[0m07:36:57.354102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d7900ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78ff26e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d79020c150>]}


============================== 07:36:57.359722 | 418b0303-12d3-469d-a50d-51a2553eee22 ==============================
[0m07:36:57.359722 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:36:57.360233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:36:57.486514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e64fe90>]}
[0m07:36:57.533298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e685550>]}
[0m07:36:57.534051 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:36:57.545269 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m07:36:57.546297 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:36:57.546947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e68a990>]}
[0m07:36:58.358294 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of `seed.dbt_modeling.Medical
Procedure`
[0m07:36:58.359014 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. For more information: https://docs.getdbt.com
/reference/global-configs/legacy-behaviors#require_resource_names_without_spaces
Run again with `--debug` to see them all.
[0m07:36:58.359493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e4c9710>]}
[0m07:36:58.366864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78fe3ac90>]}
[0m07:36:58.428870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e4d4a50>]}
[0m07:36:58.429355 [info ] [MainThread]: Found 5 seeds, 415 macros
[0m07:36:58.429766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e45f390>]}
[0m07:36:58.431660 [info ] [MainThread]: 
[0m07:36:58.432186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:36:58.436739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m07:36:58.525634 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m07:36:58.526213 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m07:36:58.526661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:58.535760 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:36:58.537108 [debug] [ThreadPool]: On list_my_db: Close
[0m07:36:58.538713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m07:36:58.544738 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m07:36:58.545087 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m07:36:58.545354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:58.548921 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.549293 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m07:36:58.549617 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:36:58.552529 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:36:58.553778 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m07:36:58.554245 [debug] [ThreadPool]: On list_my_db_public: Close
[0m07:36:58.558944 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.559299 [debug] [MainThread]: On master: BEGIN
[0m07:36:58.559569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:36:58.562886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.563273 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.563711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:36:58.566834 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:36:58.568097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e45fa10>]}
[0m07:36:58.568505 [debug] [MainThread]: On master: ROLLBACK
[0m07:36:58.569104 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.569402 [debug] [MainThread]: On master: BEGIN
[0m07:36:58.569994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.570299 [debug] [MainThread]: On master: COMMIT
[0m07:36:58.570584 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.570843 [debug] [MainThread]: On master: COMMIT
[0m07:36:58.571262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:36:58.571570 [debug] [MainThread]: On master: Close
[0m07:36:58.572011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:36:58.572332 [info ] [MainThread]: 
[0m07:36:58.580587 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Appointment
[0m07:36:58.581157 [info ] [Thread-1 (]: 1 of 5 START seed file public.Appointment ...................................... [RUN]
[0m07:36:58.581713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now seed.dbt_modeling.Appointment)
[0m07:36:58.582056 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Appointment
[0m07:36:58.582395 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Appointment
[0m07:36:58.670407 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:58.670780 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: BEGIN
[0m07:36:58.671077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:58.674488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.674900 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:58.675190 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Appointment"} */

    create table "my_db"."public"."Appointment" ("AppointmentID" integer,"Date" date,"Time" timestamp without time zone,"PatientID" integer,"DoctorID" integer)
  
[0m07:36:58.676747 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:36:59.204518 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:59.204929 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: 
          insert into "my_db"."public"."Appointment" ("AppointmentID", "Date", "Time", "PatientID", "DoctorID") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%...
[0m07:36:59.218942 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:36:59.224071 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Appointment"
[0m07:36:59.239045 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: COMMIT
[0m07:36:59.239384 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:59.239669 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: COMMIT
[0m07:36:59.247876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:36:59.249750 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: Close
[0m07:36:59.251118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d779fd0>]}
[0m07:36:59.251712 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file public.Appointment .................................. [[32mINSERT 1000[0m in 0.67s]
[0m07:36:59.252464 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Appointment
[0m07:36:59.252912 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Billing
[0m07:36:59.253380 [info ] [Thread-1 (]: 2 of 5 START seed file public.Billing .......................................... [RUN]
[0m07:36:59.253962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Appointment, now seed.dbt_modeling.Billing)
[0m07:36:59.254303 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Billing
[0m07:36:59.254634 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Billing
[0m07:36:59.275249 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.275717 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: BEGIN
[0m07:36:59.276020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:59.279537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:36:59.279985 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.280295 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Billing"} */

    create table "my_db"."public"."Billing" ("InvoiceID" text,"PatientID" integer,"Items" text,"Amount" integer)
  
[0m07:36:59.283162 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:36:59.677815 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.678222 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: 
          insert into "my_db"."public"."Billing" ("InvoiceID", "PatientID", "Items", "Amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,...
[0m07:36:59.685965 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:36:59.686786 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Billing"
[0m07:36:59.688434 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: COMMIT
[0m07:36:59.688728 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.689014 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: COMMIT
[0m07:36:59.697054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:36:59.698037 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: Close
[0m07:36:59.698674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e648250>]}
[0m07:36:59.699130 [info ] [Thread-1 (]: 2 of 5 OK loaded seed file public.Billing ...................................... [[32mINSERT 1000[0m in 0.44s]
[0m07:36:59.699764 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Billing
[0m07:36:59.700239 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Doctor
[0m07:36:59.700821 [info ] [Thread-1 (]: 3 of 5 START seed file public.Doctor ........................................... [RUN]
[0m07:36:59.701284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Billing, now seed.dbt_modeling.Doctor)
[0m07:36:59.701646 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Doctor
[0m07:36:59.701944 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Doctor
[0m07:36:59.715666 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:36:59.716118 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: BEGIN
[0m07:36:59.716432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:59.720163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:36:59.720618 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:36:59.720937 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Doctor"} */

    create table "my_db"."public"."Doctor" ("DoctorID" integer,"DoctorName" text,"Specialization" text,"DoctorContact" text)
  
[0m07:36:59.723987 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:37:00.121959 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:37:00.122367 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: 
          insert into "my_db"."public"."Doctor" ("DoctorID", "DoctorName", "Specialization", "DoctorContact") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s...
[0m07:37:00.129443 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:37:00.130235 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Doctor"
[0m07:37:00.131739 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: COMMIT
[0m07:37:00.132032 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:37:00.132290 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: COMMIT
[0m07:37:00.140640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.141626 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: Close
[0m07:37:00.142167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d68a0d0>]}
[0m07:37:00.142661 [info ] [Thread-1 (]: 3 of 5 OK loaded seed file public.Doctor ....................................... [[32mINSERT 1000[0m in 0.44s]
[0m07:37:00.143272 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Doctor
[0m07:37:00.143826 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Medical Procedure
[0m07:37:00.144325 [info ] [Thread-1 (]: 4 of 5 START seed file public.Medical Procedure ................................ [RUN]
[0m07:37:00.144795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Doctor, now seed.dbt_modeling.Medical Procedure)
[0m07:37:00.145114 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Medical Procedure
[0m07:37:00.145414 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Medical Procedure
[0m07:37:00.164530 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.164961 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: BEGIN
[0m07:37:00.165369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:00.169272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:37:00.169812 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.170170 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Medical Procedure"} */

    create table "my_db"."public"."Medical Procedure" ("ProcedureID" integer,"ProcedureName" text,"AppointmentID" integer)
  
[0m07:37:00.173028 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:37:00.470189 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.470616 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: 
          insert into "my_db"."public"."Medical Procedure" ("ProcedureID", "ProcedureName", "AppointmentID") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m07:37:00.476646 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:37:00.477365 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.478949 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: COMMIT
[0m07:37:00.479262 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.479577 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: COMMIT
[0m07:37:00.488238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.489073 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: Close
[0m07:37:00.489550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d651d50>]}
[0m07:37:00.490017 [info ] [Thread-1 (]: 4 of 5 OK loaded seed file public.Medical Procedure ............................ [[32mINSERT 1000[0m in 0.34s]
[0m07:37:00.490673 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Medical Procedure
[0m07:37:00.491244 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Patient
[0m07:37:00.492273 [info ] [Thread-1 (]: 5 of 5 START seed file public.Patient .......................................... [RUN]
[0m07:37:00.493058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Medical Procedure, now seed.dbt_modeling.Patient)
[0m07:37:00.493529 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Patient
[0m07:37:00.493838 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Patient
[0m07:37:00.509310 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.509811 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: BEGIN
[0m07:37:00.510250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:00.514126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:37:00.514625 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.514952 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Patient"} */

    create table "my_db"."public"."Patient" ("PatientID" integer,"firstname" text,"lastname" text,"email" text)
  
[0m07:37:00.517700 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:37:00.904974 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.905403 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: 
          insert into "my_db"."public"."Patient" ("PatientID", "firstname", "lastname", "email") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m07:37:00.912383 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:37:00.913143 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Patient"
[0m07:37:00.914580 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: COMMIT
[0m07:37:00.914877 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.915129 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: COMMIT
[0m07:37:00.923294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.924313 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: Close
[0m07:37:00.924875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d646150>]}
[0m07:37:00.925368 [info ] [Thread-1 (]: 5 of 5 OK loaded seed file public.Patient ...................................... [[32mINSERT 1000[0m in 0.43s]
[0m07:37:00.925969 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Patient
[0m07:37:00.927215 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:00.927552 [debug] [MainThread]: On master: BEGIN
[0m07:37:00.927872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:37:00.930690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:37:00.931065 [debug] [MainThread]: On master: COMMIT
[0m07:37:00.931368 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:00.931677 [debug] [MainThread]: On master: COMMIT
[0m07:37:00.932094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.932402 [debug] [MainThread]: On master: Close
[0m07:37:00.932860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:00.933169 [debug] [MainThread]: Connection 'seed.dbt_modeling.Patient' was properly closed.
[0m07:37:00.933713 [info ] [MainThread]: 
[0m07:37:00.934269 [info ] [MainThread]: Finished running 5 seeds in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m07:37:00.935878 [debug] [MainThread]: Command end result
[0m07:37:00.962507 [info ] [MainThread]: 
[0m07:37:00.963016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:37:00.963430 [info ] [MainThread]: 
[0m07:37:00.963799 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:37:00.964573 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.650707, "process_user_time": 4.554528, "process_kernel_time": 0.137743, "process_mem_max_rss": "115548", "process_out_blocks": "2800", "process_in_blocks": "0"}
[0m07:37:00.965041 [debug] [MainThread]: Command `dbt seed` succeeded at 07:37:00.964940 after 3.65 seconds
[0m07:37:00.965356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78ff53850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78ff99850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d793d586d0>]}
[0m07:37:00.965679 [debug] [MainThread]: Flushing usage events
[0m07:45:20.235188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb0d6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb11b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb297950>]}


============================== 07:45:20.237822 | f525dd9f-8a41-4bed-a8e0-09d1fdeb0d4a ==============================
[0m07:45:20.237822 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:45:20.238302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m07:45:20.245177 [info ] [MainThread]: dbt version: 1.8.3
[0m07:45:20.245801 [info ] [MainThread]: python version: 3.11.2
[0m07:45:20.246274 [info ] [MainThread]: python path: /usr/local/bin/python
[0m07:45:20.246694 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.31
[0m07:45:20.301291 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m07:45:20.301736 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m07:45:20.302048 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m07:45:20.302529 [info ] [MainThread]: adapter type: postgres
[0m07:45:20.302838 [info ] [MainThread]: adapter version: 1.8.2
[0m07:45:20.395828 [info ] [MainThread]: Configuration:
[0m07:45:20.396332 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:45:20.396743 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:45:20.397056 [info ] [MainThread]: Required dependencies:
[0m07:45:20.397398 [debug] [MainThread]: Executing "git --help"
[0m07:45:20.399150 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:45:20.399595 [debug] [MainThread]: STDERR: "b''"
[0m07:45:20.399908 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:45:20.400204 [info ] [MainThread]: Connection:
[0m07:45:20.400557 [info ] [MainThread]:   host: db
[0m07:45:20.400858 [info ] [MainThread]:   port: 5432
[0m07:45:20.401142 [info ] [MainThread]:   user: user
[0m07:45:20.401431 [info ] [MainThread]:   database: my_db
[0m07:45:20.401768 [info ] [MainThread]:   schema: public
[0m07:45:20.402108 [info ] [MainThread]:   connect_timeout: 10
[0m07:45:20.402473 [info ] [MainThread]:   role: None
[0m07:45:20.402812 [info ] [MainThread]:   search_path: None
[0m07:45:20.403114 [info ] [MainThread]:   keepalives_idle: 0
[0m07:45:20.403436 [info ] [MainThread]:   sslmode: None
[0m07:45:20.403746 [info ] [MainThread]:   sslcert: None
[0m07:45:20.404045 [info ] [MainThread]:   sslkey: None
[0m07:45:20.404377 [info ] [MainThread]:   sslrootcert: None
[0m07:45:20.404712 [info ] [MainThread]:   application_name: dbt
[0m07:45:20.405032 [info ] [MainThread]:   retries: 1
[0m07:45:20.405659 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:45:20.407662 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:45:20.438077 [debug] [MainThread]: Using postgres connection "debug"
[0m07:45:20.438469 [debug] [MainThread]: On debug: select 1 as id
[0m07:45:20.438745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:20.443534 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m07:45:20.444923 [debug] [MainThread]: On debug: Close
[0m07:45:20.445432 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:45:20.445876 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:45:20.446984 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.25241503, "process_user_time": 1.274704, "process_kernel_time": 0.111798, "process_mem_max_rss": "104772", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m07:45:20.447763 [debug] [MainThread]: Command `dbt debug` succeeded at 07:45:20.447575 after 0.25 seconds
[0m07:45:20.448209 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:45:20.448696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb297dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf1c97d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c987c0d0>]}
[0m07:45:20.449227 [debug] [MainThread]: Flushing usage events
[0m07:47:23.289031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a13ba4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a13add10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a152b810>]}


============================== 07:47:23.291525 | f7e5e815-b0ab-4c5f-a314-01cbadf094cd ==============================
[0m07:47:23.291525 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:47:23.291990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:47:23.420274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699fa8ef50>]}
[0m07:47:23.466002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699fad2550>]}
[0m07:47:23.466716 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:47:23.476096 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m07:47:23.546992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:47:23.547320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:47:23.547636 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of `seed.dbt_modeling.Medical
Procedure`
[0m07:47:23.548016 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. For more information: https://docs.getdbt.com
/reference/global-configs/legacy-behaviors#require_resource_names_without_spaces
Run again with `--debug` to see them all.
[0m07:47:23.548326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699f9c5ed0>]}
[0m07:47:23.570091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699fa76950>]}
[0m07:47:23.626856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699f8f54d0>]}
[0m07:47:23.627305 [info ] [MainThread]: Found 5 seeds, 415 macros
[0m07:47:23.627640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699f944690>]}
[0m07:47:23.629117 [info ] [MainThread]: 
[0m07:47:23.629448 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:47:23.631079 [debug] [MainThread]: Command end result
[0m07:47:23.654901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4060835, "process_user_time": 1.423436, "process_kernel_time": 0.12686, "process_mem_max_rss": "102304", "process_out_blocks": "1608", "process_in_blocks": "0"}
[0m07:47:23.655402 [debug] [MainThread]: Command `dbt run` succeeded at 07:47:23.655297 after 0.41 seconds
[0m07:47:23.655737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a5258510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a51646d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a52e8cd0>]}
[0m07:47:23.656062 [debug] [MainThread]: Flushing usage events
[0m07:47:57.546246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4d7f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4c740810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4baefb50>]}


============================== 07:47:57.548794 | 8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28 ==============================
[0m07:47:57.548794 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:47:57.549283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:47:57.680339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4ba3d310>]}
[0m07:47:57.726084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4f7ec650>]}
[0m07:47:57.726818 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:47:57.735575 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m07:47:57.804221 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m07:47:57.804687 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://seeds/Medical_Procedure.csv
[0m07:47:57.804969 [debug] [MainThread]: Partial parsing: deleted file: dbt_modeling://seeds/Medical Procedure.csv
[0m07:47:57.960584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4a2524d0>]}
[0m07:47:58.011608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4a11df50>]}
[0m07:47:58.012094 [info ] [MainThread]: Found 5 seeds, 415 macros
[0m07:47:58.012383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba49eb9d50>]}
[0m07:47:58.013874 [info ] [MainThread]: 
[0m07:47:58.014179 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:47:58.014722 [debug] [MainThread]: Command end result
[0m07:47:58.037151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.53253675, "process_user_time": 1.571654, "process_kernel_time": 0.101912, "process_mem_max_rss": "104364", "process_out_blocks": "2392", "process_in_blocks": "0"}
[0m07:47:58.037706 [debug] [MainThread]: Command `dbt run` succeeded at 07:47:58.037599 after 0.53 seconds
[0m07:47:58.038080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4bb11390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4bb13190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4f8dc750>]}
[0m07:47:58.038400 [debug] [MainThread]: Flushing usage events
[0m08:12:06.550398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d16e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a443416e010>]}


============================== 08:12:06.552865 | 8d3b41a5-9fa8-4508-ac0c-6fb67e76ec63 ==============================
[0m08:12:06.552865 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:12:06.553322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:12:06.560063 [info ] [MainThread]: dbt version: 1.8.3
[0m08:12:06.560484 [info ] [MainThread]: python version: 3.11.2
[0m08:12:06.560863 [info ] [MainThread]: python path: /usr/local/bin/python
[0m08:12:06.561189 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.31
[0m08:12:06.616994 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m08:12:06.617466 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m08:12:06.617849 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m08:12:06.618366 [info ] [MainThread]: adapter type: postgres
[0m08:12:06.618661 [info ] [MainThread]: adapter version: 1.8.2
[0m08:12:06.702726 [info ] [MainThread]: Configuration:
[0m08:12:06.703164 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:12:06.703497 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:12:06.703844 [info ] [MainThread]: Required dependencies:
[0m08:12:06.704128 [debug] [MainThread]: Executing "git --help"
[0m08:12:06.705797 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:12:06.706168 [debug] [MainThread]: STDERR: "b''"
[0m08:12:06.706444 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:12:06.706685 [info ] [MainThread]: Connection:
[0m08:12:06.706976 [info ] [MainThread]:   host: db
[0m08:12:06.707229 [info ] [MainThread]:   port: 5432
[0m08:12:06.707514 [info ] [MainThread]:   user: user
[0m08:12:06.707749 [info ] [MainThread]:   database: my_db
[0m08:12:06.708024 [info ] [MainThread]:   schema: public
[0m08:12:06.708261 [info ] [MainThread]:   connect_timeout: 10
[0m08:12:06.708524 [info ] [MainThread]:   role: None
[0m08:12:06.708869 [info ] [MainThread]:   search_path: None
[0m08:12:06.709178 [info ] [MainThread]:   keepalives_idle: 0
[0m08:12:06.709564 [info ] [MainThread]:   sslmode: None
[0m08:12:06.709932 [info ] [MainThread]:   sslcert: None
[0m08:12:06.710254 [info ] [MainThread]:   sslkey: None
[0m08:12:06.710542 [info ] [MainThread]:   sslrootcert: None
[0m08:12:06.710812 [info ] [MainThread]:   application_name: dbt
[0m08:12:06.711095 [info ] [MainThread]:   retries: 1
[0m08:12:06.711573 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:12:06.712936 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:12:06.741153 [debug] [MainThread]: Using postgres connection "debug"
[0m08:12:06.741657 [debug] [MainThread]: On debug: select 1 as id
[0m08:12:06.741953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:06.747815 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:12:06.748770 [debug] [MainThread]: On debug: Close
[0m08:12:06.749080 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:12:06.749441 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:12:06.750277 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.23987165, "process_user_time": 1.276169, "process_kernel_time": 0.109928, "process_mem_max_rss": "104876", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m08:12:06.750793 [debug] [MainThread]: Command `dbt debug` succeeded at 08:12:06.750683 after 0.24 seconds
[0m08:12:06.751089 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:12:06.751389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4433137510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d50e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d349d0>]}
[0m08:12:06.751719 [debug] [MainThread]: Flushing usage events
[0m09:59:34.952325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95352a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953564c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95352ac50>]}


============================== 09:59:34.954975 | 27cea84a-ea6b-44c2-bebd-356dbd37bbe6 ==============================
[0m09:59:34.954975 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:59:34.955523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m09:59:35.086272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27cea84a-ea6b-44c2-bebd-356dbd37bbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953458d50>]}
[0m09:59:35.132304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27cea84a-ea6b-44c2-bebd-356dbd37bbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa951c75710>]}
[0m09:59:35.133039 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:59:35.142361 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m09:59:35.213872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m09:59:35.214442 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m09:59:35.214747 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m09:59:35.215022 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m09:59:35.215298 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m09:59:35.215578 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m09:59:35.215879 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m09:59:35.216144 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m09:59:35.216439 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m09:59:35.216698 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m09:59:35.216960 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m09:59:35.217218 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m09:59:35.398897 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  expected token 'end of print statement', got '{'
    line 6
      from {{ref{'Billing'}}}
[0m09:59:35.399752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.48984078, "process_user_time": 1.569898, "process_kernel_time": 0.104726, "process_mem_max_rss": "104040", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m09:59:35.400186 [debug] [MainThread]: Command `dbt run` failed at 09:59:35.400093 after 0.49 seconds
[0m09:59:35.400518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9536f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953573350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953571610>]}
[0m09:59:35.400809 [debug] [MainThread]: Flushing usage events
[0m10:00:01.788492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392d9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392da890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392d9910>]}


============================== 10:00:01.791260 | ac37b9cf-e7ff-4ef2-8f9b-f574d1a59921 ==============================
[0m10:00:01.791260 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:00:01.791794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:00:01.926469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac37b9cf-e7ff-4ef2-8f9b-f574d1a59921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392e4690>]}
[0m10:00:01.979530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac37b9cf-e7ff-4ef2-8f9b-f574d1a59921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a323cf8c7d0>]}
[0m10:00:01.980292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:00:01.990156 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:00:02.074706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:00:02.075185 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:00:02.075532 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:00:02.075819 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:00:02.076100 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:00:02.076393 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:00:02.076676 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:00:02.076957 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:00:02.077236 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:00:02.077521 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:00:02.077803 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:00:02.078068 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:00:02.266592 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  expected token 'end of print statement', got '{'
    line 6
      from {{ref{'Billing'}}}
[0m10:00:02.267459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5271763, "process_user_time": 1.675611, "process_kernel_time": 0.108909, "process_mem_max_rss": "104124", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m10:00:02.267923 [debug] [MainThread]: Command `dbt run` failed at 10:00:02.267826 after 0.53 seconds
[0m10:00:02.268250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a323945bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3239292dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32376bc350>]}
[0m10:00:02.268655 [debug] [MainThread]: Flushing usage events
[0m10:01:15.313912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc61ae7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc6380090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc636f750>]}


============================== 10:01:15.316960 | 40b85ae8-a772-487d-8908-c37960118856 ==============================
[0m10:01:15.316960 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:01:15.317619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:15.462167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40b85ae8-a772-487d-8908-c37960118856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc6221810>]}
[0m10:01:15.516984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40b85ae8-a772-487d-8908-c37960118856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc9edc790>]}
[0m10:01:15.517838 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:01:15.528959 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:01:15.606553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:01:15.607086 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:01:15.607439 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:01:15.607769 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:01:15.608097 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:01:15.608429 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:01:15.608754 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:01:15.609074 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:01:15.609403 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:01:15.609728 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:01:15.610071 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:01:15.610396 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:01:15.817677 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  expected token 'end of print statement', got '{'
    line 6
      from {{ref{'Billing'}}
[0m10:01:15.818661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5525623, "process_user_time": 1.597338, "process_kernel_time": 0.139854, "process_mem_max_rss": "104308", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m10:01:15.819223 [debug] [MainThread]: Command `dbt run` failed at 10:01:15.819107 after 0.55 seconds
[0m10:01:15.819625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc61f4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc63800d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cca2c5890>]}
[0m10:01:15.819988 [debug] [MainThread]: Flushing usage events
[0m10:02:20.968977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc5d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc5fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc3ee50>]}


============================== 10:02:20.971972 | 138a316e-db16-48d1-89c8-840b8bd45246 ==============================
[0m10:02:20.971972 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:02:20.972620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:02:21.119819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '138a316e-db16-48d1-89c8-840b8bd45246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc8a550>]}
[0m10:02:21.175594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '138a316e-db16-48d1-89c8-840b8bd45246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109a3812d0>]}
[0m10:02:21.176386 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:02:21.185886 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:02:21.260252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:02:21.261067 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:02:21.261704 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:02:21.262053 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:02:21.262367 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:02:21.262673 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:02:21.263011 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:02:21.263309 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:02:21.263634 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:02:21.263943 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:02:21.264234 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:02:21.264531 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:02:21.459789 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_modeling.stg_medical_procedure' (models/staging/healthcare/stg_medical_procedure.sql) depends on a node named 'Medical_procedure' which was not found
[0m10:02:21.460853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.54143715, "process_user_time": 1.753141, "process_kernel_time": 0.12094, "process_mem_max_rss": "104428", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m10:02:21.461461 [debug] [MainThread]: Command `dbt run` failed at 10:02:21.461351 after 0.54 seconds
[0m10:02:21.461830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bde80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc5ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109fbb8b50>]}
[0m10:02:21.462228 [debug] [MainThread]: Flushing usage events
[0m10:03:03.668381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb723d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abceba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abcebe50>]}


============================== 10:03:03.670996 | 8a638b71-df0a-41a3-8f67-aebb9d2a080e ==============================
[0m10:03:03.670996 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:03:03.671683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:03:03.801309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576aa1fdfd0>]}
[0m10:03:03.848114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576af835090>]}
[0m10:03:03.848847 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:03:03.857590 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:03:03.933440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:03:03.933994 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:03:03.934294 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:03:03.934595 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:03:03.934864 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:03:03.935131 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:03:03.935399 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:03:03.935673 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:03:03.935948 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:03:03.936202 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:03:03.936461 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:03:03.936712 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:03:04.169836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576a9f99190>]}
[0m10:03:04.238541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576a9f6a750>]}
[0m10:03:04.239003 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:03:04.239298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb5bc10>]}
[0m10:03:04.240730 [info ] [MainThread]: 
[0m10:03:04.241261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:04.242178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:03:04.280197 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:03:04.280557 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:03:04.280831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:04.285428 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:03:04.286704 [debug] [ThreadPool]: On list_my_db: Close
[0m10:03:04.291678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:03:04.297524 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:04.297884 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:03:04.298136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:04.301290 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.301676 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:04.301969 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:03:04.304417 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:03:04.305774 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:03:04.306211 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:03:04.312602 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.313036 [debug] [MainThread]: On master: BEGIN
[0m10:03:04.313317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:04.316508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.316872 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.317234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:04.325482 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:03:04.326675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576aa0c8090>]}
[0m10:03:04.327066 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:04.327589 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.327902 [debug] [MainThread]: On master: BEGIN
[0m10:03:04.328420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.328734 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.328992 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.329240 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.329615 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:04.329878 [debug] [MainThread]: On master: Close
[0m10:03:04.330311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:04.330659 [info ] [MainThread]: 
[0m10:03:04.332583 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:03:04.333099 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:03:04.333582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:03:04.333979 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:03:04.341292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:03:04.342073 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:03:04.378084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:03:04.378751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:04.379059 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:03:04.379355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:04.382340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.382755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:04.383091 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date ,
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment;
  );
[0m10:03:04.383647 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 12:     from "my_db"."public"."Appointment"        
             ^

[0m10:03:04.384059 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:03:04.384581 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:03:04.388211 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 12:     from "my_db"."public"."Appointment"        
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:04.389808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576a9f54190>]}
[0m10:03:04.390540 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:03:04.391239 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:03:04.392882 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.393193 [debug] [MainThread]: On master: BEGIN
[0m10:03:04.393458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:04.396476 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.396962 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.397227 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.397484 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.397923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:04.398207 [debug] [MainThread]: On master: Close
[0m10:03:04.398629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:04.398887 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:03:04.399170 [info ] [MainThread]: 
[0m10:03:04.399542 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:03:04.400256 [debug] [MainThread]: Command end result
[0m10:03:04.430920 [info ] [MainThread]: 
[0m10:03:04.431403 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:03:04.431708 [info ] [MainThread]: 
[0m10:03:04.432097 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 12:     from "my_db"."public"."Appointment"        
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:04.432407 [info ] [MainThread]: 
[0m10:03:04.432717 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:03:04.433460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.808034, "process_user_time": 1.844303, "process_kernel_time": 0.131735, "process_mem_max_rss": "114076", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m10:03:04.433930 [debug] [MainThread]: Command `dbt run` failed at 10:03:04.433827 after 0.81 seconds
[0m10:03:04.434265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb73790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb71850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576afaa8e10>]}
[0m10:03:04.434604 [debug] [MainThread]: Flushing usage events
[0m10:03:28.601216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4b1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4691d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4b2d90>]}


============================== 10:03:28.603935 | c58acae2-a985-47ac-b864-27ccae52ae8a ==============================
[0m10:03:28.603935 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:03:28.604549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:28.748355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4b1c90>]}
[0m10:03:28.798287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf379a10>]}
[0m10:03:28.799031 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:03:28.807934 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:03:28.903111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:28.903742 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:03:29.100844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cda51590>]}
[0m10:03:29.167914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cd8ddbd0>]}
[0m10:03:29.168413 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:03:29.168697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cda229d0>]}
[0m10:03:29.170297 [info ] [MainThread]: 
[0m10:03:29.170997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:29.171884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:03:29.208972 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:03:29.209323 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:03:29.209591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:29.213881 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:03:29.215152 [debug] [ThreadPool]: On list_my_db: Close
[0m10:03:29.220902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:03:29.226730 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:29.227064 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:03:29.227315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:29.230501 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.230923 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:29.231230 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:03:29.234000 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:03:29.235404 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:03:29.235851 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:03:29.242436 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.242775 [debug] [MainThread]: On master: BEGIN
[0m10:03:29.243025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:29.246279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.246669 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.247021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:29.255323 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:03:29.256535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf36ff90>]}
[0m10:03:29.256921 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:29.257401 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.257753 [debug] [MainThread]: On master: BEGIN
[0m10:03:29.258356 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.258689 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.258954 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.259200 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.259620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:29.259918 [debug] [MainThread]: On master: Close
[0m10:03:29.260359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:29.260679 [info ] [MainThread]: 
[0m10:03:29.262689 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:03:29.263183 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:03:29.263668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:03:29.264034 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:03:29.273008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:03:29.273738 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:03:29.310496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:03:29.311135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:29.311495 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:03:29.311824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:29.315101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.315584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:29.316033 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment;
  );
[0m10:03:29.316788 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: select * from raw_appointment;
                                      ^

[0m10:03:29.317254 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:03:29.317852 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:03:29.321555 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near ";"
  LINE 14: select * from raw_appointment;
                                        ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:29.322982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf6400d0>]}
[0m10:03:29.323588 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:03:29.324199 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:03:29.325781 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.326081 [debug] [MainThread]: On master: BEGIN
[0m10:03:29.326347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:29.329310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.329737 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.330038 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.330292 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.330747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:29.331037 [debug] [MainThread]: On master: Close
[0m10:03:29.331449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:29.331701 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:03:29.332004 [info ] [MainThread]: 
[0m10:03:29.332442 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:03:29.333277 [debug] [MainThread]: Command end result
[0m10:03:29.360571 [info ] [MainThread]: 
[0m10:03:29.361030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:03:29.361327 [info ] [MainThread]: 
[0m10:03:29.361719 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near ";"
  LINE 14: select * from raw_appointment;
                                        ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:29.362011 [info ] [MainThread]: 
[0m10:03:29.362309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:03:29.363098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80480886, "process_user_time": 1.946281, "process_kernel_time": 0.133539, "process_mem_max_rss": "113708", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:03:29.363742 [debug] [MainThread]: Command `dbt run` failed at 10:03:29.363609 after 0.81 seconds
[0m10:03:29.364133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4bd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf45f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf45f9d0>]}
[0m10:03:29.364510 [debug] [MainThread]: Flushing usage events
[0m10:04:02.327099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730117298a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011759cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730117252690>]}


============================== 10:04:02.330070 | f66d359a-95d7-45e6-938d-af4e2b335cab ==============================
[0m10:04:02.330070 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:04:02.330630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:04:02.472677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011597a6d0>]}
[0m10:04:02.520399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011af8c690>]}
[0m10:04:02.521120 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:04:02.530106 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:04:02.624386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:04:02.624964 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:04:02.818129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730115a06490>]}
[0m10:04:02.884429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730115310210>]}
[0m10:04:02.884870 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:04:02.885174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301156c3790>]}
[0m10:04:02.886510 [info ] [MainThread]: 
[0m10:04:02.887026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:04:02.887791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:04:02.924801 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:04:02.925160 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:04:02.925422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:02.929987 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:04:02.931330 [debug] [ThreadPool]: On list_my_db: Close
[0m10:04:02.936395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:04:02.942092 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:04:02.942448 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:04:02.942721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:02.945972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:04:02.946373 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:04:02.946680 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:04:02.949094 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:04:02.950414 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:04:02.950835 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:04:02.957076 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.957462 [debug] [MainThread]: On master: BEGIN
[0m10:04:02.957781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:02.960964 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:02.961345 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.961702 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:04:02.970051 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:04:02.971277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301147e89d0>]}
[0m10:04:02.971682 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:02.972099 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.972432 [debug] [MainThread]: On master: BEGIN
[0m10:04:02.973078 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:02.973404 [debug] [MainThread]: On master: COMMIT
[0m10:04:02.973687 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.973935 [debug] [MainThread]: On master: COMMIT
[0m10:04:02.974296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:04:02.974575 [debug] [MainThread]: On master: Close
[0m10:04:02.974991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:02.975316 [info ] [MainThread]: 
[0m10:04:02.977207 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:04:02.977710 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:04:02.978238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:04:02.978613 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:04:02.986946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:04:02.987769 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:04:03.024407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:04:03.025081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:04:03.025435 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:04:03.025725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:03.029681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:03.030085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:04:03.030430 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment
  );
[0m10:04:03.031240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointmentid" does not exist
LINE 8:     select  AppointmentID as Appointment_id,
                    ^
HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".

[0m10:04:03.031626 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:04:03.032140 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:04:03.036040 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:04:03.037757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011479b150>]}
[0m10:04:03.038505 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:04:03.039223 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:04:03.040902 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:03.041293 [debug] [MainThread]: On master: BEGIN
[0m10:04:03.041645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:03.044591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:03.044986 [debug] [MainThread]: On master: COMMIT
[0m10:04:03.045251 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:03.045531 [debug] [MainThread]: On master: COMMIT
[0m10:04:03.045909 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:04:03.046199 [debug] [MainThread]: On master: Close
[0m10:04:03.046657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:03.046945 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:04:03.047330 [info ] [MainThread]: 
[0m10:04:03.047777 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:04:03.048615 [debug] [MainThread]: Command end result
[0m10:04:03.076874 [info ] [MainThread]: 
[0m10:04:03.077375 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:04:03.077706 [info ] [MainThread]: 
[0m10:04:03.078385 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:04:03.079046 [info ] [MainThread]: 
[0m10:04:03.079593 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:04:03.080590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80230737, "process_user_time": 1.934022, "process_kernel_time": 0.121938, "process_mem_max_rss": "114144", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m10:04:03.081271 [debug] [MainThread]: Command `dbt run` failed at 10:04:03.081143 after 0.80 seconds
[0m10:04:03.081710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011b1e0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011b1e0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011b1e0b10>]}
[0m10:04:03.082051 [debug] [MainThread]: Flushing usage events
[0m10:07:24.847346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce352e0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce352dd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce35463fd0>]}


============================== 10:07:24.849957 | c12b5bf0-b07f-46be-ad32-5e5bccafff24 ==============================
[0m10:07:24.849957 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:07:24.850531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:07:25.000537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce3396da90>]}
[0m10:07:25.049703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce38fd4fd0>]}
[0m10:07:25.050439 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:07:25.060218 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:07:25.156051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:07:25.156634 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:07:25.352156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce33968dd0>]}
[0m10:07:25.418833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce336efc10>]}
[0m10:07:25.419287 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:07:25.419592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce336be610>]}
[0m10:07:25.421062 [info ] [MainThread]: 
[0m10:07:25.421620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:25.422505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:07:25.462394 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:07:25.462761 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:07:25.463029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:25.467515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:07:25.468814 [debug] [ThreadPool]: On list_my_db: Close
[0m10:07:25.473524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:07:25.479385 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:07:25.479719 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:07:25.479976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:25.483135 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.483608 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:07:25.483903 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:07:25.486470 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:07:25.487854 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:07:25.488327 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:07:25.495057 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.495515 [debug] [MainThread]: On master: BEGIN
[0m10:07:25.495805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:25.498954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.499483 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.499858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:25.508547 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:07:25.509744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce33a29ed0>]}
[0m10:07:25.510180 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:25.510724 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.511051 [debug] [MainThread]: On master: BEGIN
[0m10:07:25.511529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.511837 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.512098 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.512354 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.512755 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:25.513038 [debug] [MainThread]: On master: Close
[0m10:07:25.513507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:07:25.513857 [info ] [MainThread]: 
[0m10:07:25.515804 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:07:25.516302 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:07:25.516779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:07:25.517195 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:07:25.525806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:07:25.526512 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:07:25.563968 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:07:25.564607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:07:25.564950 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:07:25.565272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:25.568500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.568953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:07:25.569293 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment
  );
[0m10:07:25.570015 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointmentid" does not exist
LINE 8:     select  AppointmentID as Appointment_id,
                    ^
HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".

[0m10:07:25.570497 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:07:25.571103 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:07:25.574884 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:07:25.576447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce327e8c90>]}
[0m10:07:25.577099 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:07:25.577729 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:07:25.579320 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.579633 [debug] [MainThread]: On master: BEGIN
[0m10:07:25.579892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:25.582949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.583390 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.583710 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.583969 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.584363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:25.584675 [debug] [MainThread]: On master: Close
[0m10:07:25.585106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:25.585476 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:07:25.585801 [info ] [MainThread]: 
[0m10:07:25.586156 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:07:25.587062 [debug] [MainThread]: Command end result
[0m10:07:25.615855 [info ] [MainThread]: 
[0m10:07:25.616327 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:07:25.616704 [info ] [MainThread]: 
[0m10:07:25.617180 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:07:25.617597 [info ] [MainThread]: 
[0m10:07:25.618019 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:07:25.619066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8174661, "process_user_time": 2.001389, "process_kernel_time": 0.132091, "process_mem_max_rss": "113912", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m10:07:25.619657 [debug] [MainThread]: Command `dbt run` failed at 10:07:25.619512 after 0.82 seconds
[0m10:07:25.620043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce36707250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce352ed550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce351c84d0>]}
[0m10:07:25.620439 [debug] [MainThread]: Flushing usage events
[0m10:10:52.001211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee40cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee587750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee40cdd0>]}


============================== 10:10:52.003902 | c52f6033-9ed8-4f01-9e41-aa10ea977e4c ==============================
[0m10:10:52.003902 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:10:52.004421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:10:52.154115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee419910>]}
[0m10:10:52.203990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227f20d0fd0>]}
[0m10:10:52.204710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:10:52.213974 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:10:52.308992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:52.309604 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:10:52.503977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec7d1a10>]}
[0m10:10:52.570922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec831d50>]}
[0m10:10:52.571383 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:10:52.571667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec847490>]}
[0m10:10:52.573124 [info ] [MainThread]: 
[0m10:10:52.573830 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:52.574787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:10:52.612190 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:10:52.612545 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:10:52.612807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:52.617299 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:10:52.618536 [debug] [ThreadPool]: On list_my_db: Close
[0m10:10:52.623281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:10:52.629040 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:10:52.629392 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:10:52.629664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:52.632920 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.633315 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:10:52.633621 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:52.636099 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:10:52.637545 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:10:52.637994 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:10:52.643969 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.644310 [debug] [MainThread]: On master: BEGIN
[0m10:10:52.644605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:52.647781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.648154 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.648515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:10:52.656748 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:10:52.657949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec77ad50>]}
[0m10:10:52.658344 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:52.658794 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.659070 [debug] [MainThread]: On master: BEGIN
[0m10:10:52.659616 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.659940 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.660208 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.660468 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.660806 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:10:52.661086 [debug] [MainThread]: On master: Close
[0m10:10:52.661572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:52.662011 [info ] [MainThread]: 
[0m10:10:52.664175 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:10:52.664745 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:10:52.665277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:10:52.665666 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:10:52.673722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:10:52.674428 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:10:52.711074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:10:52.711677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:10:52.712011 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:10:52.712304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:52.715451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.715973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:10:52.716320 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  AppointmentID as Appointment_id,
        PatientID as Patient_id,
        DoctorID as Doctor_id,
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:10:52.717093 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointmentid" does not exist
LINE 7:     select  AppointmentID as Appointment_id,
                    ^
HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".

[0m10:10:52.717540 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:10:52.718119 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:10:52.721768 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 7:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:10:52.723281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ebba9750>]}
[0m10:10:52.723968 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:10:52.724630 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:10:52.726203 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.726528 [debug] [MainThread]: On master: BEGIN
[0m10:10:52.726792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:52.729674 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.730202 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.730592 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.730845 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.731235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:10:52.731513 [debug] [MainThread]: On master: Close
[0m10:10:52.731966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:52.732328 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:10:52.732757 [info ] [MainThread]: 
[0m10:10:52.733200 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:10:52.734099 [debug] [MainThread]: Command end result
[0m10:10:52.761416 [info ] [MainThread]: 
[0m10:10:52.761850 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:10:52.762155 [info ] [MainThread]: 
[0m10:10:52.762541 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 7:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:10:52.762854 [info ] [MainThread]: 
[0m10:10:52.763158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:10:52.763908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8096432, "process_user_time": 1.958181, "process_kernel_time": 0.132741, "process_mem_max_rss": "113764", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:10:52.764371 [debug] [MainThread]: Command `dbt run` failed at 10:10:52.764261 after 0.81 seconds
[0m10:10:52.764708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227f2324c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227f2324d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ef9162d0>]}
[0m10:10:52.765025 [debug] [MainThread]: Flushing usage events
[0m10:12:22.720724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34cad790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac360c6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34cad210>]}


============================== 10:12:22.723278 | 66218f85-b12e-4179-a5e4-da2dd0537812 ==============================
[0m10:12:22.723278 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:12:22.723765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_patient', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:12:22.855811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34cae490>]}
[0m10:12:22.902215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac38971010>]}
[0m10:12:22.902928 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:12:22.912094 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:12:23.006457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:23.006819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:23.038033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac33380350>]}
[0m10:12:23.106260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac333c49d0>]}
[0m10:12:23.106774 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:12:23.107050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac333415d0>]}
[0m10:12:23.108667 [info ] [MainThread]: 
[0m10:12:23.109277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:23.110078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:12:23.150703 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:12:23.151100 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:12:23.151361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:23.156247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:12:23.157593 [debug] [ThreadPool]: On list_my_db: Close
[0m10:12:23.162464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:12:23.168280 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:12:23.168634 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:12:23.168879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:23.172521 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.172971 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:12:23.173264 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:12:23.175970 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:12:23.177416 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:12:23.177867 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:12:23.184316 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.184682 [debug] [MainThread]: On master: BEGIN
[0m10:12:23.184990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:23.188266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.188678 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.189037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:23.197557 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:12:23.198743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac3269d4d0>]}
[0m10:12:23.199141 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:23.199625 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.199940 [debug] [MainThread]: On master: BEGIN
[0m10:12:23.200396 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.200703 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.200962 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.201205 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.201596 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:12:23.201884 [debug] [MainThread]: On master: Close
[0m10:12:23.202307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:23.202656 [info ] [MainThread]: 
[0m10:12:23.204518 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_patient
[0m10:12:23.205046 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_patient ................................. [RUN]
[0m10:12:23.205529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_patient)
[0m10:12:23.205985 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_patient
[0m10:12:23.213820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_patient"
[0m10:12:23.214401 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_patient
[0m10:12:23.250023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_patient"
[0m10:12:23.250605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:12:23.250918 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: BEGIN
[0m10:12:23.251197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:23.254671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.255145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:12:23.255471 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */

  create view "my_db"."public"."stg_patient__dbt_tmp"
    
    
  as (
    select  PatientID as Patient_id,
        firstname as First_name,
        lastname as Last_name,
        email as Email
    from "my_db"."public"."Patient"
  );
[0m10:12:23.256240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patientid" does not exist
LINE 7:     select  PatientID as Patient_id,
                    ^
HINT:  Perhaps you meant to reference the column "Patient.PatientID".

[0m10:12:23.256810 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: ROLLBACK
[0m10:12:23.257478 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: Close
[0m10:12:23.261361 [debug] [Thread-1 (]: Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:12:23.262796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac3243c6d0>]}
[0m10:12:23.263418 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_patient ........................ [[31mERROR[0m in 0.06s]
[0m10:12:23.264020 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_patient
[0m10:12:23.265590 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.265897 [debug] [MainThread]: On master: BEGIN
[0m10:12:23.266147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:23.269315 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.269743 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.270029 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.270293 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.270781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:12:23.271098 [debug] [MainThread]: On master: Close
[0m10:12:23.271515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:23.271771 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_patient' was properly closed.
[0m10:12:23.272048 [info ] [MainThread]: 
[0m10:12:23.272371 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:12:23.273054 [debug] [MainThread]: Command end result
[0m10:12:23.303015 [info ] [MainThread]: 
[0m10:12:23.303507 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:12:23.303998 [info ] [MainThread]: 
[0m10:12:23.304613 [error] [MainThread]:   Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:12:23.305004 [info ] [MainThread]: 
[0m10:12:23.305402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:12:23.306257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6269651, "process_user_time": 1.681997, "process_kernel_time": 0.121638, "process_mem_max_rss": "111124", "process_out_blocks": "1736", "command_success": false, "process_in_blocks": "0"}
[0m10:12:23.306958 [debug] [MainThread]: Command `dbt run` failed at 10:12:23.306821 after 0.63 seconds
[0m10:12:23.307475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34fa0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34baff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34c5b890>]}
[0m10:12:23.307915 [debug] [MainThread]: Flushing usage events
[0m10:17:47.886612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca4e3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ccb8f85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca4cb8d0>]}


============================== 10:17:47.889759 | 6ee12512-37a7-41ef-87be-ef3de98d37f6 ==============================
[0m10:17:47.889759 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:17:47.890273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_patient', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:48.035134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca3afd90>]}
[0m10:17:48.082259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cce1a5050>]}
[0m10:17:48.083042 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:48.091837 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:17:48.186720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:17:48.187290 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:17:48.187631 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:17:48.187974 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:17:48.188286 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:17:48.401561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc8a40ed0>]}
[0m10:17:48.480625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca4e36d0>]}
[0m10:17:48.481139 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:17:48.481571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc8c1bc10>]}
[0m10:17:48.483146 [info ] [MainThread]: 
[0m10:17:48.483722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:48.484585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:17:48.521281 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:17:48.521679 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:17:48.521943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:48.526461 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:17:48.527805 [debug] [ThreadPool]: On list_my_db: Close
[0m10:17:48.533464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:17:48.539194 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:48.539571 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:17:48.539824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:48.543167 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.543549 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:48.543875 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:17:48.546945 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:17:48.548591 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:17:48.549120 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:17:48.554966 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.555414 [debug] [MainThread]: On master: BEGIN
[0m10:17:48.555764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:48.558929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.559282 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.559646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:48.568119 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:17:48.569365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc88e29d0>]}
[0m10:17:48.569772 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:48.570181 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.570539 [debug] [MainThread]: On master: BEGIN
[0m10:17:48.571037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.571376 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.571661 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.571933 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.572308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:48.572606 [debug] [MainThread]: On master: Close
[0m10:17:48.573064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:48.573405 [info ] [MainThread]: 
[0m10:17:48.575362 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_patient
[0m10:17:48.575903 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_patient ................................. [RUN]
[0m10:17:48.576458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_patient)
[0m10:17:48.576821 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_patient
[0m10:17:48.585181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_patient"
[0m10:17:48.585769 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_patient
[0m10:17:48.622802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_patient"
[0m10:17:48.623443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:17:48.623794 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: BEGIN
[0m10:17:48.624090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:48.627507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.627949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:17:48.628308 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */

  create view "my_db"."public"."stg_patient__dbt_tmp"
    
    
  as (
    select  PatientID as Patient_id,
        firstname as First_name,
        lastname as Last_name,
        email as Email
    from "my_db"."public"."Patient"
  );
[0m10:17:48.629441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patientid" does not exist
LINE 7:     select  PatientID as Patient_id,
                    ^
HINT:  Perhaps you meant to reference the column "Patient.PatientID".

[0m10:17:48.630041 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: ROLLBACK
[0m10:17:48.630598 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: Close
[0m10:17:48.634303 [debug] [Thread-1 (]: Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:17:48.635803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc7993ed0>]}
[0m10:17:48.636430 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_patient ........................ [[31mERROR[0m in 0.06s]
[0m10:17:48.637013 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_patient
[0m10:17:48.638555 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.638863 [debug] [MainThread]: On master: BEGIN
[0m10:17:48.639115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:48.641884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.642310 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.642620 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.642871 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.643238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:48.643532 [debug] [MainThread]: On master: Close
[0m10:17:48.643923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:48.644181 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_patient' was properly closed.
[0m10:17:48.644545 [info ] [MainThread]: 
[0m10:17:48.644990 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:17:48.645740 [debug] [MainThread]: Command end result
[0m10:17:48.674023 [info ] [MainThread]: 
[0m10:17:48.674493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:17:48.674817 [info ] [MainThread]: 
[0m10:17:48.675203 [error] [MainThread]:   Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:17:48.675529 [info ] [MainThread]: 
[0m10:17:48.675858 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:17:48.676629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8418663, "process_user_time": 2.010538, "process_kernel_time": 0.133902, "process_mem_max_rss": "113812", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:17:48.677089 [debug] [MainThread]: Command `dbt run` failed at 10:17:48.676984 after 0.84 seconds
[0m10:17:48.677452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca668110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca498c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca48f950>]}
[0m10:17:48.677775 [debug] [MainThread]: Flushing usage events
[0m10:17:54.655105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c536550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3d21e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c57f610>]}


============================== 10:17:54.657747 | 9d89f372-71a8-4216-9e8a-6b0ca5fbc46c ==============================
[0m10:17:54.657747 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:17:54.658262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:54.787622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c4bce50>]}
[0m10:17:54.833235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3ac892d0>]}
[0m10:17:54.833943 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:54.845082 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:17:54.940193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:54.940561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:54.971176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3abdc350>]}
[0m10:17:55.038742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3ac9f6d0>]}
[0m10:17:55.039200 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:17:55.039512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3acc2e50>]}
[0m10:17:55.040890 [info ] [MainThread]: 
[0m10:17:55.041464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:55.042350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:17:55.082947 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:17:55.083324 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:17:55.083587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:55.088533 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:17:55.090051 [debug] [ThreadPool]: On list_my_db: Close
[0m10:17:55.094940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:17:55.100817 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:55.101162 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:17:55.101448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:55.104576 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.104932 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:55.105218 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:17:55.107668 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:17:55.109000 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:17:55.109403 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:17:55.115927 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.116277 [debug] [MainThread]: On master: BEGIN
[0m10:17:55.116554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:55.119814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.120183 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.120551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:55.128723 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:17:55.129932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c535910>]}
[0m10:17:55.130323 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:55.130788 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.131110 [debug] [MainThread]: On master: BEGIN
[0m10:17:55.131631 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.131951 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.132218 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.132499 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.132832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:55.133096 [debug] [MainThread]: On master: Close
[0m10:17:55.133585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:55.134006 [info ] [MainThread]: 
[0m10:17:55.136223 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:17:55.136786 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:17:55.137353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:17:55.137732 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:17:55.145109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:17:55.145697 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:17:55.183429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:17:55.184075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:17:55.184429 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:17:55.184734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:55.188044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.188488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:17:55.188830 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:17:55.189628 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Date " does not exist
LINE 10:         to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH...
                              ^
HINT:  Perhaps you meant to reference the column "Appointment.Date".

[0m10:17:55.190010 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:17:55.190523 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:17:55.194230 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "Date " does not exist
  LINE 10:         to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:17:55.195636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d39c134d0>]}
[0m10:17:55.196215 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:17:55.196851 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:17:55.198465 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.198792 [debug] [MainThread]: On master: BEGIN
[0m10:17:55.199054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:55.201713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.202136 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.202433 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.202686 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.203033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:55.203295 [debug] [MainThread]: On master: Close
[0m10:17:55.203749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:55.204003 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:17:55.204283 [info ] [MainThread]: 
[0m10:17:55.204644 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:17:55.205359 [debug] [MainThread]: Command end result
[0m10:17:55.234331 [info ] [MainThread]: 
[0m10:17:55.234892 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:17:55.235294 [info ] [MainThread]: 
[0m10:17:55.235711 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "Date " does not exist
  LINE 10:         to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:17:55.236023 [info ] [MainThread]: 
[0m10:17:55.236359 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:17:55.237143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.62433565, "process_user_time": 1.662354, "process_kernel_time": 0.13179, "process_mem_max_rss": "111484", "process_out_blocks": "1720", "command_success": false, "process_in_blocks": "0"}
[0m10:17:55.237623 [debug] [MainThread]: Command `dbt run` failed at 10:17:55.237519 after 0.62 seconds
[0m10:17:55.237970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d404c0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d404c0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d404c0dd0>]}
[0m10:17:55.238298 [debug] [MainThread]: Flushing usage events
[0m10:19:08.353401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd3fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd3d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd3eb90>]}


============================== 10:19:08.356104 | e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9 ==============================
[0m10:19:08.356104 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:19:08.356672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:19:08.499487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd6b590>]}
[0m10:19:08.546198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721f5e1550>]}
[0m10:19:08.546988 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:19:08.555402 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:19:08.649805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:08.650401 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:19:08.843870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd1c390>]}
[0m10:19:08.910163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721c399790>]}
[0m10:19:08.910615 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:19:08.910893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721bd3f3d0>]}
[0m10:19:08.912248 [info ] [MainThread]: 
[0m10:19:08.912778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:08.913785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:19:08.952659 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:19:08.953028 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:19:08.953286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:08.957715 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:19:08.959160 [debug] [ThreadPool]: On list_my_db: Close
[0m10:19:08.964062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:19:08.969829 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:08.970164 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:19:08.970444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:08.974020 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:19:08.974480 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:08.974768 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:19:08.977398 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:19:08.978779 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:19:08.979258 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:19:08.986268 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.986637 [debug] [MainThread]: On master: BEGIN
[0m10:19:08.986881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:08.990026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:08.990390 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.990745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:08.998996 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:19:09.000198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721c496710>]}
[0m10:19:09.000611 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:09.001054 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.001401 [debug] [MainThread]: On master: BEGIN
[0m10:19:09.002045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:09.002363 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.002628 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.002883 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.003294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:09.003585 [debug] [MainThread]: On master: Close
[0m10:19:09.004010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:09.004344 [info ] [MainThread]: 
[0m10:19:09.006219 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:19:09.006756 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:19:09.007314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:19:09.007699 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:19:09.017263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:19:09.018065 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:19:09.054793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:19:09.055528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:09.055870 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:19:09.056184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:09.060270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:19:09.060792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:09.061124 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:19:09.061927 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                              ^
HINT:  Perhaps you meant to reference the column "Appointment.Date".

[0m10:19:09.062313 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:19:09.062891 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:19:09.066596 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:09.068029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721b1e1890>]}
[0m10:19:09.068627 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:19:09.069231 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:19:09.070848 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.071179 [debug] [MainThread]: On master: BEGIN
[0m10:19:09.071506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:09.074888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:09.075300 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.075590 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.075846 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.076199 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:09.076494 [debug] [MainThread]: On master: Close
[0m10:19:09.076882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:09.077130 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:19:09.077447 [info ] [MainThread]: 
[0m10:19:09.077783 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:19:09.078475 [debug] [MainThread]: Command end result
[0m10:19:09.104674 [info ] [MainThread]: 
[0m10:19:09.105215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:19:09.105684 [info ] [MainThread]: 
[0m10:19:09.106186 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:09.106694 [info ] [MainThread]: 
[0m10:19:09.107111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:09.108016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80226326, "process_user_time": 1.965816, "process_kernel_time": 0.136848, "process_mem_max_rss": "113812", "process_out_blocks": "2552", "command_success": false, "process_in_blocks": "0"}
[0m10:19:09.108609 [debug] [MainThread]: Command `dbt run` failed at 10:19:09.108473 after 0.80 seconds
[0m10:19:09.108996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd495d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721e030f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dcf42d0>]}
[0m10:19:09.109324 [debug] [MainThread]: Flushing usage events
[0m10:19:26.251044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896320190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896608cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896321cd0>]}


============================== 10:19:26.253788 | 7107570a-9459-4ffc-af13-a4fe10f2f02c ==============================
[0m10:19:26.253788 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:19:26.254330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:19:26.403406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896322290>]}
[0m10:19:26.450005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89a031010>]}
[0m10:19:26.450768 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:19:26.459586 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:19:26.554965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:26.555559 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:19:26.747963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8949a5c90>]}
[0m10:19:26.816696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89470b5d0>]}
[0m10:19:26.817145 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:19:26.817465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8946d1110>]}
[0m10:19:26.818903 [info ] [MainThread]: 
[0m10:19:26.819522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:26.820621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:19:26.859288 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:19:26.859720 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:19:26.859998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:26.865070 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:19:26.866356 [debug] [ThreadPool]: On list_my_db: Close
[0m10:19:26.871075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:19:26.876900 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:26.877233 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:19:26.877497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:26.881157 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.881640 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:26.881925 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:19:26.884369 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:19:26.885718 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:19:26.886186 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:19:26.892396 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.892735 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.892985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:26.896322 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.896696 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.897080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:26.905427 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:19:26.906595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc894772210>]}
[0m10:19:26.906981 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:26.907434 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.907718 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.908332 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.908644 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.908905 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.909150 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.909567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:26.909845 [debug] [MainThread]: On master: Close
[0m10:19:26.910270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:26.910624 [info ] [MainThread]: 
[0m10:19:26.912587 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:19:26.913126 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:19:26.913649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:19:26.914072 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:19:26.922492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:19:26.923097 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:19:26.960017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:19:26.960651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:26.961024 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:19:26.961355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:26.965199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.965644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:26.966002 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:19:26.966578 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 11:     from "my_db"."public"."Appointment"
             ^

[0m10:19:26.967025 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:19:26.967557 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:19:26.971246 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."public"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:26.972794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8937b4990>]}
[0m10:19:26.973488 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:19:26.974192 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:19:26.976365 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.976733 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.976989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:26.980167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.980581 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.980913 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.981167 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.981555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:26.981911 [debug] [MainThread]: On master: Close
[0m10:19:26.982451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:26.982874 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:19:26.983419 [info ] [MainThread]: 
[0m10:19:26.984125 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:19:26.985164 [debug] [MainThread]: Command end result
[0m10:19:27.014411 [info ] [MainThread]: 
[0m10:19:27.014882 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:19:27.015224 [info ] [MainThread]: 
[0m10:19:27.015603 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."public"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:27.015912 [info ] [MainThread]: 
[0m10:19:27.016205 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:27.016993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81263226, "process_user_time": 1.90631, "process_kernel_time": 0.144644, "process_mem_max_rss": "113756", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:19:27.017531 [debug] [MainThread]: Command `dbt run` failed at 10:19:27.017410 after 0.81 seconds
[0m10:19:27.017877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8963216d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89649c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896733fd0>]}
[0m10:19:27.018192 [debug] [MainThread]: Flushing usage events
[0m10:27:16.354807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a84ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a84e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a84fbd0>]}


============================== 10:27:16.357567 | 4561db34-0cf4-4f9f-9753-d9be643401dc ==============================
[0m10:27:16.357567 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:27:16.358150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:27:16.511895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a7a2550>]}
[0m10:27:16.563450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7e54c650>]}
[0m10:27:16.564152 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:27:16.575223 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:27:16.676913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:27:16.677451 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/src_healthcare.yml
[0m10:27:16.677809 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:27:16.916749 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:27:16.917266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78cbc7d0>]}
[0m10:27:17.100741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78dd7710>]}
[0m10:27:17.196176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78333ed0>]}
[0m10:27:17.196724 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:27:17.197049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78ec4790>]}
[0m10:27:17.198650 [info ] [MainThread]: 
[0m10:27:17.199220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:17.200189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:27:17.243250 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:27:17.243690 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:27:17.243998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:17.249068 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:27:17.250583 [debug] [ThreadPool]: On list_my_db: Close
[0m10:27:17.256907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:27:17.263922 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:17.264354 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:27:17.264653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:17.268474 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.268918 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:17.269247 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:27:17.272388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:27:17.274171 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:27:17.274961 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:27:17.282384 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.282799 [debug] [MainThread]: On master: BEGIN
[0m10:27:17.283118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:17.286865 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.287366 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.287791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:17.297599 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:27:17.299059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7779e490>]}
[0m10:27:17.299649 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:17.300464 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.300889 [debug] [MainThread]: On master: BEGIN
[0m10:27:17.301487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.301884 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.302180 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.302476 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.302932 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:17.303252 [debug] [MainThread]: On master: Close
[0m10:27:17.303773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:17.304130 [info ] [MainThread]: 
[0m10:27:17.306442 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:27:17.307130 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:27:17.307848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:27:17.308357 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:27:17.318647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:27:17.319688 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:27:17.364889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:27:17.365622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:17.366017 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:27:17.366370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:17.369990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.370466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:17.370876 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."healthcare"."Appointment"
  );
[0m10:27:17.371552 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 11:     from "my_db"."healthcare"."Appointment"
             ^

[0m10:27:17.371952 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:27:17.372535 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:27:17.376975 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."healthcare"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:17.378599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb77be3790>]}
[0m10:27:17.379276 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.07s]
[0m10:27:17.379950 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:27:17.382104 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.382523 [debug] [MainThread]: On master: BEGIN
[0m10:27:17.382823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:17.386001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.386428 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.386729 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.387010 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.387374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:17.387681 [debug] [MainThread]: On master: Close
[0m10:27:17.388119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:17.388401 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:27:17.388720 [info ] [MainThread]: 
[0m10:27:17.389053 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m10:27:17.389751 [debug] [MainThread]: Command end result
[0m10:27:17.493608 [info ] [MainThread]: 
[0m10:27:17.494083 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:17.494463 [info ] [MainThread]: 
[0m10:27:17.494842 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."healthcare"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:17.495146 [info ] [MainThread]: 
[0m10:27:17.495469 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:17.496277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1869818, "process_user_time": 2.325418, "process_kernel_time": 0.144963, "process_mem_max_rss": "116480", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m10:27:17.496764 [debug] [MainThread]: Command `dbt run` failed at 10:27:17.496658 after 1.19 seconds
[0m10:27:17.497164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a9f00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7e7c0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78c90fd0>]}
[0m10:27:17.497499 [debug] [MainThread]: Flushing usage events
[0m10:27:44.546564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa56a70050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d77dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d77610>]}


============================== 10:27:44.549188 | c3016f0c-dddb-4543-83e3-bc29237aee6c ==============================
[0m10:27:44.549188 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:27:44.549723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:44.694276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d977d0>]}
[0m10:27:44.742459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa58a7c850>]}
[0m10:27:44.743204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:27:44.752305 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:27:44.871971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:27:44.872570 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:27:45.095588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5350dd50>]}
[0m10:27:45.187691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa53193ed0>]}
[0m10:27:45.188139 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:27:45.188423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa53078c50>]}
[0m10:27:45.189719 [info ] [MainThread]: 
[0m10:27:45.190190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:45.190948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:27:45.230811 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:27:45.231228 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:27:45.231530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:45.236452 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:27:45.237746 [debug] [ThreadPool]: On list_my_db: Close
[0m10:27:45.242593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:27:45.248984 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:45.249388 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:27:45.249777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:45.252961 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.253372 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:45.253703 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:27:45.256208 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:27:45.257634 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:27:45.258118 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:27:45.264151 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.264537 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.264791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:45.268007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.268367 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.268723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:45.277063 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:27:45.278295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5350d0d0>]}
[0m10:27:45.278729 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:45.279193 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.279512 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.280084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.280410 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.280672 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.280915 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.281317 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:45.281595 [debug] [MainThread]: On master: Close
[0m10:27:45.282024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:45.282343 [info ] [MainThread]: 
[0m10:27:45.284163 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:27:45.284675 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:27:45.285155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:27:45.285559 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:27:45.292670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:27:45.293246 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:27:45.329925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:27:45.330562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:45.330889 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:27:45.331190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:45.334426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.334835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:45.335168 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."healthcare"."Appointment"
  );
[0m10:27:45.335860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "healthcare.Appointment" does not exist
LINE 11:     from "my_db"."healthcare"."Appointment"
                  ^

[0m10:27:45.336243 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:27:45.336863 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:27:45.341018 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  relation "healthcare.Appointment" does not exist
  LINE 11:     from "my_db"."healthcare"."Appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:45.343079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa531cce10>]}
[0m10:27:45.343766 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:27:45.344398 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:27:45.345938 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.346244 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.346572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:45.349608 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.350136 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.350564 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.350933 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.351456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:45.351830 [debug] [MainThread]: On master: Close
[0m10:27:45.352324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:45.352723 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:27:45.353136 [info ] [MainThread]: 
[0m10:27:45.353593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:27:45.354837 [debug] [MainThread]: Command end result
[0m10:27:45.385213 [info ] [MainThread]: 
[0m10:27:45.385649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:45.386001 [info ] [MainThread]: 
[0m10:27:45.386406 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  relation "healthcare.Appointment" does not exist
  LINE 11:     from "my_db"."healthcare"."Appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:45.386706 [info ] [MainThread]: 
[0m10:27:45.387035 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:45.387803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8838664, "process_user_time": 2.004778, "process_kernel_time": 0.146691, "process_mem_max_rss": "114308", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m10:27:45.388271 [debug] [MainThread]: Command `dbt run` failed at 10:27:45.388169 after 0.88 seconds
[0m10:27:45.388621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54f1c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa55088e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d76f10>]}
[0m10:27:45.388930 [debug] [MainThread]: Flushing usage events
[0m10:28:23.551404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa55eb2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa5605190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa55eac90>]}


============================== 10:28:23.554130 | 8ccfa49a-5ca4-4e70-b904-b5e4d98ce062 ==============================
[0m10:28:23.554130 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:28:23.554917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:23.698405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3ccffd0>]}
[0m10:28:23.746298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa92c8f90>]}
[0m10:28:23.747103 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:28:23.756244 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:28:23.874203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:23.874809 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:28:24.098767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3d23bd0>]}
[0m10:28:24.191947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3a221d0>]}
[0m10:28:24.192604 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:28:24.192946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa38fc210>]}
[0m10:28:24.194496 [info ] [MainThread]: 
[0m10:28:24.195032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:28:24.195901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:28:24.234354 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:28:24.234728 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:28:24.234985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:24.239596 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:28:24.240870 [debug] [ThreadPool]: On list_my_db: Close
[0m10:28:24.245631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:28:24.251926 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:28:24.252289 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:28:24.252553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:24.255797 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.256187 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:28:24.256530 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:28:24.259415 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:28:24.261002 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:28:24.261667 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:28:24.268040 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.268407 [debug] [MainThread]: On master: BEGIN
[0m10:28:24.268696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:24.271884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.272229 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.272628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:24.281069 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:28:24.282264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa38ee650>]}
[0m10:28:24.282667 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:24.283168 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.283508 [debug] [MainThread]: On master: BEGIN
[0m10:28:24.284101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.284421 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.284678 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.284921 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.285312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:28:24.285649 [debug] [MainThread]: On master: Close
[0m10:28:24.286068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:24.286402 [info ] [MainThread]: 
[0m10:28:24.288321 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:28:24.288863 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:28:24.289415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:28:24.289810 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:28:24.299598 [debug] [Thread-1 (]: Compilation Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  'raw' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:28:24.300889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3a3ad10>]}
[0m10:28:24.301492 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.01s]
[0m10:28:24.302034 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:28:24.303594 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.303916 [debug] [MainThread]: On master: BEGIN
[0m10:28:24.304185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:24.307093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.307577 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.307867 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.308119 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.308532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:28:24.308941 [debug] [MainThread]: On master: Close
[0m10:28:24.309697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:24.310066 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:28:24.310438 [info ] [MainThread]: 
[0m10:28:24.311130 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m10:28:24.312411 [debug] [MainThread]: Command end result
[0m10:28:24.342367 [info ] [MainThread]: 
[0m10:28:24.343015 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:24.343432 [info ] [MainThread]: 
[0m10:28:24.343886 [error] [MainThread]:   Compilation Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  'raw' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:28:24.344229 [info ] [MainThread]: 
[0m10:28:24.344627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:28:24.345501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8421289, "process_user_time": 1.957011, "process_kernel_time": 0.14685, "process_mem_max_rss": "113888", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m10:28:24.345975 [debug] [MainThread]: Command `dbt run` failed at 10:28:24.345871 after 0.84 seconds
[0m10:28:24.346359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa5605190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa5606a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa38f4510>]}
[0m10:28:24.346697 [debug] [MainThread]: Flushing usage events
[0m10:29:12.044090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9d9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9d8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9dbdd0>]}


============================== 10:29:12.047223 | bb11609f-8d6a-4b67-9854-e351fe5ab634 ==============================
[0m10:29:12.047223 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:29:12.047849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:12.196373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9910d0>]}
[0m10:29:12.246493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef169ce90>]}
[0m10:29:12.247266 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:12.256202 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:29:12.380979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:12.381559 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:29:12.600668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eec04fd90>]}
[0m10:29:12.693084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eebc88290>]}
[0m10:29:12.693595 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:29:12.693900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eebd633d0>]}
[0m10:29:12.695558 [info ] [MainThread]: 
[0m10:29:12.696149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:12.697061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:29:12.735629 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:29:12.735980 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:29:12.736235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:12.741106 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:29:12.742516 [debug] [ThreadPool]: On list_my_db: Close
[0m10:29:12.747626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:29:12.753428 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:12.753764 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:29:12.754025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:12.757206 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.757633 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:12.757935 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:12.760384 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:29:12.761704 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:29:12.762162 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:29:12.768704 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.769077 [debug] [MainThread]: On master: BEGIN
[0m10:29:12.769331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:12.772925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.773434 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.773837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:12.782943 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:29:12.784169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eeb142a90>]}
[0m10:29:12.784615 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:12.785087 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.785371 [debug] [MainThread]: On master: BEGIN
[0m10:29:12.785948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.786253 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.786529 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.786776 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.787182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:12.787476 [debug] [MainThread]: On master: Close
[0m10:29:12.787904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:12.788238 [info ] [MainThread]: 
[0m10:29:12.790093 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:29:12.790603 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:29:12.791106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:29:12.791490 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:29:12.799262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:29:12.800024 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:29:12.835830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:29:12.836532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.836894 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:29:12.837234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:12.840969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.841526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.841898 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:29:12.843433 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:29:12.849478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.849911 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment__dbt_tmp" rename to "stg_appointment"
[0m10:29:12.850617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:12.864831 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:29:12.865273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.865621 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:29:12.866805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:12.872758 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_appointment__dbt_backup"
[0m10:29:12.877587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.878121 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
drop view if exists "my_db"."public"."stg_appointment__dbt_backup" cascade
[0m10:29:12.878854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:29:12.881084 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:29:12.882550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eead1f890>]}
[0m10:29:12.883286 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_appointment ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m10:29:12.883944 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:29:12.885249 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.885554 [debug] [MainThread]: On master: BEGIN
[0m10:29:12.885801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:12.889199 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.889767 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.890054 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.890312 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.890793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:12.891101 [debug] [MainThread]: On master: Close
[0m10:29:12.891653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:12.891972 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:29:12.892450 [info ] [MainThread]: 
[0m10:29:12.892997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m10:29:12.893971 [debug] [MainThread]: Command end result
[0m10:29:12.924061 [info ] [MainThread]: 
[0m10:29:12.924884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:12.925308 [info ] [MainThread]: 
[0m10:29:12.925714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:12.926631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.93048716, "process_user_time": 2.019577, "process_kernel_time": 0.143685, "process_mem_max_rss": "113872", "process_out_blocks": "2600", "process_in_blocks": "0"}
[0m10:29:12.927169 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:12.927056 after 0.93 seconds
[0m10:29:12.927528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef1794710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eedb60110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eedb60150>]}
[0m10:29:12.927877 [debug] [MainThread]: Flushing usage events
[0m10:29:33.066442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc39b4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc39b1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc39b0890>]}


============================== 10:29:33.069085 | 488e3f49-83f3-40e3-af43-34df01d6708e ==============================
[0m10:29:33.069085 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:29:33.069657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:33.217680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3b37f50>]}
[0m10:29:33.268372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3880510>]}
[0m10:29:33.269316 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:33.280107 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:29:33.403021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:33.403629 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:29:33.624700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1dae150>]}
[0m10:29:33.717313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1d17f50>]}
[0m10:29:33.717815 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:29:33.718147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1df4d50>]}
[0m10:29:33.719740 [info ] [MainThread]: 
[0m10:29:33.720417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:33.721372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:29:33.760100 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:29:33.760476 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:29:33.760740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:33.765248 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:29:33.766521 [debug] [ThreadPool]: On list_my_db: Close
[0m10:29:33.771383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:29:33.777290 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:33.777651 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:29:33.777914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:33.781401 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.781774 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:33.782090 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:33.784973 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:29:33.786515 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:29:33.787195 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:29:33.793409 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.793766 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.794014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:33.797207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.797609 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.797965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:33.807082 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:29:33.808646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc46595d0>]}
[0m10:29:33.809039 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:33.809506 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.809779 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.810316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.810630 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.810916 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.811163 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.811578 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:33.811858 [debug] [MainThread]: On master: Close
[0m10:29:33.812278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:33.812627 [info ] [MainThread]: 
[0m10:29:33.814528 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:29:33.815057 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:29:33.815572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:29:33.815942 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:29:33.823434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:29:33.824027 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:29:33.860310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:29:33.860940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:33.861264 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:29:33.861565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:33.865220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.865698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:33.866036 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:29:33.866673 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "to_timestamp"
LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                 ^

[0m10:29:33.867112 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:29:33.867676 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:29:33.871630 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "to_timestamp"
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                   ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:33.873009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1dcfb10>]}
[0m10:29:33.873609 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:29:33.874201 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:29:33.875902 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.876270 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.876588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:33.879537 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.879961 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.880253 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.880542 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.880934 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:33.881207 [debug] [MainThread]: On master: Close
[0m10:29:33.881627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:33.881876 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:29:33.882166 [info ] [MainThread]: 
[0m10:29:33.882515 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:29:33.883204 [debug] [MainThread]: Command end result
[0m10:29:33.915898 [info ] [MainThread]: 
[0m10:29:33.916960 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:29:33.917611 [info ] [MainThread]: 
[0m10:29:33.918226 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "to_timestamp"
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                   ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:33.918584 [info ] [MainThread]: 
[0m10:29:33.918891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:33.919645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9016032, "process_user_time": 2.000214, "process_kernel_time": 0.148792, "process_mem_max_rss": "114160", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m10:29:33.920113 [debug] [MainThread]: Command `dbt run` failed at 10:29:33.920007 after 0.90 seconds
[0m10:29:33.920472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3997890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3997510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc2097c50>]}
[0m10:29:33.920788 [debug] [MainThread]: Flushing usage events
[0m10:29:45.219408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e9437fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e947d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e947d3d0>]}


============================== 10:29:45.221962 | 96d07ed7-0296-4163-8b48-c300358bd4e9 ==============================
[0m10:29:45.221962 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:29:45.222512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:29:45.366163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e947e110>]}
[0m10:29:45.414881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92ed1508d0>]}
[0m10:29:45.415617 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:45.424520 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:29:45.544254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:45.544834 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:29:45.772697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e7a1dd50>]}
[0m10:29:45.865817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e787ffd0>]}
[0m10:29:45.866309 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:29:45.866622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e78b1550>]}
[0m10:29:45.868054 [info ] [MainThread]: 
[0m10:29:45.868577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:45.869433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:29:45.910551 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:29:45.910923 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:29:45.911187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:45.915727 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:29:45.917021 [debug] [ThreadPool]: On list_my_db: Close
[0m10:29:45.921944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:29:45.927867 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:45.928235 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:29:45.928523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:45.931796 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:45.932203 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:45.932526 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:45.935134 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:29:45.936610 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:29:45.937121 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:29:45.943349 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.943699 [debug] [MainThread]: On master: BEGIN
[0m10:29:45.943958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:45.946859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:45.947234 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.947639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:45.956656 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:29:45.958180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e796a710>]}
[0m10:29:45.958600 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:45.959072 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.959358 [debug] [MainThread]: On master: BEGIN
[0m10:29:45.959945 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:45.960241 [debug] [MainThread]: On master: COMMIT
[0m10:29:45.960515 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.960762 [debug] [MainThread]: On master: COMMIT
[0m10:29:45.961168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:45.961463 [debug] [MainThread]: On master: Close
[0m10:29:45.961887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:45.962228 [info ] [MainThread]: 
[0m10:29:45.964132 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:29:45.964633 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:29:45.965218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:29:45.965595 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:29:45.974318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:29:45.975072 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:29:46.010575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:29:46.011175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:46.011520 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:29:46.011799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:46.014920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:46.015342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:46.015757 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:29:46.016513 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                              ^
HINT:  Perhaps you meant to reference the column "Appointment.Date".

[0m10:29:46.016894 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:29:46.017573 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:29:46.021554 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:46.022953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e65264d0>]}
[0m10:29:46.023549 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:29:46.024154 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:29:46.025708 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:46.026028 [debug] [MainThread]: On master: BEGIN
[0m10:29:46.026311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:46.029392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:46.029828 [debug] [MainThread]: On master: COMMIT
[0m10:29:46.030116 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:46.030374 [debug] [MainThread]: On master: COMMIT
[0m10:29:46.030780 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:46.031062 [debug] [MainThread]: On master: Close
[0m10:29:46.031467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:46.031724 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:29:46.032002 [info ] [MainThread]: 
[0m10:29:46.032324 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:29:46.032988 [debug] [MainThread]: Command end result
[0m10:29:46.062943 [info ] [MainThread]: 
[0m10:29:46.063537 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:29:46.063915 [info ] [MainThread]: 
[0m10:29:46.064371 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:46.064728 [info ] [MainThread]: 
[0m10:29:46.065085 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:46.065918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8882614, "process_user_time": 2.001606, "process_kernel_time": 0.144899, "process_mem_max_rss": "114384", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m10:29:46.066409 [debug] [MainThread]: Command `dbt run` failed at 10:29:46.066286 after 0.89 seconds
[0m10:29:46.066775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e948b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e9778b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92ed3d8c90>]}
[0m10:29:46.067100 [debug] [MainThread]: Flushing usage events
[0m10:30:09.029999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa04f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fb7f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa01110>]}


============================== 10:30:09.032914 | e2285b22-dba7-4fdc-bdca-558bb8d94661 ==============================
[0m10:30:09.032914 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:30:09.033557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:30:09.178966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fb7ff50>]}
[0m10:30:09.227211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a36c8fd0>]}
[0m10:30:09.228237 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:09.239623 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:30:09.361414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:09.362004 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:30:09.636832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659df27290>]}
[0m10:30:09.729782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659dd84650>]}
[0m10:30:09.730351 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:30:09.730657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659dfd17d0>]}
[0m10:30:09.732014 [info ] [MainThread]: 
[0m10:30:09.732532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:09.733410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:30:09.773652 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:30:09.774040 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:30:09.774316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:09.778786 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:30:09.780512 [debug] [ThreadPool]: On list_my_db: Close
[0m10:30:09.785608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:30:09.791501 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:30:09.791865 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:30:09.792118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:09.795811 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.796407 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:30:09.796736 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:30:09.799302 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:30:09.800707 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:30:09.801128 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:30:09.807248 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.807621 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.807876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:09.811011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.811374 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.811780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:09.820976 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:30:09.822470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659dce3810>]}
[0m10:30:09.822864 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:09.823356 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.823639 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.824246 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.824554 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.824814 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.825061 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.825466 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:09.825756 [debug] [MainThread]: On master: Close
[0m10:30:09.826183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:30:09.826516 [info ] [MainThread]: 
[0m10:30:09.828402 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:30:09.828914 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:30:09.829421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:30:09.829817 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:30:09.837649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:30:09.838257 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:30:09.874727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:30:09.875367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.875700 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:30:09.875991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:09.879615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.880381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.880757 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp("Date" || ' ' || "Time", 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:30:09.882482 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:09.889120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.889516 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment" rename to "stg_appointment__dbt_backup"
[0m10:30:09.890159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:09.893233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.893594 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment__dbt_tmp" rename to "stg_appointment"
[0m10:30:09.894171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:09.909782 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:30:09.910223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.910536 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:30:09.911549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:09.917423 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_appointment__dbt_backup"
[0m10:30:09.921984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.922322 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
drop view if exists "my_db"."public"."stg_appointment__dbt_backup" cascade
[0m10:30:09.923954 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:09.926157 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:30:09.927519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659cdcfb90>]}
[0m10:30:09.928183 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_appointment ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m10:30:09.928809 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:30:09.929936 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.930242 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.930530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:09.934068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.934465 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.934776 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.935040 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.935422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:09.935701 [debug] [MainThread]: On master: Close
[0m10:30:09.936103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:09.936397 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:30:09.936735 [info ] [MainThread]: 
[0m10:30:09.937144 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m10:30:09.937991 [debug] [MainThread]: Command end result
[0m10:30:09.971083 [info ] [MainThread]: 
[0m10:30:09.971569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:09.971875 [info ] [MainThread]: 
[0m10:30:09.972217 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:09.973011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99253845, "process_user_time": 2.096279, "process_kernel_time": 0.12378, "process_mem_max_rss": "113928", "process_out_blocks": "2592", "process_in_blocks": "0"}
[0m10:30:09.973516 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:09.973403 after 0.99 seconds
[0m10:30:09.973853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa13450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa13510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a37c0710>]}
[0m10:30:09.974204 [debug] [MainThread]: Flushing usage events
[0m10:57:22.525956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d7e7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d272990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d273dd0>]}


============================== 10:57:22.528600 | dceb85d6-6f16-4883-9625-974504ee95c6 ==============================
[0m10:57:22.528600 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:57:22.529225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_billing', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:22.671239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d19ce90>]}
[0m10:57:22.717427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730550f50510>]}
[0m10:57:22.718164 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:22.728277 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:57:22.845439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:22.846016 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:57:23.063768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d29e590>]}
[0m10:57:23.154955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054b5d4110>]}
[0m10:57:23.155417 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:57:23.155736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054b6b9110>]}
[0m10:57:23.157150 [info ] [MainThread]: 
[0m10:57:23.157709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:23.158566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:57:23.196955 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:57:23.197298 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:57:23.197586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:23.201902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:57:23.203171 [debug] [ThreadPool]: On list_my_db: Close
[0m10:57:23.207995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:57:23.213842 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:23.214270 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:57:23.214584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:23.217941 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.218345 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:23.218685 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:57:23.221254 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:57:23.222686 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:57:23.223175 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:57:23.229401 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.229735 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.229989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:23.233284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.233656 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.234026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:23.243116 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:57:23.244590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054a579350>]}
[0m10:57:23.244998 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:23.245425 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.245688 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.246262 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.246568 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.246831 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.247076 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.247494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:23.247785 [debug] [MainThread]: On master: Close
[0m10:57:23.248212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:23.248548 [info ] [MainThread]: 
[0m10:57:23.250519 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:57:23.251047 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:57:23.251537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:57:23.251935 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:57:23.259475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:57:23.260056 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:57:23.296116 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:57:23.296663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:23.296991 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:57:23.297275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.301003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.301437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:23.301784 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceId "as Invoice_id,
        "PatientID "as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m10:57:23.302517 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "InvoiceId " does not exist
LINE 7:     select  "InvoiceId "as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:57:23.302915 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:57:23.303429 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:57:23.307102 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId "as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:23.308508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054a114e10>]}
[0m10:57:23.309097 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:57:23.309703 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:57:23.311433 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.311774 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.312040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:23.315163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.315611 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.315888 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.316141 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.316597 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:23.316968 [debug] [MainThread]: On master: Close
[0m10:57:23.317571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:23.317970 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:57:23.318395 [info ] [MainThread]: 
[0m10:57:23.318872 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:57:23.320158 [debug] [MainThread]: Command end result
[0m10:57:23.350717 [info ] [MainThread]: 
[0m10:57:23.351321 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:57:23.351708 [info ] [MainThread]: 
[0m10:57:23.352186 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId "as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:23.352516 [info ] [MainThread]: 
[0m10:57:23.352895 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:23.353646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8740776, "process_user_time": 2.005954, "process_kernel_time": 0.145778, "process_mem_max_rss": "114464", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m10:57:23.354125 [debug] [MainThread]: Command `dbt run` failed at 10:57:23.354023 after 0.87 seconds
[0m10:57:23.354472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d273dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d404210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d27fad0>]}
[0m10:57:23.354807 [debug] [MainThread]: Flushing usage events
[0m10:57:56.256910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd93390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd8c1d0>]}


============================== 10:57:56.259611 | 27b2c526-50bf-425c-9f06-78e9cd5d7dc6 ==============================
[0m10:57:56.259611 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:57:56.260110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:56.388029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a467410>]}
[0m10:57:56.434874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840faaced0>]}
[0m10:57:56.435605 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:56.445717 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:57:56.562543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:56.563090 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:57:56.782695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a2fb6d0>]}
[0m10:57:56.873903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bcbbb50>]}
[0m10:57:56.874381 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:57:56.874674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd528d0>]}
[0m10:57:56.876045 [info ] [MainThread]: 
[0m10:57:56.876587 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:56.877425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:57:56.918376 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:57:56.918756 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:57:56.919019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:56.923882 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:57:56.925236 [debug] [ThreadPool]: On list_my_db: Close
[0m10:57:56.930329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:57:56.936111 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:56.936457 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:57:56.936721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:56.939937 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:56.940350 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:56.940679 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:57:56.943115 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:57:56.944535 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:57:56.945026 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:57:56.951168 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.951606 [debug] [MainThread]: On master: BEGIN
[0m10:57:56.951878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:56.955160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:56.955601 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.955989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:56.965276 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:57:56.966809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a1f5250>]}
[0m10:57:56.967213 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:56.967698 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.967992 [debug] [MainThread]: On master: BEGIN
[0m10:57:56.968444 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:56.968793 [debug] [MainThread]: On master: COMMIT
[0m10:57:56.969076 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.969361 [debug] [MainThread]: On master: COMMIT
[0m10:57:56.969787 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:56.970090 [debug] [MainThread]: On master: Close
[0m10:57:56.970554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:56.970910 [info ] [MainThread]: 
[0m10:57:56.972759 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:57:56.973288 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:57:56.973784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:57:56.974175 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:57:56.981989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:57:56.982670 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:57:57.018941 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:57:57.019641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:57.020016 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:57:57.020409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:57.023496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:57:57.023910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:57.024234 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceId " as Invoice_id,
        "PatientID " as Patient_id,
        "Items",
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m10:57:57.025024 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "InvoiceId " does not exist
LINE 7:     select  "InvoiceId " as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:57:57.025471 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:57:57.026031 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:57:57.030476 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:57.032056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a12a250>]}
[0m10:57:57.032679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:57:57.033284 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:57:57.034820 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:57.035136 [debug] [MainThread]: On master: BEGIN
[0m10:57:57.035425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:57.038170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:57.038633 [debug] [MainThread]: On master: COMMIT
[0m10:57:57.038953 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:57.039230 [debug] [MainThread]: On master: COMMIT
[0m10:57:57.039634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:57.039918 [debug] [MainThread]: On master: Close
[0m10:57:57.040326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:57.040617 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:57:57.040923 [info ] [MainThread]: 
[0m10:57:57.041269 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:57:57.041995 [debug] [MainThread]: Command end result
[0m10:57:57.075025 [info ] [MainThread]: 
[0m10:57:57.075500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:57:57.075803 [info ] [MainThread]: 
[0m10:57:57.076179 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:57.076491 [info ] [MainThread]: 
[0m10:57:57.076786 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:57.077647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8619785, "process_user_time": 1.880381, "process_kernel_time": 0.148713, "process_mem_max_rss": "114292", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m10:57:57.078521 [debug] [MainThread]: Command `dbt run` failed at 10:57:57.078367 after 0.86 seconds
[0m10:57:57.078911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840fd04c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840fd04dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778408db0e10>]}
[0m10:57:57.079264 [debug] [MainThread]: Flushing usage events
[0m10:58:20.013879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f72e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f777dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f775090>]}


============================== 10:58:20.016459 | efa82402-2273-49cf-a7eb-b88531ee0c26 ==============================
[0m10:58:20.016459 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:58:20.016967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:20.147097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f6b1410>]}
[0m10:58:20.192917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa63430a50>]}
[0m10:58:20.193646 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:58:20.203373 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:58:20.318609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:20.319200 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:58:20.535895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5dba5010>]}
[0m10:58:20.628986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5db01050>]}
[0m10:58:20.629469 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:58:20.629771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5d75ed90>]}
[0m10:58:20.631127 [info ] [MainThread]: 
[0m10:58:20.631630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:58:20.632460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:58:20.672547 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:58:20.672993 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:58:20.673276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:20.678309 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:58:20.679681 [debug] [ThreadPool]: On list_my_db: Close
[0m10:58:20.684655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:58:20.691114 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:58:20.691508 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:58:20.691883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:20.695232 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.695664 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:58:20.695965 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:58:20.698403 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:58:20.699743 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:58:20.700151 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:58:20.706893 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.707265 [debug] [MainThread]: On master: BEGIN
[0m10:58:20.707550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:20.710677 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.711050 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.711411 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:58:20.720552 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:58:20.721995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f621450>]}
[0m10:58:20.722430 [debug] [MainThread]: On master: ROLLBACK
[0m10:58:20.722910 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.723188 [debug] [MainThread]: On master: BEGIN
[0m10:58:20.723816 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.724165 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.724463 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.724728 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.725191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:58:20.725490 [debug] [MainThread]: On master: Close
[0m10:58:20.725958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:20.726264 [info ] [MainThread]: 
[0m10:58:20.728232 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:58:20.728766 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:58:20.729356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:58:20.729784 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:58:20.737823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:58:20.738562 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:58:20.774890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:58:20.775516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:58:20.775845 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:58:20.776137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:20.779500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.779947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:58:20.780292 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID " as Invoice_id,
        "PatientID " as Patient_id,
        "Items",
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m10:58:20.781050 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "InvoiceID " does not exist
LINE 7:     select  "InvoiceID " as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:58:20.781438 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:58:20.781969 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:58:20.785672 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceID " does not exist
  LINE 7:     select  "InvoiceID " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:58:20.787322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5de938d0>]}
[0m10:58:20.787987 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:58:20.788597 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:58:20.790228 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.790535 [debug] [MainThread]: On master: BEGIN
[0m10:58:20.790800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:20.793678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.794117 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.794478 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.794739 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.795106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:58:20.795384 [debug] [MainThread]: On master: Close
[0m10:58:20.795783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:20.796050 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:58:20.796327 [info ] [MainThread]: 
[0m10:58:20.796677 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:58:20.797397 [debug] [MainThread]: Command end result
[0m10:58:20.828081 [info ] [MainThread]: 
[0m10:58:20.828664 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:58:20.829029 [info ] [MainThread]: 
[0m10:58:20.829605 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceID " does not exist
  LINE 7:     select  "InvoiceID " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:58:20.830006 [info ] [MainThread]: 
[0m10:58:20.830435 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:20.831301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.85898364, "process_user_time": 1.898164, "process_kernel_time": 0.127809, "process_mem_max_rss": "114488", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m10:58:20.831807 [debug] [MainThread]: Command `dbt run` failed at 10:58:20.831702 after 0.86 seconds
[0m10:58:20.832163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5fa6ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5dce96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa636b8c90>]}
[0m10:58:20.832497 [debug] [MainThread]: Flushing usage events
[0m10:59:45.357640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb555e5a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb555e5b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb555e5add0>]}


============================== 10:59:45.360365 | 37f7e44b-f3dc-4e7a-83aa-2cf584728cf4 ==============================
[0m10:59:45.360365 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:59:45.360925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:45.505546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb5544e0bd0>]}
[0m10:59:45.553267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb559b4cf10>]}
[0m10:59:45.553951 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:59:45.564155 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:59:45.684624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:59:45.685261 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:59:45.905197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb554252190>]}
[0m10:59:45.996828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb554161850>]}
[0m10:59:45.997259 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:59:45.997561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb55458ffd0>]}
[0m10:59:45.998882 [info ] [MainThread]: 
[0m10:59:45.999393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:46.000172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:59:46.039937 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:59:46.040375 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:59:46.040655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:46.045693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:59:46.047147 [debug] [ThreadPool]: On list_my_db: Close
[0m10:59:46.052387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:59:46.058478 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:59:46.058824 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:59:46.059076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:46.062289 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.062655 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:59:46.062953 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:59:46.065386 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:59:46.066706 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:59:46.067159 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:59:46.073764 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.074122 [debug] [MainThread]: On master: BEGIN
[0m10:59:46.074425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:46.077466 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.077870 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.078222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:46.087237 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:59:46.088781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb55415a3d0>]}
[0m10:59:46.089203 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:46.089815 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.090222 [debug] [MainThread]: On master: BEGIN
[0m10:59:46.090960 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.091327 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.091618 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.091889 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.092261 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:59:46.092543 [debug] [MainThread]: On master: Close
[0m10:59:46.092991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:59:46.093346 [info ] [MainThread]: 
[0m10:59:46.095596 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:59:46.096139 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:59:46.096675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:59:46.097022 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:59:46.104594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:59:46.105349 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:59:46.141771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:59:46.142386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:59:46.142723 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:59:46.143011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:46.146193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.146617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:59:46.146957 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  InvoiceID  as Invoice_id,
        PatientID  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m10:59:46.147685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "invoiceid" does not exist
LINE 7:     select  InvoiceID  as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:59:46.148077 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:59:46.148575 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:59:46.152502 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID  as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:59:46.153942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb5541ca090>]}
[0m10:59:46.154546 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:59:46.155127 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:59:46.156657 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.156972 [debug] [MainThread]: On master: BEGIN
[0m10:59:46.157229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:46.160051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.160467 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.160758 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.161021 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.161415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:59:46.161711 [debug] [MainThread]: On master: Close
[0m10:59:46.162186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:46.162539 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:59:46.162966 [info ] [MainThread]: 
[0m10:59:46.163476 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:59:46.164588 [debug] [MainThread]: Command end result
[0m10:59:46.194362 [info ] [MainThread]: 
[0m10:59:46.194808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:59:46.195137 [info ] [MainThread]: 
[0m10:59:46.195577 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID  as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:59:46.195888 [info ] [MainThread]: 
[0m10:59:46.196246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:59:46.196996 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88652784, "process_user_time": 2.021291, "process_kernel_time": 0.137951, "process_mem_max_rss": "114672", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m10:59:46.197455 [debug] [MainThread]: Command `dbt run` failed at 10:59:46.197352 after 0.89 seconds
[0m10:59:46.197791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb5545c6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb559da0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb559da0c50>]}
[0m10:59:46.198107 [debug] [MainThread]: Flushing usage events
[0m11:00:25.227241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683de3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96840fcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683db11d0>]}


============================== 11:00:25.229794 | 1036a25d-4f91-4d54-911b-0d84eba48287 ==============================
[0m11:00:25.229794 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:00:25.230290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:00:25.360574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683c27450>]}
[0m11:00:25.406296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683dba550>]}
[0m11:00:25.407020 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:00:25.415707 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:00:25.536643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:00:25.537233 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:00:25.755933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9682542a50>]}
[0m11:00:25.846628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96821be590>]}
[0m11:00:25.847090 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:00:25.847378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96821d2e90>]}
[0m11:00:25.848795 [info ] [MainThread]: 
[0m11:00:25.849393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:25.850225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:00:25.888906 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:00:25.889290 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:00:25.889585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:25.894369 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:00:25.895623 [debug] [ThreadPool]: On list_my_db: Close
[0m11:00:25.901156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:00:25.907050 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:25.907396 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:00:25.907650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:25.910707 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.911064 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:25.911364 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:00:25.913751 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:00:25.915106 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:00:25.915560 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:00:25.922324 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.922693 [debug] [MainThread]: On master: BEGIN
[0m11:00:25.922953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:25.926057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.926429 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.926783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:25.935764 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:25.937210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684358210>]}
[0m11:00:25.937637 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:25.938099 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.938447 [debug] [MainThread]: On master: BEGIN
[0m11:00:25.939052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.939371 [debug] [MainThread]: On master: COMMIT
[0m11:00:25.939641 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.939885 [debug] [MainThread]: On master: COMMIT
[0m11:00:25.940259 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:25.940560 [debug] [MainThread]: On master: Close
[0m11:00:25.940999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:25.941318 [info ] [MainThread]: 
[0m11:00:25.943319 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:00:25.943870 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:00:25.944453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:00:25.944844 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:00:25.952522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:00:25.953105 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:00:25.989785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:00:25.990543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:25.990975 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:00:25.991350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:25.994293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.994758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:25.995116 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  InvoiceID as Invoice_id,
        PatientID  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:00:25.995870 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "invoiceid" does not exist
LINE 7:     select  InvoiceID as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m11:00:25.996242 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:00:25.996776 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:00:26.000487 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:26.002556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96821d2910>]}
[0m11:00:26.003211 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:00:26.003832 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:00:26.005529 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.005858 [debug] [MainThread]: On master: BEGIN
[0m11:00:26.006135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:26.009256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:26.009745 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.010041 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.010318 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.010727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:26.011052 [debug] [MainThread]: On master: Close
[0m11:00:26.011687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:26.012012 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:00:26.012383 [info ] [MainThread]: 
[0m11:00:26.012999 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:00:26.014185 [debug] [MainThread]: Command end result
[0m11:00:26.046171 [info ] [MainThread]: 
[0m11:00:26.046612 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:00:26.046902 [info ] [MainThread]: 
[0m11:00:26.047266 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:26.047570 [info ] [MainThread]: 
[0m11:00:26.047870 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:00:26.048606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8627668, "process_user_time": 1.935678, "process_kernel_time": 0.136624, "process_mem_max_rss": "114212", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m11:00:26.049068 [debug] [MainThread]: Command `dbt run` failed at 11:00:26.048960 after 0.86 seconds
[0m11:00:26.049409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683e05490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683f88110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685301710>]}
[0m11:00:26.049721 [debug] [MainThread]: Flushing usage events
[0m11:00:44.900878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3912821c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3912ad4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39129bbd10>]}


============================== 11:00:44.903434 | e05dd429-6bdd-4fb8-8252-fe551f3eefa5 ==============================
[0m11:00:44.903434 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:00:44.903987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_billing', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:45.030742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910ea95d0>]}
[0m11:00:45.076881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39164ed050>]}
[0m11:00:45.077563 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:00:45.086241 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:00:45.203694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:00:45.204287 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:00:45.422669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910ba8050>]}
[0m11:00:45.514040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910c56790>]}
[0m11:00:45.514553 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:00:45.514838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910c5fbd0>]}
[0m11:00:45.516247 [info ] [MainThread]: 
[0m11:00:45.516804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:45.517678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:00:45.556703 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:00:45.557096 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:00:45.557384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:45.562451 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:00:45.563752 [debug] [ThreadPool]: On list_my_db: Close
[0m11:00:45.568487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:00:45.574264 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:45.574602 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:00:45.574866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:45.578490 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.578908 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:45.579211 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:00:45.581685 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:00:45.583041 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:00:45.583480 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:00:45.590061 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.590403 [debug] [MainThread]: On master: BEGIN
[0m11:00:45.590657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:45.593759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.594169 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.594544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:45.603653 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:45.605169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910d63e90>]}
[0m11:00:45.605593 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:45.606064 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.606345 [debug] [MainThread]: On master: BEGIN
[0m11:00:45.606937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.607229 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.607507 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.607755 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.608127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:45.608418 [debug] [MainThread]: On master: Close
[0m11:00:45.608851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:45.609196 [info ] [MainThread]: 
[0m11:00:45.610995 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:00:45.611508 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:00:45.612005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:00:45.612451 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:00:45.619836 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:00:45.620426 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:00:45.655138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:00:45.655747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:45.656061 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:00:45.656366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:45.659710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.660326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:45.660691 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID " as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:00:45.661429 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "PatientID " does not exist
LINE 8:         "PatientID " as Patient_id,
                ^
HINT:  Perhaps you meant to reference the column "Billing.PatientID".

[0m11:00:45.661869 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:00:45.662369 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:00:45.666036 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:45.667445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390ff95290>]}
[0m11:00:45.668036 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.05s]
[0m11:00:45.668631 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:00:45.670246 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.670556 [debug] [MainThread]: On master: BEGIN
[0m11:00:45.670824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:45.673944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.674390 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.674690 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.674960 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.675374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:45.675685 [debug] [MainThread]: On master: Close
[0m11:00:45.676186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:45.676656 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:00:45.677067 [info ] [MainThread]: 
[0m11:00:45.677614 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:00:45.678899 [debug] [MainThread]: Command end result
[0m11:00:45.710953 [info ] [MainThread]: 
[0m11:00:45.711861 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:00:45.712404 [info ] [MainThread]: 
[0m11:00:45.713106 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:45.713482 [info ] [MainThread]: 
[0m11:00:45.713812 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:00:45.714593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8549311, "process_user_time": 1.877543, "process_kernel_time": 0.110913, "process_mem_max_rss": "114284", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m11:00:45.715111 [debug] [MainThread]: Command `dbt run` failed at 11:00:45.714999 after 0.86 seconds
[0m11:00:45.715542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39168d58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39129c8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3916760f50>]}
[0m11:00:45.715893 [debug] [MainThread]: Flushing usage events
[0m11:01:05.020938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a01963c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a01afb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a019634d0>]}


============================== 11:01:05.023567 | ce84fa02-c7b5-4976-83f8-5229db52a647 ==============================
[0m11:01:05.023567 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:05.024115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:01:05.153375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a019cc1d0>]}
[0m11:01:05.200322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a000a0550>]}
[0m11:01:05.201025 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:01:05.209726 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:01:05.327692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:05.328031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:05.376494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849fffef590>]}
[0m11:01:05.467683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849fff19d10>]}
[0m11:01:05.468165 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:01:05.468456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a032838d0>]}
[0m11:01:05.469852 [info ] [MainThread]: 
[0m11:01:05.470551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:05.471478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:01:05.510479 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:01:05.510840 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:05.511096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:05.515468 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:01:05.516823 [debug] [ThreadPool]: On list_my_db: Close
[0m11:01:05.521781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:01:05.527610 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:05.527933 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:01:05.528188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:05.531359 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.531724 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:05.532029 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:01:05.534486 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:01:05.535851 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:01:05.536215 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:01:05.542462 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.542805 [debug] [MainThread]: On master: BEGIN
[0m11:01:05.543095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:05.546369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.546743 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.547111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:01:05.556358 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:01:05.557822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849ffd42e10>]}
[0m11:01:05.558235 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:05.558709 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.558991 [debug] [MainThread]: On master: BEGIN
[0m11:01:05.559424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.559694 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.559943 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.560184 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.560603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:05.560886 [debug] [MainThread]: On master: Close
[0m11:01:05.561309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:05.561646 [info ] [MainThread]: 
[0m11:01:05.563625 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:01:05.564137 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:01:05.564617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:01:05.565024 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:01:05.572753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:01:05.573367 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:01:05.610150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:01:05.610770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:05.611101 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:01:05.611402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:05.614590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.614982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:05.615322 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID " as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:01:05.616661 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "PatientID " does not exist
LINE 8:         "PatientID " as Patient_id,
                ^
HINT:  Perhaps you meant to reference the column "Billing.PatientID".

[0m11:01:05.617285 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:01:05.617908 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:01:05.621673 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:05.623052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849ff2b3c50>]}
[0m11:01:05.623635 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:01:05.624219 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:01:05.625767 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.626164 [debug] [MainThread]: On master: BEGIN
[0m11:01:05.626461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:05.629218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.629649 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.629969 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.630246 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.630648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:05.630945 [debug] [MainThread]: On master: Close
[0m11:01:05.631362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:05.631627 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:01:05.631958 [info ] [MainThread]: 
[0m11:01:05.632327 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:01:05.633144 [debug] [MainThread]: Command end result
[0m11:01:05.663142 [info ] [MainThread]: 
[0m11:01:05.663716 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:05.664053 [info ] [MainThread]: 
[0m11:01:05.664505 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:05.664829 [info ] [MainThread]: 
[0m11:01:05.665179 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:05.666294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6867025, "process_user_time": 1.690054, "process_kernel_time": 0.120932, "process_mem_max_rss": "111464", "process_out_blocks": "1760", "command_success": false, "process_in_blocks": "0"}
[0m11:01:05.666988 [debug] [MainThread]: Command `dbt run` failed at 11:01:05.666875 after 0.69 seconds
[0m11:01:05.667378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a018c1f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a02dba390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a01983090>]}
[0m11:01:05.667757 [debug] [MainThread]: Flushing usage events
[0m11:01:23.991175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f93d9b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f93d07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f9553750>]}


============================== 11:01:23.993728 | 430bb237-918d-4257-9e2f-6faa9c2beb52 ==============================
[0m11:01:23.993728 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:23.994427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_billing', 'send_anonymous_usage_stats': 'True'}
[0m11:01:24.123872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f920b650>]}
[0m11:01:24.170055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fd09c710>]}
[0m11:01:24.170790 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:01:24.179633 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:01:24.296193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:24.296768 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:01:24.519217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f79608d0>]}
[0m11:01:24.612744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f7756910>]}
[0m11:01:24.613264 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:01:24.613587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f77ee090>]}
[0m11:01:24.615001 [info ] [MainThread]: 
[0m11:01:24.615589 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:24.616485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:01:24.657813 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:01:24.658194 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:24.658659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:24.663496 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:01:24.664874 [debug] [ThreadPool]: On list_my_db: Close
[0m11:01:24.669803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:01:24.675698 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:24.676049 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:01:24.676300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:24.679321 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.679701 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:24.679989 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:01:24.682492 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:01:24.683852 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:01:24.684239 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:01:24.690486 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.690866 [debug] [MainThread]: On master: BEGIN
[0m11:01:24.691122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:24.694177 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.694638 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.695031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:01:24.704052 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:01:24.705601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f7a35650>]}
[0m11:01:24.706086 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:24.706537 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.706848 [debug] [MainThread]: On master: BEGIN
[0m11:01:24.707316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.707650 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.707954 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.708230 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.708679 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:24.708983 [debug] [MainThread]: On master: Close
[0m11:01:24.709476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:24.709880 [info ] [MainThread]: 
[0m11:01:24.712082 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:01:24.712624 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:01:24.713106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:01:24.713601 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:01:24.722540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:01:24.723178 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:01:24.757947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:01:24.758605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:24.758916 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:01:24.759198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:24.762890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.763345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:24.763672 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        PatientID  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:01:24.764503 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patientid" does not exist
LINE 8:         PatientID  as Patient_id,
                ^
HINT:  Perhaps you meant to reference the column "Billing.PatientID".

[0m11:01:24.764897 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:01:24.765450 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:01:24.769184 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "patientid" does not exist
  LINE 8:         PatientID  as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:24.770599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f7a4ed50>]}
[0m11:01:24.771200 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:01:24.771817 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:01:24.773475 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.773823 [debug] [MainThread]: On master: BEGIN
[0m11:01:24.774101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:24.777032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.777522 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.777833 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.778106 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.778473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:24.778761 [debug] [MainThread]: On master: Close
[0m11:01:24.779166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:24.779444 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:01:24.779758 [info ] [MainThread]: 
[0m11:01:24.780079 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:01:24.780784 [debug] [MainThread]: Command end result
[0m11:01:24.810738 [info ] [MainThread]: 
[0m11:01:24.811463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:24.812044 [info ] [MainThread]: 
[0m11:01:24.812637 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "patientid" does not exist
  LINE 8:         PatientID  as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:24.813081 [info ] [MainThread]: 
[0m11:01:24.813521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:24.814404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.86440617, "process_user_time": 1.875233, "process_kernel_time": 0.144863, "process_mem_max_rss": "114616", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m11:01:24.814948 [debug] [MainThread]: Command `dbt run` failed at 11:01:24.814842 after 0.87 seconds
[0m11:01:24.815297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fd2f0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fd2f0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f93beed0>]}
[0m11:01:24.815634 [debug] [MainThread]: Flushing usage events
[0m11:01:54.718953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5945da590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb594623d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb594622750>]}


============================== 11:01:54.721903 | b5d885f9-a7b5-464e-9eb1-2180c3f32ab9 ==============================
[0m11:01:54.721903 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:54.722597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:54.864249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb592ce4050>]}
[0m11:01:54.912110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5982d5010>]}
[0m11:01:54.912845 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:01:54.922312 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:01:55.040720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:55.041325 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:01:55.267770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb592b63dd0>]}
[0m11:01:55.361397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb592a02fd0>]}
[0m11:01:55.361901 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:01:55.362188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5928e1710>]}
[0m11:01:55.363623 [info ] [MainThread]: 
[0m11:01:55.364201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:55.365089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:01:55.402777 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:01:55.403135 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:55.403408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:55.407677 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:01:55.408954 [debug] [ThreadPool]: On list_my_db: Close
[0m11:01:55.413737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:01:55.419730 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:55.420102 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:01:55.420362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:55.423434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.423805 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:55.424094 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:01:55.426545 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:01:55.427896 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:01:55.428297 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:01:55.434351 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.434790 [debug] [MainThread]: On master: BEGIN
[0m11:01:55.435148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:55.438419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.438836 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.439327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:01:55.448417 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:01:55.449997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb59529d5d0>]}
[0m11:01:55.450457 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:55.450979 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.451289 [debug] [MainThread]: On master: BEGIN
[0m11:01:55.451979 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.452320 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.452622 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.452885 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.453281 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:55.453601 [debug] [MainThread]: On master: Close
[0m11:01:55.454057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:55.454420 [info ] [MainThread]: 
[0m11:01:55.456590 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:01:55.457167 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:01:55.457792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:01:55.458308 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:01:55.466063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:01:55.466877 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:01:55.502691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:01:55.503321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:55.503634 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:01:55.503912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:55.507547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.508031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:55.508401 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:01:55.509247 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "items" does not exist
LINE 9:         Items,
                ^
HINT:  Perhaps you meant to reference the column "Billing.Items".

[0m11:01:55.509674 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:01:55.510181 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:01:55.513831 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "items" does not exist
  LINE 9:         Items,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.Items".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:55.515316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5919d3b90>]}
[0m11:01:55.515992 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:01:55.516603 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:01:55.518276 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.518643 [debug] [MainThread]: On master: BEGIN
[0m11:01:55.518925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:55.522045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.522502 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.522798 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.523058 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.523527 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:55.523980 [debug] [MainThread]: On master: Close
[0m11:01:55.524642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:55.524987 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:01:55.525494 [info ] [MainThread]: 
[0m11:01:55.526250 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:01:55.527662 [debug] [MainThread]: Command end result
[0m11:01:55.558184 [info ] [MainThread]: 
[0m11:01:55.558716 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:55.559062 [info ] [MainThread]: 
[0m11:01:55.559470 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "items" does not exist
  LINE 9:         Items,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.Items".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:55.559813 [info ] [MainThread]: 
[0m11:01:55.560136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:55.560931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8905146, "process_user_time": 1.990506, "process_kernel_time": 0.127775, "process_mem_max_rss": "114204", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m11:01:55.561452 [debug] [MainThread]: Command `dbt run` failed at 11:01:55.561301 after 0.89 seconds
[0m11:01:55.561812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb59462d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5947b0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5983c47d0>]}
[0m11:01:55.562140 [debug] [MainThread]: Flushing usage events
[0m11:02:08.051261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ec08c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ebeb8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205f82abd0>]}


============================== 11:02:08.053866 | e5660aeb-9f0a-4228-a811-6486c847dfe6 ==============================
[0m11:02:08.053866 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:02:08.054441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_billing', 'send_anonymous_usage_stats': 'True'}
[0m11:02:08.184010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d30fe90>]}
[0m11:02:08.230279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d34d210>]}
[0m11:02:08.231009 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:02:08.239882 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:02:08.360680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:08.361326 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:02:08.579864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205cfd8b10>]}
[0m11:02:08.671680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205cfb8390>]}
[0m11:02:08.672181 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:02:08.672511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d30e210>]}
[0m11:02:08.673978 [info ] [MainThread]: 
[0m11:02:08.674591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:08.675497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:02:08.713470 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:02:08.713831 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:02:08.714096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:08.718593 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:02:08.719877 [debug] [ThreadPool]: On list_my_db: Close
[0m11:02:08.724663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:02:08.730683 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:08.731041 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:02:08.731367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:08.734383 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.734786 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:08.735082 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:08.737617 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:02:08.739044 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:02:08.739463 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:02:08.745977 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.746462 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.746735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:08.749891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.750249 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.750639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:08.759684 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:02:08.761371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ec41b10>]}
[0m11:02:08.761858 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:08.762313 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.762592 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.763157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.763468 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.763732 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.763987 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.764366 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:08.764628 [debug] [MainThread]: On master: Close
[0m11:02:08.765060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:08.765370 [info ] [MainThread]: 
[0m11:02:08.767214 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:02:08.767736 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:02:08.768267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:02:08.768660 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:02:08.776727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:02:08.777639 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:02:08.813797 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:02:08.814432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.814780 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:02:08.815074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:08.818387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.818808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.819154 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items",
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m11:02:08.820651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:02:08.826843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.827233 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
alter table "my_db"."public"."stg_billing__dbt_tmp" rename to "stg_billing"
[0m11:02:08.827892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:02:08.841539 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m11:02:08.841930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.842254 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m11:02:08.872646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:02:08.887829 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_billing__dbt_backup"
[0m11:02:08.898051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.898685 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
drop view if exists "my_db"."public"."stg_billing__dbt_backup" cascade
[0m11:02:08.899555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:02:08.902948 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:02:08.904766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d065890>]}
[0m11:02:08.905626 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_billing ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m11:02:08.906517 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:02:08.907912 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.908277 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.908574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:08.912452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.912893 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.913169 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.913439 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.913828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:08.914110 [debug] [MainThread]: On master: Close
[0m11:02:08.914660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:08.915108 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:02:08.915618 [info ] [MainThread]: 
[0m11:02:08.916143 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m11:02:08.917594 [debug] [MainThread]: Command end result
[0m11:02:08.951491 [info ] [MainThread]: 
[0m11:02:08.951962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:08.952268 [info ] [MainThread]: 
[0m11:02:08.952613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:02:08.953366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.94890964, "process_user_time": 2.068142, "process_kernel_time": 0.134944, "process_mem_max_rss": "113980", "process_out_blocks": "2584", "process_in_blocks": "0"}
[0m11:02:08.953833 [debug] [MainThread]: Command `dbt run` succeeded at 11:02:08.953729 after 0.95 seconds
[0m11:02:08.954163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792062aec690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ebb7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ebb7910>]}
[0m11:02:08.954503 [debug] [MainThread]: Flushing usage events
[0m11:02:34.726945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965ae050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965ad0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965ad4d0>]}


============================== 11:02:34.729525 | 33db9efe-d426-46ce-b886-e0516d88a27e ==============================
[0m11:02:34.729525 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:02:34.730026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_doctor', 'send_anonymous_usage_stats': 'True'}
[0m11:02:34.871626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965acb50>]}
[0m11:02:34.919194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94cd1310>]}
[0m11:02:34.919887 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:02:34.930362 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:02:35.048164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:35.048520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:35.097323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94bc7ad0>]}
[0m11:02:35.189462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94c06910>]}
[0m11:02:35.189974 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:02:35.190253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94bdc290>]}
[0m11:02:35.191704 [info ] [MainThread]: 
[0m11:02:35.192209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:35.193032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:02:35.232098 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:02:35.232453 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:02:35.232713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:35.237111 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:02:35.238349 [debug] [ThreadPool]: On list_my_db: Close
[0m11:02:35.243098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:02:35.248938 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:35.249289 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:02:35.249567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:35.252750 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.253115 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:35.253429 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:35.255878 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:02:35.257222 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:02:35.257663 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:02:35.264221 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.264631 [debug] [MainThread]: On master: BEGIN
[0m11:02:35.264891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:35.267840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.268238 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.268626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:35.278407 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:02:35.280119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94c3ad50>]}
[0m11:02:35.280525 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:35.280926 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.281183 [debug] [MainThread]: On master: BEGIN
[0m11:02:35.281590 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.281876 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.282127 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.282376 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.282719 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:35.282978 [debug] [MainThread]: On master: Close
[0m11:02:35.283461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:35.283893 [info ] [MainThread]: 
[0m11:02:35.286047 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_doctor
[0m11:02:35.286551 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_doctor .................................. [RUN]
[0m11:02:35.287015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_doctor)
[0m11:02:35.287466 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_doctor
[0m11:02:35.295271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_doctor"
[0m11:02:35.295814 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_doctor
[0m11:02:35.333681 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_doctor"
[0m11:02:35.334488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:02:35.334862 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: BEGIN
[0m11:02:35.335180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:35.338448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.338854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:02:35.339186 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */

  create view "my_db"."public"."stg_doctor__dbt_tmp"
    
    
  as (
    select  DoctorID as Doctor_id,
        DoctorName as Doctor_name,
        Specialization,
        DoctorContact as Doctor_contact
    from "my_db"."public"."Doctor"
  );
[0m11:02:35.339879 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "doctorid" does not exist
LINE 7:     select  DoctorID as Doctor_id,
                    ^
HINT:  Perhaps you meant to reference the column "Doctor.DoctorID".

[0m11:02:35.340282 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: ROLLBACK
[0m11:02:35.340901 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: Close
[0m11:02:35.344602 [debug] [Thread-1 (]: Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "doctorid" does not exist
  LINE 7:     select  DoctorID as Doctor_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:02:35.346064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94950610>]}
[0m11:02:35.346691 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_doctor ......................... [[31mERROR[0m in 0.06s]
[0m11:02:35.347287 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_doctor
[0m11:02:35.348890 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.349182 [debug] [MainThread]: On master: BEGIN
[0m11:02:35.349450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:35.352395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.352822 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.353130 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.353451 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.353837 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:35.354127 [debug] [MainThread]: On master: Close
[0m11:02:35.354548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:35.354825 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_doctor' was properly closed.
[0m11:02:35.355137 [info ] [MainThread]: 
[0m11:02:35.355489 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:02:35.356183 [debug] [MainThread]: Command end result
[0m11:02:35.386304 [info ] [MainThread]: 
[0m11:02:35.386867 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:02:35.387242 [info ] [MainThread]: 
[0m11:02:35.387692 [error] [MainThread]:   Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "doctorid" does not exist
  LINE 7:     select  DoctorID as Doctor_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:02:35.388018 [info ] [MainThread]: 
[0m11:02:35.388393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:02:35.389190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.71130633, "process_user_time": 1.793819, "process_kernel_time": 0.138985, "process_mem_max_rss": "111780", "process_out_blocks": "1760", "command_success": false, "process_in_blocks": "0"}
[0m11:02:35.389683 [debug] [MainThread]: Command `dbt run` failed at 11:02:35.389579 after 0.71 seconds
[0m11:02:35.390035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e96727dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e96564ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e96566310>]}
[0m11:02:35.390376 [debug] [MainThread]: Flushing usage events
[0m11:03:02.005538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e2244b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e22420910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e2244a290>]}


============================== 11:03:02.008104 | 04ff815a-cd8c-4622-bfda-bb23ac3dfd60 ==============================
[0m11:03:02.008104 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:03:02.008608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_doctor', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:03:02.140346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e22356c10>]}
[0m11:03:02.186245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e20b8d2d0>]}
[0m11:03:02.186932 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:03:02.195432 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:03:02.312448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:02.313044 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m11:03:02.530410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e208a7010>]}
[0m11:03:02.622139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e207cff90>]}
[0m11:03:02.622658 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:03:02.622932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e20a12cd0>]}
[0m11:03:02.624359 [info ] [MainThread]: 
[0m11:03:02.624863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:02.625681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:03:02.665054 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:03:02.665493 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:03:02.665767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:02.670772 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:03:02.672169 [debug] [ThreadPool]: On list_my_db: Close
[0m11:03:02.677275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:03:02.683171 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:02.683536 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:03:02.683800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:02.687012 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.687430 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:02.687735 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:03:02.690280 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:03:02.691799 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:03:02.692480 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:03:02.699159 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.699546 [debug] [MainThread]: On master: BEGIN
[0m11:03:02.699827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:02.702902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.703343 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.703744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:02.713451 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:03:02.715232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e1f73d210>]}
[0m11:03:02.715683 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:02.716184 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.716494 [debug] [MainThread]: On master: BEGIN
[0m11:03:02.717083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.717417 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.717722 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.718004 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.718382 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:02.718686 [debug] [MainThread]: On master: Close
[0m11:03:02.719122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:02.719452 [info ] [MainThread]: 
[0m11:03:02.721413 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_doctor
[0m11:03:02.721913 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_doctor .................................. [RUN]
[0m11:03:02.722494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_doctor)
[0m11:03:02.722862 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_doctor
[0m11:03:02.730207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_doctor"
[0m11:03:02.730807 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_doctor
[0m11:03:02.766500 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_doctor"
[0m11:03:02.767116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:02.767444 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: BEGIN
[0m11:03:02.767732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:02.770650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.771047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:02.771389 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */

  create view "my_db"."public"."stg_doctor__dbt_tmp"
    
    
  as (
    select  "DoctorID" as Doctor_id,
        "DoctorName "as Doctor_name,
        "Specialization",
        "DoctorContact" as Doctor_contact
    from "my_db"."public"."Doctor"
  );
[0m11:03:02.771983 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "DoctorName " does not exist
LINE 8:         "DoctorName "as Doctor_name,
                ^
HINT:  Perhaps you meant to reference the column "Doctor.DoctorName".

[0m11:03:02.772326 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: ROLLBACK
[0m11:03:02.772821 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: Close
[0m11:03:02.776538 [debug] [Thread-1 (]: Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "DoctorName " does not exist
  LINE 8:         "DoctorName "as Doctor_name,
                  ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorName".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:03:02.778503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e2075f010>]}
[0m11:03:02.779193 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_doctor ......................... [[31mERROR[0m in 0.05s]
[0m11:03:02.779795 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_doctor
[0m11:03:02.781623 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.781984 [debug] [MainThread]: On master: BEGIN
[0m11:03:02.782237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:02.785301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.785727 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.785992 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.786256 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.786659 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:02.786944 [debug] [MainThread]: On master: Close
[0m11:03:02.787353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:02.787609 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_doctor' was properly closed.
[0m11:03:02.787890 [info ] [MainThread]: 
[0m11:03:02.788213 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:03:02.788864 [debug] [MainThread]: Command end result
[0m11:03:02.817496 [info ] [MainThread]: 
[0m11:03:02.817958 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:03:02.818266 [info ] [MainThread]: 
[0m11:03:02.818745 [error] [MainThread]:   Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "DoctorName " does not exist
  LINE 8:         "DoctorName "as Doctor_name,
                  ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorName".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:03:02.819193 [info ] [MainThread]: 
[0m11:03:02.819671 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:03:02.820653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8570106, "process_user_time": 1.977956, "process_kernel_time": 0.160915, "process_mem_max_rss": "114600", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m11:03:02.821210 [debug] [MainThread]: Command `dbt run` failed at 11:03:02.821093 after 0.86 seconds
[0m11:03:02.821623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e22477850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e263c4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e263c4390>]}
[0m11:03:02.821969 [debug] [MainThread]: Flushing usage events
[0m11:03:18.998830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0f07cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c10da0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0f0a8a10>]}


============================== 11:03:19.001558 | e97816cb-07ae-4d2a-ac51-0fe1ddf37491 ==============================
[0m11:03:19.001558 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:03:19.002069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_doctor', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:03:19.170073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d74d2d0>]}
[0m11:03:19.219914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0ef90510>]}
[0m11:03:19.220669 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:03:19.230085 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:03:19.350740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:19.351342 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m11:03:19.574091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d64bd10>]}
[0m11:03:19.667910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d510890>]}
[0m11:03:19.668418 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:03:19.668701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c10a81150>]}
[0m11:03:19.670125 [info ] [MainThread]: 
[0m11:03:19.670701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:19.671685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:03:19.710417 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:03:19.710793 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:03:19.711116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:19.715553 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:03:19.716826 [debug] [ThreadPool]: On list_my_db: Close
[0m11:03:19.721837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:03:19.727598 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:19.727962 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:03:19.728264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:19.731900 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.732305 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:19.732669 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:03:19.735539 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:03:19.736960 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:03:19.737491 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:03:19.744262 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.744647 [debug] [MainThread]: On master: BEGIN
[0m11:03:19.744978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:19.748147 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.748543 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.748909 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:19.758760 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:03:19.760468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d511690>]}
[0m11:03:19.760853 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:19.761332 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.761614 [debug] [MainThread]: On master: BEGIN
[0m11:03:19.762184 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.762535 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.762795 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.763046 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.763382 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:19.763643 [debug] [MainThread]: On master: Close
[0m11:03:19.764055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:19.764373 [info ] [MainThread]: 
[0m11:03:19.766344 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_doctor
[0m11:03:19.766863 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_doctor .................................. [RUN]
[0m11:03:19.767422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_doctor)
[0m11:03:19.767824 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_doctor
[0m11:03:19.775374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_doctor"
[0m11:03:19.775985 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_doctor
[0m11:03:19.811411 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_doctor"
[0m11:03:19.812039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.812396 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: BEGIN
[0m11:03:19.812721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:19.815800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.816205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.816559 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */

  create view "my_db"."public"."stg_doctor__dbt_tmp"
    
    
  as (
    select  "DoctorID" as Doctor_id,
        "DoctorName" as Doctor_name,
        "Specialization",
        "DoctorContact" as Doctor_contact
    from "my_db"."public"."Doctor"
  );
[0m11:03:19.818422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:03:19.824674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.825077 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */
alter table "my_db"."public"."stg_doctor__dbt_tmp" rename to "stg_doctor"
[0m11:03:19.825767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:03:19.839882 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: COMMIT
[0m11:03:19.840349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.840651 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: COMMIT
[0m11:03:19.841757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:03:19.847551 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_doctor__dbt_backup"
[0m11:03:19.852081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.852464 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */
drop view if exists "my_db"."public"."stg_doctor__dbt_backup" cascade
[0m11:03:19.853067 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:03:19.855297 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: Close
[0m11:03:19.856817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d1a39d0>]}
[0m11:03:19.857587 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_doctor ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m11:03:19.858233 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_doctor
[0m11:03:19.859364 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.859653 [debug] [MainThread]: On master: BEGIN
[0m11:03:19.859913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:19.862956 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.863419 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.863831 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.864199 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.864759 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:19.865166 [debug] [MainThread]: On master: Close
[0m11:03:19.865752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:19.866129 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_doctor' was properly closed.
[0m11:03:19.866519 [info ] [MainThread]: 
[0m11:03:19.866954 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:03:19.867887 [debug] [MainThread]: Command end result
[0m11:03:19.898181 [info ] [MainThread]: 
[0m11:03:19.898725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:19.899108 [info ] [MainThread]: 
[0m11:03:19.899450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:03:19.900275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9443655, "process_user_time": 2.019065, "process_kernel_time": 0.145292, "process_mem_max_rss": "114064", "process_out_blocks": "2592", "process_in_blocks": "0"}
[0m11:03:19.900799 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:19.900694 after 0.94 seconds
[0m11:03:19.901119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c12f7c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c12eb0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c1300c310>]}
[0m11:03:19.901481 [debug] [MainThread]: Flushing usage events
[0m11:03:51.465112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f52a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f570bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f570fd0>]}


============================== 11:03:51.467760 | 49afd10c-f618-4deb-982a-620def6d5b0c ==============================
[0m11:03:51.467760 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:03:51.468304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_medical_procedure', 'send_anonymous_usage_stats': 'True'}
[0m11:03:51.599075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f457350>]}
[0m11:03:51.646972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827dcb5650>]}
[0m11:03:51.647675 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:03:51.656576 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:03:51.771824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:51.772381 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m11:03:51.989395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827da4b790>]}
[0m11:03:52.081906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827d9cef10>]}
[0m11:03:52.082372 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:03:52.082659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827d977b10>]}
[0m11:03:52.084166 [info ] [MainThread]: 
[0m11:03:52.084756 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:52.085690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:03:52.125121 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:03:52.125495 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:03:52.125763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:52.130602 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:03:52.131981 [debug] [ThreadPool]: On list_my_db: Close
[0m11:03:52.137074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:03:52.142786 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:52.143133 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:03:52.143420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:52.147005 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.147497 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:52.147800 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:03:52.150354 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m11:03:52.151757 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:03:52.152211 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:03:52.158638 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.158979 [debug] [MainThread]: On master: BEGIN
[0m11:03:52.159228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:52.162143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.162527 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.162896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:52.174016 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m11:03:52.175853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827d965990>]}
[0m11:03:52.176242 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:52.176682 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.176965 [debug] [MainThread]: On master: BEGIN
[0m11:03:52.177403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.177671 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.177923 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.178160 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.178534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:52.178811 [debug] [MainThread]: On master: Close
[0m11:03:52.179236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:52.179612 [info ] [MainThread]: 
[0m11:03:52.181482 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.181981 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_medical_procedure ....................... [RUN]
[0m11:03:52.182457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_medical_procedure)
[0m11:03:52.182915 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.190489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.191077 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.226829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.227407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.227746 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: BEGIN
[0m11:03:52.228025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:52.231537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.231994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.232368 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_medical_procedure"} */

  create view "my_db"."public"."stg_medical_procedure__dbt_tmp"
    
    
  as (
    select  "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
    from "my_db"."public"."Medical_Procedure"
  );
[0m11:03:52.234188 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:03:52.240241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.240640 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_medical_procedure"} */
alter table "my_db"."public"."stg_medical_procedure__dbt_tmp" rename to "stg_medical_procedure"
[0m11:03:52.241342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:03:52.255259 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: COMMIT
[0m11:03:52.255663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.255967 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: COMMIT
[0m11:03:52.263820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:03:52.270229 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_medical_procedure__dbt_backup"
[0m11:03:52.274852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.275199 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_medical_procedure"} */
drop view if exists "my_db"."public"."stg_medical_procedure__dbt_backup" cascade
[0m11:03:52.275787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:03:52.277970 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: Close
[0m11:03:52.279398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827c936850>]}
[0m11:03:52.280094 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_medical_procedure .................. [[32mCREATE VIEW[0m in 0.10s]
[0m11:03:52.280790 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.281935 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.282251 [debug] [MainThread]: On master: BEGIN
[0m11:03:52.282513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:52.285910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.286286 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.286611 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.286887 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.287280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:52.287569 [debug] [MainThread]: On master: Close
[0m11:03:52.287965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:52.288216 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_medical_procedure' was properly closed.
[0m11:03:52.288527 [info ] [MainThread]: 
[0m11:03:52.288855 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:03:52.289534 [debug] [MainThread]: Command end result
[0m11:03:52.320457 [info ] [MainThread]: 
[0m11:03:52.321052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:52.321419 [info ] [MainThread]: 
[0m11:03:52.321749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:03:52.322548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8999287, "process_user_time": 1.886749, "process_kernel_time": 0.133698, "process_mem_max_rss": "114024", "process_out_blocks": "2592", "process_in_blocks": "0"}
[0m11:03:52.323034 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:52.322930 after 0.90 seconds
[0m11:03:52.323358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f57f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f6ebe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728283454550>]}
[0m11:03:52.323681 [debug] [MainThread]: Flushing usage events
[0m11:04:33.806460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898ed2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898f1b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898f19210>]}


============================== 11:04:33.808952 | 237a20f3-d777-437b-a358-7b516ffe2e1f ==============================
[0m11:04:33.808952 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:04:33.809508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_patient', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:04:33.939529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898f24490>]}
[0m11:04:33.985724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c589cbdcfd0>]}
[0m11:04:33.986460 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:04:33.995450 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:04:34.114189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:34.114775 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m11:04:34.333090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5897572690>]}
[0m11:04:34.425328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5897327e90>]}
[0m11:04:34.425831 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:04:34.426111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c58972f2e90>]}
[0m11:04:34.427513 [info ] [MainThread]: 
[0m11:04:34.428046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:04:34.428857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:04:34.468158 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:04:34.468515 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:04:34.468772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.473247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:04:34.474512 [debug] [ThreadPool]: On list_my_db: Close
[0m11:04:34.479378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:04:34.485189 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:04:34.485542 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:04:34.485790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:34.488950 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.489356 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:04:34.489655 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:04:34.492127 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:04:34.493529 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:04:34.494004 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:04:34.500665 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.501010 [debug] [MainThread]: On master: BEGIN
[0m11:04:34.501260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:34.504404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.504782 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.505134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:04:34.516563 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m11:04:34.518780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898e24710>]}
[0m11:04:34.519162 [debug] [MainThread]: On master: ROLLBACK
[0m11:04:34.519727 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.520003 [debug] [MainThread]: On master: BEGIN
[0m11:04:34.520446 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.520773 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.521038 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.521282 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.521746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:04:34.522028 [debug] [MainThread]: On master: Close
[0m11:04:34.522526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:34.522844 [info ] [MainThread]: 
[0m11:04:34.524990 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_patient
[0m11:04:34.525548 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_patient ................................. [RUN]
[0m11:04:34.526029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_patient)
[0m11:04:34.526433 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_patient
[0m11:04:34.534347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_patient"
[0m11:04:34.534976 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_patient
[0m11:04:34.570284 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_patient"
[0m11:04:34.570913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.571256 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: BEGIN
[0m11:04:34.571597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:34.574790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.575208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.575582 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */

  create view "my_db"."public"."stg_patient__dbt_tmp"
    
    
  as (
    select  "PatientID" as Patient_id,
        "firstname" as First_name,
        "lastname" as Last_name,
        "email" as Email
    from "my_db"."public"."Patient"
  );
[0m11:04:34.577211 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:04:34.584136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.584581 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */
alter table "my_db"."public"."stg_patient__dbt_tmp" rename to "stg_patient"
[0m11:04:34.585265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:04:34.599315 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: COMMIT
[0m11:04:34.599753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.600069 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: COMMIT
[0m11:04:34.628585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:04:34.635277 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_patient__dbt_backup"
[0m11:04:34.640221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.640635 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */
drop view if exists "my_db"."public"."stg_patient__dbt_backup" cascade
[0m11:04:34.641267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:04:34.643543 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: Close
[0m11:04:34.644922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5895ff4110>]}
[0m11:04:34.645661 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_patient ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m11:04:34.646332 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_patient
[0m11:04:34.647633 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.647929 [debug] [MainThread]: On master: BEGIN
[0m11:04:34.648177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:34.651372 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.651811 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.652259 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.652714 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.653296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:04:34.653783 [debug] [MainThread]: On master: Close
[0m11:04:34.654498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:34.655057 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_patient' was properly closed.
[0m11:04:34.655719 [info ] [MainThread]: 
[0m11:04:34.656346 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m11:04:34.658043 [debug] [MainThread]: Command end result
[0m11:04:34.689249 [info ] [MainThread]: 
[0m11:04:34.689794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:34.690106 [info ] [MainThread]: 
[0m11:04:34.690450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:04:34.691243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92606986, "process_user_time": 1.900854, "process_kernel_time": 0.114809, "process_mem_max_rss": "114044", "process_out_blocks": "2600", "process_in_blocks": "0"}
[0m11:04:34.691750 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:34.691639 after 0.93 seconds
[0m11:04:34.692089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c589cccc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c58963f2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c58990a0090>]}
[0m11:04:34.692456 [debug] [MainThread]: Flushing usage events
[0m11:20:30.079723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532510fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532693750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532513310>]}


============================== 11:20:30.082304 | 558a09be-9250-4ce8-a044-099dad9eb713 ==============================
[0m11:20:30.082304 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:20:30.082849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_billing', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:30.210924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5331948d0>]}
[0m11:20:30.257780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc536204a10>]}
[0m11:20:30.258542 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:20:30.268207 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:20:30.385355 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m11:20:30.386046 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:20:30.386383 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:20:30.583182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5309ee4d0>]}
[0m11:20:30.651105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5305218d0>]}
[0m11:20:30.651566 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:20:30.651873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc530ab6dd0>]}
[0m11:20:30.653182 [info ] [MainThread]: 
[0m11:20:30.653678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:30.654452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:20:30.690208 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:20:30.690561 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:20:30.690870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:30.695640 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:20:30.697048 [debug] [ThreadPool]: On list_my_db: Close
[0m11:20:30.702233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:20:30.707981 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:30.708311 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:20:30.708584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:30.712304 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.712838 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:30.713158 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:20:30.715882 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:20:30.717382 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:20:30.717866 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:20:30.725255 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.725621 [debug] [MainThread]: On master: BEGIN
[0m11:20:30.725900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:30.729068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.729488 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.729896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:30.742288 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:20:30.744753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc530a4ee10>]}
[0m11:20:30.745212 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:30.745717 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.746011 [debug] [MainThread]: On master: BEGIN
[0m11:20:30.746556 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.746940 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.747295 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.747586 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.747983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:30.748280 [debug] [MainThread]: On master: Close
[0m11:20:30.748774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:30.749195 [info ] [MainThread]: 
[0m11:20:30.751164 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:20:30.751698 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:20:30.752301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:20:30.752719 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:20:30.760189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:20:30.760833 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:20:30.796625 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:20:30.797294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:30.797652 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:20:30.798042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:30.801243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.801702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:30.802056 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum(Amount) as total_amount
from billing
group by Invoice_id,Patient_id,Procedure
order by total_amount desc;
  );
[0m11:20:30.802750 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: order by total_amount desc;
                                   ^

[0m11:20:30.803162 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: ROLLBACK
[0m11:20:30.803687 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:20:30.807560 [debug] [Thread-1 (]: Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  syntax error at or near ";"
  LINE 22: order by total_amount desc;
                                     ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:30.809013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc52f95e010>]}
[0m11:20:30.809694 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:20:30.810376 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:20:30.811951 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.812378 [debug] [MainThread]: On master: BEGIN
[0m11:20:30.812674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:30.815641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.816057 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.816353 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.816624 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.817035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:30.817326 [debug] [MainThread]: On master: Close
[0m11:20:30.817748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:30.818013 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:20:30.818383 [info ] [MainThread]: 
[0m11:20:30.818735 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:20:30.819463 [debug] [MainThread]: Command end result
[0m11:20:30.850841 [info ] [MainThread]: 
[0m11:20:30.851286 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:30.851602 [info ] [MainThread]: 
[0m11:20:30.852004 [error] [MainThread]:   Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  syntax error at or near ";"
  LINE 22: order by total_amount desc;
                                     ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:30.852305 [info ] [MainThread]: 
[0m11:20:30.852650 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:20:30.853384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81496894, "process_user_time": 1.835742, "process_kernel_time": 0.122715, "process_mem_max_rss": "114076", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m11:20:30.853869 [debug] [MainThread]: Command `dbt run` failed at 11:20:30.853767 after 0.82 seconds
[0m11:20:30.854221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532510ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc53251fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5324d0150>]}
[0m11:20:30.854575 [debug] [MainThread]: Flushing usage events
[0m11:20:48.281231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f7521d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f88ee710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f7522890>]}


============================== 11:20:48.283994 | b46a27a9-dd90-4846-bb93-57fd9608f567 ==============================
[0m11:20:48.283994 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:20:48.284683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_billing', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:48.413219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f77b0290>]}
[0m11:20:48.459399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724fb23cf50>]}
[0m11:20:48.460077 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:20:48.469461 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:20:48.561628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:48.562200 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:20:48.757326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f7433ed0>]}
[0m11:20:48.832253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f5c9c1d0>]}
[0m11:20:48.832762 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:20:48.833130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f59ab450>]}
[0m11:20:48.834776 [info ] [MainThread]: 
[0m11:20:48.835381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:48.836327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:20:48.875267 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:20:48.875632 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:20:48.875936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:48.880595 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:20:48.881848 [debug] [ThreadPool]: On list_my_db: Close
[0m11:20:48.887413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:20:48.893388 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:48.893761 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:20:48.894011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:48.897142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.897625 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:48.897919 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:20:48.900507 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:20:48.902155 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:20:48.902772 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:20:48.909580 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.909924 [debug] [MainThread]: On master: BEGIN
[0m11:20:48.910169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:48.913424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.913809 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.914180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:48.926653 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:20:48.928932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f5582050>]}
[0m11:20:48.929380 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:48.929866 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.930158 [debug] [MainThread]: On master: BEGIN
[0m11:20:48.930757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.931078 [debug] [MainThread]: On master: COMMIT
[0m11:20:48.931356 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.931617 [debug] [MainThread]: On master: COMMIT
[0m11:20:48.932011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:48.932330 [debug] [MainThread]: On master: Close
[0m11:20:48.932872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:48.933210 [info ] [MainThread]: 
[0m11:20:48.935679 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:20:48.936445 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:20:48.936984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:20:48.937348 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:20:48.945887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:20:48.946715 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:20:48.983975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:20:48.984616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:48.985018 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:20:48.985479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:48.988956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.989394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:48.989779 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum(Amount) as total_amount
from billing
group by Invoice_id,Patient_id,Procedure
order by total_amount desc
  );
[0m11:20:48.990594 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 19:     sum(Amount) as total_amount
                 ^
HINT:  Perhaps you meant to reference the column "billing.Amount".

[0m11:20:48.990967 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: ROLLBACK
[0m11:20:48.991471 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:20:48.995970 [debug] [Thread-1 (]: Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  column "amount" does not exist
  LINE 19:     sum(Amount) as total_amount
                   ^
  HINT:  Perhaps you meant to reference the column "billing.Amount".
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:48.997395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f4588990>]}
[0m11:20:48.997970 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:20:48.998559 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:20:49.000210 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:49.000548 [debug] [MainThread]: On master: BEGIN
[0m11:20:49.000816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:49.004108 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:49.004496 [debug] [MainThread]: On master: COMMIT
[0m11:20:49.004788 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:49.005046 [debug] [MainThread]: On master: COMMIT
[0m11:20:49.005483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:49.005777 [debug] [MainThread]: On master: Close
[0m11:20:49.006195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:49.006460 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:20:49.006753 [info ] [MainThread]: 
[0m11:20:49.007095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:20:49.007773 [debug] [MainThread]: Command end result
[0m11:20:49.033393 [info ] [MainThread]: 
[0m11:20:49.033830 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:49.034142 [info ] [MainThread]: 
[0m11:20:49.034536 [error] [MainThread]:   Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  column "amount" does not exist
  LINE 19:     sum(Amount) as total_amount
                   ^
  HINT:  Perhaps you meant to reference the column "billing.Amount".
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:49.034865 [info ] [MainThread]: 
[0m11:20:49.035216 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:20:49.036432 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8012521, "process_user_time": 1.845092, "process_kernel_time": 0.148926, "process_mem_max_rss": "113912", "process_out_blocks": "2552", "command_success": false, "process_in_blocks": "0"}
[0m11:20:49.037072 [debug] [MainThread]: Command `dbt run` failed at 11:20:49.036938 after 0.80 seconds
[0m11:20:49.037477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f793ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724fb494dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724fb494450>]}
[0m11:20:49.037838 [debug] [MainThread]: Flushing usage events
[0m11:21:11.711897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b15dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b13f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b13f8d0>]}


============================== 11:21:11.714532 | e7c406a9-aae3-4521-abf8-a453c4f5ea79 ==============================
[0m11:21:11.714532 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:21:11.715148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_billing', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:11.859419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437980fa90>]}
[0m11:21:11.906904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7343798812d0>]}
[0m11:21:11.907627 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:21:11.917064 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:21:12.008145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:21:12.008673 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:21:12.199531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437951f190>]}
[0m11:21:12.264963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7343795a99d0>]}
[0m11:21:12.265470 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:21:12.265758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7343795d3410>]}
[0m11:21:12.267261 [info ] [MainThread]: 
[0m11:21:12.267841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:21:12.269053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:21:12.305694 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:21:12.306060 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:21:12.306353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:12.311110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:21:12.312458 [debug] [ThreadPool]: On list_my_db: Close
[0m11:21:12.317322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:21:12.323121 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:21:12.323461 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:21:12.323719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:12.326917 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.327332 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:21:12.327671 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:21:12.330188 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:21:12.331676 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:21:12.332130 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:21:12.339616 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.339954 [debug] [MainThread]: On master: BEGIN
[0m11:21:12.340205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:21:12.343366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.343725 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.344086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:21:12.356165 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:21:12.358362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734379897cd0>]}
[0m11:21:12.358756 [debug] [MainThread]: On master: ROLLBACK
[0m11:21:12.359206 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.359498 [debug] [MainThread]: On master: BEGIN
[0m11:21:12.360147 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.360521 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.360785 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.361050 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.361470 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:21:12.361745 [debug] [MainThread]: On master: Close
[0m11:21:12.362192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:12.362593 [info ] [MainThread]: 
[0m11:21:12.364717 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:21:12.365412 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:21:12.365913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:21:12.366343 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:21:12.374627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:21:12.375196 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:21:12.411820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:21:12.412851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.413378 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:21:12.413736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:12.416889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.417318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.417714 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") as total_amount
from billing
group by Invoice_id,Patient_id,Procedure
order by total_amount desc
  );
[0m11:21:12.419811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:21:12.425853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.426240 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m11:21:12.426931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:21:12.441003 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:21:12.441439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.441746 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:21:12.449539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:21:12.455766 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m11:21:12.460450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.460813 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m11:21:12.461369 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:21:12.463556 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:21:12.465533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734379182bd0>]}
[0m11:21:12.466473 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m11:21:12.467138 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:21:12.468370 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.468667 [debug] [MainThread]: On master: BEGIN
[0m11:21:12.468916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:21:12.471756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.472225 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.472548 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.472899 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.473313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:21:12.473657 [debug] [MainThread]: On master: Close
[0m11:21:12.474160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:12.474558 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:21:12.474959 [info ] [MainThread]: 
[0m11:21:12.475346 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m11:21:12.476400 [debug] [MainThread]: Command end result
[0m11:21:12.505160 [info ] [MainThread]: 
[0m11:21:12.505628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:12.505980 [info ] [MainThread]: 
[0m11:21:12.506332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:21:12.507106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8374216, "process_user_time": 1.954775, "process_kernel_time": 0.139912, "process_mem_max_rss": "113536", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:21:12.507576 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:12.507471 after 0.84 seconds
[0m11:21:12.507899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b16b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437f22d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437ef34710>]}
[0m11:21:12.508210 [debug] [MainThread]: Flushing usage events
[0m11:26:22.470091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec24f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec24f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58edf58f90>]}


============================== 11:26:22.472658 | 943fc1bb-ef01-44d3-9684-83a27217eb88 ==============================
[0m11:26:22.472658 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:26:22.473189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_billing', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:26:22.600109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec133510>]}
[0m11:26:22.645913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58eff55010>]}
[0m11:26:22.646600 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:26:22.655397 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:26:22.748872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:26:22.749424 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:26:22.941308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea8313d0>]}
[0m11:26:23.007500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea6cbb90>]}
[0m11:26:23.007947 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:26:23.008247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea9c8050>]}
[0m11:26:23.009670 [info ] [MainThread]: 
[0m11:26:23.010221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:26:23.011068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:26:23.048647 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:26:23.049043 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:26:23.049345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:23.053910 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:26:23.055197 [debug] [ThreadPool]: On list_my_db: Close
[0m11:26:23.060020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:26:23.066093 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:26:23.066464 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:26:23.066721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:23.069850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.070208 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:26:23.070540 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:26:23.073033 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:26:23.074462 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:26:23.074895 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:26:23.081879 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.082226 [debug] [MainThread]: On master: BEGIN
[0m11:26:23.082491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:23.085491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.085848 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.086203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:26:23.099228 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m11:26:23.101833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea570890>]}
[0m11:26:23.102285 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:23.102788 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.103084 [debug] [MainThread]: On master: BEGIN
[0m11:26:23.103719 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.104046 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.104313 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.104586 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.105015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:26:23.105302 [debug] [MainThread]: On master: Close
[0m11:26:23.105827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:23.106197 [info ] [MainThread]: 
[0m11:26:23.108323 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:26:23.108879 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:26:23.109461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:26:23.109872 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:26:23.118177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:26:23.118792 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:26:23.155040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:26:23.155673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.156025 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:26:23.156348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:23.159448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.159963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.160301 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc
  );
[0m11:26:23.162223 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:26:23.168979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.169383 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m11:26:23.170138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:26:23.173495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.173904 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m11:26:23.174639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:26:23.190890 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:26:23.191281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.191582 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:26:23.243083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:26:23.256214 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m11:26:23.267044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.268056 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m11:26:23.270764 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:26:23.275413 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:26:23.277938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea62e210>]}
[0m11:26:23.279013 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.17s]
[0m11:26:23.280048 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:26:23.281955 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.282618 [debug] [MainThread]: On master: BEGIN
[0m11:26:23.283216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:23.287947 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.288560 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.289053 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.289489 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.290166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:26:23.290620 [debug] [MainThread]: On master: Close
[0m11:26:23.291152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:23.291503 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:26:23.291875 [info ] [MainThread]: 
[0m11:26:23.292296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:26:23.293291 [debug] [MainThread]: Command end result
[0m11:26:23.324326 [info ] [MainThread]: 
[0m11:26:23.324801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:23.325114 [info ] [MainThread]: 
[0m11:26:23.325452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:26:23.326195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8973367, "process_user_time": 1.977134, "process_kernel_time": 0.12463, "process_mem_max_rss": "113564", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:26:23.326712 [debug] [MainThread]: Command `dbt run` succeeded at 11:26:23.326601 after 0.90 seconds
[0m11:26:23.327045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58eea5df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec27aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58f033d890>]}
[0m11:26:23.327392 [debug] [MainThread]: Flushing usage events
[0m11:27:38.066570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db5f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db151d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133ed3cd10>]}


============================== 11:27:38.070028 | c8866c99-42f0-4d5e-8a38-9c3872488e78 ==============================
[0m11:27:38.070028 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:27:38.070576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_billing', 'send_anonymous_usage_stats': 'True'}
[0m11:27:38.204898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c1ef710>]}
[0m11:27:38.251370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db1e550>]}
[0m11:27:38.252107 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:27:38.261120 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:27:38.354027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:27:38.354603 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:27:38.548262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c21d7d0>]}
[0m11:27:38.614921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c060e10>]}
[0m11:27:38.615436 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:27:38.615740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133bf9f550>]}
[0m11:27:38.617152 [info ] [MainThread]: 
[0m11:27:38.617666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:27:38.618542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:27:38.656211 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:27:38.656637 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:27:38.656892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:38.661953 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:27:38.663288 [debug] [ThreadPool]: On list_my_db: Close
[0m11:27:38.668077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:27:38.673912 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:27:38.674267 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:27:38.674544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:38.677710 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.678082 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:27:38.678397 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:27:38.680876 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:27:38.682299 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:27:38.682767 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:27:38.689661 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.690070 [debug] [MainThread]: On master: BEGIN
[0m11:27:38.690445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:38.693479 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.693850 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.694211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:27:38.707161 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m11:27:38.709528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133aff85d0>]}
[0m11:27:38.709968 [debug] [MainThread]: On master: ROLLBACK
[0m11:27:38.710401 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.710666 [debug] [MainThread]: On master: BEGIN
[0m11:27:38.711250 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.711575 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.711838 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.712093 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.712506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:27:38.712819 [debug] [MainThread]: On master: Close
[0m11:27:38.713518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:27:38.713918 [info ] [MainThread]: 
[0m11:27:38.716104 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:27:38.716617 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:27:38.717095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:27:38.717583 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:27:38.726156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:27:38.726741 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:27:38.763662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:27:38.764250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.764587 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:27:38.764893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:38.768289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.768844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.769182 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select distinct
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc
  );
[0m11:27:38.771248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:27:38.778171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.778569 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m11:27:38.779276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:27:38.782464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.782842 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m11:27:38.783547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:27:38.799639 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:27:38.800059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.800349 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:27:38.822437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:27:38.829044 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m11:27:38.834293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.834761 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m11:27:38.836408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:27:38.838628 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:27:38.840108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c28a490>]}
[0m11:27:38.840864 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m11:27:38.841526 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:27:38.842603 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.842929 [debug] [MainThread]: On master: BEGIN
[0m11:27:38.843203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:27:38.846359 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.846797 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.847139 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.847475 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.847985 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:27:38.848482 [debug] [MainThread]: On master: Close
[0m11:27:38.849036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:38.849455 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:27:38.849918 [info ] [MainThread]: 
[0m11:27:38.850601 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m11:27:38.851512 [debug] [MainThread]: Command end result
[0m11:27:38.883600 [info ] [MainThread]: 
[0m11:27:38.884081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:27:38.884400 [info ] [MainThread]: 
[0m11:27:38.884725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:27:38.885470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86453736, "process_user_time": 1.914386, "process_kernel_time": 0.138955, "process_mem_max_rss": "113700", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:27:38.885929 [debug] [MainThread]: Command `dbt run` succeeded at 11:27:38.885826 after 0.87 seconds
[0m11:27:38.886253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db6ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133dcec110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7213419007d0>]}
[0m11:27:38.886578 [debug] [MainThread]: Flushing usage events
[0m11:38:54.023890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcaaffb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcac97690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcac97890>]}


============================== 11:38:54.026456 | 44fc3166-84c7-4efe-a438-4c47ce2c1309 ==============================
[0m11:38:54.026456 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:38:54.026965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_doctor', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:38:54.156675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffca9c7d10>]}
[0m11:38:54.203108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc9234510>]}
[0m11:38:54.203829 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:38:54.213081 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:38:54.310764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:54.311352 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m11:38:54.506186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc9076710>]}
[0m11:38:54.573537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc8b0c890>]}
[0m11:38:54.573985 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:38:54.574317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc8f83410>]}
[0m11:38:54.575772 [info ] [MainThread]: 
[0m11:38:54.576361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:54.577214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:38:54.615512 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:38:54.615896 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:38:54.616155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:54.621002 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:38:54.622430 [debug] [ThreadPool]: On list_my_db: Close
[0m11:38:54.627235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:38:54.632982 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:38:54.633316 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:38:54.633587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:54.636935 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.637310 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:38:54.637629 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:38:54.640075 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:38:54.641513 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:38:54.641946 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:38:54.648757 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.649092 [debug] [MainThread]: On master: BEGIN
[0m11:38:54.649354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:54.652596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.652963 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.653319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:38:54.666384 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m11:38:54.668770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc8f06750>]}
[0m11:38:54.669158 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:54.669604 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.669878 [debug] [MainThread]: On master: BEGIN
[0m11:38:54.670427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.670727 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.670983 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.671242 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.671630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:38:54.671921 [debug] [MainThread]: On master: Close
[0m11:38:54.672456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:54.672917 [info ] [MainThread]: 
[0m11:38:54.674975 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_doctor
[0m11:38:54.675502 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_doctor .................................. [RUN]
[0m11:38:54.676089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_doctor)
[0m11:38:54.676466 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_doctor
[0m11:38:54.684654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_doctor"
[0m11:38:54.685177 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_doctor
[0m11:38:54.721844 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_doctor"
[0m11:38:54.722413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.722759 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: BEGIN
[0m11:38:54.723058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:54.726359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.726814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.727152 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */

  create view "my_db"."public"."dim_doctor__dbt_tmp"
    
    
  as (
    with doctor as (
    select * from "my_db"."public"."stg_doctor"
)

select * from doctor
  );
[0m11:38:54.728725 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:38:54.735077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.735534 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor__dbt_tmp" rename to "dim_doctor"
[0m11:38:54.736244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:38:54.750111 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:38:54.750516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.750815 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:38:54.802935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:38:54.820140 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_doctor__dbt_backup"
[0m11:38:54.832127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.832908 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
drop view if exists "my_db"."public"."dim_doctor__dbt_backup" cascade
[0m11:38:54.833823 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:38:54.837543 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: Close
[0m11:38:54.840167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc82b2350>]}
[0m11:38:54.841151 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_doctor ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:38:54.842071 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_doctor
[0m11:38:54.843487 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.843866 [debug] [MainThread]: On master: BEGIN
[0m11:38:54.844174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:54.847553 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.847997 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.848295 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.848595 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.849091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:38:54.849602 [debug] [MainThread]: On master: Close
[0m11:38:54.850170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:54.850604 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_doctor' was properly closed.
[0m11:38:54.851082 [info ] [MainThread]: 
[0m11:38:54.851497 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:38:54.852420 [debug] [MainThread]: Command end result
[0m11:38:54.880434 [info ] [MainThread]: 
[0m11:38:54.880925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:54.881283 [info ] [MainThread]: 
[0m11:38:54.881622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:38:54.882413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9002047, "process_user_time": 1.856005, "process_kernel_time": 0.140924, "process_mem_max_rss": "113736", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m11:38:54.882901 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:54.882793 after 0.90 seconds
[0m11:38:54.883236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcaca4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffce904710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcea60d90>]}
[0m11:38:54.883585 [debug] [MainThread]: Flushing usage events
[0m11:42:53.066637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53144d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc532c7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53147110>]}


============================== 11:42:53.069258 | 503734ea-e002-4163-9bd7-12488159565c ==============================
[0m11:42:53.069258 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:42:53.069788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_medical_procedure', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:42:53.201302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53144f90>]}
[0m11:42:53.247661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc56e3d0d0>]}
[0m11:42:53.248401 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:42:53.257628 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:42:53.352643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:53.353171 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:42:53.545340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc5171f4d0>]}
[0m11:42:53.611141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc51513410>]}
[0m11:42:53.611639 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:42:53.611922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc516e8690>]}
[0m11:42:53.613359 [info ] [MainThread]: 
[0m11:42:53.614042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:42:53.614977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:42:53.652723 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:42:53.653060 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:42:53.653311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:53.658003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:42:53.659472 [debug] [ThreadPool]: On list_my_db: Close
[0m11:42:53.664507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:42:53.670256 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:42:53.670601 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:42:53.670854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:53.674122 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.674532 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:42:53.674824 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:42:53.677238 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m11:42:53.678687 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:42:53.679268 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:42:53.686364 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.686703 [debug] [MainThread]: On master: BEGIN
[0m11:42:53.686956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:53.690035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.690433 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.690792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:42:53.704680 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m11:42:53.707302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc509dabd0>]}
[0m11:42:53.707743 [debug] [MainThread]: On master: ROLLBACK
[0m11:42:53.708213 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.708495 [debug] [MainThread]: On master: BEGIN
[0m11:42:53.709093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.709396 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.709676 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.709916 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.710375 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:42:53.710670 [debug] [MainThread]: On master: Close
[0m11:42:53.711122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:53.711495 [info ] [MainThread]: 
[0m11:42:53.713752 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.714301 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:42:53.714795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:42:53.715168 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.723358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.723893 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.760310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.761037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.761401 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:42:53.761708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:53.764901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.765387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.765824 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select 
    Procedure_id,
    Procedure_name over (partition by Procedure_name),
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:42:53.766471 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "over"
LINE 16:     Procedure_name over (partition by Procedure_name),
                            ^

[0m11:42:53.766880 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: ROLLBACK
[0m11:42:53.767388 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:42:53.771371 [debug] [Thread-1 (]: Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "over"
  LINE 16:     Procedure_name over (partition by Procedure_name),
                              ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m11:42:53.772827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc5055b290>]}
[0m11:42:53.773440 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_medical_procedure .............. [[31mERROR[0m in 0.06s]
[0m11:42:53.774088 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.775846 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.776253 [debug] [MainThread]: On master: BEGIN
[0m11:42:53.776630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:53.779548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.779992 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.780284 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.780561 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.780942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:42:53.781220 [debug] [MainThread]: On master: Close
[0m11:42:53.781773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:53.782076 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:42:53.782408 [info ] [MainThread]: 
[0m11:42:53.782837 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:42:53.783955 [debug] [MainThread]: Command end result
[0m11:42:53.812664 [info ] [MainThread]: 
[0m11:42:53.813292 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:42:53.813670 [info ] [MainThread]: 
[0m11:42:53.814093 [error] [MainThread]:   Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "over"
  LINE 16:     Procedure_name over (partition by Procedure_name),
                              ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m11:42:53.814427 [info ] [MainThread]: 
[0m11:42:53.814793 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:42:53.815548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79069024, "process_user_time": 1.790024, "process_kernel_time": 0.135623, "process_mem_max_rss": "114248", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m11:42:53.816017 [debug] [MainThread]: Command `dbt run` failed at 11:42:53.815914 after 0.79 seconds
[0m11:42:53.816363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53153310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc532c7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc515216d0>]}
[0m11:42:53.816696 [debug] [MainThread]: Flushing usage events
[0m11:45:05.434688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d5630dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d5631f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d5633dd0>]}


============================== 11:45:05.437215 | ffd151f8-4258-493a-b92e-4dab4df6dcf6 ==============================
[0m11:45:05.437215 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:45:05.437755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:05.565877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d55e8c50>]}
[0m11:45:05.612301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d92e4650>]}
[0m11:45:05.612999 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:45:05.622197 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:45:05.718464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:05.719034 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:45:05.913069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d3cf5510>]}
[0m11:45:05.979749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d39e0810>]}
[0m11:45:05.980237 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:45:05.980542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d3a77450>]}
[0m11:45:05.982169 [info ] [MainThread]: 
[0m11:45:05.982802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:05.983748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:45:06.022358 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:45:06.022763 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:45:06.023013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:06.028233 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:45:06.029631 [debug] [ThreadPool]: On list_my_db: Close
[0m11:45:06.034621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:45:06.040674 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:06.041165 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:45:06.041435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:06.045093 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.045501 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:06.045799 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:45:06.048508 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m11:45:06.049979 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:45:06.050408 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:45:06.057350 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.057706 [debug] [MainThread]: On master: BEGIN
[0m11:45:06.057960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:06.061153 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.061520 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.061891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:06.075766 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m11:45:06.078368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d39e3750>]}
[0m11:45:06.078793 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:06.079283 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.079581 [debug] [MainThread]: On master: BEGIN
[0m11:45:06.080162 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.080490 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.080771 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.081037 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.081514 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:06.081808 [debug] [MainThread]: On master: Close
[0m11:45:06.082330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:06.082683 [info ] [MainThread]: 
[0m11:45:06.084831 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.085412 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:45:06.085876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:45:06.086321 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.095065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.095896 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.131494 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.132100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.132446 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:45:06.132753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:06.136011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.136419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.136787 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select 
    Procedure_id,
    count(*) over (partition by Procedure_name) as procedure_count,
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:45:06.138701 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:45:06.145187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.145666 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m11:45:06.146408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:06.159885 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:06.160295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.160594 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:06.212007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:06.222278 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m11:45:06.230521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.231249 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m11:45:06.232399 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:45:06.235930 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:45:06.238104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d3c9f010>]}
[0m11:45:06.239093 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.15s]
[0m11:45:06.239924 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.241321 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.241739 [debug] [MainThread]: On master: BEGIN
[0m11:45:06.242076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:06.245331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.245867 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.246173 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.246452 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.246898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:06.247365 [debug] [MainThread]: On master: Close
[0m11:45:06.247977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:06.248479 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:45:06.249042 [info ] [MainThread]: 
[0m11:45:06.249611 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:45:06.250458 [debug] [MainThread]: Command end result
[0m11:45:06.280183 [info ] [MainThread]: 
[0m11:45:06.280659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:06.280988 [info ] [MainThread]: 
[0m11:45:06.281316 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:06.282063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.88987124, "process_user_time": 1.8803, "process_kernel_time": 0.132021, "process_mem_max_rss": "113264", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:45:06.282536 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:06.282432 after 0.89 seconds
[0m11:45:06.282853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d563fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d563f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d93d4550>]}
[0m11:45:06.283179 [debug] [MainThread]: Flushing usage events
[0m11:45:55.649480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14a897d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14ad0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14a8a550>]}


============================== 11:45:55.652411 | 590cec82-7865-4a61-a6c4-d447cd18193f ==============================
[0m11:45:55.652411 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:45:55.652915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_medical_procedure', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:55.788280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c131805d0>]}
[0m11:45:55.834401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c18794650>]}
[0m11:45:55.835129 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:45:55.843941 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:45:55.936169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:55.936767 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:45:56.154181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c149a2250>]}
[0m11:45:56.233799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c131a9d90>]}
[0m11:45:56.234457 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:45:56.234939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c149a1d50>]}
[0m11:45:56.236722 [info ] [MainThread]: 
[0m11:45:56.237380 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:56.238327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:45:56.277828 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:45:56.278212 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:45:56.278622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:56.286317 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:45:56.288831 [debug] [ThreadPool]: On list_my_db: Close
[0m11:45:56.295640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:45:56.302197 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:56.302617 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:45:56.302891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:56.306398 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.306968 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:56.307369 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:45:56.310467 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:45:56.312115 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:45:56.312746 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:45:56.323325 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.323703 [debug] [MainThread]: On master: BEGIN
[0m11:45:56.323961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:56.327082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.327545 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.327932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:56.345817 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m11:45:56.349156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c131b64d0>]}
[0m11:45:56.349716 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:56.350216 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.350582 [debug] [MainThread]: On master: BEGIN
[0m11:45:56.351096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.351465 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.351740 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.351992 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.352390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:56.352703 [debug] [MainThread]: On master: Close
[0m11:45:56.353184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:56.353553 [info ] [MainThread]: 
[0m11:45:56.355608 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.356211 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:45:56.357804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:45:56.358245 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.367662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.368432 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.408656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.409310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.409705 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:45:56.410051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:56.414086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.414891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.415325 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select 
    Procedure_id,
    count(*) over (partition by Procedure_name) as procedure_count,
    Procedure_name,
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:45:56.417390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:45:56.423951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.424403 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m11:45:56.425083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:56.428139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.428602 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m11:45:56.429666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:56.448542 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:56.448986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.449368 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:56.500560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:56.507113 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m11:45:56.512102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.512835 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m11:45:56.515007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:45:56.517594 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:45:56.519606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c12b0bdd0>]}
[0m11:45:56.520470 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:45:56.521115 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.522244 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.522595 [debug] [MainThread]: On master: BEGIN
[0m11:45:56.522848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:56.525838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.526264 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.526674 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.526945 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.527377 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:56.527730 [debug] [MainThread]: On master: Close
[0m11:45:56.528180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:56.528491 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:45:56.529027 [info ] [MainThread]: 
[0m11:45:56.529770 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m11:45:56.531876 [debug] [MainThread]: Command end result
[0m11:45:56.566940 [info ] [MainThread]: 
[0m11:45:56.567699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:56.568076 [info ] [MainThread]: 
[0m11:45:56.568468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:56.569317 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9626546, "process_user_time": 1.90781, "process_kernel_time": 0.136842, "process_mem_max_rss": "113312", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:45:56.569820 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:56.569713 after 0.96 seconds
[0m11:45:56.570187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14d60310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c188845d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c18a08d90>]}
[0m11:45:56.570560 [debug] [MainThread]: Flushing usage events
[0m11:46:42.843165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b85ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316d07550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b86b10>]}


============================== 11:46:42.847541 | ac319a10-0144-4108-b519-c586b4bb3574 ==============================
[0m11:46:42.847541 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:46:42.849472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:46:43.014881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b3cc50>]}
[0m11:46:43.084396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b55550>]}
[0m11:46:43.085183 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:46:43.095223 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:46:43.219212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:46:43.219803 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:46:43.442720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7383150f9910>]}
[0m11:46:43.517982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738314f8c910>]}
[0m11:46:43.518446 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:46:43.518791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738314ff3450>]}
[0m11:46:43.520223 [info ] [MainThread]: 
[0m11:46:43.520775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:43.521587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:46:43.560227 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:46:43.560773 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:46:43.561093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:43.567850 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:46:43.569125 [debug] [ThreadPool]: On list_my_db: Close
[0m11:46:43.574377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:46:43.580495 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:46:43.580889 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:46:43.581184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:43.585045 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.585519 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:46:43.585932 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:46:43.588871 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:46:43.590554 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:46:43.591134 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:46:43.600636 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.601109 [debug] [MainThread]: On master: BEGIN
[0m11:46:43.601479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:43.604748 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.605110 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.605546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:46:43.623364 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m11:46:43.626520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7383143d6150>]}
[0m11:46:43.626922 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:43.627386 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.627662 [debug] [MainThread]: On master: BEGIN
[0m11:46:43.628280 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.628618 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.628893 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.629157 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.630099 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:46:43.631183 [debug] [MainThread]: On master: Close
[0m11:46:43.632183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:43.632799 [info ] [MainThread]: 
[0m11:46:43.635775 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.636536 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:46:43.638136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:46:43.638714 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.647014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.648025 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.694911 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.695714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.696258 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:46:43.697011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:43.701702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.702160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.702628 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select distinct
    Procedure_id,
    Procedure_name,
    count(*) over (partition by Procedure_name) as procedure_count,
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:46:43.705415 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:46:43.712889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.714553 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m11:46:43.715830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:46:43.719803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.720253 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m11:46:43.721024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:46:43.740342 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:46:43.740783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.741103 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:46:43.749510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:46:43.756667 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m11:46:43.761821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.762254 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m11:46:43.764491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:46:43.767033 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:46:43.768824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73831429dc10>]}
[0m11:46:43.769689 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.13s]
[0m11:46:43.770508 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.771878 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.772357 [debug] [MainThread]: On master: BEGIN
[0m11:46:43.772704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:43.775937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.776424 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.777002 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.777587 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.778400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:46:43.779086 [debug] [MainThread]: On master: Close
[0m11:46:43.780265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:43.780985 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:46:43.781667 [info ] [MainThread]: 
[0m11:46:43.782439 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m11:46:43.784568 [debug] [MainThread]: Command end result
[0m11:46:43.839472 [info ] [MainThread]: 
[0m11:46:43.840106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:43.840497 [info ] [MainThread]: 
[0m11:46:43.840852 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:46:43.842114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0584965, "process_user_time": 2.240232, "process_kernel_time": 0.133894, "process_mem_max_rss": "113524", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:46:43.842962 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:43.842780 after 1.06 seconds
[0m11:46:43.843415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b85410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73831a970690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73831aacc350>]}
[0m11:46:43.843889 [debug] [MainThread]: Flushing usage events
[0m11:51:40.514523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47a0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47838d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f4759850>]}


============================== 11:51:40.517126 | b284c6ed-b76c-4d57-bd5a-c294a8ad358f ==============================
[0m11:51:40.517126 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:51:40.517615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_patient', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:40.643003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47cfd10>]}
[0m11:51:40.688875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f8470ed0>]}
[0m11:51:40.689599 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:51:40.698638 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:51:40.789743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:51:40.790280 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m11:51:40.981785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f2d34310>]}
[0m11:51:41.047130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f2b5aa10>]}
[0m11:51:41.047589 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:51:41.047926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f61e6310>]}
[0m11:51:41.049383 [info ] [MainThread]: 
[0m11:51:41.050046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:51:41.050871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:51:41.087677 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:51:41.088044 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:51:41.088299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:41.092637 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:51:41.093942 [debug] [ThreadPool]: On list_my_db: Close
[0m11:51:41.098999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:51:41.104817 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:51:41.105146 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:51:41.105428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:41.108445 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.108820 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:51:41.109107 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:51:41.111554 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:51:41.113137 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:51:41.113625 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:51:41.121035 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.121378 [debug] [MainThread]: On master: BEGIN
[0m11:51:41.121628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:51:41.124874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.125218 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.125599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:51:41.140300 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m11:51:41.143123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f2d17450>]}
[0m11:51:41.143533 [debug] [MainThread]: On master: ROLLBACK
[0m11:51:41.144011 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.144303 [debug] [MainThread]: On master: BEGIN
[0m11:51:41.144987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.145297 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.145630 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.145904 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.146309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:51:41.146617 [debug] [MainThread]: On master: Close
[0m11:51:41.147069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:41.147409 [info ] [MainThread]: 
[0m11:51:41.149804 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m11:51:41.150474 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m11:51:41.151974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m11:51:41.152382 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m11:51:41.159916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m11:51:41.160463 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m11:51:41.197954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m11:51:41.198546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.198866 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m11:51:41.199152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:41.202414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.202859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.203205 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
)
select * from patient
  );
[0m11:51:41.204911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:51:41.210859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.211287 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m11:51:41.212061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:51:41.225926 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:51:41.226418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.226757 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:51:41.278265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:51:41.292635 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_patient__dbt_backup"
[0m11:51:41.304759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.305729 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
drop view if exists "my_db"."public"."dim_patient__dbt_backup" cascade
[0m11:51:41.307074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:51:41.311475 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m11:51:41.314020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f1fccf10>]}
[0m11:51:41.315060 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_patient ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m11:51:41.316105 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m11:51:41.318028 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.318502 [debug] [MainThread]: On master: BEGIN
[0m11:51:41.318843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:41.322800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.323397 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.323845 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.324206 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.324741 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:51:41.325081 [debug] [MainThread]: On master: Close
[0m11:51:41.325768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:41.326149 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m11:51:41.326561 [info ] [MainThread]: 
[0m11:51:41.326918 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:51:41.328024 [debug] [MainThread]: Command end result
[0m11:51:41.359501 [info ] [MainThread]: 
[0m11:51:41.360011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:41.360360 [info ] [MainThread]: 
[0m11:51:41.360723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:41.361520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.88750935, "process_user_time": 1.82379, "process_kernel_time": 0.134689, "process_mem_max_rss": "113676", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m11:51:41.362088 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:41.361927 after 0.89 seconds
[0m11:51:41.362562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47ad710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f8859890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f8560710>]}
[0m11:51:41.362954 [debug] [MainThread]: Flushing usage events
[0m11:52:38.046749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750902946d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750902981a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750902980250>]}


============================== 11:52:38.049385 | ae2932f6-324b-4ab4-af4c-f2f93781e73c ==============================
[0m11:52:38.049385 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:52:38.049880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_patient', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:52:38.194064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75090284cc10>]}
[0m11:52:38.242923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750906641010>]}
[0m11:52:38.243640 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:52:38.253129 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:52:38.345493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:38.346067 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m11:52:38.543692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509010ba150>]}
[0m11:52:38.609265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750900d48790>]}
[0m11:52:38.609729 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:52:38.610043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509035de090>]}
[0m11:52:38.611439 [info ] [MainThread]: 
[0m11:52:38.611965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:52:38.612882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:52:38.651312 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:52:38.651685 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:52:38.651945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:38.665022 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:52:38.666357 [debug] [ThreadPool]: On list_my_db: Close
[0m11:52:38.671189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:52:38.676860 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:52:38.677166 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:52:38.677425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:38.680956 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.681386 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:52:38.681727 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:52:38.684307 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m11:52:38.685823 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:52:38.686298 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:52:38.694332 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.694720 [debug] [MainThread]: On master: BEGIN
[0m11:52:38.695002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:38.698247 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.698609 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.698980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:52:38.714205 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m11:52:38.717119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750900d7cb50>]}
[0m11:52:38.717503 [debug] [MainThread]: On master: ROLLBACK
[0m11:52:38.717967 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.718239 [debug] [MainThread]: On master: BEGIN
[0m11:52:38.718821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.719103 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.719384 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.719644 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.720039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:52:38.720321 [debug] [MainThread]: On master: Close
[0m11:52:38.720789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:38.721166 [info ] [MainThread]: 
[0m11:52:38.723223 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m11:52:38.723809 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m11:52:38.725325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m11:52:38.725814 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m11:52:38.733760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m11:52:38.734392 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m11:52:38.770461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m11:52:38.771131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.771536 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m11:52:38.771846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:38.775608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.776041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.776432 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
)
select * from patient
order by patient_id
  );
[0m11:52:38.778125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:52:38.784816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.785242 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient" rename to "dim_patient__dbt_backup"
[0m11:52:38.785963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:52:38.788964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.789314 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m11:52:38.790066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:52:38.805768 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:52:38.806167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.806505 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:52:38.814472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:52:38.820887 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_patient__dbt_backup"
[0m11:52:38.825792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.826168 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
drop view if exists "my_db"."public"."dim_patient__dbt_backup" cascade
[0m11:52:38.827896 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:52:38.830200 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m11:52:38.831623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ffd83a50>]}
[0m11:52:38.832526 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_patient ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m11:52:38.833218 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m11:52:38.834530 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.834821 [debug] [MainThread]: On master: BEGIN
[0m11:52:38.835072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:38.838248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.838664 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.838973 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.839353 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.839912 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:52:38.840387 [debug] [MainThread]: On master: Close
[0m11:52:38.841005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:38.841354 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m11:52:38.841719 [info ] [MainThread]: 
[0m11:52:38.842543 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m11:52:38.843509 [debug] [MainThread]: Command end result
[0m11:52:38.872281 [info ] [MainThread]: 
[0m11:52:38.872829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:38.873196 [info ] [MainThread]: 
[0m11:52:38.873545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:52:38.874302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86895895, "process_user_time": 1.969374, "process_kernel_time": 0.124896, "process_mem_max_rss": "113484", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m11:52:38.874806 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:38.874695 after 0.87 seconds
[0m11:52:38.875137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509067307d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509068b44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509068b4e10>]}
[0m11:52:38.875498 [debug] [MainThread]: Flushing usage events
[0m11:53:13.933516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299df7c7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299df7f1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299df7ebe90>]}


============================== 11:53:13.936202 | 9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b ==============================
[0m11:53:13.936202 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:53:13.936737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_doctor', 'send_anonymous_usage_stats': 'True'}
[0m11:53:14.073425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299ddb13b50>]}
[0m11:53:14.122971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299e17ecc10>]}
[0m11:53:14.123754 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:14.132836 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:53:14.226651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:14.227230 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m11:53:14.420755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dc263ad0>]}
[0m11:53:14.489989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dbf58d10>]}
[0m11:53:14.490490 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:53:14.490786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dc021610>]}
[0m11:53:14.492262 [info ] [MainThread]: 
[0m11:53:14.492790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:14.493694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:53:14.531210 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:53:14.532652 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:53:14.532961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:14.537369 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:53:14.538650 [debug] [ThreadPool]: On list_my_db: Close
[0m11:53:14.543623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:53:14.549439 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:53:14.549801 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:53:14.550053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:14.553181 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.553604 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:53:14.553898 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:53:14.556372 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m11:53:14.557808 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:53:14.558215 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:53:14.565700 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.566048 [debug] [MainThread]: On master: BEGIN
[0m11:53:14.566301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:14.569494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.569851 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.570221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:14.585651 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m11:53:14.588677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299ddabe910>]}
[0m11:53:14.589063 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:14.589565 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.589835 [debug] [MainThread]: On master: BEGIN
[0m11:53:14.590362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.590681 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.590959 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.591223 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.591602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:14.591922 [debug] [MainThread]: On master: Close
[0m11:53:14.592374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:14.592697 [info ] [MainThread]: 
[0m11:53:14.594809 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_doctor
[0m11:53:14.595379 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_doctor .................................. [RUN]
[0m11:53:14.596966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_doctor)
[0m11:53:14.597421 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_doctor
[0m11:53:14.604854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_doctor"
[0m11:53:14.605501 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_doctor
[0m11:53:14.640658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_doctor"
[0m11:53:14.641272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.641623 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: BEGIN
[0m11:53:14.641974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:14.645555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.646021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.646413 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */

  create view "my_db"."public"."dim_doctor__dbt_tmp"
    
    
  as (
    with doctor as (
    select * from "my_db"."public"."stg_doctor"
)

select * from doctor 
order by doctor_id
  );
[0m11:53:14.648554 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:53:14.654965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.655379 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor" rename to "dim_doctor__dbt_backup"
[0m11:53:14.656076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:14.659105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.659474 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor__dbt_tmp" rename to "dim_doctor"
[0m11:53:14.660145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:14.676186 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:53:14.676644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.676961 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:53:14.685010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:14.691173 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_doctor__dbt_backup"
[0m11:53:14.695843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.696201 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
drop view if exists "my_db"."public"."dim_doctor__dbt_backup" cascade
[0m11:53:14.697877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:53:14.700149 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: Close
[0m11:53:14.701797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299daf38f10>]}
[0m11:53:14.702756 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_doctor ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m11:53:14.703486 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_doctor
[0m11:53:14.704722 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.705025 [debug] [MainThread]: On master: BEGIN
[0m11:53:14.705277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:14.708429 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.708807 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.709146 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.709436 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.709838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:14.710211 [debug] [MainThread]: On master: Close
[0m11:53:14.710804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:14.711267 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_doctor' was properly closed.
[0m11:53:14.711891 [info ] [MainThread]: 
[0m11:53:14.712823 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:53:14.713755 [debug] [MainThread]: Command end result
[0m11:53:14.741645 [info ] [MainThread]: 
[0m11:53:14.742119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:14.742451 [info ] [MainThread]: 
[0m11:53:14.742783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:53:14.743514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8571896, "process_user_time": 1.90009, "process_kernel_time": 0.114703, "process_mem_max_rss": "113948", "process_out_blocks": "2576", "process_in_blocks": "0"}
[0m11:53:14.743979 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:14.743876 after 0.86 seconds
[0m11:53:14.744295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dddfca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299ddc900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299e18dc790>]}
[0m11:53:14.744636 [debug] [MainThread]: Flushing usage events
[0m12:18:50.236117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab915a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab915a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab92f7990>]}


============================== 12:18:50.238643 | 0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4 ==============================
[0m12:18:50.238643 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:18:50.239170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:50.365889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab904ad90>]}
[0m12:18:50.411799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cabce54950>]}
[0m12:18:50.412538 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:18:50.421576 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:18:50.514686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:50.515241 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:18:50.708345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab903c790>]}
[0m12:18:50.775906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab75ee450>]}
[0m12:18:50.776388 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:18:50.776684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab771d590>]}
[0m12:18:50.778124 [info ] [MainThread]: 
[0m12:18:50.778645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:50.779497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:18:50.817454 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:18:50.817830 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:18:50.818138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:50.822977 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:18:50.824422 [debug] [ThreadPool]: On list_my_db: Close
[0m12:18:50.830112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:18:50.836517 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:18:50.836863 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:18:50.837129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:50.840366 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.840721 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:18:50.841041 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:18:50.843507 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:18:50.844950 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:18:50.845363 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:18:50.853399 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.853747 [debug] [MainThread]: On master: BEGIN
[0m12:18:50.854011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:50.857190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.857573 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.857925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:50.873212 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:18:50.876103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab76e3d10>]}
[0m12:18:50.876494 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:50.876980 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.877252 [debug] [MainThread]: On master: BEGIN
[0m12:18:50.877853 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.878144 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.878417 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.878664 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.879067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:18:50.879375 [debug] [MainThread]: On master: Close
[0m12:18:50.879796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:18:50.880111 [info ] [MainThread]: 
[0m12:18:50.881853 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:18:50.882363 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:18:50.884048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:18:50.884533 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:18:50.893712 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:18:50.894377 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:18:50.930501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:18:50.931371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:18:50.931727 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:18:50.932013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:50.935448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.935879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:18:50.936253 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select Patient_id
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
    "AppointmentID" as Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select Invoice_id
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    p.Patient_id,
    d.Doctor_id,
    p.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a
join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Procedure_id = pr.Procedure_id
join billing_data b on a.Invoice_id = b.Invoice_id
  );
[0m12:18:50.937297 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "AppointmentID" does not exist
LINE 25:     "AppointmentID" as Appointment_id
             ^

[0m12:18:50.937769 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:18:50.938270 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:18:50.942189 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column "AppointmentID" does not exist
  LINE 25:     "AppointmentID" as Appointment_id
               ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:18:50.943651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab6557dd0>]}
[0m12:18:50.944240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:18:50.944859 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:18:50.946505 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.946898 [debug] [MainThread]: On master: BEGIN
[0m12:18:50.947240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:50.950074 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.950545 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.950843 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.951147 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.951798 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:18:50.952245 [debug] [MainThread]: On master: Close
[0m12:18:50.952802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:50.953159 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:18:50.953646 [info ] [MainThread]: 
[0m12:18:50.954086 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:18:50.955008 [debug] [MainThread]: Command end result
[0m12:18:50.982432 [info ] [MainThread]: 
[0m12:18:50.982998 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:18:50.983432 [info ] [MainThread]: 
[0m12:18:50.983996 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column "AppointmentID" does not exist
  LINE 25:     "AppointmentID" as Appointment_id
               ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:18:50.984369 [info ] [MainThread]: 
[0m12:18:50.984726 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:18:50.985566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79080784, "process_user_time": 1.802767, "process_kernel_time": 0.13446, "process_mem_max_rss": "113968", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m12:18:50.986082 [debug] [MainThread]: Command `dbt run` failed at 12:18:50.985971 after 0.79 seconds
[0m12:18:50.986450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78caba59b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cabd0bcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cabd0bcc90>]}
[0m12:18:50.986776 [debug] [MainThread]: Flushing usage events
[0m12:19:40.526033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d6d3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d71a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d71a750>]}


============================== 12:19:40.528674 | 954252fe-dd6b-4c30-99ec-374673cef6bf ==============================
[0m12:19:40.528674 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:19:40.529259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fct_appointment', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:19:40.668867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bdffd50>]}
[0m12:19:40.716236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb613dcfd0>]}
[0m12:19:40.716920 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:19:40.726071 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:19:40.821803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:40.822387 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:19:41.015350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bd012d0>]}
[0m12:19:41.081750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bb59a10>]}
[0m12:19:41.082232 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:19:41.082557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5b7895d0>]}
[0m12:19:41.084007 [info ] [MainThread]: 
[0m12:19:41.084534 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:41.085388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:19:41.123561 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:19:41.123910 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:19:41.124171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:41.128632 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:19:41.129919 [debug] [ThreadPool]: On list_my_db: Close
[0m12:19:41.134749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:19:41.140488 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:19:41.140841 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:19:41.141088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:41.144409 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.144865 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:19:41.145158 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:19:41.147947 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:19:41.149471 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:19:41.149929 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:19:41.157314 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.157714 [debug] [MainThread]: On master: BEGIN
[0m12:19:41.157996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:41.161240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.161678 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.162056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:41.178032 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:19:41.181095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bab7810>]}
[0m12:19:41.181490 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:41.182005 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.182276 [debug] [MainThread]: On master: BEGIN
[0m12:19:41.182906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.183236 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.183525 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.183778 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.184198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:19:41.184495 [debug] [MainThread]: On master: Close
[0m12:19:41.184955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:41.185288 [info ] [MainThread]: 
[0m12:19:41.187579 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:19:41.188232 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:19:41.189763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:19:41.190172 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:19:41.199503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:19:41.200263 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:19:41.236056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:19:41.236647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:19:41.236966 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:19:41.237242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:41.240440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.240875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:19:41.241217 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select Patient_id
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select Invoice_id
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    p.Patient_id,
    d.Doctor_id,
    p.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a
join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Procedure_id = pr.Procedure_id
join billing_data b on a.Invoice_id = b.Invoice_id
  );
[0m12:19:41.242438 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.procedure_id does not exist
LINE 43: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                   ^
HINT:  Perhaps you meant to reference the column "pr.procedure_id".

[0m12:19:41.242877 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:19:41.243396 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:19:41.247698 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column a.procedure_id does not exist
  LINE 43: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                     ^
  HINT:  Perhaps you meant to reference the column "pr.procedure_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:19:41.249525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bdbbf10>]}
[0m12:19:41.250162 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:19:41.250779 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:19:41.252368 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.252661 [debug] [MainThread]: On master: BEGIN
[0m12:19:41.252914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:41.255880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.256314 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.256641 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.256892 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.257269 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:19:41.257586 [debug] [MainThread]: On master: Close
[0m12:19:41.258049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:41.258418 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:19:41.258801 [info ] [MainThread]: 
[0m12:19:41.259191 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:19:41.260359 [debug] [MainThread]: Command end result
[0m12:19:41.287079 [info ] [MainThread]: 
[0m12:19:41.287531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:19:41.287815 [info ] [MainThread]: 
[0m12:19:41.288182 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column a.procedure_id does not exist
  LINE 43: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                     ^
  HINT:  Perhaps you meant to reference the column "pr.procedure_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:19:41.288500 [info ] [MainThread]: 
[0m12:19:41.288805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:19:41.289527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8069918, "process_user_time": 2.004504, "process_kernel_time": 0.130706, "process_mem_max_rss": "113992", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m12:19:41.289990 [debug] [MainThread]: Command `dbt run` failed at 12:19:41.289876 after 0.81 seconds
[0m12:19:41.290321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d6d14d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d8a0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5a346750>]}
[0m12:19:41.290641 [debug] [MainThread]: Flushing usage events
[0m12:47:20.141865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a7549eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a7579cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a754837d0>]}


============================== 12:47:20.144375 | 12f43597-5425-4b42-9328-d57687a5ddaf ==============================
[0m12:47:20.144375 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:47:20.144884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m fct_appointment', 'send_anonymous_usage_stats': 'True'}
[0m12:47:20.273774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a75372d90>]}
[0m12:47:20.319879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a79190710>]}
[0m12:47:20.320611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:47:20.329946 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:47:20.421656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:20.422186 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:47:20.616182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a73c0ca50>]}
[0m12:47:20.682295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a73820990>]}
[0m12:47:20.682800 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:47:20.683077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a738b1d50>]}
[0m12:47:20.684556 [info ] [MainThread]: 
[0m12:47:20.685060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:20.685997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:47:20.723890 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:47:20.724239 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:47:20.724511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:20.728949 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:47:20.730249 [debug] [ThreadPool]: On list_my_db: Close
[0m12:47:20.735242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:47:20.741280 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:20.741644 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:47:20.741890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:20.745170 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.745574 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:20.745869 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:20.748313 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:47:20.749787 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:47:20.750217 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:47:20.757522 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.757871 [debug] [MainThread]: On master: BEGIN
[0m12:47:20.758113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:20.761384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.761786 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.762138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:20.777362 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:47:20.780220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a72ddb850>]}
[0m12:47:20.780608 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:20.781005 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.781292 [debug] [MainThread]: On master: BEGIN
[0m12:47:20.781872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.782219 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.782500 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.782746 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.783125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:20.783415 [debug] [MainThread]: On master: Close
[0m12:47:20.783837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:20.784131 [info ] [MainThread]: 
[0m12:47:20.786224 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:47:20.786819 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:47:20.788379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:47:20.788786 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:47:20.796972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:47:20.797573 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:47:20.832823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:47:20.833440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:20.833782 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:47:20.834050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:20.838854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.839256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:20.839632 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select Patient_id
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:47:20.841128 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 46: join billing_data b on a.Patient_id = b.Patient_id
                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:47:20.841590 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:47:20.842085 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:47:20.845809 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 46: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:20.847254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a73822a90>]}
[0m12:47:20.847862 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:47:20.848478 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:47:20.849980 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.850290 [debug] [MainThread]: On master: BEGIN
[0m12:47:20.850561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:20.853770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.854159 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.854516 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.854848 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.855291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:20.855703 [debug] [MainThread]: On master: Close
[0m12:47:20.856461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:20.856847 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:47:20.857183 [info ] [MainThread]: 
[0m12:47:20.857581 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:47:20.858503 [debug] [MainThread]: Command end result
[0m12:47:20.885562 [info ] [MainThread]: 
[0m12:47:20.886419 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:20.886776 [info ] [MainThread]: 
[0m12:47:20.887223 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 46: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:20.887546 [info ] [MainThread]: 
[0m12:47:20.887871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:47:20.888804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7883628, "process_user_time": 1.823306, "process_kernel_time": 0.118759, "process_mem_max_rss": "113684", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m12:47:20.889376 [debug] [MainThread]: Command `dbt run` failed at 12:47:20.889247 after 0.79 seconds
[0m12:47:20.889778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a754a9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a793e4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a793e4d90>]}
[0m12:47:20.890214 [debug] [MainThread]: Flushing usage events
[0m12:47:58.736706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89417ada10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8941764c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89417ae950>]}


============================== 12:47:58.739871 | 74799194-b38e-4bf8-a4bb-5f32a27a50c9 ==============================
[0m12:47:58.739871 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:47:58.740568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:58.894344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893fe73710>]}
[0m12:47:58.950247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8945461010>]}
[0m12:47:58.951410 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:47:58.961015 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:47:59.064115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:59.064750 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:47:59.269691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893fd34c50>]}
[0m12:47:59.336886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893fb6c590>]}
[0m12:47:59.337428 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:47:59.337856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a894301a550>]}
[0m12:47:59.339511 [info ] [MainThread]: 
[0m12:47:59.340041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:59.340993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:47:59.378454 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:47:59.378870 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:47:59.379132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:59.384230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:47:59.385561 [debug] [ThreadPool]: On list_my_db: Close
[0m12:47:59.390278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:47:59.396039 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:59.396403 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:47:59.396659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:59.400513 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.401074 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:59.401585 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:59.404192 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:47:59.405726 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:47:59.406196 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:47:59.413289 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.413629 [debug] [MainThread]: On master: BEGIN
[0m12:47:59.413897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:59.417220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.417726 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.418208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:59.434420 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:47:59.437770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8942429410>]}
[0m12:47:59.438247 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:59.438771 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.439044 [debug] [MainThread]: On master: BEGIN
[0m12:47:59.439500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.439812 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.440068 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.440311 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.440747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:59.441031 [debug] [MainThread]: On master: Close
[0m12:47:59.441503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:59.441852 [info ] [MainThread]: 
[0m12:47:59.444173 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:47:59.444692 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:47:59.446472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:47:59.446971 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:47:59.455822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:47:59.456518 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:47:59.492049 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:47:59.492664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:59.493006 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:47:59.493300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:59.496548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.496988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:59.497464 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:47:59.498993 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:47:59.499434 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:47:59.500024 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:47:59.504215 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:59.505619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893eb21090>]}
[0m12:47:59.506209 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:47:59.506890 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:47:59.508547 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.508878 [debug] [MainThread]: On master: BEGIN
[0m12:47:59.509130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:59.512205 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.512631 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.512924 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.513197 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.513644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:59.513959 [debug] [MainThread]: On master: Close
[0m12:47:59.514378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:59.514648 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:47:59.514958 [info ] [MainThread]: 
[0m12:47:59.515297 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:47:59.516011 [debug] [MainThread]: Command end result
[0m12:47:59.545028 [info ] [MainThread]: 
[0m12:47:59.545468 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:59.545763 [info ] [MainThread]: 
[0m12:47:59.546121 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:59.546433 [info ] [MainThread]: 
[0m12:47:59.546742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:47:59.547535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8684435, "process_user_time": 2.046037, "process_kernel_time": 0.139002, "process_mem_max_rss": "114028", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m12:47:59.548046 [debug] [MainThread]: Command `dbt run` failed at 12:47:59.547934 after 0.87 seconds
[0m12:47:59.548413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89458498d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a894192fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8941764210>]}
[0m12:47:59.548761 [debug] [MainThread]: Flushing usage events
[0m12:48:29.266373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be02ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7c144d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be49950>]}


============================== 12:48:29.268953 | a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9 ==============================
[0m12:48:29.268953 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:48:29.269454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:29.410512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be4b510>]}
[0m12:48:29.458113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a5598d0>]}
[0m12:48:29.458800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:48:29.468547 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:48:29.572647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:29.573067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:29.609440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a4fc610>]}
[0m12:48:29.681489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a569c10>]}
[0m12:48:29.681954 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:48:29.682246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a347fd0>]}
[0m12:48:29.683730 [info ] [MainThread]: 
[0m12:48:29.684259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:48:29.685095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:48:29.724782 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:48:29.725182 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:48:29.725465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:29.730563 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:48:29.731865 [debug] [ThreadPool]: On list_my_db: Close
[0m12:48:29.737266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:48:29.743171 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:48:29.743681 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:48:29.744164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:29.747494 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.747856 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:48:29.748184 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:48:29.750674 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:48:29.752181 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:48:29.752613 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:48:29.759808 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.760163 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.760436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:29.764171 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.764562 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.764945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:48:29.780951 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:48:29.783947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a387590>]}
[0m12:48:29.784341 [debug] [MainThread]: On master: ROLLBACK
[0m12:48:29.784776 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.785033 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.785493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.785833 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.786098 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.786348 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.786733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:48:29.787018 [debug] [MainThread]: On master: Close
[0m12:48:29.787447 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:29.787809 [info ] [MainThread]: 
[0m12:48:29.789847 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:48:29.790385 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:48:29.791088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:48:29.791535 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:48:29.800810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:48:29.801412 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:48:29.837115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:48:29.837694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:48:29.838021 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:48:29.838296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:29.841660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.842230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:48:29.842659 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:48:29.844540 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:48:29.845156 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:48:29.845804 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:48:29.849784 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:48:29.851171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a38cc50>]}
[0m12:48:29.851755 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:48:29.852368 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:48:29.854110 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.854449 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.854708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:29.857938 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.858300 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.858577 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.858838 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.859192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:48:29.859467 [debug] [MainThread]: On master: Close
[0m12:48:29.859856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:29.860106 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:48:29.860403 [info ] [MainThread]: 
[0m12:48:29.860738 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:48:29.861444 [debug] [MainThread]: Command end result
[0m12:48:29.891523 [info ] [MainThread]: 
[0m12:48:29.891964 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:48:29.892272 [info ] [MainThread]: 
[0m12:48:29.892661 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:48:29.892967 [info ] [MainThread]: 
[0m12:48:29.893287 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:48:29.894194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6742713, "process_user_time": 1.755404, "process_kernel_time": 0.124957, "process_mem_max_rss": "111076", "process_out_blocks": "1752", "command_success": false, "process_in_blocks": "0"}
[0m12:48:29.894913 [debug] [MainThread]: Command `dbt run` failed at 12:48:29.894785 after 0.68 seconds
[0m12:48:29.895354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be56790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7ff01890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd796b4250>]}
[0m12:48:29.895808 [debug] [MainThread]: Flushing usage events
[0m12:52:42.848181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e657fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e6870dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e6567790>]}


============================== 12:52:42.850789 | 154b0ec2-d6e9-4fda-965e-9e5c73aee690 ==============================
[0m12:52:42.850789 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:52:42.851339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_billing', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:42.979998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e657e790>]}
[0m12:52:43.026532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03ea24ce10>]}
[0m12:52:43.027240 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:43.037160 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:52:43.130756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:43.131370 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m12:52:43.324021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e64bbb50>]}
[0m12:52:43.393269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e4c9bc90>]}
[0m12:52:43.393778 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:52:43.394079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e7a8d7d0>]}
[0m12:52:43.395526 [info ] [MainThread]: 
[0m12:52:43.396191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:43.397216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:52:43.434610 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:52:43.434958 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:52:43.435216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:43.439602 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:52:43.440861 [debug] [ThreadPool]: On list_my_db: Close
[0m12:52:43.445803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:52:43.451496 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:52:43.451839 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:52:43.452102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:43.455569 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.456078 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:52:43.456425 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:52:43.459128 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:52:43.460700 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:52:43.461171 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:52:43.469587 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.469922 [debug] [MainThread]: On master: BEGIN
[0m12:52:43.470169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:43.473239 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.473604 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.473958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:43.489467 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:52:43.492461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e4af7810>]}
[0m12:52:43.492851 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:43.493342 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.493673 [debug] [MainThread]: On master: BEGIN
[0m12:52:43.494231 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.494541 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.494842 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.495093 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.495512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:52:43.495820 [debug] [MainThread]: On master: Close
[0m12:52:43.496342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:43.496731 [info ] [MainThread]: 
[0m12:52:43.498735 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m12:52:43.499232 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m12:52:43.500864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m12:52:43.501305 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m12:52:43.508654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m12:52:43.509275 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m12:52:43.545420 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m12:52:43.546040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:52:43.546369 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m12:52:43.546664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:43.549927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.550315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:52:43.550677 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  InvoiceID as Invoice_id,
        PatientID  as Patient_id,
        Items as Procedure,
        Amount
    from "my_db"."public"."Billing"
  );
[0m12:52:43.551407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "invoiceid" does not exist
LINE 7:     select  InvoiceID as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m12:52:43.551770 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m12:52:43.552258 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m12:52:43.555936 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:52:43.557368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e394e510>]}
[0m12:52:43.557952 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m12:52:43.558592 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m12:52:43.560327 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.560674 [debug] [MainThread]: On master: BEGIN
[0m12:52:43.560960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:43.564052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.564449 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.564720 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.564999 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.565411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:52:43.565697 [debug] [MainThread]: On master: Close
[0m12:52:43.566254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:43.566720 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m12:52:43.567189 [info ] [MainThread]: 
[0m12:52:43.567827 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:52:43.568737 [debug] [MainThread]: Command end result
[0m12:52:43.596128 [info ] [MainThread]: 
[0m12:52:43.596668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:43.596998 [info ] [MainThread]: 
[0m12:52:43.597453 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:52:43.597750 [info ] [MainThread]: 
[0m12:52:43.598059 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:52:43.598797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79226536, "process_user_time": 1.815849, "process_kernel_time": 0.128705, "process_mem_max_rss": "114096", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m12:52:43.599248 [debug] [MainThread]: Command `dbt run` failed at 12:52:43.599147 after 0.79 seconds
[0m12:52:43.599619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e657fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03ea4c0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03ea4c0dd0>]}
[0m12:52:43.599929 [debug] [MainThread]: Flushing usage events
[0m12:53:15.533872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716d4ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716d4e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716d4c590>]}


============================== 12:53:15.536384 | 61aaf0fc-5069-4333-ad7c-2b2222338c10 ==============================
[0m12:53:15.536384 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:53:15.536883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_billing', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:53:15.665912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716c5c110>]}
[0m12:53:15.711859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a71aa49010>]}
[0m12:53:15.712568 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:53:15.721487 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:53:15.812573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:15.813151 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m12:53:16.005424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a715499590>]}
[0m12:53:16.073112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7154c1750>]}
[0m12:53:16.073581 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:53:16.073876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a714d03f90>]}
[0m12:53:16.075524 [info ] [MainThread]: 
[0m12:53:16.076160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:16.077104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:53:16.114127 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:53:16.114500 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:53:16.114781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:16.119878 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:53:16.121482 [debug] [ThreadPool]: On list_my_db: Close
[0m12:53:16.126284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:53:16.131946 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:16.132330 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:53:16.132621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:16.135754 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.136124 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:16.136470 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:53:16.138942 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:53:16.140423 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:53:16.140888 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:53:16.148786 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.149119 [debug] [MainThread]: On master: BEGIN
[0m12:53:16.149372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:16.152489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.152862 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.153219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:53:16.168638 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:53:16.171675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a71401d4d0>]}
[0m12:53:16.172106 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:16.172503 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.172768 [debug] [MainThread]: On master: BEGIN
[0m12:53:16.173185 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.173480 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.173739 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.173991 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.174322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:16.174615 [debug] [MainThread]: On master: Close
[0m12:53:16.175227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:16.175733 [info ] [MainThread]: 
[0m12:53:16.178078 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m12:53:16.178590 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m12:53:16.180208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m12:53:16.180676 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m12:53:16.187848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m12:53:16.188604 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m12:53:16.223649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m12:53:16.224258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:16.224582 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m12:53:16.224861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:16.228030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.228424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:16.228739 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        Amount
    from "my_db"."public"."Billing"
  );
[0m12:53:16.229366 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 10:         Amount
                 ^
HINT:  Perhaps you meant to reference the column "Billing.Amount".

[0m12:53:16.229727 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m12:53:16.230285 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m12:53:16.233967 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "amount" does not exist
  LINE 10:         Amount
                   ^
  HINT:  Perhaps you meant to reference the column "Billing.Amount".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:53:16.235362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716c87ed0>]}
[0m12:53:16.235947 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m12:53:16.236651 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m12:53:16.238417 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.238758 [debug] [MainThread]: On master: BEGIN
[0m12:53:16.239021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:16.242035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.242402 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.242682 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.242928 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.243277 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:16.243556 [debug] [MainThread]: On master: Close
[0m12:53:16.243960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:16.244222 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m12:53:16.244539 [info ] [MainThread]: 
[0m12:53:16.244875 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:53:16.245866 [debug] [MainThread]: Command end result
[0m12:53:16.275904 [info ] [MainThread]: 
[0m12:53:16.276402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:16.276725 [info ] [MainThread]: 
[0m12:53:16.277160 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "amount" does not exist
  LINE 10:         Amount
                   ^
  HINT:  Perhaps you meant to reference the column "Billing.Amount".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:53:16.277502 [info ] [MainThread]: 
[0m12:53:16.277855 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:53:16.278661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7864996, "process_user_time": 1.870357, "process_kernel_time": 0.128749, "process_mem_max_rss": "113936", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m12:53:16.279162 [debug] [MainThread]: Command `dbt run` failed at 12:53:16.279054 after 0.79 seconds
[0m12:53:16.279531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716f17a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716f17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716f17d10>]}
[0m12:53:16.279874 [debug] [MainThread]: Flushing usage events
[0m12:53:26.936109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3ad9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3ada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3acc50>]}


============================== 12:53:26.938686 | a6e2e9c3-4397-4ef9-8c56-9d787b9468fa ==============================
[0m12:53:26.938686 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:53:26.939201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:27.070234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f28ad90>]}
[0m12:53:27.117088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275730a0f50>]}
[0m12:53:27.117772 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:53:27.126738 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:53:27.218252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:27.218796 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m12:53:27.412375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f392ad0>]}
[0m12:53:27.479855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756d657d10>]}
[0m12:53:27.480559 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:53:27.480963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756d62cbd0>]}
[0m12:53:27.482538 [info ] [MainThread]: 
[0m12:53:27.483106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:27.483971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:53:27.521661 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:53:27.522041 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:53:27.522299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:27.527480 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:53:27.528746 [debug] [ThreadPool]: On list_my_db: Close
[0m12:53:27.534099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:53:27.540163 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:27.540519 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:53:27.540769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:27.544230 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.544603 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:27.544906 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:53:27.547430 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:53:27.549026 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:53:27.549627 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:53:27.556653 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.556979 [debug] [MainThread]: On master: BEGIN
[0m12:53:27.557221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:27.560358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.560704 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.561049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:53:27.576241 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:53:27.579254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756db12910>]}
[0m12:53:27.579772 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:27.580247 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.580541 [debug] [MainThread]: On master: BEGIN
[0m12:53:27.581127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.581480 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.581769 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.582020 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.582409 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:27.582728 [debug] [MainThread]: On master: Close
[0m12:53:27.583197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:27.583538 [info ] [MainThread]: 
[0m12:53:27.585471 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m12:53:27.585989 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m12:53:27.587617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m12:53:27.588040 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m12:53:27.595619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m12:53:27.596590 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m12:53:27.632377 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m12:53:27.632983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.633293 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m12:53:27.633579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:27.636561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.636998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.637409 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m12:53:27.638977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:53:27.645635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.646035 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
alter table "my_db"."public"."stg_billing" rename to "stg_billing__dbt_backup"
[0m12:53:27.646771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:53:27.650156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.650614 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
alter table "my_db"."public"."stg_billing__dbt_tmp" rename to "stg_billing"
[0m12:53:27.651350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:53:27.667535 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m12:53:27.667942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.668261 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m12:53:27.676395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:53:27.682862 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_billing__dbt_backup"
[0m12:53:27.687702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.688096 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
drop view if exists "my_db"."public"."stg_billing__dbt_backup" cascade
[0m12:53:27.689759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:53:27.692107 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m12:53:27.693795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756cbea750>]}
[0m12:53:27.694544 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_billing ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m12:53:27.695275 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m12:53:27.696557 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.696870 [debug] [MainThread]: On master: BEGIN
[0m12:53:27.697130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:27.700256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.700675 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.701003 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.701271 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.701777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:27.702223 [debug] [MainThread]: On master: Close
[0m12:53:27.702808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:27.703139 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m12:53:27.703550 [info ] [MainThread]: 
[0m12:53:27.704095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:53:27.704914 [debug] [MainThread]: Command end result
[0m12:53:27.734134 [info ] [MainThread]: 
[0m12:53:27.734634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:27.734983 [info ] [MainThread]: 
[0m12:53:27.735322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:53:27.736076 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84218264, "process_user_time": 1.943378, "process_kernel_time": 0.135677, "process_mem_max_rss": "113340", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m12:53:27.736553 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:27.736438 after 0.84 seconds
[0m12:53:27.736871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3adad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3adfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727573198710>]}
[0m12:53:27.737178 [debug] [MainThread]: Flushing usage events
[0m12:54:52.647329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d177fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d177510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d177790>]}


============================== 12:54:52.650600 | 52f5402a-c0ce-4cce-8614-640f3950c4e3 ==============================
[0m12:54:52.650600 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:54:52.651313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_billing', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:52.814183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d07bf10>]}
[0m12:54:52.877166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b8b9b50>]}
[0m12:54:52.878169 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:54:52.897246 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:54:53.044455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:53.045258 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m12:54:53.280151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b8cfed0>]}
[0m12:54:53.349496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b568390>]}
[0m12:54:53.349977 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:54:53.350275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b779950>]}
[0m12:54:53.351828 [info ] [MainThread]: 
[0m12:54:53.352375 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:53.353292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:54:53.390991 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:54:53.391420 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:54:53.391718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:53.397648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:54:53.398908 [debug] [ThreadPool]: On list_my_db: Close
[0m12:54:53.403677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:54:53.409556 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:54:53.409900 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:54:53.410150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:53.413225 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.413634 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:54:53.413931 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:53.416485 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:54:53.418116 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:54:53.418633 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:54:53.426200 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.426553 [debug] [MainThread]: On master: BEGIN
[0m12:54:53.426798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:53.429960 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.430330 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.430736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:53.446112 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:54:53.449078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b7b98d0>]}
[0m12:54:53.449498 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:53.449973 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.450267 [debug] [MainThread]: On master: BEGIN
[0m12:54:53.450863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.451162 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.451459 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.451734 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.452151 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:53.452460 [debug] [MainThread]: On master: Close
[0m12:54:53.452909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:53.453220 [info ] [MainThread]: 
[0m12:54:53.455088 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m12:54:53.455596 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m12:54:53.457168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m12:54:53.457598 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m12:54:53.465523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m12:54:53.466178 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m12:54:53.502122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m12:54:53.502725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.503097 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m12:54:53.503388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:53.507450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.507919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.508351 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select distinct
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc
  );
[0m12:54:53.510627 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:54:53.517185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.517600 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m12:54:53.518356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:53.521397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.521740 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m12:54:53.522428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:53.538402 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:54:53.538847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.539139 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:54:53.561980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:53.576281 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m12:54:53.586651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.587365 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m12:54:53.589867 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:54:53.593288 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m12:54:53.595187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b59dd90>]}
[0m12:54:53.596123 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m12:54:53.596968 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m12:54:53.598298 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.598631 [debug] [MainThread]: On master: BEGIN
[0m12:54:53.598903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:53.602005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.602468 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.602786 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.603035 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.603427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:53.603733 [debug] [MainThread]: On master: Close
[0m12:54:53.604205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:53.604518 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m12:54:53.604887 [info ] [MainThread]: 
[0m12:54:53.605502 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m12:54:53.606430 [debug] [MainThread]: Command end result
[0m12:54:53.635093 [info ] [MainThread]: 
[0m12:54:53.635583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:53.635921 [info ] [MainThread]: 
[0m12:54:53.636248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:54:53.637022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0566818, "process_user_time": 2.141088, "process_kernel_time": 0.146937, "process_mem_max_rss": "113656", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m12:54:53.637482 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:53.637379 after 1.06 seconds
[0m12:54:53.637798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d30fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a210e8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a210e9150>]}
[0m12:54:53.638106 [debug] [MainThread]: Flushing usage events
[0m12:55:38.169005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bcbe8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bcbeb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bcba2690>]}


============================== 12:55:38.171962 | 97e2168a-1042-4075-8676-a41a5b08ed82 ==============================
[0m12:55:38.171962 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:55:38.172649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_billing', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:38.358215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bca24210>]}
[0m12:55:38.423801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c08ac710>]}
[0m12:55:38.424532 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:55:38.437349 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:55:38.551435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:55:38.552004 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m12:55:38.810981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bb15d4d0>]}
[0m12:55:38.893596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bb334f90>]}
[0m12:55:38.894090 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:55:38.894482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bb15e690>]}
[0m12:55:38.896487 [info ] [MainThread]: 
[0m12:55:38.897520 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:38.898584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:55:38.938297 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:55:38.938699 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:55:38.938974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:38.946509 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:55:38.948042 [debug] [ThreadPool]: On list_my_db: Close
[0m12:55:38.953242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:55:38.959139 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:55:38.959489 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:55:38.959762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:38.963559 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:55:38.964019 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:55:38.964361 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:55:38.967235 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:55:38.968817 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:55:38.969294 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:55:38.976639 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:38.977013 [debug] [MainThread]: On master: BEGIN
[0m12:55:38.977273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:38.980978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:55:38.981406 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:38.981768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:55:38.998122 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:55:39.001312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871ba3c1fd0>]}
[0m12:55:39.001733 [debug] [MainThread]: On master: ROLLBACK
[0m12:55:39.002145 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.002443 [debug] [MainThread]: On master: BEGIN
[0m12:55:39.002873 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:55:39.003186 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.003473 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.003720 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.004056 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:55:39.004325 [debug] [MainThread]: On master: Close
[0m12:55:39.004836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:39.005270 [info ] [MainThread]: 
[0m12:55:39.007581 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m12:55:39.008085 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m12:55:39.009675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m12:55:39.010084 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m12:55:39.019440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m12:55:39.020061 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m12:55:39.056253 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m12:55:39.056874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.057206 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m12:55:39.057514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:39.060683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:55:39.061101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.061450 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select distinct
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc ,Patient_id
  );
[0m12:55:39.064113 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:55:39.070523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.070942 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m12:55:39.071674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:55:39.074723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.075061 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m12:55:39.075684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:55:39.091962 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:55:39.092375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.092720 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:55:39.143911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:55:39.152090 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m12:55:39.157728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.158202 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m12:55:39.160151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:55:39.163219 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m12:55:39.165666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871b9f203d0>]}
[0m12:55:39.167168 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m12:55:39.168845 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m12:55:39.171039 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.171459 [debug] [MainThread]: On master: BEGIN
[0m12:55:39.171773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:39.175448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:55:39.175890 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.176200 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.176511 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.177013 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:55:39.177385 [debug] [MainThread]: On master: Close
[0m12:55:39.177994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:39.178545 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m12:55:39.179133 [info ] [MainThread]: 
[0m12:55:39.179829 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:55:39.181319 [debug] [MainThread]: Command end result
[0m12:55:39.229057 [info ] [MainThread]: 
[0m12:55:39.229936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:39.230573 [info ] [MainThread]: 
[0m12:55:39.231259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:55:39.232842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.122446, "process_user_time": 2.208911, "process_kernel_time": 0.143929, "process_mem_max_rss": "113496", "process_out_blocks": "2584", "process_in_blocks": "0"}
[0m12:55:39.234379 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:39.233911 after 1.12 seconds
[0m12:55:39.235558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c09a4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c0b00c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c0b00d90>]}
[0m12:55:39.237141 [debug] [MainThread]: Flushing usage events
[0m12:56:09.676631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c4201dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c4200fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41e7b90>]}


============================== 12:56:09.679233 | c32211fe-6ca4-4138-88ad-e371e30c7514 ==============================
[0m12:56:09.679233 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:56:09.679716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m fct_appointment', 'send_anonymous_usage_stats': 'True'}
[0m12:56:09.813867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c2895c10>]}
[0m12:56:09.862267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c7efc790>]}
[0m12:56:09.862912 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:56:09.872186 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:56:09.974211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:09.974652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:10.010172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c2822050>]}
[0m12:56:10.081070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c294d690>]}
[0m12:56:10.081511 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:56:10.081805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41fced0>]}
[0m12:56:10.083238 [info ] [MainThread]: 
[0m12:56:10.083810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:10.084668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:56:10.124888 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:56:10.125247 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:56:10.125525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:10.129955 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:56:10.131219 [debug] [ThreadPool]: On list_my_db: Close
[0m12:56:10.136189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:56:10.142250 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:56:10.142627 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:56:10.142875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:10.146097 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.146465 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:56:10.146771 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:56:10.149226 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:56:10.150683 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:56:10.151156 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:56:10.159306 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.159663 [debug] [MainThread]: On master: BEGIN
[0m12:56:10.159922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:10.163151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.163544 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.163919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:10.179367 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:56:10.182120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41ce890>]}
[0m12:56:10.182490 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:10.182937 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.183198 [debug] [MainThread]: On master: BEGIN
[0m12:56:10.183732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.184026 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.184278 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.184551 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.184919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:56:10.185188 [debug] [MainThread]: On master: Close
[0m12:56:10.185622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:10.185928 [info ] [MainThread]: 
[0m12:56:10.187793 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:56:10.188316 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:56:10.189040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:56:10.189506 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:56:10.198661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:56:10.199382 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:56:10.236109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:56:10.236886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.237332 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:56:10.237666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:10.241046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.241549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.241964 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:56:10.244565 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:56:10.250735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.251111 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
alter table "my_db"."public"."fct_appointment__dbt_tmp" rename to "fct_appointment"
[0m12:56:10.251864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:56:10.266936 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m12:56:10.267314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.267615 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m12:56:10.275243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:56:10.281262 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."fct_appointment__dbt_backup"
[0m12:56:10.285904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.286285 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
drop view if exists "my_db"."public"."fct_appointment__dbt_backup" cascade
[0m12:56:10.286933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:56:10.289042 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:56:10.290450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41c0990>]}
[0m12:56:10.291231 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fct_appointment ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m12:56:10.292481 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:56:10.293596 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.293918 [debug] [MainThread]: On master: BEGIN
[0m12:56:10.294199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:10.297366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.297897 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.298221 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.298553 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.299057 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:56:10.299498 [debug] [MainThread]: On master: Close
[0m12:56:10.300002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:10.300356 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:56:10.300819 [info ] [MainThread]: 
[0m12:56:10.301355 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:56:10.302206 [debug] [MainThread]: Command end result
[0m12:56:10.331624 [info ] [MainThread]: 
[0m12:56:10.332116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:10.332447 [info ] [MainThread]: 
[0m12:56:10.332784 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:56:10.333532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7016038, "process_user_time": 1.736623, "process_kernel_time": 0.115974, "process_mem_max_rss": "111080", "process_out_blocks": "1760", "process_in_blocks": "0"}
[0m12:56:10.334005 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:10.333902 after 0.70 seconds
[0m12:56:10.334315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c420f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c420d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c1a17bd0>]}
[0m12:56:10.334643 [debug] [MainThread]: Flushing usage events
[0m13:16:00.391290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497923b26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497926bcb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497923b3810>]}


============================== 13:16:00.394325 | e477a818-c73a-4a98-93db-c8a664a3b680 ==============================
[0m13:16:00.394325 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:16:00.394932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:16:00.557691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e477a818-c73a-4a98-93db-c8a664a3b680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749790a8d210>]}
[0m13:16:00.607026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e477a818-c73a-4a98-93db-c8a664a3b680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749796098790>]}
[0m13:16:00.607738 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:16:00.617097 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:16:00.715659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:00.716199 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m13:16:00.913598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e477a818-c73a-4a98-93db-c8a664a3b680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74979098f450>]}
[0m13:16:00.979774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e477a818-c73a-4a98-93db-c8a664a3b680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497907f1990>]}
[0m13:16:00.980266 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m13:16:00.980582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e477a818-c73a-4a98-93db-c8a664a3b680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749790ac2550>]}
[0m13:16:00.982167 [info ] [MainThread]: 
[0m13:16:00.982759 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:16:00.983725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m13:16:01.022222 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m13:16:01.022593 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m13:16:01.022852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:01.027777 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:16:01.029168 [debug] [ThreadPool]: On list_my_db: Close
[0m13:16:01.034197 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m13:16:01.040016 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:16:01.040383 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:16:01.040650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:01.043570 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:16:01.043932 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:16:01.044224 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:16:01.046732 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:16:01.048198 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:16:01.048651 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:16:01.055985 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:01.056352 [debug] [MainThread]: On master: BEGIN
[0m13:16:01.056602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:01.059693 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:16:01.060060 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:01.060443 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:16:01.076503 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m13:16:01.080396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e477a818-c73a-4a98-93db-c8a664a3b680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74978fbdd250>]}
[0m13:16:01.080798 [debug] [MainThread]: On master: ROLLBACK
[0m13:16:01.081306 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:01.081591 [debug] [MainThread]: On master: BEGIN
[0m13:16:01.082168 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:16:01.082483 [debug] [MainThread]: On master: COMMIT
[0m13:16:01.082779 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:01.083019 [debug] [MainThread]: On master: COMMIT
[0m13:16:01.083385 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:16:01.083675 [debug] [MainThread]: On master: Close
[0m13:16:01.084128 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:01.084453 [info ] [MainThread]: 
[0m13:16:01.086391 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m13:16:01.087729 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m13:16:01.088326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m13:16:01.088792 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m13:16:01.096369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m13:16:01.096960 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m13:16:01.131986 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m13:16:01.132579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:16:01.132906 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m13:16:01.133183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:01.136253 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:16:01.136655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:16:01.136971 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"') as Appointment_date
    from "my_db"."public"."Appointment"
  );
[0m13:16:01.137753 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function to_timestamp(timestamp without time zone, unknown) does not exist
LINE 10:         to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:16:01.138115 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m13:16:01.138657 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m13:16:01.142923 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  function to_timestamp(timestamp without time zone, unknown) does not exist
  LINE 10:         to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m13:16:01.144312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e477a818-c73a-4a98-93db-c8a664a3b680', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74978fb51390>]}
[0m13:16:01.144909 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m13:16:01.145541 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m13:16:01.147102 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:01.147460 [debug] [MainThread]: On master: BEGIN
[0m13:16:01.147747 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:01.150658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:16:01.151055 [debug] [MainThread]: On master: COMMIT
[0m13:16:01.151324 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:01.151596 [debug] [MainThread]: On master: COMMIT
[0m13:16:01.151936 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:16:01.152203 [debug] [MainThread]: On master: Close
[0m13:16:01.152623 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:01.152884 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m13:16:01.153174 [info ] [MainThread]: 
[0m13:16:01.153513 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:16:01.154174 [debug] [MainThread]: Command end result
[0m13:16:01.183307 [info ] [MainThread]: 
[0m13:16:01.183915 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:16:01.184276 [info ] [MainThread]: 
[0m13:16:01.184739 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  function to_timestamp(timestamp without time zone, unknown) does not exist
  LINE 10:         to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m13:16:01.185105 [info ] [MainThread]: 
[0m13:16:01.185456 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:16:01.186212 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8445363, "process_user_time": 1.845013, "process_kernel_time": 0.139698, "process_mem_max_rss": "114088", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m13:16:01.186690 [debug] [MainThread]: Command `dbt run` failed at 13:16:01.186585 after 0.85 seconds
[0m13:16:01.187055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x749792454090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497926bcc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74979630cdd0>]}
[0m13:16:01.187635 [debug] [MainThread]: Flushing usage events
[0m13:16:27.978005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827cf6de10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827cfb6610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827cfb73d0>]}


============================== 13:16:27.980532 | 4784510f-4e4f-42d8-89cf-27ca2c83a5b9 ==============================
[0m13:16:27.980532 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:16:27.981047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:16:28.112837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4784510f-4e4f-42d8-89cf-27ca2c83a5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827ceaba90>]}
[0m13:16:28.159379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4784510f-4e4f-42d8-89cf-27ca2c83a5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758280c78fd0>]}
[0m13:16:28.160108 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:16:28.169258 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:16:28.263509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:28.264064 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m13:16:28.457419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4784510f-4e4f-42d8-89cf-27ca2c83a5b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827b32d710>]}
[0m13:16:28.522094 [error] [MainThread]: Encountered an error:
Found a cycle: model.dbt_modeling.stg_appointment
[0m13:16:28.523842 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 332, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 569, in run
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 506, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/compile.py", line 125, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/runnable.py", line 147, in _runtime_initialize
    self.compile_manifest()
  File "/usr/local/lib/python3.11/site-packages/dbt/task/base.py", line 145, in compile_manifest
    self.graph = self.compiler.compile(self.manifest)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 449, in compile
    linker.link_graph(manifest)
  File "/usr/local/lib/python3.11/site-packages/dbt/compilation.py", line 192, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.dbt_modeling.stg_appointment

[0m13:16:28.524661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5881547, "process_user_time": 1.676442, "process_kernel_time": 0.108898, "process_mem_max_rss": "105132", "process_out_blocks": "1664", "command_success": false, "process_in_blocks": "0"}
[0m13:16:28.525078 [debug] [MainThread]: Command `dbt run` failed at 13:16:28.524986 after 0.59 seconds
[0m13:16:28.525392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827cfc1090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827d13c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75827b3ca2d0>]}
[0m13:16:28.525690 [debug] [MainThread]: Flushing usage events
[0m13:16:32.529206 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
[0m13:17:15.139464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72690360e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726904fe8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726905b7d550>]}


============================== 13:17:15.142435 | db5c781f-a271-4aa0-aec6-83fe1c6fe4a7 ==============================
[0m13:17:15.142435 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:17:15.142958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_appointment', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:17:15.277754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db5c781f-a271-4aa0-aec6-83fe1c6fe4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72690360e6d0>]}
[0m13:17:15.323788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db5c781f-a271-4aa0-aec6-83fe1c6fe4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7269072dcf90>]}
[0m13:17:15.324541 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:17:15.333736 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:17:15.426058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:15.426625 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m13:17:15.621704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db5c781f-a271-4aa0-aec6-83fe1c6fe4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726901d15d90>]}
[0m13:17:15.695938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db5c781f-a271-4aa0-aec6-83fe1c6fe4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726901b7ebd0>]}
[0m13:17:15.696421 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m13:17:15.696746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5c781f-a271-4aa0-aec6-83fe1c6fe4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726901b65110>]}
[0m13:17:15.698167 [info ] [MainThread]: 
[0m13:17:15.698713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:17:15.699517 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m13:17:15.737142 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m13:17:15.737527 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m13:17:15.737798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:15.742343 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:17:15.743804 [debug] [ThreadPool]: On list_my_db: Close
[0m13:17:15.748651 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m13:17:15.754672 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:17:15.755021 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:17:15.755273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:15.758274 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:17:15.758670 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:17:15.758955 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:17:15.761453 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:17:15.762969 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:17:15.763327 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:17:15.770833 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:15.771217 [debug] [MainThread]: On master: BEGIN
[0m13:17:15.771510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:15.774823 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:17:15.775184 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:15.775549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:17:15.791750 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m13:17:15.795565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db5c781f-a271-4aa0-aec6-83fe1c6fe4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7269011cb750>]}
[0m13:17:15.795941 [debug] [MainThread]: On master: ROLLBACK
[0m13:17:15.796400 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:15.796655 [debug] [MainThread]: On master: BEGIN
[0m13:17:15.797290 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:17:15.797591 [debug] [MainThread]: On master: COMMIT
[0m13:17:15.797842 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:15.798126 [debug] [MainThread]: On master: COMMIT
[0m13:17:15.798492 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:17:15.798750 [debug] [MainThread]: On master: Close
[0m13:17:15.799207 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:17:15.799563 [info ] [MainThread]: 
[0m13:17:15.801874 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m13:17:15.803381 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m13:17:15.804072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m13:17:15.804508 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m13:17:15.811859 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m13:17:15.812423 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m13:17:15.848038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m13:17:15.848636 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:17:15.848964 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m13:17:15.849247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:15.854206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:17:15.854846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:17:15.855226 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"') as Appointment_date
from "my_db"."public"."Appointment"
  );
[0m13:17:15.856194 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function to_timestamp(timestamp without time zone, unknown) does not exist
LINE 10:         to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:17:15.856700 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m13:17:15.857311 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m13:17:15.861912 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  function to_timestamp(timestamp without time zone, unknown) does not exist
  LINE 10:         to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m13:17:15.863285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db5c781f-a271-4aa0-aec6-83fe1c6fe4a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726900978d90>]}
[0m13:17:15.863898 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m13:17:15.864511 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m13:17:15.866173 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:15.866511 [debug] [MainThread]: On master: BEGIN
[0m13:17:15.866765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:15.869704 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:17:15.870097 [debug] [MainThread]: On master: COMMIT
[0m13:17:15.870382 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:15.870649 [debug] [MainThread]: On master: COMMIT
[0m13:17:15.871034 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:17:15.871298 [debug] [MainThread]: On master: Close
[0m13:17:15.871701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:15.871949 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m13:17:15.872226 [info ] [MainThread]: 
[0m13:17:15.872580 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m13:17:15.873318 [debug] [MainThread]: Command end result
[0m13:17:15.901915 [info ] [MainThread]: 
[0m13:17:15.902584 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:17:15.902963 [info ] [MainThread]: 
[0m13:17:15.903397 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  function to_timestamp(timestamp without time zone, unknown) does not exist
  LINE 10:         to_timestamp("Time", 'YYYY-MM-DD"T"HH24:MI:SS.FF3"Z"...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m13:17:15.903744 [info ] [MainThread]: 
[0m13:17:15.904091 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:17:15.904990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8099227, "process_user_time": 1.924799, "process_kernel_time": 0.128785, "process_mem_max_rss": "114320", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m13:17:15.905506 [debug] [MainThread]: Command `dbt run` failed at 13:17:15.905398 after 0.81 seconds
[0m13:17:15.905889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726903787e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72690360ce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726907550c90>]}
[0m13:17:15.906226 [debug] [MainThread]: Flushing usage events
[0m13:18:10.908706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8d39b210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8d352b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8d352910>]}


============================== 13:18:10.911425 | 9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761 ==============================
[0m13:18:10.911425 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:18:10.912027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m13:18:11.037594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8d3c5890>]}
[0m13:18:11.083474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d91068f90>]}
[0m13:18:11.084210 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:18:11.092522 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:18:11.187607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:11.188147 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m13:18:11.383211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8b92d3d0>]}
[0m13:18:11.449795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8b791490>]}
[0m13:18:11.450374 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m13:18:11.450678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8b686c10>]}
[0m13:18:11.452102 [info ] [MainThread]: 
[0m13:18:11.452672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:11.453526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m13:18:11.491708 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m13:18:11.492087 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m13:18:11.492460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:11.497408 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:18:11.498716 [debug] [ThreadPool]: On list_my_db: Close
[0m13:18:11.503397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m13:18:11.511215 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:18:11.511794 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:18:11.512227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:11.518804 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:18:11.519376 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:18:11.519883 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:18:11.524056 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:18:11.526641 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:18:11.527385 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:18:11.543877 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:11.544467 [debug] [MainThread]: On master: BEGIN
[0m13:18:11.544925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:11.549365 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:11.549845 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:11.550231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:18:11.570476 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m13:18:11.574348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8aba9710>]}
[0m13:18:11.574746 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:11.575139 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:11.575415 [debug] [MainThread]: On master: BEGIN
[0m13:18:11.575829 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:11.576094 [debug] [MainThread]: On master: COMMIT
[0m13:18:11.576412 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:11.576689 [debug] [MainThread]: On master: COMMIT
[0m13:18:11.577170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:11.577492 [debug] [MainThread]: On master: Close
[0m13:18:11.578004 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:11.578445 [info ] [MainThread]: 
[0m13:18:11.580702 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m13:18:11.582252 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m13:18:11.582808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m13:18:11.583166 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m13:18:11.590639 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m13:18:11.591391 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m13:18:11.628131 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m13:18:11.628840 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:18:11.629170 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m13:18:11.629484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:11.633065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:18:11.633484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:18:11.633816 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        "Time"::timestamp as Appointment_date
from "my_db"."public"."Appointment"
  );
[0m13:18:11.635484 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:18:11.642146 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:18:11.642591 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment" rename to "stg_appointment__dbt_backup"
[0m13:18:11.643286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:11.646374 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:18:11.646735 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment__dbt_tmp" rename to "stg_appointment"
[0m13:18:11.647400 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:11.664113 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m13:18:11.664512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:18:11.664834 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m13:18:11.672834 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:18:11.679383 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_appointment__dbt_backup"
[0m13:18:11.684130 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m13:18:11.684488 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
drop view if exists "my_db"."public"."stg_appointment__dbt_backup" cascade
[0m13:18:11.686443 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:18:11.688759 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m13:18:11.690351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fdd5c8f-23ff-49fc-bf93-8e94a7b8d761', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8abdbd90>]}
[0m13:18:11.691167 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_appointment ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m13:18:11.691824 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m13:18:11.693006 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:11.693395 [debug] [MainThread]: On master: BEGIN
[0m13:18:11.693799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:11.697079 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:11.697646 [debug] [MainThread]: On master: COMMIT
[0m13:18:11.697995 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:11.698302 [debug] [MainThread]: On master: COMMIT
[0m13:18:11.698759 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:11.699173 [debug] [MainThread]: On master: Close
[0m13:18:11.699820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:11.700184 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m13:18:11.700963 [info ] [MainThread]: 
[0m13:18:11.701779 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:18:11.702890 [debug] [MainThread]: Command end result
[0m13:18:11.731972 [info ] [MainThread]: 
[0m13:18:11.732471 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:11.732794 [info ] [MainThread]: 
[0m13:18:11.733140 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:18:11.733882 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8662067, "process_user_time": 1.88175, "process_kernel_time": 0.132349, "process_mem_max_rss": "113620", "process_out_blocks": "2576", "process_in_blocks": "0"}
[0m13:18:11.734375 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:11.734258 after 0.87 seconds
[0m13:18:11.734707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8d3a57d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d91158710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708d8d2ca650>]}
[0m13:18:11.735042 [debug] [MainThread]: Flushing usage events
[0m13:18:47.967281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e6aa4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e6c27e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e6aa58d0>]}


============================== 13:18:47.969735 | c64c6e69-64ea-447a-a610-24497bf5945a ==============================
[0m13:18:47.969735 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:18:47.970258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:18:48.099524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c64c6e69-64ea-447a-a610-24497bf5945a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e69b1090>]}
[0m13:18:48.146161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c64c6e69-64ea-447a-a610-24497bf5945a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e51a9150>]}
[0m13:18:48.146898 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:18:48.155538 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:18:48.249712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:18:48.250092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:18:48.282583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c64c6e69-64ea-447a-a610-24497bf5945a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e5153490>]}
[0m13:18:48.351571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c64c6e69-64ea-447a-a610-24497bf5945a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e5159250>]}
[0m13:18:48.352046 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m13:18:48.352321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c64c6e69-64ea-447a-a610-24497bf5945a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e6a9ca90>]}
[0m13:18:48.353775 [info ] [MainThread]: 
[0m13:18:48.354389 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:18:48.355266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m13:18:48.395382 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m13:18:48.395720 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m13:18:48.395971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:48.400233 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:18:48.401544 [debug] [ThreadPool]: On list_my_db: Close
[0m13:18:48.406392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m13:18:48.412222 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:18:48.412563 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:18:48.412814 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:48.416295 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:18:48.416701 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:18:48.416989 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:18:48.419540 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m13:18:48.421264 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:18:48.421802 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:18:48.429225 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:48.429583 [debug] [MainThread]: On master: BEGIN
[0m13:18:48.429830 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:18:48.433114 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:48.433489 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:48.433889 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:18:48.449212 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m13:18:48.452246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c64c6e69-64ea-447a-a610-24497bf5945a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e51bead0>]}
[0m13:18:48.452647 [debug] [MainThread]: On master: ROLLBACK
[0m13:18:48.453119 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:48.453422 [debug] [MainThread]: On master: BEGIN
[0m13:18:48.454035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:48.454355 [debug] [MainThread]: On master: COMMIT
[0m13:18:48.454644 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:48.454922 [debug] [MainThread]: On master: COMMIT
[0m13:18:48.455300 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:48.455601 [debug] [MainThread]: On master: Close
[0m13:18:48.456027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:48.456355 [info ] [MainThread]: 
[0m13:18:48.458381 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m13:18:48.458896 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m13:18:48.459725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m13:18:48.460110 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m13:18:48.468246 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m13:18:48.468843 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m13:18:48.504026 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m13:18:48.506366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:18:48.506819 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m13:18:48.507127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:18:48.510464 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:18:48.510901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:18:48.511265 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m13:18:48.513853 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:18:48.519977 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:18:48.520404 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
alter table "my_db"."public"."fct_appointment__dbt_tmp" rename to "fct_appointment"
[0m13:18:48.521287 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:18:48.536331 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m13:18:48.536766 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:18:48.537088 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m13:18:48.544668 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:18:48.550827 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."fct_appointment__dbt_backup"
[0m13:18:48.555713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:18:48.556084 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
drop view if exists "my_db"."public"."fct_appointment__dbt_backup" cascade
[0m13:18:48.556729 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:18:48.559051 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m13:18:48.560582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c64c6e69-64ea-447a-a610-24497bf5945a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12e433edd0>]}
[0m13:18:48.561245 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fct_appointment ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m13:18:48.561929 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m13:18:48.563123 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:48.563422 [debug] [MainThread]: On master: BEGIN
[0m13:18:48.563672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:18:48.566799 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:18:48.567213 [debug] [MainThread]: On master: COMMIT
[0m13:18:48.567522 [debug] [MainThread]: Using postgres connection "master"
[0m13:18:48.567774 [debug] [MainThread]: On master: COMMIT
[0m13:18:48.568185 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:18:48.568500 [debug] [MainThread]: On master: Close
[0m13:18:48.568973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:48.569317 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m13:18:48.569702 [info ] [MainThread]: 
[0m13:18:48.570139 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:18:48.571206 [debug] [MainThread]: Command end result
[0m13:18:48.599901 [info ] [MainThread]: 
[0m13:18:48.600435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:48.600806 [info ] [MainThread]: 
[0m13:18:48.601178 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:18:48.601967 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6764599, "process_user_time": 1.687403, "process_kernel_time": 0.126729, "process_mem_max_rss": "110940", "process_out_blocks": "1760", "process_in_blocks": "0"}
[0m13:18:48.602595 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:48.602453 after 0.68 seconds
[0m13:18:48.603019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12ea8487d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12ea9cce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a12ea9ccf50>]}
[0m13:18:48.603563 [debug] [MainThread]: Flushing usage events
[0m13:31:05.112498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a1da31810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a1da32d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a1da30fd0>]}


============================== 13:31:05.115055 | 9f9817d6-7b49-4bbc-b143-aa647b29d84b ==============================
[0m13:31:05.115055 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:31:05.115614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:31:05.249203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f9817d6-7b49-4bbc-b143-aa647b29d84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a1e660990>]}
[0m13:31:05.296324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f9817d6-7b49-4bbc-b143-aa647b29d84b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a2174ce10>]}
[0m13:31:05.297052 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:31:05.306443 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:31:05.386463 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbt_modeling: marts/appointment/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version 2
    2  | 
    3  | models:
    4  |   - name: fct_appointment
    5  |     description: "It is a fact table that contain information about appointments"
    6  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 7
[0m13:31:05.387432 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.31733164, "process_user_time": 1.390153, "process_kernel_time": 0.116844, "process_mem_max_rss": "101660", "process_out_blocks": "8", "command_success": false, "process_in_blocks": "0"}
[0m13:31:05.387947 [debug] [MainThread]: Command `dbt test` failed at 13:31:05.387842 after 0.32 seconds
[0m13:31:05.388316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a1dd28e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a1dcc0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x737a1d9df610>]}
[0m13:31:05.388662 [debug] [MainThread]: Flushing usage events
[0m13:31:48.065732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab739c26b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab739c078d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab739c24fd0>]}


============================== 13:31:48.068514 | c0f48846-12d9-41fe-be9a-ef243cd1fae9 ==============================
[0m13:31:48.068514 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:31:48.069074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m13:31:48.210030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0f48846-12d9-41fe-be9a-ef243cd1fae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab73832a8d0>]}
[0m13:31:48.256649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0f48846-12d9-41fe-be9a-ef243cd1fae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab73d940ed0>]}
[0m13:31:48.257396 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:31:48.269884 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:31:48.376444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:31:48.377103 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/schema.yml
[0m13:31:48.439773 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:31:48.440247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c0f48846-12d9-41fe-be9a-ef243cd1fae9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab73837e710>]}
[0m13:31:48.685748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0f48846-12d9-41fe-be9a-ef243cd1fae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab737ffd210>]}
[0m13:31:48.790235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0f48846-12d9-41fe-be9a-ef243cd1fae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab737d56b90>]}
[0m13:31:48.790892 [info ] [MainThread]: Found 5 seeds, 10 models, 10 data tests, 415 macros
[0m13:31:48.791246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0f48846-12d9-41fe-be9a-ef243cd1fae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab738318a50>]}
[0m13:31:48.793704 [info ] [MainThread]: 
[0m13:31:48.794302 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:31:48.799188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m13:31:48.838394 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:31:48.838744 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:31:48.839003 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:48.843165 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:31:48.843570 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:31:48.843853 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:31:48.846275 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:31:48.847967 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:31:48.848511 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:31:48.856135 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:48.856499 [debug] [MainThread]: On master: BEGIN
[0m13:31:48.856749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:48.860001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:31:48.860363 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:48.860721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:48.876943 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m13:31:48.880789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0f48846-12d9-41fe-be9a-ef243cd1fae9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab738031a50>]}
[0m13:31:48.881171 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:48.881703 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:48.881981 [debug] [MainThread]: On master: BEGIN
[0m13:31:48.882582 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:31:48.882990 [debug] [MainThread]: On master: COMMIT
[0m13:31:48.883332 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:48.883600 [debug] [MainThread]: On master: COMMIT
[0m13:31:48.884060 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:31:48.884355 [debug] [MainThread]: On master: Close
[0m13:31:48.884872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:31:48.885192 [info ] [MainThread]: 
[0m13:31:48.887431 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:31:48.887864 [info ] [Thread-1 (]: 1 of 10 START test not_null_dim_doctor_doctor_id ............................... [RUN]
[0m13:31:48.888678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m13:31:48.889085 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:31:48.902914 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:31:48.903893 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:31:48.921787 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:31:48.922566 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:31:48.922911 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m13:31:48.923223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:48.926608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:48.927023 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:31:48.927381 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m13:31:48.928655 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:48.932512 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m13:31:48.933070 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m13:31:48.933867 [info ] [Thread-1 (]: 1 of 10 PASS not_null_dim_doctor_doctor_id ..................................... [[32mPASS[0m in 0.05s]
[0m13:31:48.934719 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:31:48.935274 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:31:48.935823 [info ] [Thread-1 (]: 2 of 10 START test not_null_dim_patient_patient_id ............................. [RUN]
[0m13:31:48.936284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m13:31:48.936627 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:31:48.940862 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:31:48.941392 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:31:48.943741 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:31:48.944231 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:31:48.944559 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m13:31:48.944850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:48.948248 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:48.949159 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:31:48.949798 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m13:31:48.951525 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:48.954093 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m13:31:48.954847 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m13:31:48.955762 [info ] [Thread-1 (]: 2 of 10 PASS not_null_dim_patient_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m13:31:48.956709 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:31:48.957238 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499
[0m13:31:48.957892 [info ] [Thread-1 (]: 3 of 10 START test not_null_fct_appointment_Appointment_id ..................... [RUN]
[0m13:31:48.958548 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499)
[0m13:31:48.958967 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499
[0m13:31:48.966980 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499"
[0m13:31:48.967576 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499
[0m13:31:48.970255 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499"
[0m13:31:48.970891 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499"
[0m13:31:48.971263 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499: BEGIN
[0m13:31:48.971642 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:48.975787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:48.976726 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499"
[0m13:31:48.977302 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Appointment_id
from "my_db"."public"."fct_appointment"
where Appointment_id is null



      
    ) dbt_internal_test
[0m13:31:48.985431 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:48.987403 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499: ROLLBACK
[0m13:31:48.988079 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499: Close
[0m13:31:48.988741 [info ] [Thread-1 (]: 3 of 10 PASS not_null_fct_appointment_Appointment_id ........................... [[32mPASS[0m in 0.03s]
[0m13:31:48.989497 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499
[0m13:31:48.990087 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230
[0m13:31:48.990715 [info ] [Thread-1 (]: 4 of 10 START test not_null_fct_appointment_Doctor_id .......................... [RUN]
[0m13:31:48.991356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_Appointment_id.14d8587499, now test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230)
[0m13:31:48.991797 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230
[0m13:31:48.998091 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230"
[0m13:31:48.998840 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230
[0m13:31:49.003115 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230"
[0m13:31:49.003761 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230"
[0m13:31:49.004106 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230: BEGIN
[0m13:31:49.004442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:49.007583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:49.007989 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230"
[0m13:31:49.008328 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Doctor_id
from "my_db"."public"."fct_appointment"
where Doctor_id is null



      
    ) dbt_internal_test
[0m13:31:49.014626 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:49.016600 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230: ROLLBACK
[0m13:31:49.017294 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230: Close
[0m13:31:49.018071 [info ] [Thread-1 (]: 4 of 10 PASS not_null_fct_appointment_Doctor_id ................................ [[32mPASS[0m in 0.03s]
[0m13:31:49.018850 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230
[0m13:31:49.019302 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0
[0m13:31:49.019921 [info ] [Thread-1 (]: 5 of 10 START test not_null_fct_appointment_Patient_id ......................... [RUN]
[0m13:31:49.020707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_Doctor_id.3ac5e07230, now test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0)
[0m13:31:49.021080 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0
[0m13:31:49.025278 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0"
[0m13:31:49.025790 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0
[0m13:31:49.030579 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0"
[0m13:31:49.031280 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0"
[0m13:31:49.031856 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0: BEGIN
[0m13:31:49.032199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:49.035912 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:49.036385 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0"
[0m13:31:49.036729 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select Patient_id
from "my_db"."public"."fct_appointment"
where Patient_id is null



      
    ) dbt_internal_test
[0m13:31:49.041991 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:49.043611 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0: ROLLBACK
[0m13:31:49.044145 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0: Close
[0m13:31:49.044997 [info ] [Thread-1 (]: 5 of 10 PASS not_null_fct_appointment_Patient_id ............................... [[32mPASS[0m in 0.02s]
[0m13:31:49.047297 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0
[0m13:31:49.048279 [debug] [Thread-1 (]: Began running node test.dbt_modeling.realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_.bf9397b4f8
[0m13:31:49.049039 [info ] [Thread-1 (]: 6 of 10 START test realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_  [RUN]
[0m13:31:49.050007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_Patient_id.30cd57d3f0, now test.dbt_modeling.realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_.bf9397b4f8)
[0m13:31:49.050686 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_.bf9397b4f8
[0m13:31:49.131672 [debug] [Thread-1 (]: Compilation Error in test realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)
  'test_realationships' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:31:49.132379 [error] [Thread-1 (]: 6 of 10 ERROR realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_  [[31mERROR[0m in 0.08s]
[0m13:31:49.133098 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_.bf9397b4f8
[0m13:31:49.133663 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f
[0m13:31:49.134956 [info ] [Thread-1 (]: 7 of 10 START test relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_  [RUN]
[0m13:31:49.135558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_.bf9397b4f8, now test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f)
[0m13:31:49.135998 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f
[0m13:31:49.144193 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f"
[0m13:31:49.145936 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f
[0m13:31:49.152911 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f"
[0m13:31:49.154213 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f"
[0m13:31:49.154735 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f: BEGIN
[0m13:31:49.155184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:49.159271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:49.159783 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f"
[0m13:31:49.160219 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select Doctor_id as from_field
    from "my_db"."public"."fct_appointment"
    where Doctor_id is not null
),

parent as (
    select Doctor_id as to_field
    from "my_db"."public"."dim_doctor"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:31:49.171054 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:49.172609 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f: ROLLBACK
[0m13:31:49.173059 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f: Close
[0m13:31:49.173782 [info ] [Thread-1 (]: 7 of 10 PASS relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_  [[32mPASS[0m in 0.04s]
[0m13:31:49.174626 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f
[0m13:31:49.175215 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:31:49.175768 [info ] [Thread-1 (]: 8 of 10 START test unique_dim_doctor_doctor_id ................................. [RUN]
[0m13:31:49.176230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_Doctor_id__Doctor_id__ref_dim_doctor_.339088840f, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m13:31:49.176611 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:31:49.187229 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:31:49.187810 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:31:49.190190 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:31:49.190709 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:31:49.191042 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m13:31:49.191351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:49.195095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:49.196482 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:31:49.197186 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:31:49.199480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:49.202310 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m13:31:49.203171 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m13:31:49.204609 [error] [Thread-1 (]: 8 of 10 FAIL 275 unique_dim_doctor_doctor_id ................................... [[31mFAIL 275[0m in 0.03s]
[0m13:31:49.205766 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:31:49.206340 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:31:49.206898 [info ] [Thread-1 (]: 9 of 10 START test unique_dim_patient_patient_id ............................... [RUN]
[0m13:31:49.207359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m13:31:49.207719 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:31:49.213053 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:31:49.214114 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:31:49.217386 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:31:49.218183 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:31:49.219065 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m13:31:49.219596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:49.223898 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:49.224410 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:31:49.224775 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:31:49.226662 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:49.228219 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m13:31:49.229241 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m13:31:49.231135 [error] [Thread-1 (]: 9 of 10 FAIL 280 unique_dim_patient_patient_id ................................. [[31mFAIL 280[0m in 0.02s]
[0m13:31:49.232241 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:31:49.233040 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e
[0m13:31:49.233881 [info ] [Thread-1 (]: 10 of 10 START test unique_fct_appointment_Appointment_id ...................... [RUN]
[0m13:31:49.234891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61, now test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e)
[0m13:31:49.235483 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e
[0m13:31:49.240760 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e"
[0m13:31:49.241378 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e
[0m13:31:49.243971 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e"
[0m13:31:49.244532 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e"
[0m13:31:49.244881 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e: BEGIN
[0m13:31:49.245519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:31:49.250168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:31:49.250702 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e"
[0m13:31:49.251068 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    Appointment_id as unique_field,
    count(*) as n_records

from "my_db"."public"."fct_appointment"
where Appointment_id is not null
group by Appointment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:31:49.260294 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:31:49.262032 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e: ROLLBACK
[0m13:31:49.263205 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e: Close
[0m13:31:49.264461 [error] [Thread-1 (]: 10 of 10 FAIL 171 unique_fct_appointment_Appointment_id ........................ [[31mFAIL 171[0m in 0.03s]
[0m13:31:49.265304 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e
[0m13:31:49.266783 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:49.267195 [debug] [MainThread]: On master: BEGIN
[0m13:31:49.267511 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:49.271481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:31:49.271903 [debug] [MainThread]: On master: COMMIT
[0m13:31:49.272188 [debug] [MainThread]: Using postgres connection "master"
[0m13:31:49.272489 [debug] [MainThread]: On master: COMMIT
[0m13:31:49.272938 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:31:49.273251 [debug] [MainThread]: On master: Close
[0m13:31:49.273679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:49.273940 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_fct_appointment_Appointment_id.1bfefe5d2e' was properly closed.
[0m13:31:49.274264 [info ] [MainThread]: 
[0m13:31:49.274616 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m13:31:49.276578 [debug] [MainThread]: Command end result
[0m13:31:49.315959 [info ] [MainThread]: 
[0m13:31:49.316525 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m13:31:49.316895 [info ] [MainThread]: 
[0m13:31:49.317375 [error] [MainThread]:   Compilation Error in test realationships_fct_appointment_Patient_id__Patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)
  'test_realationships' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:31:49.317703 [info ] [MainThread]: 
[0m13:31:49.318107 [error] [MainThread]: [31mFailure in test unique_dim_doctor_doctor_id (models/marts/appointment/schema.yml)[0m
[0m13:31:49.318491 [error] [MainThread]:   Got 275 results, configured to fail if != 0
[0m13:31:49.318792 [info ] [MainThread]: 
[0m13:31:49.319173 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_doctor_doctor_id.sql
[0m13:31:49.319490 [info ] [MainThread]: 
[0m13:31:49.319894 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m13:31:49.320315 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m13:31:49.320648 [info ] [MainThread]: 
[0m13:31:49.321011 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m13:31:49.321299 [info ] [MainThread]: 
[0m13:31:49.321678 [error] [MainThread]: [31mFailure in test unique_fct_appointment_Appointment_id (models/marts/appointment/schema.yml)[0m
[0m13:31:49.322089 [error] [MainThread]:   Got 171 results, configured to fail if != 0
[0m13:31:49.322431 [info ] [MainThread]: 
[0m13:31:49.322814 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_fct_appointment_Appointment_id.sql
[0m13:31:49.323137 [info ] [MainThread]: 
[0m13:31:49.323486 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=4 SKIP=0 TOTAL=10
[0m13:31:49.324287 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.3073537, "process_user_time": 2.455038, "process_kernel_time": 0.159612, "process_mem_max_rss": "115648", "process_out_blocks": "2920", "command_success": false, "process_in_blocks": "0"}
[0m13:31:49.324780 [debug] [MainThread]: Command `dbt test` failed at 13:31:49.324672 after 1.31 seconds
[0m13:31:49.325131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab739c312d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab739d9fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ab739fa40d0>]}
[0m13:31:49.325488 [debug] [MainThread]: Flushing usage events
[0m13:32:23.381671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64b350c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64b17da710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64b18ac090>]}


============================== 13:32:23.384633 | ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1 ==============================
[0m13:32:23.384633 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:32:23.385298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:32:23.520588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64b182d990>]}
[0m13:32:23.567057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64b5508c50>]}
[0m13:32:23.567976 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:32:23.576343 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:32:23.684160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:23.685115 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/schema.yml
[0m13:32:23.874859 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:32:23.875359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64afaf1890>]}
[0m13:32:24.071320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64afeeb950>]}
[0m13:32:24.166917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64aefb4a90>]}
[0m13:32:24.167406 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m13:32:24.167732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64afab4fd0>]}
[0m13:32:24.170499 [info ] [MainThread]: 
[0m13:32:24.170981 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:24.175357 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m13:32:24.267455 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:32:24.267991 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:32:24.268499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:24.274445 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.274920 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:32:24.275331 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:32:24.278458 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:32:24.280267 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:32:24.280957 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:32:24.288813 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:24.289175 [debug] [MainThread]: On master: BEGIN
[0m13:32:24.289465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:24.292412 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.292807 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:24.293214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:32:24.310610 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m13:32:24.314668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecf19aeb-d89b-4c66-bd0f-20d2e15f61c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64ae385350>]}
[0m13:32:24.315090 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:24.315582 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:24.315872 [debug] [MainThread]: On master: BEGIN
[0m13:32:24.316380 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.316704 [debug] [MainThread]: On master: COMMIT
[0m13:32:24.316996 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:24.317265 [debug] [MainThread]: On master: COMMIT
[0m13:32:24.317708 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:32:24.318025 [debug] [MainThread]: On master: Close
[0m13:32:24.318532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:32:24.318884 [info ] [MainThread]: 
[0m13:32:24.321366 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:32:24.321837 [info ] [Thread-1 (]: 1 of 20 START test not_null_dim_billing_invoice_id ............................. [RUN]
[0m13:32:24.322326 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m13:32:24.322754 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:32:24.335548 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:32:24.336306 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:32:24.351616 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:32:24.352418 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:32:24.352903 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m13:32:24.353240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.356692 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.357258 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:32:24.357708 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m13:32:24.360960 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.365475 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m13:32:24.366091 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m13:32:24.367176 [info ] [Thread-1 (]: 1 of 20 PASS not_null_dim_billing_invoice_id ................................... [[32mPASS[0m in 0.04s]
[0m13:32:24.368262 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:32:24.368923 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:32:24.369474 [info ] [Thread-1 (]: 2 of 20 START test not_null_dim_doctor_doctor_id ............................... [RUN]
[0m13:32:24.369956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m13:32:24.370293 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:32:24.375344 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:32:24.375886 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:32:24.378135 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:32:24.378640 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:32:24.378960 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m13:32:24.379257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.382424 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.382884 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:32:24.383267 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m13:32:24.384794 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.386569 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m13:32:24.387263 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m13:32:24.388115 [info ] [Thread-1 (]: 2 of 20 PASS not_null_dim_doctor_doctor_id ..................................... [[32mPASS[0m in 0.02s]
[0m13:32:24.389048 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:32:24.389610 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:32:24.390135 [info ] [Thread-1 (]: 3 of 20 START test not_null_dim_medical_procedure_procedure_id ................. [RUN]
[0m13:32:24.390720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m13:32:24.391086 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:32:24.395653 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:32:24.396269 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:32:24.399346 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:32:24.400113 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:32:24.400596 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m13:32:24.400930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.404059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.404506 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:32:24.404844 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m13:32:24.407858 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.409308 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m13:32:24.409845 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m13:32:24.410630 [info ] [Thread-1 (]: 3 of 20 PASS not_null_dim_medical_procedure_procedure_id ....................... [[32mPASS[0m in 0.02s]
[0m13:32:24.411587 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:32:24.412279 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:32:24.412886 [info ] [Thread-1 (]: 4 of 20 START test not_null_dim_patient_patient_id ............................. [RUN]
[0m13:32:24.413442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m13:32:24.414693 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:32:24.420823 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:32:24.421388 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:32:24.423840 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:32:24.424399 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:32:24.424730 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m13:32:24.425030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.428125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.428551 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:32:24.428904 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m13:32:24.430248 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.432621 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m13:32:24.433295 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m13:32:24.434280 [info ] [Thread-1 (]: 4 of 20 PASS not_null_dim_patient_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m13:32:24.436266 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:32:24.437201 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:32:24.437915 [info ] [Thread-1 (]: 5 of 20 START test not_null_fct_appointment_appointment_date ................... [RUN]
[0m13:32:24.438417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed)
[0m13:32:24.438766 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:32:24.443088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:32:24.443621 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:32:24.445870 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:32:24.446424 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:32:24.446922 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: BEGIN
[0m13:32:24.447662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.452268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.452985 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:32:24.453452 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_date
from "my_db"."public"."fct_appointment"
where appointment_date is null



      
    ) dbt_internal_test
[0m13:32:24.458860 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.460452 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: ROLLBACK
[0m13:32:24.460956 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: Close
[0m13:32:24.461546 [info ] [Thread-1 (]: 5 of 20 PASS not_null_fct_appointment_appointment_date ......................... [[32mPASS[0m in 0.02s]
[0m13:32:24.462163 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:32:24.462584 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:32:24.463044 [info ] [Thread-1 (]: 6 of 20 START test not_null_fct_appointment_appointment_id ..................... [RUN]
[0m13:32:24.463754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed, now test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21)
[0m13:32:24.464812 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:32:24.469903 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:32:24.470526 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:32:24.472953 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:32:24.473499 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:32:24.473826 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: BEGIN
[0m13:32:24.474126 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.477154 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.477567 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:32:24.477907 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_id
from "my_db"."public"."fct_appointment"
where appointment_id is null



      
    ) dbt_internal_test
[0m13:32:24.483395 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.485460 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: ROLLBACK
[0m13:32:24.486144 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: Close
[0m13:32:24.486874 [info ] [Thread-1 (]: 6 of 20 PASS not_null_fct_appointment_appointment_id ........................... [[32mPASS[0m in 0.02s]
[0m13:32:24.487712 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:32:24.488162 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:32:24.488635 [info ] [Thread-1 (]: 7 of 20 START test not_null_fct_appointment_doctor_id .......................... [RUN]
[0m13:32:24.489384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21, now test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64)
[0m13:32:24.489804 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:32:24.494121 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:32:24.494663 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:32:24.496945 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:32:24.497701 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:32:24.498214 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: BEGIN
[0m13:32:24.498617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.502203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.502776 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:32:24.503165 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."fct_appointment"
where doctor_id is null



      
    ) dbt_internal_test
[0m13:32:24.508431 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.509942 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: ROLLBACK
[0m13:32:24.510411 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: Close
[0m13:32:24.510956 [info ] [Thread-1 (]: 7 of 20 PASS not_null_fct_appointment_doctor_id ................................ [[32mPASS[0m in 0.02s]
[0m13:32:24.511557 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:32:24.511984 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:32:24.512417 [info ] [Thread-1 (]: 8 of 20 START test not_null_fct_appointment_invoice_id ......................... [RUN]
[0m13:32:24.512883 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64, now test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62)
[0m13:32:24.513267 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:32:24.521992 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:32:24.522549 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:32:24.524965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:32:24.525508 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:32:24.525851 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: BEGIN
[0m13:32:24.526173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.529416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.529947 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:32:24.530473 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."fct_appointment"
where invoice_id is null



      
    ) dbt_internal_test
[0m13:32:24.538742 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.540377 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: ROLLBACK
[0m13:32:24.540979 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: Close
[0m13:32:24.541693 [info ] [Thread-1 (]: 8 of 20 PASS not_null_fct_appointment_invoice_id ............................... [[32mPASS[0m in 0.03s]
[0m13:32:24.542419 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:32:24.542880 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:32:24.543349 [info ] [Thread-1 (]: 9 of 20 START test not_null_fct_appointment_patient_id ......................... [RUN]
[0m13:32:24.543860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62, now test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09)
[0m13:32:24.544207 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:32:24.549399 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:32:24.550120 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:32:24.553035 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:32:24.553891 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:32:24.554374 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: BEGIN
[0m13:32:24.554706 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.558227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.558677 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:32:24.559026 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."fct_appointment"
where patient_id is null



      
    ) dbt_internal_test
[0m13:32:24.564633 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.566720 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: ROLLBACK
[0m13:32:24.567460 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: Close
[0m13:32:24.568161 [info ] [Thread-1 (]: 9 of 20 PASS not_null_fct_appointment_patient_id ............................... [[32mPASS[0m in 0.02s]
[0m13:32:24.568985 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:32:24.569518 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:32:24.570214 [info ] [Thread-1 (]: 10 of 20 START test not_null_fct_appointment_procedure_id ...................... [RUN]
[0m13:32:24.570798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09, now test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758)
[0m13:32:24.571202 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:32:24.575479 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:32:24.575984 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:32:24.578239 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:32:24.578733 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:32:24.579048 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: BEGIN
[0m13:32:24.579349 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.583359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.583944 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:32:24.584518 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."fct_appointment"
where procedure_id is null



      
    ) dbt_internal_test
[0m13:32:24.591782 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.593308 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: ROLLBACK
[0m13:32:24.593918 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: Close
[0m13:32:24.594567 [info ] [Thread-1 (]: 10 of 20 PASS not_null_fct_appointment_procedure_id ............................ [[32mPASS[0m in 0.02s]
[0m13:32:24.595182 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:32:24.595642 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:32:24.596062 [info ] [Thread-1 (]: 11 of 20 START test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m13:32:24.596538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758, now test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549)
[0m13:32:24.596929 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:32:24.603197 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:32:24.603846 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:32:24.606467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:32:24.607080 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:32:24.607468 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: BEGIN
[0m13:32:24.607817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.610909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.611386 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:32:24.611771 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."dim_billing"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:32:24.615856 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.617904 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: ROLLBACK
[0m13:32:24.618658 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: Close
[0m13:32:24.619423 [error] [Thread-1 (]: 11 of 20 FAIL 336 relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [[31mFAIL 336[0m in 0.02s]
[0m13:32:24.620292 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:32:24.620769 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:32:24.621261 [info ] [Thread-1 (]: 12 of 20 START test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [RUN]
[0m13:32:24.621829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549, now test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc)
[0m13:32:24.622241 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:32:24.627731 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:32:24.628247 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:32:24.630736 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:32:24.631829 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:32:24.632254 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: BEGIN
[0m13:32:24.632682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.636699 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.637243 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:32:24.637692 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select doctor_id as from_field
    from "my_db"."public"."fct_appointment"
    where doctor_id is not null
),

parent as (
    select doctor_id as to_field
    from "my_db"."public"."dim_doctor"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:32:24.647589 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.649808 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: ROLLBACK
[0m13:32:24.650540 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: Close
[0m13:32:24.651292 [info ] [Thread-1 (]: 12 of 20 PASS relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [[32mPASS[0m in 0.03s]
[0m13:32:24.652128 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:32:24.652675 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:32:24.653203 [info ] [Thread-1 (]: 13 of 20 START test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [RUN]
[0m13:32:24.653763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc, now test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77)
[0m13:32:24.654142 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:32:24.659368 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:32:24.659894 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:32:24.662093 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:32:24.662555 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:32:24.662890 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: BEGIN
[0m13:32:24.663216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.667450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.668064 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:32:24.668616 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select invoice_id as from_field
    from "my_db"."public"."fct_appointment"
    where invoice_id is not null
),

parent as (
    select invoice_id as to_field
    from "my_db"."public"."dim_billing"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:32:24.679782 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.681659 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: ROLLBACK
[0m13:32:24.682318 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: Close
[0m13:32:24.683245 [info ] [Thread-1 (]: 13 of 20 PASS relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [[32mPASS[0m in 0.03s]
[0m13:32:24.684325 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:32:24.685033 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:32:24.685642 [info ] [Thread-1 (]: 14 of 20 START test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m13:32:24.686211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77, now test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c)
[0m13:32:24.686598 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:32:24.693707 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:32:24.694216 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:32:24.696540 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:32:24.697077 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:32:24.697524 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: BEGIN
[0m13:32:24.697873 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.701682 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.702174 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:32:24.702621 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."fct_appointment"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:32:24.712114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.713865 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: ROLLBACK
[0m13:32:24.715058 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: Close
[0m13:32:24.715940 [info ] [Thread-1 (]: 14 of 20 PASS relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [[32mPASS[0m in 0.03s]
[0m13:32:24.716790 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:32:24.717359 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:32:24.718004 [info ] [Thread-1 (]: 15 of 20 START test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [RUN]
[0m13:32:24.718610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c, now test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46)
[0m13:32:24.719030 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:32:24.724658 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:32:24.725169 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:32:24.727421 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:32:24.727926 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:32:24.728276 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: BEGIN
[0m13:32:24.728599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.732285 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.732765 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:32:24.733268 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select procedure_id as from_field
    from "my_db"."public"."fct_appointment"
    where procedure_id is not null
),

parent as (
    select procedure_id as to_field
    from "my_db"."public"."dim_medical_procedure"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:32:24.744971 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.746505 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: ROLLBACK
[0m13:32:24.747209 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: Close
[0m13:32:24.748401 [info ] [Thread-1 (]: 15 of 20 PASS relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [[32mPASS[0m in 0.03s]
[0m13:32:24.749286 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:32:24.749848 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:32:24.750367 [info ] [Thread-1 (]: 16 of 20 START test unique_dim_billing_invoice_id .............................. [RUN]
[0m13:32:24.751068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m13:32:24.751523 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:32:24.758540 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:32:24.759070 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:32:24.761348 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:32:24.761836 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:32:24.762154 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m13:32:24.762454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.766097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.766647 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:32:24.767076 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:24.770939 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.772761 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m13:32:24.773390 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m13:32:24.774035 [info ] [Thread-1 (]: 16 of 20 PASS unique_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.02s]
[0m13:32:24.774670 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:32:24.775068 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:32:24.775484 [info ] [Thread-1 (]: 17 of 20 START test unique_dim_doctor_doctor_id ................................ [RUN]
[0m13:32:24.775937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m13:32:24.776310 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:32:24.780413 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:32:24.781700 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:32:24.784660 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:32:24.785490 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:32:24.785870 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m13:32:24.786306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.789815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.790279 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:32:24.790632 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:24.792457 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.793900 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m13:32:24.794311 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m13:32:24.794902 [error] [Thread-1 (]: 17 of 20 FAIL 275 unique_dim_doctor_doctor_id .................................. [[31mFAIL 275[0m in 0.02s]
[0m13:32:24.795600 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:32:24.796038 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:32:24.796455 [info ] [Thread-1 (]: 18 of 20 START test unique_dim_medical_procedure_procedure_id .................. [RUN]
[0m13:32:24.797146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m13:32:24.797803 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:32:24.803269 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:32:24.804061 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:32:24.806738 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:32:24.807311 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:32:24.807667 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m13:32:24.807975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.810983 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.811421 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:32:24.811767 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:24.815676 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.817654 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m13:32:24.818398 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m13:32:24.819260 [error] [Thread-1 (]: 18 of 20 FAIL 260 unique_dim_medical_procedure_procedure_id .................... [[31mFAIL 260[0m in 0.02s]
[0m13:32:24.820153 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:32:24.820691 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:32:24.821187 [info ] [Thread-1 (]: 19 of 20 START test unique_dim_patient_patient_id .............................. [RUN]
[0m13:32:24.821726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m13:32:24.822159 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:32:24.826637 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:32:24.827206 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:32:24.829465 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:32:24.830049 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:32:24.830628 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m13:32:24.831234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.835114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.835599 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:32:24.835970 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:24.838010 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.839619 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m13:32:24.840139 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m13:32:24.840853 [error] [Thread-1 (]: 19 of 20 FAIL 280 unique_dim_patient_patient_id ................................ [[31mFAIL 280[0m in 0.02s]
[0m13:32:24.841585 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:32:24.842038 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:32:24.842461 [info ] [Thread-1 (]: 20 of 20 START test unique_fct_appointment_appointment_id ...................... [RUN]
[0m13:32:24.842952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61, now test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f)
[0m13:32:24.843312 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:32:24.852116 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:32:24.852865 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:32:24.855270 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:32:24.855823 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:32:24.856170 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: BEGIN
[0m13:32:24.856653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:24.859759 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.860166 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:32:24.860527 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    appointment_id as unique_field,
    count(*) as n_records

from "my_db"."public"."fct_appointment"
where appointment_id is not null
group by appointment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:24.869943 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:32:24.871685 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: ROLLBACK
[0m13:32:24.872363 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: Close
[0m13:32:24.873010 [error] [Thread-1 (]: 20 of 20 FAIL 171 unique_fct_appointment_appointment_id ........................ [[31mFAIL 171[0m in 0.03s]
[0m13:32:24.873644 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:32:24.874775 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:24.875096 [debug] [MainThread]: On master: BEGIN
[0m13:32:24.875376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:24.878348 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:32:24.878762 [debug] [MainThread]: On master: COMMIT
[0m13:32:24.879091 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:24.879376 [debug] [MainThread]: On master: COMMIT
[0m13:32:24.879799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:32:24.880104 [debug] [MainThread]: On master: Close
[0m13:32:24.880657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:24.881057 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f' was properly closed.
[0m13:32:24.881689 [info ] [MainThread]: 
[0m13:32:24.882153 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m13:32:24.886391 [debug] [MainThread]: Command end result
[0m13:32:24.920373 [info ] [MainThread]: 
[0m13:32:24.920912 [info ] [MainThread]: [31mCompleted with 5 errors and 0 warnings:[0m
[0m13:32:24.921275 [info ] [MainThread]: 
[0m13:32:24.921700 [error] [MainThread]: [31mFailure in test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)[0m
[0m13:32:24.922065 [error] [MainThread]:   Got 336 results, configured to fail if != 0
[0m13:32:24.922364 [info ] [MainThread]: 
[0m13:32:24.922764 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/relationships_dim_billing_67d755ce333822e0ca7d372874c62656.sql
[0m13:32:24.923075 [info ] [MainThread]: 
[0m13:32:24.923484 [error] [MainThread]: [31mFailure in test unique_dim_doctor_doctor_id (models/marts/appointment/schema.yml)[0m
[0m13:32:24.923858 [error] [MainThread]:   Got 275 results, configured to fail if != 0
[0m13:32:24.924151 [info ] [MainThread]: 
[0m13:32:24.924530 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_doctor_doctor_id.sql
[0m13:32:24.924835 [info ] [MainThread]: 
[0m13:32:24.925227 [error] [MainThread]: [31mFailure in test unique_dim_medical_procedure_procedure_id (models/marts/appointment/schema.yml)[0m
[0m13:32:24.925629 [error] [MainThread]:   Got 260 results, configured to fail if != 0
[0m13:32:24.925967 [info ] [MainThread]: 
[0m13:32:24.926404 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_medical_procedure_procedure_id.sql
[0m13:32:24.926721 [info ] [MainThread]: 
[0m13:32:24.927122 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m13:32:24.927499 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m13:32:24.927794 [info ] [MainThread]: 
[0m13:32:24.928176 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m13:32:24.928491 [info ] [MainThread]: 
[0m13:32:24.928878 [error] [MainThread]: [31mFailure in test unique_fct_appointment_appointment_id (models/marts/appointment/schema.yml)[0m
[0m13:32:24.929250 [error] [MainThread]:   Got 171 results, configured to fail if != 0
[0m13:32:24.929564 [info ] [MainThread]: 
[0m13:32:24.929942 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_fct_appointment_appointment_id.sql
[0m13:32:24.930311 [info ] [MainThread]: 
[0m13:32:24.930809 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=5 SKIP=0 TOTAL=20
[0m13:32:24.932312 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.624646, "process_user_time": 2.5527, "process_kernel_time": 0.158856, "process_mem_max_rss": "117356", "process_out_blocks": "3360", "command_success": false, "process_in_blocks": "0"}
[0m13:32:24.932925 [debug] [MainThread]: Command `dbt test` failed at 13:32:24.932812 after 1.63 seconds
[0m13:32:24.933320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64b188bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64b19a8210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a64afb4d550>]}
[0m13:32:24.933895 [debug] [MainThread]: Flushing usage events
[0m13:40:27.799706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21439ca250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21439a7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2143cb0d10>]}


============================== 13:40:27.802254 | eec75931-0cfd-4b33-a64c-9121330379a2 ==============================
[0m13:40:27.802254 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:40:27.802765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_doctor', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:27.932811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21439a7510>]}
[0m13:40:27.978850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21476d8f50>]}
[0m13:40:27.979583 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:40:27.989247 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:40:28.097427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:40:28.098446 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/schema.yml
[0m13:40:28.098739 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m13:40:28.293623 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m13:40:28.294056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2142129210>]}
[0m13:40:28.503894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2141d21910>]}
[0m13:40:28.586983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2141928950>]}
[0m13:40:28.587819 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m13:40:28.588396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b214198b3d0>]}
[0m13:40:28.590447 [info ] [MainThread]: 
[0m13:40:28.591047 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:28.591897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m13:40:28.683129 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m13:40:28.683689 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m13:40:28.684141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:28.689829 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:40:28.691195 [debug] [ThreadPool]: On list_my_db: Close
[0m13:40:28.696282 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m13:40:28.702227 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:40:28.702772 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:40:28.703146 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:28.707081 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:40:28.707484 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:40:28.707789 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:40:28.710492 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:40:28.712751 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:40:28.713390 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:40:28.725491 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:28.725986 [debug] [MainThread]: On master: BEGIN
[0m13:40:28.726383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:28.729779 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:28.730320 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:28.730814 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:28.748075 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m13:40:28.752096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2141964950>]}
[0m13:40:28.752635 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:28.753140 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:28.753456 [debug] [MainThread]: On master: BEGIN
[0m13:40:28.754077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:28.754458 [debug] [MainThread]: On master: COMMIT
[0m13:40:28.754747 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:28.755026 [debug] [MainThread]: On master: COMMIT
[0m13:40:28.755459 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:40:28.755865 [debug] [MainThread]: On master: Close
[0m13:40:28.756365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:28.756728 [info ] [MainThread]: 
[0m13:40:28.759042 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_doctor
[0m13:40:28.759650 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_doctor .................................. [RUN]
[0m13:40:28.760166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_doctor)
[0m13:40:28.760633 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_doctor
[0m13:40:28.767924 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_doctor"
[0m13:40:28.768547 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_doctor
[0m13:40:28.806416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_doctor"
[0m13:40:28.807035 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m13:40:28.807381 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: BEGIN
[0m13:40:28.807682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:28.810863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:28.811308 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m13:40:28.811660 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */

  create view "my_db"."public"."dim_doctor__dbt_tmp"
    
    
  as (
    with doctor as (
    select  "DoctorID" as Doctor_id,
            "DoctorName" as Doctor_name,
            "Specialization",
            "DoctorContact" as Doctor_contact
    from "my_db"."public"."Doctor"       
   
)

select distinct Doctor_id from doctor 
order by doctor_id
  );
[0m13:40:28.813400 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:40:28.820223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m13:40:28.820647 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor" rename to "dim_doctor__dbt_backup"
[0m13:40:28.821424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:40:28.824571 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m13:40:28.824944 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor__dbt_tmp" rename to "dim_doctor"
[0m13:40:28.825697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:40:28.842175 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m13:40:28.842566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m13:40:28.842868 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m13:40:28.850499 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:40:28.858643 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_doctor__dbt_backup"
[0m13:40:28.863490 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m13:40:28.863876 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
drop view if exists "my_db"."public"."dim_doctor__dbt_backup" cascade
[0m13:40:28.865647 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:40:28.867839 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: Close
[0m13:40:28.869443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eec75931-0cfd-4b33-a64c-9121330379a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2141d9b610>]}
[0m13:40:28.870114 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_doctor ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m13:40:28.870751 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_doctor
[0m13:40:28.871976 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:28.872468 [debug] [MainThread]: On master: BEGIN
[0m13:40:28.872902 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:28.876400 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:28.876922 [debug] [MainThread]: On master: COMMIT
[0m13:40:28.877324 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:28.877717 [debug] [MainThread]: On master: COMMIT
[0m13:40:28.878295 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:40:28.878745 [debug] [MainThread]: On master: Close
[0m13:40:28.879408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:28.879919 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_doctor' was properly closed.
[0m13:40:28.880367 [info ] [MainThread]: 
[0m13:40:28.880919 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:40:28.882627 [debug] [MainThread]: Command end result
[0m13:40:28.915588 [info ] [MainThread]: 
[0m13:40:28.916041 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:28.916366 [info ] [MainThread]: 
[0m13:40:28.916695 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:40:28.917453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1602004, "process_user_time": 2.161063, "process_kernel_time": 0.142938, "process_mem_max_rss": "115500", "process_out_blocks": "2880", "process_in_blocks": "0"}
[0m13:40:28.917927 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:28.917823 after 1.16 seconds
[0m13:40:28.918253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b21477d4750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2141d199d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b2147930490>]}
[0m13:40:28.918580 [debug] [MainThread]: Flushing usage events
[0m13:40:49.014258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2b13753d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2b1370750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2b1356610>]}


============================== 13:40:49.016965 | 53e9e1e1-d62e-4664-be13-eba060c5dc35 ==============================
[0m13:40:49.016965 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:40:49.017488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:40:49.147016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53e9e1e1-d62e-4664-be13-eba060c5dc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2afa28710>]}
[0m13:40:49.193325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53e9e1e1-d62e-4664-be13-eba060c5dc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2b50906d0>]}
[0m13:40:49.194017 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:40:49.203553 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:40:49.326648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:49.326982 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:49.369542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53e9e1e1-d62e-4664-be13-eba060c5dc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2b1381f10>]}
[0m13:40:49.463916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53e9e1e1-d62e-4664-be13-eba060c5dc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2af5512d0>]}
[0m13:40:49.464511 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m13:40:49.464846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e9e1e1-d62e-4664-be13-eba060c5dc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2af935ed0>]}
[0m13:40:49.467663 [info ] [MainThread]: 
[0m13:40:49.468211 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:49.474497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m13:40:49.514252 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:40:49.514628 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:40:49.514891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:49.519462 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.519900 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:40:49.520199 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:40:49.522837 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m13:40:49.524354 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:40:49.524853 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:40:49.532769 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:49.533105 [debug] [MainThread]: On master: BEGIN
[0m13:40:49.533358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:49.536385 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.536767 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:49.537132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:49.552553 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m13:40:49.555513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53e9e1e1-d62e-4664-be13-eba060c5dc35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2af93dd10>]}
[0m13:40:49.555895 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:49.556356 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:49.556617 [debug] [MainThread]: On master: BEGIN
[0m13:40:49.557189 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.557544 [debug] [MainThread]: On master: COMMIT
[0m13:40:49.557806 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:49.558177 [debug] [MainThread]: On master: COMMIT
[0m13:40:49.558620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:40:49.558940 [debug] [MainThread]: On master: Close
[0m13:40:49.559398 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:40:49.559738 [info ] [MainThread]: 
[0m13:40:49.562531 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:40:49.562942 [info ] [Thread-1 (]: 1 of 20 START test not_null_dim_billing_invoice_id ............................. [RUN]
[0m13:40:49.563415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m13:40:49.563945 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:40:49.581377 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:40:49.582135 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:40:49.597322 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:40:49.598008 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:40:49.598349 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m13:40:49.598650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.601620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.602036 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:40:49.602381 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m13:40:49.605236 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:49.609083 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m13:40:49.609602 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m13:40:49.610327 [info ] [Thread-1 (]: 1 of 20 PASS not_null_dim_billing_invoice_id ................................... [[32mPASS[0m in 0.05s]
[0m13:40:49.611168 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:40:49.611749 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:40:49.612194 [info ] [Thread-1 (]: 2 of 20 START test not_null_dim_doctor_doctor_id ............................... [RUN]
[0m13:40:49.612831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m13:40:49.613222 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:40:49.617358 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:40:49.617943 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:40:49.621186 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:40:49.621793 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:40:49.622214 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m13:40:49.622665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.626247 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.626740 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:40:49.627074 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m13:40:49.628330 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:49.629942 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m13:40:49.630542 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m13:40:49.631415 [info ] [Thread-1 (]: 2 of 20 PASS not_null_dim_doctor_doctor_id ..................................... [[32mPASS[0m in 0.02s]
[0m13:40:49.632696 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:40:49.633369 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:40:49.633949 [info ] [Thread-1 (]: 3 of 20 START test not_null_dim_medical_procedure_procedure_id ................. [RUN]
[0m13:40:49.634446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m13:40:49.634789 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:40:49.638869 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:40:49.639411 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:40:49.641709 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:40:49.642646 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:40:49.643171 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m13:40:49.643539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.647044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.647509 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:40:49.647912 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m13:40:49.651443 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:49.653011 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m13:40:49.653549 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m13:40:49.654138 [info ] [Thread-1 (]: 3 of 20 PASS not_null_dim_medical_procedure_procedure_id ....................... [[32mPASS[0m in 0.02s]
[0m13:40:49.654803 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:40:49.655191 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:40:49.655629 [info ] [Thread-1 (]: 4 of 20 START test not_null_dim_patient_patient_id ............................. [RUN]
[0m13:40:49.656063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m13:40:49.656403 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:40:49.661617 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:40:49.662443 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:40:49.665140 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:40:49.665819 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:40:49.666167 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m13:40:49.666503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.669501 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.669914 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:40:49.670258 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m13:40:49.671522 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:49.672968 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m13:40:49.673392 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m13:40:49.673973 [info ] [Thread-1 (]: 4 of 20 PASS not_null_dim_patient_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m13:40:49.674600 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:40:49.675134 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:40:49.676019 [info ] [Thread-1 (]: 5 of 20 START test not_null_fct_appointment_appointment_date ................... [RUN]
[0m13:40:49.677105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed)
[0m13:40:49.677630 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:40:49.683016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:40:49.683630 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:40:49.686039 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:40:49.686612 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:40:49.686948 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: BEGIN
[0m13:40:49.687261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.690413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.690839 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:40:49.691186 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_date
from "my_db"."public"."fct_appointment"
where appointment_date is null



      
    ) dbt_internal_test
[0m13:40:49.691989 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m13:40:49.692670 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: ROLLBACK
[0m13:40:49.693527 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: Close
[0m13:40:49.698854 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_appointment_date (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_date.sql
[0m13:40:49.699583 [error] [Thread-1 (]: 5 of 20 ERROR not_null_fct_appointment_appointment_date ........................ [[31mERROR[0m in 0.02s]
[0m13:40:49.700284 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:40:49.700717 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:40:49.701070 [info ] [Thread-1 (]: 6 of 20 START test not_null_fct_appointment_appointment_id ..................... [RUN]
[0m13:40:49.702245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed, now test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21)
[0m13:40:49.702677 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:40:49.706925 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:40:49.707498 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:40:49.710575 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:40:49.711467 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:40:49.712307 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: BEGIN
[0m13:40:49.713079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.716534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.716955 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:40:49.717289 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_id
from "my_db"."public"."fct_appointment"
where appointment_id is null



      
    ) dbt_internal_test
[0m13:40:49.717979 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m13:40:49.718359 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: ROLLBACK
[0m13:40:49.718929 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: Close
[0m13:40:49.721348 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_id.sql
[0m13:40:49.721842 [error] [Thread-1 (]: 6 of 20 ERROR not_null_fct_appointment_appointment_id .......................... [[31mERROR[0m in 0.02s]
[0m13:40:49.722584 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:40:49.723072 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:40:49.723524 [info ] [Thread-1 (]: 7 of 20 START test not_null_fct_appointment_doctor_id .......................... [RUN]
[0m13:40:49.724025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21, now test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64)
[0m13:40:49.724380 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:40:49.730417 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:40:49.731085 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:40:49.733653 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:40:49.734227 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:40:49.734667 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: BEGIN
[0m13:40:49.734996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.738125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.738557 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:40:49.738913 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."fct_appointment"
where doctor_id is null



      
    ) dbt_internal_test
[0m13:40:49.739500 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m13:40:49.739843 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: ROLLBACK
[0m13:40:49.740304 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: Close
[0m13:40:49.743386 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_doctor_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_doctor_id.sql
[0m13:40:49.744286 [error] [Thread-1 (]: 7 of 20 ERROR not_null_fct_appointment_doctor_id ............................... [[31mERROR[0m in 0.02s]
[0m13:40:49.745276 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:40:49.746161 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:40:49.747228 [info ] [Thread-1 (]: 8 of 20 START test not_null_fct_appointment_invoice_id ......................... [RUN]
[0m13:40:49.748036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64, now test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62)
[0m13:40:49.748548 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:40:49.752995 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:40:49.753579 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:40:49.757609 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:40:49.758257 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:40:49.758803 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: BEGIN
[0m13:40:49.759446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.764168 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.764673 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:40:49.765073 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."fct_appointment"
where invoice_id is null



      
    ) dbt_internal_test
[0m13:40:49.766147 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m13:40:49.766711 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: ROLLBACK
[0m13:40:49.767300 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: Close
[0m13:40:49.770038 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_invoice_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_invoice_id.sql
[0m13:40:49.770813 [error] [Thread-1 (]: 8 of 20 ERROR not_null_fct_appointment_invoice_id .............................. [[31mERROR[0m in 0.02s]
[0m13:40:49.771479 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:40:49.771911 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:40:49.772400 [info ] [Thread-1 (]: 9 of 20 START test not_null_fct_appointment_patient_id ......................... [RUN]
[0m13:40:49.772872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62, now test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09)
[0m13:40:49.773278 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:40:49.779063 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:40:49.779812 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:40:49.782528 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:40:49.783212 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:40:49.783600 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: BEGIN
[0m13:40:49.783906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.786894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.787307 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:40:49.787660 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."fct_appointment"
where patient_id is null



      
    ) dbt_internal_test
[0m13:40:49.788263 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m13:40:49.788633 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: ROLLBACK
[0m13:40:49.789106 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: Close
[0m13:40:49.791507 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_patient_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_patient_id.sql
[0m13:40:49.792414 [error] [Thread-1 (]: 9 of 20 ERROR not_null_fct_appointment_patient_id .............................. [[31mERROR[0m in 0.02s]
[0m13:40:49.793647 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:40:49.794234 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:40:49.794970 [info ] [Thread-1 (]: 10 of 20 START test not_null_fct_appointment_procedure_id ...................... [RUN]
[0m13:40:49.795986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09, now test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758)
[0m13:40:49.796735 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:40:49.801359 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:40:49.801911 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:40:49.804179 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:40:49.804722 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:40:49.805050 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: BEGIN
[0m13:40:49.805359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.808462 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.809286 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:40:49.809984 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."fct_appointment"
where procedure_id is null



      
    ) dbt_internal_test
[0m13:40:49.810985 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m13:40:49.811583 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: ROLLBACK
[0m13:40:49.812517 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: Close
[0m13:40:49.815751 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_procedure_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_procedure_id.sql
[0m13:40:49.816405 [error] [Thread-1 (]: 10 of 20 ERROR not_null_fct_appointment_procedure_id ........................... [[31mERROR[0m in 0.02s]
[0m13:40:49.817017 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:40:49.817441 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:40:49.817940 [info ] [Thread-1 (]: 11 of 20 START test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m13:40:49.818421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758, now test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549)
[0m13:40:49.818794 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:40:49.827760 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:40:49.828939 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:40:49.832365 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:40:49.833005 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:40:49.833350 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: BEGIN
[0m13:40:49.833668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.836635 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.837061 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:40:49.837433 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."dim_billing"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:49.841148 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:49.843657 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: ROLLBACK
[0m13:40:49.844632 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: Close
[0m13:40:49.845852 [error] [Thread-1 (]: 11 of 20 FAIL 336 relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [[31mFAIL 336[0m in 0.03s]
[0m13:40:49.846954 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:40:49.847439 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:40:49.847945 [info ] [Thread-1 (]: 12 of 20 START test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [RUN]
[0m13:40:49.848605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549, now test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc)
[0m13:40:49.849088 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:40:49.854831 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:40:49.855400 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:40:49.857693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:40:49.858274 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:40:49.858650 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: BEGIN
[0m13:40:49.859141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.863868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.864432 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:40:49.864840 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select doctor_id as from_field
    from "my_db"."public"."fct_appointment"
    where doctor_id is not null
),

parent as (
    select doctor_id as to_field
    from "my_db"."public"."dim_doctor"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:49.865756 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m13:40:49.866305 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: ROLLBACK
[0m13:40:49.866852 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: Close
[0m13:40:49.869461 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_fa9c4db216fde9c5ba7fc811056f7bd9.sql
[0m13:40:49.870077 [error] [Thread-1 (]: 12 of 20 ERROR relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [[31mERROR[0m in 0.02s]
[0m13:40:49.870772 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:40:49.871210 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:40:49.871669 [info ] [Thread-1 (]: 13 of 20 START test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [RUN]
[0m13:40:49.872148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc, now test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77)
[0m13:40:49.872512 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:40:49.880096 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:40:49.880734 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:40:49.883374 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:40:49.884000 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:40:49.884344 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: BEGIN
[0m13:40:49.884657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.887634 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.888054 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:40:49.888417 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select invoice_id as from_field
    from "my_db"."public"."fct_appointment"
    where invoice_id is not null
),

parent as (
    select invoice_id as to_field
    from "my_db"."public"."dim_billing"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:49.889113 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m13:40:49.889491 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: ROLLBACK
[0m13:40:49.889992 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: Close
[0m13:40:49.892815 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_6aadef5ebd2b7c0bac677b51dbcf7646.sql
[0m13:40:49.893874 [error] [Thread-1 (]: 13 of 20 ERROR relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [[31mERROR[0m in 0.02s]
[0m13:40:49.894717 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:40:49.895398 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:40:49.896479 [info ] [Thread-1 (]: 14 of 20 START test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m13:40:49.897609 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77, now test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c)
[0m13:40:49.898253 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:40:49.903708 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:40:49.904272 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:40:49.908389 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:40:49.909644 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:40:49.910351 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: BEGIN
[0m13:40:49.910762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.915089 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:49.915656 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:40:49.916057 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."fct_appointment"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:49.916784 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m13:40:49.917198 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: ROLLBACK
[0m13:40:49.917718 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: Close
[0m13:40:49.921003 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_1ac9e1ce04500c065eff4df6f762bf9b.sql
[0m13:40:49.921639 [error] [Thread-1 (]: 14 of 20 ERROR relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [[31mERROR[0m in 0.02s]
[0m13:40:49.922297 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:40:49.922698 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:40:49.923044 [info ] [Thread-1 (]: 15 of 20 START test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [RUN]
[0m13:40:49.923550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c, now test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46)
[0m13:40:49.923884 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:40:49.987837 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:40:49.988789 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:40:49.992648 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:40:49.993868 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:40:49.994507 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: BEGIN
[0m13:40:49.995036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:49.999900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:50.000537 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:40:50.001089 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select procedure_id as from_field
    from "my_db"."public"."fct_appointment"
    where procedure_id is not null
),

parent as (
    select procedure_id as to_field
    from "my_db"."public"."dim_medical_procedure"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:40:50.002169 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m13:40:50.002750 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: ROLLBACK
[0m13:40:50.003509 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: Close
[0m13:40:50.007182 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_ad9e4146696e075b8b2d77e7a218615c.sql
[0m13:40:50.008274 [error] [Thread-1 (]: 15 of 20 ERROR relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [[31mERROR[0m in 0.08s]
[0m13:40:50.009570 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:40:50.010377 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:40:50.011104 [info ] [Thread-1 (]: 16 of 20 START test unique_dim_billing_invoice_id .............................. [RUN]
[0m13:40:50.011854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m13:40:50.012482 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:40:50.019612 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:40:50.020175 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:40:50.022534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:40:50.023031 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:40:50.023376 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m13:40:50.023684 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:50.027134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:50.027680 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:40:50.028113 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:40:50.032322 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:50.034428 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m13:40:50.035081 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m13:40:50.035959 [info ] [Thread-1 (]: 16 of 20 PASS unique_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.02s]
[0m13:40:50.036959 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:40:50.037459 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:40:50.037876 [info ] [Thread-1 (]: 17 of 20 START test unique_dim_doctor_doctor_id ................................ [RUN]
[0m13:40:50.038368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m13:40:50.038737 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:40:50.042680 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:40:50.043262 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:40:50.046096 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:40:50.047011 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:40:50.047589 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m13:40:50.047957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:50.051476 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:50.051948 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:40:50.052312 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:40:50.054108 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:50.055586 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m13:40:50.056033 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m13:40:50.056629 [info ] [Thread-1 (]: 17 of 20 PASS unique_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.02s]
[0m13:40:50.057358 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:40:50.057798 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:40:50.058234 [info ] [Thread-1 (]: 18 of 20 START test unique_dim_medical_procedure_procedure_id .................. [RUN]
[0m13:40:50.058742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m13:40:50.059093 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:40:50.064380 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:40:50.065036 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:40:50.067509 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:40:50.068154 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:40:50.068518 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m13:40:50.068826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:50.072466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:50.072933 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:40:50.073365 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:40:50.077283 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:50.079152 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m13:40:50.079890 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m13:40:50.080585 [error] [Thread-1 (]: 18 of 20 FAIL 260 unique_dim_medical_procedure_procedure_id .................... [[31mFAIL 260[0m in 0.02s]
[0m13:40:50.081312 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:40:50.081744 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:40:50.082218 [info ] [Thread-1 (]: 19 of 20 START test unique_dim_patient_patient_id .............................. [RUN]
[0m13:40:50.082738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m13:40:50.083158 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:40:50.087986 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:40:50.088768 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:40:50.091534 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:40:50.092234 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:40:50.092628 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m13:40:50.093067 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:50.096830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:50.097325 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:40:50.097703 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:40:50.099526 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:40:50.100943 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m13:40:50.101409 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m13:40:50.101988 [error] [Thread-1 (]: 19 of 20 FAIL 280 unique_dim_patient_patient_id ................................ [[31mFAIL 280[0m in 0.02s]
[0m13:40:50.102679 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:40:50.103167 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:40:50.103613 [info ] [Thread-1 (]: 20 of 20 START test unique_fct_appointment_appointment_id ...................... [RUN]
[0m13:40:50.104075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61, now test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f)
[0m13:40:50.104452 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:40:50.108400 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:40:50.109004 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:40:50.112669 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:40:50.113485 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:40:50.114066 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: BEGIN
[0m13:40:50.114569 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:50.118023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:40:50.118543 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:40:50.118950 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    appointment_id as unique_field,
    count(*) as n_records

from "my_db"."public"."fct_appointment"
where appointment_id is not null
group by appointment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:40:50.119665 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 15: from "my_db"."public"."fct_appointment"
              ^

[0m13:40:50.120055 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: ROLLBACK
[0m13:40:50.120551 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: Close
[0m13:40:50.122981 [debug] [Thread-1 (]: Database Error in test unique_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 15: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/unique_fct_appointment_appointment_id.sql
[0m13:40:50.123583 [error] [Thread-1 (]: 20 of 20 ERROR unique_fct_appointment_appointment_id ........................... [[31mERROR[0m in 0.02s]
[0m13:40:50.124209 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:40:50.125400 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:50.125701 [debug] [MainThread]: On master: BEGIN
[0m13:40:50.125971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:50.130300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:40:50.130735 [debug] [MainThread]: On master: COMMIT
[0m13:40:50.131031 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:50.131296 [debug] [MainThread]: On master: COMMIT
[0m13:40:50.131694 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:40:50.131992 [debug] [MainThread]: On master: Close
[0m13:40:50.132453 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:50.132768 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f' was properly closed.
[0m13:40:50.133175 [info ] [MainThread]: 
[0m13:40:50.133570 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m13:40:50.137499 [debug] [MainThread]: Command end result
[0m13:40:50.174301 [info ] [MainThread]: 
[0m13:40:50.174734 [info ] [MainThread]: [31mCompleted with 14 errors and 0 warnings:[0m
[0m13:40:50.175068 [info ] [MainThread]: 
[0m13:40:50.175471 [error] [MainThread]:   Database Error in test not_null_fct_appointment_appointment_date (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_date.sql
[0m13:40:50.175811 [info ] [MainThread]: 
[0m13:40:50.176206 [error] [MainThread]:   Database Error in test not_null_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_id.sql
[0m13:40:50.176714 [info ] [MainThread]: 
[0m13:40:50.177347 [error] [MainThread]:   Database Error in test not_null_fct_appointment_doctor_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_doctor_id.sql
[0m13:40:50.177735 [info ] [MainThread]: 
[0m13:40:50.178110 [error] [MainThread]:   Database Error in test not_null_fct_appointment_invoice_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_invoice_id.sql
[0m13:40:50.178445 [info ] [MainThread]: 
[0m13:40:50.178805 [error] [MainThread]:   Database Error in test not_null_fct_appointment_patient_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_patient_id.sql
[0m13:40:50.179093 [info ] [MainThread]: 
[0m13:40:50.179446 [error] [MainThread]:   Database Error in test not_null_fct_appointment_procedure_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_procedure_id.sql
[0m13:40:50.179777 [info ] [MainThread]: 
[0m13:40:50.180213 [error] [MainThread]: [31mFailure in test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)[0m
[0m13:40:50.180809 [error] [MainThread]:   Got 336 results, configured to fail if != 0
[0m13:40:50.181269 [info ] [MainThread]: 
[0m13:40:50.181820 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/relationships_dim_billing_67d755ce333822e0ca7d372874c62656.sql
[0m13:40:50.182242 [info ] [MainThread]: 
[0m13:40:50.182806 [error] [MainThread]:   Database Error in test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_fa9c4db216fde9c5ba7fc811056f7bd9.sql
[0m13:40:50.183212 [info ] [MainThread]: 
[0m13:40:50.183672 [error] [MainThread]:   Database Error in test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_6aadef5ebd2b7c0bac677b51dbcf7646.sql
[0m13:40:50.184130 [info ] [MainThread]: 
[0m13:40:50.184723 [error] [MainThread]:   Database Error in test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_1ac9e1ce04500c065eff4df6f762bf9b.sql
[0m13:40:50.185251 [info ] [MainThread]: 
[0m13:40:50.185963 [error] [MainThread]:   Database Error in test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_ad9e4146696e075b8b2d77e7a218615c.sql
[0m13:40:50.186397 [info ] [MainThread]: 
[0m13:40:50.186870 [error] [MainThread]: [31mFailure in test unique_dim_medical_procedure_procedure_id (models/marts/appointment/schema.yml)[0m
[0m13:40:50.187312 [error] [MainThread]:   Got 260 results, configured to fail if != 0
[0m13:40:50.187620 [info ] [MainThread]: 
[0m13:40:50.187946 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_medical_procedure_procedure_id.sql
[0m13:40:50.188227 [info ] [MainThread]: 
[0m13:40:50.188574 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m13:40:50.188888 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m13:40:50.189159 [info ] [MainThread]: 
[0m13:40:50.189490 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m13:40:50.189854 [info ] [MainThread]: 
[0m13:40:50.190338 [error] [MainThread]:   Database Error in test unique_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 15: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/unique_fct_appointment_appointment_id.sql
[0m13:40:50.190662 [info ] [MainThread]: 
[0m13:40:50.190964 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=14 SKIP=0 TOTAL=20
[0m13:40:50.191732 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2194022, "process_user_time": 2.223031, "process_kernel_time": 0.136001, "process_mem_max_rss": "114176", "process_out_blocks": "2480", "command_success": false, "process_in_blocks": "0"}
[0m13:40:50.192191 [debug] [MainThread]: Command `dbt test` failed at 13:40:50.192087 after 1.22 seconds
[0m13:40:50.192576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2b52e8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2b52e8d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a2ae9745d0>]}
[0m13:40:50.193003 [debug] [MainThread]: Flushing usage events
[0m13:44:05.042217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170b00be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170afc0c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170afed810>]}


============================== 13:44:05.045360 | 7cee0a3f-056a-43e8-9c11-557263bee815 ==============================
[0m13:44:05.045360 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:44:05.045983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:05.197430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cee0a3f-056a-43e8-9c11-557263bee815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517096efd50>]}
[0m13:44:05.255091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cee0a3f-056a-43e8-9c11-557263bee815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170eccd090>]}
[0m13:44:05.256168 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:44:05.268011 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:44:05.398927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:05.399294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:05.451087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cee0a3f-056a-43e8-9c11-557263bee815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170958f310>]}
[0m13:44:05.558253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cee0a3f-056a-43e8-9c11-557263bee815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751709636d10>]}
[0m13:44:05.558851 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m13:44:05.559212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cee0a3f-056a-43e8-9c11-557263bee815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517096efe50>]}
[0m13:44:05.561019 [info ] [MainThread]: 
[0m13:44:05.561593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:05.562501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m13:44:05.601595 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m13:44:05.601964 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m13:44:05.602232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:05.607196 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m13:44:05.608617 [debug] [ThreadPool]: On list_my_db: Close
[0m13:44:05.613370 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m13:44:05.619250 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:44:05.619592 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:44:05.619854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:05.623648 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:44:05.624078 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:44:05.624393 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:44:05.627143 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m13:44:05.628657 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:44:05.629100 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:44:05.636786 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:05.637132 [debug] [MainThread]: On master: BEGIN
[0m13:44:05.637429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:05.640908 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:44:05.641271 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:05.641644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:05.656991 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m13:44:05.660098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cee0a3f-056a-43e8-9c11-557263bee815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x751709636f90>]}
[0m13:44:05.660534 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:05.661007 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:05.661288 [debug] [MainThread]: On master: BEGIN
[0m13:44:05.661885 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:44:05.662185 [debug] [MainThread]: On master: COMMIT
[0m13:44:05.662456 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:05.662702 [debug] [MainThread]: On master: COMMIT
[0m13:44:05.663090 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:44:05.663385 [debug] [MainThread]: On master: Close
[0m13:44:05.663848 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:05.664171 [info ] [MainThread]: 
[0m13:44:05.666036 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m13:44:05.666574 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m13:44:05.667386 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m13:44:05.667796 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m13:44:05.676826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m13:44:05.677483 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m13:44:05.712919 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m13:44:05.713539 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:44:05.713880 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m13:44:05.714175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:05.717612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:05.718070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:44:05.718471 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m13:44:05.721062 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m13:44:05.727226 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:44:05.727623 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
alter table "my_db"."public"."fct_appointment__dbt_tmp" rename to "fct_appointment"
[0m13:44:05.728466 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:44:05.742529 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m13:44:05.742949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:44:05.743263 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m13:44:05.794622 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m13:44:05.809938 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."fct_appointment__dbt_backup"
[0m13:44:05.822581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m13:44:05.823569 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
drop view if exists "my_db"."public"."fct_appointment__dbt_backup" cascade
[0m13:44:05.824821 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m13:44:05.829315 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m13:44:05.831971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cee0a3f-056a-43e8-9c11-557263bee815', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7517087aa5d0>]}
[0m13:44:05.833032 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fct_appointment ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m13:44:05.834163 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m13:44:05.835577 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:05.836012 [debug] [MainThread]: On master: BEGIN
[0m13:44:05.836397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:05.840599 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:44:05.841120 [debug] [MainThread]: On master: COMMIT
[0m13:44:05.841492 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:05.841850 [debug] [MainThread]: On master: COMMIT
[0m13:44:05.842390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:44:05.842773 [debug] [MainThread]: On master: Close
[0m13:44:05.843295 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:05.843871 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m13:44:05.844282 [info ] [MainThread]: 
[0m13:44:05.844696 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m13:44:05.845653 [debug] [MainThread]: Command end result
[0m13:44:05.879414 [info ] [MainThread]: 
[0m13:44:05.879923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:05.880238 [info ] [MainThread]: 
[0m13:44:05.880596 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:44:05.881361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.89540386, "process_user_time": 1.920135, "process_kernel_time": 0.157846, "process_mem_max_rss": "111272", "process_out_blocks": "2000", "process_in_blocks": "0"}
[0m13:44:05.881857 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:05.881750 after 0.90 seconds
[0m13:44:05.882182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170edbc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170969bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75170ef404d0>]}
[0m13:44:05.882505 [debug] [MainThread]: Flushing usage events
[0m13:44:20.885402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75203300f610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75203318f810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75203300cad0>]}


============================== 13:44:20.887827 | c26df552-9913-43a7-9f15-3cff5039185f ==============================
[0m13:44:20.887827 [info ] [MainThread]: Running with dbt=1.8.3
[0m13:44:20.888350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:21.026266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c26df552-9913-43a7-9f15-3cff5039185f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7520316d1ad0>]}
[0m13:44:21.076493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c26df552-9913-43a7-9f15-3cff5039185f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752036cc0fd0>]}
[0m13:44:21.077277 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m13:44:21.086769 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m13:44:21.211316 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:21.211683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:21.257327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c26df552-9913-43a7-9f15-3cff5039185f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7520316ba290>]}
[0m13:44:21.359301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c26df552-9913-43a7-9f15-3cff5039185f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7520311ab8d0>]}
[0m13:44:21.359852 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m13:44:21.360152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26df552-9913-43a7-9f15-3cff5039185f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75203173a150>]}
[0m13:44:21.362929 [info ] [MainThread]: 
[0m13:44:21.363547 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:21.369905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m13:44:21.409927 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:44:21.410348 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m13:44:21.410611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:21.415005 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.415393 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m13:44:21.415729 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:44:21.418327 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m13:44:21.419857 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m13:44:21.420300 [debug] [ThreadPool]: On list_my_db_public: Close
[0m13:44:21.427879 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.428224 [debug] [MainThread]: On master: BEGIN
[0m13:44:21.428486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:21.431687 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.432060 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.432439 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:21.448756 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m13:44:21.452614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26df552-9913-43a7-9f15-3cff5039185f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7520311f0b90>]}
[0m13:44:21.453030 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:21.453509 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.453787 [debug] [MainThread]: On master: BEGIN
[0m13:44:21.454354 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.454660 [debug] [MainThread]: On master: COMMIT
[0m13:44:21.454955 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.455202 [debug] [MainThread]: On master: COMMIT
[0m13:44:21.455651 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:44:21.455934 [debug] [MainThread]: On master: Close
[0m13:44:21.456391 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:44:21.456730 [info ] [MainThread]: 
[0m13:44:21.459297 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:44:21.459730 [info ] [Thread-1 (]: 1 of 20 START test not_null_dim_billing_invoice_id ............................. [RUN]
[0m13:44:21.460218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m13:44:21.460635 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:44:21.476565 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:44:21.477251 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:44:21.492016 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:44:21.492686 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:44:21.493153 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m13:44:21.493511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.497134 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.497632 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m13:44:21.498020 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m13:44:21.501088 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.504993 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m13:44:21.505573 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m13:44:21.506182 [info ] [Thread-1 (]: 1 of 20 PASS not_null_dim_billing_invoice_id ................................... [[32mPASS[0m in 0.05s]
[0m13:44:21.506770 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m13:44:21.507174 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:44:21.507715 [info ] [Thread-1 (]: 2 of 20 START test not_null_dim_doctor_doctor_id ............................... [RUN]
[0m13:44:21.508234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m13:44:21.508608 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:44:21.513075 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:44:21.513677 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:44:21.516977 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:44:21.517543 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:44:21.517871 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m13:44:21.518221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.521498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.521909 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m13:44:21.522230 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m13:44:21.523415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.524865 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m13:44:21.525316 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m13:44:21.525972 [info ] [Thread-1 (]: 2 of 20 PASS not_null_dim_doctor_doctor_id ..................................... [[32mPASS[0m in 0.02s]
[0m13:44:21.526897 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m13:44:21.527587 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:44:21.528455 [info ] [Thread-1 (]: 3 of 20 START test not_null_dim_medical_procedure_procedure_id ................. [RUN]
[0m13:44:21.529105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m13:44:21.529513 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:44:21.534027 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:44:21.534612 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:44:21.537152 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:44:21.537954 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:44:21.538512 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m13:44:21.538884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.542273 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.542725 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m13:44:21.543320 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m13:44:21.547012 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.548718 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m13:44:21.549259 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m13:44:21.549856 [info ] [Thread-1 (]: 3 of 20 PASS not_null_dim_medical_procedure_procedure_id ....................... [[32mPASS[0m in 0.02s]
[0m13:44:21.550490 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m13:44:21.550927 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:44:21.551360 [info ] [Thread-1 (]: 4 of 20 START test not_null_dim_patient_patient_id ............................. [RUN]
[0m13:44:21.551862 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m13:44:21.552217 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:44:21.557063 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:44:21.557627 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:44:21.560454 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:44:21.561163 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:44:21.561590 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m13:44:21.561907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.565256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.565683 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m13:44:21.566030 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m13:44:21.567285 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.568732 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m13:44:21.569133 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m13:44:21.569691 [info ] [Thread-1 (]: 4 of 20 PASS not_null_dim_patient_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m13:44:21.570301 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m13:44:21.570811 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:44:21.571248 [info ] [Thread-1 (]: 5 of 20 START test not_null_fct_appointment_appointment_date ................... [RUN]
[0m13:44:21.571712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed)
[0m13:44:21.572056 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:44:21.576398 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:44:21.577299 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:44:21.580148 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:44:21.581177 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:44:21.581650 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: BEGIN
[0m13:44:21.581987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.585287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.585783 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m13:44:21.586162 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_date
from "my_db"."public"."fct_appointment"
where appointment_date is null



      
    ) dbt_internal_test
[0m13:44:21.590873 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.592392 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: ROLLBACK
[0m13:44:21.593089 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: Close
[0m13:44:21.594206 [info ] [Thread-1 (]: 5 of 20 PASS not_null_fct_appointment_appointment_date ......................... [[32mPASS[0m in 0.02s]
[0m13:44:21.595184 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m13:44:21.595878 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:44:21.596499 [info ] [Thread-1 (]: 6 of 20 START test not_null_fct_appointment_appointment_id ..................... [RUN]
[0m13:44:21.597096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed, now test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21)
[0m13:44:21.597559 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:44:21.602053 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:44:21.602638 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:44:21.604952 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:44:21.605491 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:44:21.605813 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: BEGIN
[0m13:44:21.606145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.609309 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.610112 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m13:44:21.610793 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_id
from "my_db"."public"."fct_appointment"
where appointment_id is null



      
    ) dbt_internal_test
[0m13:44:21.616214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.617873 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: ROLLBACK
[0m13:44:21.618406 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: Close
[0m13:44:21.619006 [info ] [Thread-1 (]: 6 of 20 PASS not_null_fct_appointment_appointment_id ........................... [[32mPASS[0m in 0.02s]
[0m13:44:21.619665 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m13:44:21.620117 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:44:21.620701 [info ] [Thread-1 (]: 7 of 20 START test not_null_fct_appointment_doctor_id .......................... [RUN]
[0m13:44:21.621304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21, now test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64)
[0m13:44:21.621680 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:44:21.625903 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:44:21.626869 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:44:21.629769 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:44:21.630675 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:44:21.631112 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: BEGIN
[0m13:44:21.631599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.635077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.635557 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m13:44:21.635921 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."fct_appointment"
where doctor_id is null



      
    ) dbt_internal_test
[0m13:44:21.640517 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.642046 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: ROLLBACK
[0m13:44:21.642590 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: Close
[0m13:44:21.643859 [info ] [Thread-1 (]: 7 of 20 PASS not_null_fct_appointment_doctor_id ................................ [[32mPASS[0m in 0.02s]
[0m13:44:21.644840 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m13:44:21.645416 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:44:21.646045 [info ] [Thread-1 (]: 8 of 20 START test not_null_fct_appointment_invoice_id ......................... [RUN]
[0m13:44:21.646893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64, now test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62)
[0m13:44:21.647423 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:44:21.652436 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:44:21.653033 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:44:21.657462 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:44:21.658109 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:44:21.658487 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: BEGIN
[0m13:44:21.658822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.663121 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.663781 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m13:44:21.664305 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."fct_appointment"
where invoice_id is null



      
    ) dbt_internal_test
[0m13:44:21.671288 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.672780 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: ROLLBACK
[0m13:44:21.673270 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: Close
[0m13:44:21.673925 [info ] [Thread-1 (]: 8 of 20 PASS not_null_fct_appointment_invoice_id ............................... [[32mPASS[0m in 0.03s]
[0m13:44:21.674624 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m13:44:21.675062 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:44:21.675510 [info ] [Thread-1 (]: 9 of 20 START test not_null_fct_appointment_patient_id ......................... [RUN]
[0m13:44:21.676009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62, now test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09)
[0m13:44:21.676616 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:44:21.682026 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:44:21.682661 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:44:21.685027 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:44:21.685568 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:44:21.685898 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: BEGIN
[0m13:44:21.686207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.689262 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.689701 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m13:44:21.690032 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."fct_appointment"
where patient_id is null



      
    ) dbt_internal_test
[0m13:44:21.695502 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.697528 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: ROLLBACK
[0m13:44:21.698128 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: Close
[0m13:44:21.698799 [info ] [Thread-1 (]: 9 of 20 PASS not_null_fct_appointment_patient_id ............................... [[32mPASS[0m in 0.02s]
[0m13:44:21.699552 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m13:44:21.700012 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:44:21.700521 [info ] [Thread-1 (]: 10 of 20 START test not_null_fct_appointment_procedure_id ...................... [RUN]
[0m13:44:21.701251 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09, now test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758)
[0m13:44:21.701634 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:44:21.705768 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:44:21.706376 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:44:21.708634 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:44:21.709130 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:44:21.709493 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: BEGIN
[0m13:44:21.710024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.714171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.714691 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m13:44:21.715082 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."fct_appointment"
where procedure_id is null



      
    ) dbt_internal_test
[0m13:44:21.721649 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.723099 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: ROLLBACK
[0m13:44:21.723616 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: Close
[0m13:44:21.724191 [info ] [Thread-1 (]: 10 of 20 PASS not_null_fct_appointment_procedure_id ............................ [[32mPASS[0m in 0.02s]
[0m13:44:21.724940 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m13:44:21.725547 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:44:21.726177 [info ] [Thread-1 (]: 11 of 20 START test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m13:44:21.727307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758, now test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549)
[0m13:44:21.728067 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:44:21.737933 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:44:21.738530 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:44:21.740874 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:44:21.741398 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:44:21.741725 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: BEGIN
[0m13:44:21.742024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.746453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.746999 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m13:44:21.747466 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."dim_billing"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:21.751855 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.753957 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: ROLLBACK
[0m13:44:21.754545 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: Close
[0m13:44:21.755131 [error] [Thread-1 (]: 11 of 20 FAIL 336 relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [[31mFAIL 336[0m in 0.03s]
[0m13:44:21.755791 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m13:44:21.756223 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:44:21.756638 [info ] [Thread-1 (]: 12 of 20 START test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [RUN]
[0m13:44:21.757140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549, now test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc)
[0m13:44:21.757498 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:44:21.764440 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:44:21.765084 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:44:21.767769 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:44:21.768605 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:44:21.768969 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: BEGIN
[0m13:44:21.769281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.772381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.772801 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m13:44:21.773155 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select doctor_id as from_field
    from "my_db"."public"."fct_appointment"
    where doctor_id is not null
),

parent as (
    select doctor_id as to_field
    from "my_db"."public"."dim_doctor"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:21.783447 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.785292 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: ROLLBACK
[0m13:44:21.785946 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: Close
[0m13:44:21.786576 [info ] [Thread-1 (]: 12 of 20 PASS relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [[32mPASS[0m in 0.03s]
[0m13:44:21.787219 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m13:44:21.787635 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:44:21.788096 [info ] [Thread-1 (]: 13 of 20 START test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [RUN]
[0m13:44:21.788593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc, now test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77)
[0m13:44:21.788952 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:44:21.795169 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:44:21.795922 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:44:21.799097 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:44:21.799866 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:44:21.800310 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: BEGIN
[0m13:44:21.800648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.803971 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.804408 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m13:44:21.804770 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select invoice_id as from_field
    from "my_db"."public"."fct_appointment"
    where invoice_id is not null
),

parent as (
    select invoice_id as to_field
    from "my_db"."public"."dim_billing"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:21.816241 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.817923 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: ROLLBACK
[0m13:44:21.818462 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: Close
[0m13:44:21.819052 [info ] [Thread-1 (]: 13 of 20 PASS relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [[32mPASS[0m in 0.03s]
[0m13:44:21.819695 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m13:44:21.820095 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:44:21.820514 [info ] [Thread-1 (]: 14 of 20 START test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m13:44:21.820954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77, now test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c)
[0m13:44:21.821303 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:44:21.826591 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:44:21.827493 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:44:21.833265 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:44:21.833975 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:44:21.834345 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: BEGIN
[0m13:44:21.834661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.838110 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.838534 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m13:44:21.838903 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."fct_appointment"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:21.848528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.850128 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: ROLLBACK
[0m13:44:21.850810 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: Close
[0m13:44:21.851534 [info ] [Thread-1 (]: 14 of 20 PASS relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [[32mPASS[0m in 0.03s]
[0m13:44:21.852183 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m13:44:21.852597 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:44:21.853065 [info ] [Thread-1 (]: 15 of 20 START test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [RUN]
[0m13:44:21.853550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c, now test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46)
[0m13:44:21.853889 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:44:21.913432 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:44:21.914353 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:44:21.917954 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:44:21.918753 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:44:21.919291 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: BEGIN
[0m13:44:21.919810 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.924658 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.925253 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m13:44:21.925861 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select procedure_id as from_field
    from "my_db"."public"."fct_appointment"
    where procedure_id is not null
),

parent as (
    select procedure_id as to_field
    from "my_db"."public"."dim_medical_procedure"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m13:44:21.939046 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.940622 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: ROLLBACK
[0m13:44:21.941135 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: Close
[0m13:44:21.941737 [info ] [Thread-1 (]: 15 of 20 PASS relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [[32mPASS[0m in 0.09s]
[0m13:44:21.942450 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m13:44:21.942896 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:44:21.943357 [info ] [Thread-1 (]: 16 of 20 START test unique_dim_billing_invoice_id .............................. [RUN]
[0m13:44:21.944003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m13:44:21.944401 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:44:21.951210 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:44:21.951957 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:44:21.954767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:44:21.955439 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:44:21.955785 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m13:44:21.956088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.959622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.960048 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m13:44:21.960400 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:21.964303 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.966108 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m13:44:21.966686 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m13:44:21.967485 [info ] [Thread-1 (]: 16 of 20 PASS unique_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.02s]
[0m13:44:21.968379 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m13:44:21.968976 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:44:21.969508 [info ] [Thread-1 (]: 17 of 20 START test unique_dim_doctor_doctor_id ................................ [RUN]
[0m13:44:21.969945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m13:44:21.970276 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:44:21.974330 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:44:21.974905 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:44:21.977663 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:44:21.978297 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:44:21.978746 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m13:44:21.979247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.983257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:21.983740 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m13:44:21.984077 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:21.985916 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:21.987403 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m13:44:21.987880 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m13:44:21.988466 [info ] [Thread-1 (]: 17 of 20 PASS unique_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.02s]
[0m13:44:21.989187 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m13:44:21.989636 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:44:21.990087 [info ] [Thread-1 (]: 18 of 20 START test unique_dim_medical_procedure_procedure_id .................. [RUN]
[0m13:44:21.990593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m13:44:21.990930 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:44:21.996822 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:44:21.997548 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:44:22.000408 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:44:22.001098 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:44:22.001554 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m13:44:22.001910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:22.005039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:22.005526 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m13:44:22.005906 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:22.011390 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:22.014045 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m13:44:22.014682 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m13:44:22.015412 [error] [Thread-1 (]: 18 of 20 FAIL 260 unique_dim_medical_procedure_procedure_id .................... [[31mFAIL 260[0m in 0.02s]
[0m13:44:22.016100 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m13:44:22.016633 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:44:22.017071 [info ] [Thread-1 (]: 19 of 20 START test unique_dim_patient_patient_id .............................. [RUN]
[0m13:44:22.017971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m13:44:22.018366 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:44:22.022314 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:44:22.022861 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:44:22.025168 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:44:22.025706 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:44:22.026043 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m13:44:22.026563 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:22.030363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:22.030964 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m13:44:22.031458 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:22.033631 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:22.035209 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m13:44:22.035703 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m13:44:22.036664 [error] [Thread-1 (]: 19 of 20 FAIL 280 unique_dim_patient_patient_id ................................ [[31mFAIL 280[0m in 0.02s]
[0m13:44:22.037567 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m13:44:22.038135 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:44:22.038637 [info ] [Thread-1 (]: 20 of 20 START test unique_fct_appointment_appointment_id ...................... [RUN]
[0m13:44:22.039096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61, now test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f)
[0m13:44:22.039438 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:44:22.043951 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:44:22.044794 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:44:22.048222 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:44:22.048992 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:44:22.049438 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: BEGIN
[0m13:44:22.049759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:22.053176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m13:44:22.053641 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m13:44:22.053984 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    appointment_id as unique_field,
    count(*) as n_records

from "my_db"."public"."fct_appointment"
where appointment_id is not null
group by appointment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:22.062785 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m13:44:22.064603 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: ROLLBACK
[0m13:44:22.065281 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: Close
[0m13:44:22.065932 [error] [Thread-1 (]: 20 of 20 FAIL 157 unique_fct_appointment_appointment_id ........................ [[31mFAIL 157[0m in 0.03s]
[0m13:44:22.066658 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m13:44:22.068037 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:22.068413 [debug] [MainThread]: On master: BEGIN
[0m13:44:22.068687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:22.071503 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:44:22.071939 [debug] [MainThread]: On master: COMMIT
[0m13:44:22.072277 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:22.072572 [debug] [MainThread]: On master: COMMIT
[0m13:44:22.072991 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:44:22.073273 [debug] [MainThread]: On master: Close
[0m13:44:22.073685 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:22.073949 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f' was properly closed.
[0m13:44:22.074276 [info ] [MainThread]: 
[0m13:44:22.074667 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m13:44:22.078860 [debug] [MainThread]: Command end result
[0m13:44:22.116429 [info ] [MainThread]: 
[0m13:44:22.116996 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m13:44:22.117360 [info ] [MainThread]: 
[0m13:44:22.117827 [error] [MainThread]: [31mFailure in test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)[0m
[0m13:44:22.118211 [error] [MainThread]:   Got 336 results, configured to fail if != 0
[0m13:44:22.118545 [info ] [MainThread]: 
[0m13:44:22.118941 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/relationships_dim_billing_67d755ce333822e0ca7d372874c62656.sql
[0m13:44:22.119257 [info ] [MainThread]: 
[0m13:44:22.119663 [error] [MainThread]: [31mFailure in test unique_dim_medical_procedure_procedure_id (models/marts/appointment/schema.yml)[0m
[0m13:44:22.120014 [error] [MainThread]:   Got 260 results, configured to fail if != 0
[0m13:44:22.120289 [info ] [MainThread]: 
[0m13:44:22.120658 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_medical_procedure_procedure_id.sql
[0m13:44:22.120940 [info ] [MainThread]: 
[0m13:44:22.121292 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m13:44:22.121635 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m13:44:22.121949 [info ] [MainThread]: 
[0m13:44:22.122308 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m13:44:22.122613 [info ] [MainThread]: 
[0m13:44:22.122977 [error] [MainThread]: [31mFailure in test unique_fct_appointment_appointment_id (models/marts/appointment/schema.yml)[0m
[0m13:44:22.123313 [error] [MainThread]:   Got 157 results, configured to fail if != 0
[0m13:44:22.123597 [info ] [MainThread]: 
[0m13:44:22.123922 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_fct_appointment_appointment_id.sql
[0m13:44:22.124228 [info ] [MainThread]: 
[0m13:44:22.124540 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=4 SKIP=0 TOTAL=20
[0m13:44:22.125375 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2832632, "process_user_time": 2.15468, "process_kernel_time": 0.173651, "process_mem_max_rss": "113692", "process_out_blocks": "2456", "command_success": false, "process_in_blocks": "0"}
[0m13:44:22.126043 [debug] [MainThread]: Command `dbt test` failed at 13:44:22.125857 after 1.28 seconds
[0m13:44:22.126586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752036f34d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752036f34cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7520316d1bd0>]}
[0m13:44:22.127632 [debug] [MainThread]: Flushing usage events
[0m14:05:59.084652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6563ca2850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6563ce95d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e65661dce50>]}


============================== 14:05:59.089021 | 99288d6d-2338-4c5c-a54a-dc431e47b386 ==============================
[0m14:05:59.089021 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:05:59.090227 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_medical_procedure', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:59.247223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6563cf6790>]}
[0m14:05:59.306591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e65679e4e90>]}
[0m14:05:59.307427 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:05:59.317965 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:05:59.456491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:05:59.457212 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m14:05:59.457633 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:05:59.691572 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:05:59.692230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e65621603d0>]}
[0m14:05:59.881463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e65620e37d0>]}
[0m14:05:59.985528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e65619b0150>]}
[0m14:05:59.986040 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m14:05:59.986373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6562106c90>]}
[0m14:05:59.988093 [info ] [MainThread]: 
[0m14:05:59.988739 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:59.989786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:06:00.035029 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:06:00.035439 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:06:00.035710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:00.040660 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:06:00.042318 [debug] [ThreadPool]: On list_my_db: Close
[0m14:06:00.048480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:06:00.054491 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:00.054834 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:06:00.055078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:00.058209 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:00.058570 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:00.058874 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:00.061432 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:06:00.063093 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:06:00.063775 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:06:00.071327 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:00.071680 [debug] [MainThread]: On master: BEGIN
[0m14:06:00.071973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:00.075057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:00.075492 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:00.075895 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:00.093829 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:06:00.098093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e656096d650>]}
[0m14:06:00.098549 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:00.099017 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:00.099312 [debug] [MainThread]: On master: BEGIN
[0m14:06:00.099932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:00.100276 [debug] [MainThread]: On master: COMMIT
[0m14:06:00.100602 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:00.100887 [debug] [MainThread]: On master: COMMIT
[0m14:06:00.101323 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:00.101657 [debug] [MainThread]: On master: Close
[0m14:06:00.102115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:00.102452 [info ] [MainThread]: 
[0m14:06:00.104478 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:06:00.105072 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:06:00.106146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:06:00.106609 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:06:00.113962 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:06:00.114561 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:06:00.220850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:06:00.222312 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:00.223418 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:06:00.224117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:00.229607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:00.230162 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:00.230654 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        row_number() over (partition by Procedure_id, order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:06:00.231404 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "order"
LINE 19: ...    row_number() over (partition by Procedure_id, order by P...
                                                              ^

[0m14:06:00.231884 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: ROLLBACK
[0m14:06:00.232494 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:06:00.236809 [debug] [Thread-1 (]: Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "order"
  LINE 19: ...    row_number() over (partition by Procedure_id, order by P...
                                                                ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:06:00.238341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99288d6d-2338-4c5c-a54a-dc431e47b386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e656090c190>]}
[0m14:06:00.238982 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_medical_procedure .............. [[31mERROR[0m in 0.13s]
[0m14:06:00.239629 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:06:00.241803 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:00.242391 [debug] [MainThread]: On master: BEGIN
[0m14:06:00.242702 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:00.245935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:00.246306 [debug] [MainThread]: On master: COMMIT
[0m14:06:00.246602 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:00.246854 [debug] [MainThread]: On master: COMMIT
[0m14:06:00.247179 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:00.247488 [debug] [MainThread]: On master: Close
[0m14:06:00.247925 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:00.248206 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:06:00.248541 [info ] [MainThread]: 
[0m14:06:00.248887 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:06:00.249803 [debug] [MainThread]: Command end result
[0m14:06:00.290740 [info ] [MainThread]: 
[0m14:06:00.291237 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:00.291597 [info ] [MainThread]: 
[0m14:06:00.292056 [error] [MainThread]:   Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "order"
  LINE 19: ...    row_number() over (partition by Procedure_id, order by P...
                                                                ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:06:00.292412 [info ] [MainThread]: 
[0m14:06:00.292742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:06:00.293609 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2582746, "process_user_time": 2.459429, "process_kernel_time": 0.142198, "process_mem_max_rss": "115692", "process_out_blocks": "2896", "command_success": false, "process_in_blocks": "0"}
[0m14:06:00.294155 [debug] [MainThread]: Command `dbt run` failed at 14:06:00.294032 after 1.26 seconds
[0m14:06:00.294698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6561ddba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6567c3cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6567c3cc50>]}
[0m14:06:00.295176 [debug] [MainThread]: Flushing usage events
[0m14:06:11.577441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088479ed350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708847d7f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70884867cbd0>]}


============================== 14:06:11.580482 | 845298bb-192e-4aff-9ab8-a0b461b30567 ==============================
[0m14:06:11.580482 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:06:11.581020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:11.739236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7088479ed150>]}
[0m14:06:11.801109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70884b6e8690>]}
[0m14:06:11.802873 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:06:11.816982 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:06:11.960629 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:11.961298 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:06:12.193154 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:06:12.193748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708845dae110>]}
[0m14:06:12.384904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708846165110>]}
[0m14:06:12.485210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708845e31f50>]}
[0m14:06:12.485728 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m14:06:12.486038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70884552c090>]}
[0m14:06:12.487872 [info ] [MainThread]: 
[0m14:06:12.488437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:12.489453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:06:12.530979 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:06:12.531440 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:06:12.531759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:12.536742 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:06:12.538093 [debug] [ThreadPool]: On list_my_db: Close
[0m14:06:12.544269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:06:12.552609 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:12.553062 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:06:12.553428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:12.556965 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.557397 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:12.557748 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:12.560448 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:06:12.562061 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:06:12.562555 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:06:12.570614 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.570977 [debug] [MainThread]: On master: BEGIN
[0m14:06:12.571272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:12.574524 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.574901 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.575276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:12.592750 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:06:12.596608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708845dbbc10>]}
[0m14:06:12.597097 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:12.597641 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.597946 [debug] [MainThread]: On master: BEGIN
[0m14:06:12.598429 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.598775 [debug] [MainThread]: On master: COMMIT
[0m14:06:12.599059 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.599324 [debug] [MainThread]: On master: COMMIT
[0m14:06:12.599791 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:12.600102 [debug] [MainThread]: On master: Close
[0m14:06:12.600580 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:12.600908 [info ] [MainThread]: 
[0m14:06:12.602962 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:06:12.603542 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:06:12.604490 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:06:12.605231 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:06:12.616318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.617138 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:06:12.716849 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.717522 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.717867 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:06:12.718172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:12.721549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.722045 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.722441 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:06:12.724551 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:06:12.731807 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.732262 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m14:06:12.733107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:12.736718 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.737157 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m14:06:12.738004 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:06:12.759677 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:06:12.760100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.760449 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:06:12.811525 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:06:12.820819 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m14:06:12.827248 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:06:12.827664 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m14:06:12.829409 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:06:12.831790 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:06:12.833297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845298bb-192e-4aff-9ab8-a0b461b30567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70884599d290>]}
[0m14:06:12.833986 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.23s]
[0m14:06:12.834626 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:06:12.835772 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.836073 [debug] [MainThread]: On master: BEGIN
[0m14:06:12.836329 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:12.839445 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:12.840121 [debug] [MainThread]: On master: COMMIT
[0m14:06:12.840616 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:12.841064 [debug] [MainThread]: On master: COMMIT
[0m14:06:12.841758 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:12.842320 [debug] [MainThread]: On master: Close
[0m14:06:12.843212 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:12.843717 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:06:12.844566 [info ] [MainThread]: 
[0m14:06:12.845568 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m14:06:12.846766 [debug] [MainThread]: Command end result
[0m14:06:12.886779 [info ] [MainThread]: 
[0m14:06:12.887939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:12.889409 [info ] [MainThread]: 
[0m14:06:12.890522 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:06:12.891727 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3671304, "process_user_time": 2.542834, "process_kernel_time": 0.181416, "process_mem_max_rss": "115400", "process_out_blocks": "2888", "process_in_blocks": "0"}
[0m14:06:12.892348 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:12.892217 after 1.37 seconds
[0m14:06:12.892730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70884b940dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70884b940490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70884b940c50>]}
[0m14:06:12.893203 [debug] [MainThread]: Flushing usage events
[0m14:06:23.877011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d037fb2050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d037f6a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d037f99410>]}


============================== 14:06:23.879773 | a2749459-b8d3-4225-817d-b831e7409300 ==============================
[0m14:06:23.879773 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:06:23.880387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:24.053537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2749459-b8d3-4225-817d-b831e7409300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d03668e0d0>]}
[0m14:06:24.112780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2749459-b8d3-4225-817d-b831e7409300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d03bc98950>]}
[0m14:06:24.113515 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:06:24.123989 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:06:24.252453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:24.252814 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:24.312586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2749459-b8d3-4225-817d-b831e7409300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d037fdf790>]}
[0m14:06:24.425287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2749459-b8d3-4225-817d-b831e7409300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d036177f10>]}
[0m14:06:24.426014 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m14:06:24.426750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2749459-b8d3-4225-817d-b831e7409300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d037ed10d0>]}
[0m14:06:24.430656 [info ] [MainThread]: 
[0m14:06:24.431894 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:24.442384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:06:24.485206 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:24.485590 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:06:24.485880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:24.490348 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.490769 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:24.491096 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:24.493788 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:06:24.495369 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:06:24.495971 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:06:24.505747 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:24.507024 [debug] [MainThread]: On master: BEGIN
[0m14:06:24.507384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:24.512452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.512849 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:24.513230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:24.530693 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:06:24.534338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2749459-b8d3-4225-817d-b831e7409300', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d0366d78d0>]}
[0m14:06:24.534758 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:24.535160 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:24.535436 [debug] [MainThread]: On master: BEGIN
[0m14:06:24.535848 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.536130 [debug] [MainThread]: On master: COMMIT
[0m14:06:24.536392 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:24.536640 [debug] [MainThread]: On master: COMMIT
[0m14:06:24.536981 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:24.537244 [debug] [MainThread]: On master: Close
[0m14:06:24.537735 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:24.538170 [info ] [MainThread]: 
[0m14:06:24.541003 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:06:24.541479 [info ] [Thread-1 (]: 1 of 20 START test not_null_dim_billing_invoice_id ............................. [RUN]
[0m14:06:24.541968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:06:24.542329 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:06:24.561579 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:06:24.562381 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:06:24.583681 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:06:24.584363 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:06:24.584793 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m14:06:24.585162 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.590787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.591417 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:06:24.591957 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:06:24.595224 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:24.599528 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m14:06:24.600182 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m14:06:24.600863 [info ] [Thread-1 (]: 1 of 20 PASS not_null_dim_billing_invoice_id ................................... [[32mPASS[0m in 0.06s]
[0m14:06:24.601521 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:06:24.601944 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:06:24.602441 [info ] [Thread-1 (]: 2 of 20 START test not_null_dim_doctor_doctor_id ............................... [RUN]
[0m14:06:24.602945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:06:24.603286 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:06:24.608052 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:06:24.608652 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:06:24.612996 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:06:24.613986 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:06:24.614413 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m14:06:24.614754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.618240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.618935 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:06:24.619393 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:06:24.621120 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:24.623158 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m14:06:24.623711 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m14:06:24.624514 [info ] [Thread-1 (]: 2 of 20 PASS not_null_dim_doctor_doctor_id ..................................... [[32mPASS[0m in 0.02s]
[0m14:06:24.625401 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:06:24.626022 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:24.626624 [info ] [Thread-1 (]: 3 of 20 START test not_null_dim_medical_procedure_procedure_id ................. [RUN]
[0m14:06:24.627437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:06:24.628084 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:24.633903 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:24.634586 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:24.637466 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:24.638352 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:24.638815 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:06:24.639750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.645792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.646602 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:24.647221 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:06:24.653222 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:24.656860 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:06:24.657659 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:06:24.658794 [info ] [Thread-1 (]: 3 of 20 PASS not_null_dim_medical_procedure_procedure_id ....................... [[32mPASS[0m in 0.03s]
[0m14:06:24.661895 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:24.663735 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:06:24.664541 [info ] [Thread-1 (]: 4 of 20 START test not_null_dim_patient_patient_id ............................. [RUN]
[0m14:06:24.665184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:06:24.665625 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:06:24.670537 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:06:24.672002 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:06:24.675056 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:06:24.675751 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:06:24.676181 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m14:06:24.676532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.681135 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.681799 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:06:24.682439 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m14:06:24.684347 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:24.685951 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m14:06:24.686407 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m14:06:24.687160 [info ] [Thread-1 (]: 4 of 20 PASS not_null_dim_patient_patient_id ................................... [[32mPASS[0m in 0.02s]
[0m14:06:24.688669 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:06:24.689358 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m14:06:24.690031 [info ] [Thread-1 (]: 5 of 20 START test not_null_fct_appointment_appointment_date ................... [RUN]
[0m14:06:24.690753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed)
[0m14:06:24.691386 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m14:06:24.697522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m14:06:24.698193 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m14:06:24.701197 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m14:06:24.702002 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m14:06:24.702953 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: BEGIN
[0m14:06:24.703513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.710740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.711945 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"
[0m14:06:24.713453 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_date
from "my_db"."public"."fct_appointment"
where appointment_date is null



      
    ) dbt_internal_test
[0m14:06:24.714993 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m14:06:24.715608 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: ROLLBACK
[0m14:06:24.716300 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed: Close
[0m14:06:24.722889 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_appointment_date (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_date.sql
[0m14:06:24.723966 [error] [Thread-1 (]: 5 of 20 ERROR not_null_fct_appointment_appointment_date ........................ [[31mERROR[0m in 0.03s]
[0m14:06:24.724936 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed
[0m14:06:24.725736 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m14:06:24.727102 [info ] [Thread-1 (]: 6 of 20 START test not_null_fct_appointment_appointment_id ..................... [RUN]
[0m14:06:24.727829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed, now test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21)
[0m14:06:24.728262 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m14:06:24.733364 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m14:06:24.733941 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m14:06:24.736495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m14:06:24.737123 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m14:06:24.737597 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: BEGIN
[0m14:06:24.738083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.742030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.742794 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"
[0m14:06:24.743387 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select appointment_id
from "my_db"."public"."fct_appointment"
where appointment_id is null



      
    ) dbt_internal_test
[0m14:06:24.744233 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m14:06:24.744810 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: ROLLBACK
[0m14:06:24.745386 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21: Close
[0m14:06:24.748586 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_id.sql
[0m14:06:24.749184 [error] [Thread-1 (]: 6 of 20 ERROR not_null_fct_appointment_appointment_id .......................... [[31mERROR[0m in 0.02s]
[0m14:06:24.749791 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21
[0m14:06:24.750187 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m14:06:24.750649 [info ] [Thread-1 (]: 7 of 20 START test not_null_fct_appointment_doctor_id .......................... [RUN]
[0m14:06:24.751104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21, now test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64)
[0m14:06:24.751452 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m14:06:24.757350 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m14:06:24.758163 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m14:06:24.761721 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m14:06:24.762943 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m14:06:24.763360 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: BEGIN
[0m14:06:24.763672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.767140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.767743 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"
[0m14:06:24.768151 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."fct_appointment"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:06:24.768890 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m14:06:24.769425 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: ROLLBACK
[0m14:06:24.770171 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64: Close
[0m14:06:24.775020 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_doctor_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_doctor_id.sql
[0m14:06:24.776672 [error] [Thread-1 (]: 7 of 20 ERROR not_null_fct_appointment_doctor_id ............................... [[31mERROR[0m in 0.03s]
[0m14:06:24.778546 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64
[0m14:06:24.780627 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m14:06:24.782620 [info ] [Thread-1 (]: 8 of 20 START test not_null_fct_appointment_invoice_id ......................... [RUN]
[0m14:06:24.783551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64, now test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62)
[0m14:06:24.784164 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m14:06:24.792175 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m14:06:24.792999 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m14:06:24.798331 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m14:06:24.799303 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m14:06:24.800012 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: BEGIN
[0m14:06:24.800447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.803879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.804676 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"
[0m14:06:24.805180 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."fct_appointment"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:06:24.806165 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m14:06:24.806641 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: ROLLBACK
[0m14:06:24.807300 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62: Close
[0m14:06:24.811455 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_invoice_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_invoice_id.sql
[0m14:06:24.812313 [error] [Thread-1 (]: 8 of 20 ERROR not_null_fct_appointment_invoice_id .............................. [[31mERROR[0m in 0.03s]
[0m14:06:24.813000 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62
[0m14:06:24.813519 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m14:06:24.814029 [info ] [Thread-1 (]: 9 of 20 START test not_null_fct_appointment_patient_id ......................... [RUN]
[0m14:06:24.814546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62, now test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09)
[0m14:06:24.814926 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m14:06:24.819449 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m14:06:24.820194 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m14:06:24.823708 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m14:06:24.824649 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m14:06:24.825121 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: BEGIN
[0m14:06:24.825643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.829640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.830383 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"
[0m14:06:24.830769 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."fct_appointment"
where patient_id is null



      
    ) dbt_internal_test
[0m14:06:24.831994 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m14:06:24.832486 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: ROLLBACK
[0m14:06:24.833051 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09: Close
[0m14:06:24.835679 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_patient_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_patient_id.sql
[0m14:06:24.836313 [error] [Thread-1 (]: 9 of 20 ERROR not_null_fct_appointment_patient_id .............................. [[31mERROR[0m in 0.02s]
[0m14:06:24.837274 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09
[0m14:06:24.838071 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m14:06:24.839797 [info ] [Thread-1 (]: 10 of 20 START test not_null_fct_appointment_procedure_id ...................... [RUN]
[0m14:06:24.841459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09, now test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758)
[0m14:06:24.842814 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m14:06:24.852374 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m14:06:24.853182 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m14:06:24.856922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m14:06:24.857907 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m14:06:24.858457 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: BEGIN
[0m14:06:24.858892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.864376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.864925 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"
[0m14:06:24.865346 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."fct_appointment"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:06:24.866158 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 14: from "my_db"."public"."fct_appointment"
              ^

[0m14:06:24.866592 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: ROLLBACK
[0m14:06:24.867174 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758: Close
[0m14:06:24.869863 [debug] [Thread-1 (]: Database Error in test not_null_fct_appointment_procedure_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_procedure_id.sql
[0m14:06:24.870440 [error] [Thread-1 (]: 10 of 20 ERROR not_null_fct_appointment_procedure_id ........................... [[31mERROR[0m in 0.03s]
[0m14:06:24.871769 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758
[0m14:06:24.872707 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:06:24.873421 [info ] [Thread-1 (]: 11 of 20 START test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m14:06:24.874296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758, now test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549)
[0m14:06:24.874816 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:06:24.885009 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:06:24.885611 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:06:24.888684 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:06:24.889446 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:06:24.889842 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: BEGIN
[0m14:06:24.890205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.894304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.894942 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:06:24.895377 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."dim_billing"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:06:24.900230 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:24.901890 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: ROLLBACK
[0m14:06:24.902461 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: Close
[0m14:06:24.903267 [error] [Thread-1 (]: 11 of 20 FAIL 336 relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [[31mFAIL 336[0m in 0.03s]
[0m14:06:24.904438 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:06:24.905699 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m14:06:24.907292 [info ] [Thread-1 (]: 12 of 20 START test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [RUN]
[0m14:06:24.909000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549, now test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc)
[0m14:06:24.909957 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m14:06:24.924511 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m14:06:24.925434 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m14:06:24.930365 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m14:06:24.931359 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m14:06:24.931822 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: BEGIN
[0m14:06:24.932215 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.935940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.936499 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"
[0m14:06:24.937127 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select doctor_id as from_field
    from "my_db"."public"."fct_appointment"
    where doctor_id is not null
),

parent as (
    select doctor_id as to_field
    from "my_db"."public"."dim_doctor"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:06:24.938687 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m14:06:24.939653 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: ROLLBACK
[0m14:06:24.940572 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc: Close
[0m14:06:24.944810 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_fa9c4db216fde9c5ba7fc811056f7bd9.sql
[0m14:06:24.945466 [error] [Thread-1 (]: 12 of 20 ERROR relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_  [[31mERROR[0m in 0.04s]
[0m14:06:24.946199 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc
[0m14:06:24.946678 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m14:06:24.947134 [info ] [Thread-1 (]: 13 of 20 START test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [RUN]
[0m14:06:24.947831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc, now test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77)
[0m14:06:24.948284 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m14:06:24.954418 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m14:06:24.955308 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m14:06:24.958358 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m14:06:24.959204 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m14:06:24.960208 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: BEGIN
[0m14:06:24.960788 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:24.964639 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:24.965200 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"
[0m14:06:24.965614 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select invoice_id as from_field
    from "my_db"."public"."fct_appointment"
    where invoice_id is not null
),

parent as (
    select invoice_id as to_field
    from "my_db"."public"."dim_billing"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:06:24.966327 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m14:06:24.966832 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: ROLLBACK
[0m14:06:24.967365 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77: Close
[0m14:06:24.970218 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_6aadef5ebd2b7c0bac677b51dbcf7646.sql
[0m14:06:24.970919 [error] [Thread-1 (]: 13 of 20 ERROR relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_  [[31mERROR[0m in 0.02s]
[0m14:06:24.973116 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77
[0m14:06:24.973893 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m14:06:24.975013 [info ] [Thread-1 (]: 14 of 20 START test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m14:06:24.976017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77, now test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c)
[0m14:06:24.976927 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m14:06:24.989168 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m14:06:24.990256 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m14:06:24.997840 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m14:06:24.998715 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m14:06:24.999148 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: BEGIN
[0m14:06:24.999525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.003230 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.003894 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"
[0m14:06:25.004454 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."fct_appointment"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:06:25.005928 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m14:06:25.006546 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: ROLLBACK
[0m14:06:25.007193 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c: Close
[0m14:06:25.010968 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_1ac9e1ce04500c065eff4df6f762bf9b.sql
[0m14:06:25.012265 [error] [Thread-1 (]: 14 of 20 ERROR relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_  [[31mERROR[0m in 0.04s]
[0m14:06:25.014314 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c
[0m14:06:25.015547 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:25.016318 [info ] [Thread-1 (]: 15 of 20 START test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [RUN]
[0m14:06:25.017255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c, now test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46)
[0m14:06:25.018120 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:25.123304 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:25.125021 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:25.129343 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:25.130241 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:25.130668 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: BEGIN
[0m14:06:25.131052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.134522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.134973 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:25.135378 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select procedure_id as from_field
    from "my_db"."public"."fct_appointment"
    where procedure_id is not null
),

parent as (
    select procedure_id as to_field
    from "my_db"."public"."dim_medical_procedure"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:06:25.136076 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m14:06:25.136518 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: ROLLBACK
[0m14:06:25.137111 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: Close
[0m14:06:25.139859 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_ad9e4146696e075b8b2d77e7a218615c.sql
[0m14:06:25.140716 [error] [Thread-1 (]: 15 of 20 ERROR relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [[31mERROR[0m in 0.12s]
[0m14:06:25.141580 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:25.142034 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:06:25.142480 [info ] [Thread-1 (]: 16 of 20 START test unique_dim_billing_invoice_id .............................. [RUN]
[0m14:06:25.142952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:06:25.143332 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:06:25.150571 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:06:25.151258 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:06:25.153804 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:06:25.154364 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:06:25.154689 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m14:06:25.154985 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.157969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.158467 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:06:25.158969 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:06:25.163966 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:25.165695 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m14:06:25.166331 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m14:06:25.167216 [info ] [Thread-1 (]: 16 of 20 PASS unique_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.02s]
[0m14:06:25.168063 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:06:25.169129 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:06:25.170082 [info ] [Thread-1 (]: 17 of 20 START test unique_dim_doctor_doctor_id ................................ [RUN]
[0m14:06:25.170773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:06:25.171190 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:06:25.177281 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:06:25.178653 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:06:25.186637 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:06:25.188693 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:06:25.189425 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m14:06:25.189897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.195188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.196045 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:06:25.196490 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:06:25.198527 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:25.200310 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m14:06:25.200962 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m14:06:25.201683 [info ] [Thread-1 (]: 17 of 20 PASS unique_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.03s]
[0m14:06:25.202420 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:06:25.202881 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:25.203507 [info ] [Thread-1 (]: 18 of 20 START test unique_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:06:25.204050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:06:25.204476 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:25.209995 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:25.210686 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:25.213290 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:25.213974 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:25.214362 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:06:25.214703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.217991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.218434 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:25.218797 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:06:25.221462 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:25.224190 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:06:25.225103 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:06:25.226096 [info ] [Thread-1 (]: 18 of 20 PASS unique_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.02s]
[0m14:06:25.227134 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:25.227670 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:06:25.228257 [info ] [Thread-1 (]: 19 of 20 START test unique_dim_patient_patient_id .............................. [RUN]
[0m14:06:25.228861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:06:25.229271 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:06:25.233847 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:06:25.234479 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:06:25.237496 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:06:25.238814 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:06:25.239747 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m14:06:25.241431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.250349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.250934 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:06:25.251690 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:06:25.254936 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:25.260711 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m14:06:25.261901 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m14:06:25.262877 [error] [Thread-1 (]: 19 of 20 FAIL 280 unique_dim_patient_patient_id ................................ [[31mFAIL 280[0m in 0.03s]
[0m14:06:25.263718 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:06:25.264222 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m14:06:25.264739 [info ] [Thread-1 (]: 20 of 20 START test unique_fct_appointment_appointment_id ...................... [RUN]
[0m14:06:25.265538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61, now test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f)
[0m14:06:25.266214 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m14:06:25.272614 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m14:06:25.273490 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m14:06:25.276473 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m14:06:25.277085 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m14:06:25.277467 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: BEGIN
[0m14:06:25.277820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:25.282448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.282971 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"
[0m14:06:25.283435 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    appointment_id as unique_field,
    count(*) as n_records

from "my_db"."public"."fct_appointment"
where appointment_id is not null
group by appointment_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:06:25.284450 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 15: from "my_db"."public"."fct_appointment"
              ^

[0m14:06:25.284916 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: ROLLBACK
[0m14:06:25.285538 [debug] [Thread-1 (]: On test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f: Close
[0m14:06:25.288901 [debug] [Thread-1 (]: Database Error in test unique_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 15: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/unique_fct_appointment_appointment_id.sql
[0m14:06:25.290132 [error] [Thread-1 (]: 20 of 20 ERROR unique_fct_appointment_appointment_id ........................... [[31mERROR[0m in 0.02s]
[0m14:06:25.291235 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f
[0m14:06:25.292854 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:25.293298 [debug] [MainThread]: On master: BEGIN
[0m14:06:25.293623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:25.297282 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:25.297851 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.298143 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:25.298447 [debug] [MainThread]: On master: COMMIT
[0m14:06:25.298850 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:25.299197 [debug] [MainThread]: On master: Close
[0m14:06:25.299773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:25.300156 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f' was properly closed.
[0m14:06:25.300648 [info ] [MainThread]: 
[0m14:06:25.301129 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m14:06:25.305265 [debug] [MainThread]: Command end result
[0m14:06:25.393933 [info ] [MainThread]: 
[0m14:06:25.394871 [info ] [MainThread]: [31mCompleted with 13 errors and 0 warnings:[0m
[0m14:06:25.395578 [info ] [MainThread]: 
[0m14:06:25.397067 [error] [MainThread]:   Database Error in test not_null_fct_appointment_appointment_date (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_date.sql
[0m14:06:25.397767 [info ] [MainThread]: 
[0m14:06:25.398853 [error] [MainThread]:   Database Error in test not_null_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_appointment_id.sql
[0m14:06:25.399797 [info ] [MainThread]: 
[0m14:06:25.400617 [error] [MainThread]:   Database Error in test not_null_fct_appointment_doctor_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_doctor_id.sql
[0m14:06:25.401278 [info ] [MainThread]: 
[0m14:06:25.402061 [error] [MainThread]:   Database Error in test not_null_fct_appointment_invoice_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_invoice_id.sql
[0m14:06:25.403013 [info ] [MainThread]: 
[0m14:06:25.403954 [error] [MainThread]:   Database Error in test not_null_fct_appointment_patient_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_patient_id.sql
[0m14:06:25.404616 [info ] [MainThread]: 
[0m14:06:25.405305 [error] [MainThread]:   Database Error in test not_null_fct_appointment_procedure_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 14: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/not_null_fct_appointment_procedure_id.sql
[0m14:06:25.406246 [info ] [MainThread]: 
[0m14:06:25.407095 [error] [MainThread]: [31mFailure in test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)[0m
[0m14:06:25.407821 [error] [MainThread]:   Got 336 results, configured to fail if != 0
[0m14:06:25.408380 [info ] [MainThread]: 
[0m14:06:25.409001 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/relationships_dim_billing_67d755ce333822e0ca7d372874c62656.sql
[0m14:06:25.409876 [info ] [MainThread]: 
[0m14:06:25.410644 [error] [MainThread]:   Database Error in test relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_fa9c4db216fde9c5ba7fc811056f7bd9.sql
[0m14:06:25.411401 [info ] [MainThread]: 
[0m14:06:25.412253 [error] [MainThread]:   Database Error in test relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_6aadef5ebd2b7c0bac677b51dbcf7646.sql
[0m14:06:25.413692 [info ] [MainThread]: 
[0m14:06:25.415117 [error] [MainThread]:   Database Error in test relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_1ac9e1ce04500c065eff4df6f762bf9b.sql
[0m14:06:25.416205 [info ] [MainThread]: 
[0m14:06:25.417793 [error] [MainThread]:   Database Error in test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_ad9e4146696e075b8b2d77e7a218615c.sql
[0m14:06:25.418921 [info ] [MainThread]: 
[0m14:06:25.420190 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m14:06:25.421053 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m14:06:25.422165 [info ] [MainThread]: 
[0m14:06:25.422984 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m14:06:25.423926 [info ] [MainThread]: 
[0m14:06:25.424816 [error] [MainThread]:   Database Error in test unique_fct_appointment_appointment_id (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 15: from "my_db"."public"."fct_appointment"
                ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/unique_fct_appointment_appointment_id.sql
[0m14:06:25.425717 [info ] [MainThread]: 
[0m14:06:25.426403 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=13 SKIP=0 TOTAL=20
[0m14:06:25.428119 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.6029936, "process_user_time": 2.806994, "process_kernel_time": 0.193379, "process_mem_max_rss": "114096", "process_out_blocks": "2480", "command_success": false, "process_in_blocks": "0"}
[0m14:06:25.429222 [debug] [MainThread]: Command `dbt test` failed at 14:06:25.428994 after 1.60 seconds
[0m14:06:25.429902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d038240350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d036177150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72d036177910>]}
[0m14:06:25.431370 [debug] [MainThread]: Flushing usage events
[0m14:06:47.166488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a55840dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a559c3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a55a90090>]}


============================== 14:06:47.169915 | 7a880879-1143-4244-8457-92e05a2f718b ==============================
[0m14:06:47.169915 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:06:47.170503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test -m dim_mediccal_procedure', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:47.344404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a880879-1143-4244-8457-92e05a2f718b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a557f8f10>]}
[0m14:06:47.405139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a880879-1143-4244-8457-92e05a2f718b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a59520350>]}
[0m14:06:47.405877 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:06:47.416658 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:06:47.549576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:47.550004 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:47.601329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a880879-1143-4244-8457-92e05a2f718b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a53eb1f50>]}
[0m14:06:47.717245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a880879-1143-4244-8457-92e05a2f718b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a53a003d0>]}
[0m14:06:47.717850 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m14:06:47.718255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a880879-1143-4244-8457-92e05a2f718b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a53f8a050>]}
[0m14:06:47.719262 [warn ] [MainThread]: The selection criterion 'dim_mediccal_procedure' does not match any enabled nodes
[0m14:06:47.720876 [info ] [MainThread]: 
[0m14:06:47.721478 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:06:47.723418 [debug] [MainThread]: Command end result
[0m14:06:47.761203 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.648061, "process_user_time": 1.962468, "process_kernel_time": 0.142797, "process_mem_max_rss": "105532", "process_out_blocks": "1952", "process_in_blocks": "0"}
[0m14:06:47.761834 [debug] [MainThread]: Command `dbt test` succeeded at 14:06:47.761700 after 0.65 seconds
[0m14:06:47.762206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a55840ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a5584d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740a5962c690>]}
[0m14:06:47.762543 [debug] [MainThread]: Flushing usage events
[0m14:06:58.115505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d4b3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d62b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d4b3890>]}


============================== 14:06:58.120702 | 53f4c67b-e182-4a78-844c-761403d60399 ==============================
[0m14:06:58.120702 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:06:58.121696 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test -m dim_medical_procedure', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:58.283546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53f4c67b-e182-4a78-844c-761403d60399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d4bf4d0>]}
[0m14:06:58.344010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53f4c67b-e182-4a78-844c-761403d60399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764641180e90>]}
[0m14:06:58.344898 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:06:58.356026 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:06:58.489988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:58.490421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:58.544025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53f4c67b-e182-4a78-844c-761403d60399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463bb49690>]}
[0m14:06:58.665039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53f4c67b-e182-4a78-844c-761403d60399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463b673dd0>]}
[0m14:06:58.665596 [info ] [MainThread]: Found 5 seeds, 10 models, 20 data tests, 415 macros
[0m14:06:58.665947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53f4c67b-e182-4a78-844c-761403d60399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d4b1190>]}
[0m14:06:58.667863 [info ] [MainThread]: 
[0m14:06:58.668449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:58.673326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:06:58.717779 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:58.718270 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:06:58.718565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:58.724045 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:06:58.724599 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:06:58.725304 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:58.729924 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:06:58.731851 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:06:58.732500 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:06:58.740750 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.741191 [debug] [MainThread]: On master: BEGIN
[0m14:06:58.741504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:58.744624 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:58.745044 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.745447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:58.763642 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:06:58.766671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53f4c67b-e182-4a78-844c-761403d60399', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463b64f490>]}
[0m14:06:58.767064 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:58.767560 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.767839 [debug] [MainThread]: On master: BEGIN
[0m14:06:58.768360 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:58.768705 [debug] [MainThread]: On master: COMMIT
[0m14:06:58.768964 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.769208 [debug] [MainThread]: On master: COMMIT
[0m14:06:58.769617 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:58.769921 [debug] [MainThread]: On master: Close
[0m14:06:58.770356 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:58.770688 [info ] [MainThread]: 
[0m14:06:58.772739 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:58.773221 [info ] [Thread-1 (]: 1 of 3 START test not_null_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:06:58.774014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:06:58.774547 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:58.796894 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:58.799510 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:58.816172 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:58.816849 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:58.817259 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:06:58.817599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:58.821423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:58.821891 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:06:58.822269 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:06:58.823720 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:58.827839 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:06:58.828441 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:06:58.829074 [info ] [Thread-1 (]: 1 of 3 PASS not_null_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.06s]
[0m14:06:58.829733 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:06:58.830177 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:58.830690 [info ] [Thread-1 (]: 2 of 3 START test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [RUN]
[0m14:06:58.831173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46)
[0m14:06:58.831550 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:58.842019 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:58.842697 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:58.845401 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:58.846202 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:58.846609 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: BEGIN
[0m14:06:58.846979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:58.850856 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:58.851486 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"
[0m14:06:58.851924 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select procedure_id as from_field
    from "my_db"."public"."fct_appointment"
    where procedure_id is not null
),

parent as (
    select procedure_id as to_field
    from "my_db"."public"."dim_medical_procedure"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:06:58.852939 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.fct_appointment" does not exist
LINE 13:     from "my_db"."public"."fct_appointment"
                  ^

[0m14:06:58.854824 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: ROLLBACK
[0m14:06:58.856792 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46: Close
[0m14:06:58.864859 [debug] [Thread-1 (]: Database Error in test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_ad9e4146696e075b8b2d77e7a218615c.sql
[0m14:06:58.866053 [error] [Thread-1 (]: 2 of 3 ERROR relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_  [[31mERROR[0m in 0.03s]
[0m14:06:58.867033 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46
[0m14:06:58.867792 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:58.870396 [info ] [Thread-1 (]: 3 of 3 START test unique_dim_medical_procedure_procedure_id .................... [RUN]
[0m14:06:58.871109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:06:58.871562 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:58.881769 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:58.882395 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:58.884902 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:58.885491 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:58.885862 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:06:58.886179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:58.889441 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:06:58.889893 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:06:58.890290 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:06:58.892966 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:06:58.894838 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:06:58.895733 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:06:58.896555 [info ] [Thread-1 (]: 3 of 3 PASS unique_dim_medical_procedure_procedure_id .......................... [[32mPASS[0m in 0.03s]
[0m14:06:58.897321 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:06:58.898696 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.899100 [debug] [MainThread]: On master: BEGIN
[0m14:06:58.899662 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:58.903814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:06:58.904192 [debug] [MainThread]: On master: COMMIT
[0m14:06:58.904480 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:58.904734 [debug] [MainThread]: On master: COMMIT
[0m14:06:58.905077 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:06:58.905365 [debug] [MainThread]: On master: Close
[0m14:06:58.905855 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:58.906236 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5' was properly closed.
[0m14:06:58.906679 [info ] [MainThread]: 
[0m14:06:58.907103 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m14:06:58.908360 [debug] [MainThread]: Command end result
[0m14:06:58.952529 [info ] [MainThread]: 
[0m14:06:58.953053 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:58.953414 [info ] [MainThread]: 
[0m14:06:58.953997 [error] [MainThread]:   Database Error in test relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_ (models/marts/appointment/schema.yml)
  relation "public.fct_appointment" does not exist
  LINE 13:     from "my_db"."public"."fct_appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/schema.yml/relationships_fct_appointment_ad9e4146696e075b8b2d77e7a218615c.sql
[0m14:06:58.954476 [info ] [MainThread]: 
[0m14:06:58.954824 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:06:58.955626 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.8907039, "process_user_time": 2.109352, "process_kernel_time": 0.17471, "process_mem_max_rss": "114500", "process_out_blocks": "2048", "command_success": false, "process_in_blocks": "0"}
[0m14:06:58.956177 [debug] [MainThread]: Command `dbt test` failed at 14:06:58.956067 after 0.89 seconds
[0m14:06:58.956603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d493b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d469890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76463d389110>]}
[0m14:06:58.957011 [debug] [MainThread]: Flushing usage events
[0m14:09:16.564680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264a2daa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264a2d8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264a2da7d0>]}


============================== 14:09:16.567282 | ef528520-f63a-4784-88ec-97e44af59fe7 ==============================
[0m14:09:16.567282 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:09:16.567768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fat_appointment', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:16.702222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef528520-f63a-4784-88ec-97e44af59fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264a32d590>]}
[0m14:09:16.748974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef528520-f63a-4784-88ec-97e44af59fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e028bd0>]}
[0m14:09:16.749653 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:09:16.760347 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:09:16.870754 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:09:16.871272 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:09:16.871620 [debug] [MainThread]: Partial parsing: deleted file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m14:09:17.062841 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:09:17.063284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ef528520-f63a-4784-88ec-97e44af59fe7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264a322290>]}
[0m14:09:17.073293 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_appointment' in the 'models' section of file 'models/marts/appointment/schema.yml'
[0m14:09:17.198604 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.unique_fct_appointment_appointment_id.9f18942b0f' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.199093 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.not_null_fct_appointment_appointment_id.6559e7ea21' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.199459 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.not_null_fct_appointment_patient_id.0ae5226e09' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.199859 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.relationships_fct_appointment_patient_id__patient_id__ref_dim_patient_.2f81775b5c' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.200208 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.not_null_fct_appointment_doctor_id.de7b32ca64' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.200612 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.relationships_fct_appointment_doctor_id__doctor_id__ref_dim_doctor_.912eb183fc' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.200976 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.not_null_fct_appointment_procedure_id.fdc4137758' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.201310 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.relationships_fct_appointment_procedure_id__procedure_id__ref_dim_medical_procedure_.d25ab6cd46' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.201656 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.not_null_fct_appointment_invoice_id.c8148fed62' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.201974 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.relationships_fct_appointment_invoice_id__invoice_id__ref_dim_billing_.9a310f7c77' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.202285 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_modeling.not_null_fct_appointment_appointment_date.db194ab9ed' (models/marts/appointment/schema.yml) depends on a node named 'fct_appointment' in package '' which was not found
[0m14:09:17.262860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef528520-f63a-4784-88ec-97e44af59fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772648ac4e50>]}
[0m14:09:17.345785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef528520-f63a-4784-88ec-97e44af59fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772647f21610>]}
[0m14:09:17.346239 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:09:17.346533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef528520-f63a-4784-88ec-97e44af59fe7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772647b38590>]}
[0m14:09:17.347149 [warn ] [MainThread]: The selection criterion 'fat_appointment' does not match any enabled nodes
[0m14:09:17.348255 [info ] [MainThread]: 
[0m14:09:17.348552 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:09:17.348970 [debug] [MainThread]: Command end result
[0m14:09:17.377818 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85643494, "process_user_time": 1.906772, "process_kernel_time": 0.125984, "process_mem_max_rss": "108588", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m14:09:17.378362 [debug] [MainThread]: Command `dbt run` succeeded at 14:09:17.378242 after 0.86 seconds
[0m14:09:17.378716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264a32d450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264a4a8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e138750>]}
[0m14:09:17.379050 [debug] [MainThread]: Flushing usage events
[0m14:09:24.318066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442adfe2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ae1a3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ae31ccd0>]}


============================== 14:09:24.320707 | 8f9839ee-090b-4594-abd7-f21d341a32b3 ==============================
[0m14:09:24.320707 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:09:24.321226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m fact_appointment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:24.454097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f9839ee-090b-4594-abd7-f21d341a32b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442adfe1190>]}
[0m14:09:24.500815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f9839ee-090b-4594-abd7-f21d341a32b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442b1cf8f10>]}
[0m14:09:24.501504 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:09:24.510519 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:09:24.621614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:09:24.621991 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:09:24.664050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f9839ee-090b-4594-abd7-f21d341a32b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ac64c350>]}
[0m14:09:24.750159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f9839ee-090b-4594-abd7-f21d341a32b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ac3fc110>]}
[0m14:09:24.750683 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:09:24.751030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9839ee-090b-4594-abd7-f21d341a32b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ac6dc9d0>]}
[0m14:09:24.752728 [info ] [MainThread]: 
[0m14:09:24.753287 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:09:24.754192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:09:24.794517 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:09:24.794916 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:09:24.795190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:24.799969 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:09:24.801223 [debug] [ThreadPool]: On list_my_db: Close
[0m14:09:24.805985 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:09:24.812078 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:09:24.812438 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:09:24.812692 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:24.815816 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:09:24.816180 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:09:24.816482 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:09:24.818915 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:09:24.820370 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:09:24.820819 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:09:24.828857 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:24.829221 [debug] [MainThread]: On master: BEGIN
[0m14:09:24.829507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:24.832796 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:24.833221 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:24.833605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:09:24.849073 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:09:24.852116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9839ee-090b-4594-abd7-f21d341a32b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ab8eca10>]}
[0m14:09:24.852519 [debug] [MainThread]: On master: ROLLBACK
[0m14:09:24.853043 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:24.853320 [debug] [MainThread]: On master: BEGIN
[0m14:09:24.853923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:24.854240 [debug] [MainThread]: On master: COMMIT
[0m14:09:24.854546 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:24.854801 [debug] [MainThread]: On master: COMMIT
[0m14:09:24.855183 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:09:24.855492 [debug] [MainThread]: On master: Close
[0m14:09:24.855947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:24.856322 [info ] [MainThread]: 
[0m14:09:24.858454 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:09:24.858988 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:09:24.859793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:09:24.860172 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:09:24.868438 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:09:24.868962 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:09:24.928166 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:09:24.929187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:09:24.929778 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:09:24.930257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:24.934618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:09:24.935173 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:09:24.935568 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:09:24.936599 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:09:24.937040 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:09:24.937560 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:09:24.941471 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:09:24.943044 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f9839ee-090b-4594-abd7-f21d341a32b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442ae029150>]}
[0m14:09:24.943742 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.08s]
[0m14:09:24.944392 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:09:24.946171 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:24.946583 [debug] [MainThread]: On master: BEGIN
[0m14:09:24.946877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:24.950155 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:24.950590 [debug] [MainThread]: On master: COMMIT
[0m14:09:24.950880 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:24.951156 [debug] [MainThread]: On master: COMMIT
[0m14:09:24.951569 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:09:24.951874 [debug] [MainThread]: On master: Close
[0m14:09:24.952284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:24.952570 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:09:24.952886 [info ] [MainThread]: 
[0m14:09:24.953224 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m14:09:24.953968 [debug] [MainThread]: Command end result
[0m14:09:24.989064 [info ] [MainThread]: 
[0m14:09:24.989542 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:24.989854 [info ] [MainThread]: 
[0m14:09:24.990261 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:09:24.990600 [info ] [MainThread]: 
[0m14:09:24.990969 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:09:24.991852 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7164144, "process_user_time": 1.755691, "process_kernel_time": 0.125691, "process_mem_max_rss": "111860", "process_out_blocks": "1976", "command_success": false, "process_in_blocks": "0"}
[0m14:09:24.992511 [debug] [MainThread]: Command `dbt run` failed at 14:09:24.992375 after 0.72 seconds
[0m14:09:24.993400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442b1f6ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442b1f6cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7442b1f6cd10>]}
[0m14:09:24.994562 [debug] [MainThread]: Flushing usage events
[0m14:09:57.475733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a48910bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a4861f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a485d6950>]}


============================== 14:09:57.478566 | af9a5d38-9c18-4010-8531-9baeabb4c375 ==============================
[0m14:09:57.478566 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:09:57.479127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m fact_appointment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:57.635401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af9a5d38-9c18-4010-8531-9baeabb4c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a46cef6d0>]}
[0m14:09:57.684669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af9a5d38-9c18-4010-8531-9baeabb4c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a4c338f10>]}
[0m14:09:57.685357 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:09:57.694800 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:09:57.805798 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:09:57.806360 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:09:58.011465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af9a5d38-9c18-4010-8531-9baeabb4c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a46c3a250>]}
[0m14:09:58.095642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af9a5d38-9c18-4010-8531-9baeabb4c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a485569d0>]}
[0m14:09:58.096128 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:09:58.096470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9a5d38-9c18-4010-8531-9baeabb4c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a485d5a50>]}
[0m14:09:58.098054 [info ] [MainThread]: 
[0m14:09:58.098585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:09:58.099417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:09:58.136094 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:09:58.136503 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:09:58.136766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:58.142219 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:09:58.143533 [debug] [ThreadPool]: On list_my_db: Close
[0m14:09:58.148882 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:09:58.154745 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:09:58.155094 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:09:58.155358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:09:58.158667 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:09:58.159032 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:09:58.159329 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:09:58.161828 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:09:58.163283 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:09:58.163744 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:09:58.172123 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:58.172515 [debug] [MainThread]: On master: BEGIN
[0m14:09:58.172789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:58.176184 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:58.176565 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:58.176923 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:09:58.192116 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:09:58.195091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af9a5d38-9c18-4010-8531-9baeabb4c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a469b6050>]}
[0m14:09:58.195530 [debug] [MainThread]: On master: ROLLBACK
[0m14:09:58.196034 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:58.196338 [debug] [MainThread]: On master: BEGIN
[0m14:09:58.196932 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:58.197262 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.197564 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:58.197844 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.198274 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:09:58.198601 [debug] [MainThread]: On master: Close
[0m14:09:58.199060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:09:58.199385 [info ] [MainThread]: 
[0m14:09:58.201540 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:09:58.202085 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:09:58.203015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:09:58.203433 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:09:58.211928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:09:58.212651 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:09:58.248887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:09:58.249581 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:09:58.249913 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:09:58.250230 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:09:58.254172 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:09:58.254761 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:09:58.255169 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:09:58.256469 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column pr.appointment_id does not exist
LINE 47: join procedure_data pr on a.Appointment_id = pr.Appointment_...
                                                      ^
HINT:  Perhaps you meant to reference the column "a.appointment_id".

[0m14:09:58.256936 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:09:58.257445 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:09:58.261178 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column pr.appointment_id does not exist
  LINE 47: join procedure_data pr on a.Appointment_id = pr.Appointment_...
                                                        ^
  HINT:  Perhaps you meant to reference the column "a.appointment_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:09:58.262560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af9a5d38-9c18-4010-8531-9baeabb4c375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a45944a10>]}
[0m14:09:58.263161 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:09:58.263821 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:09:58.265495 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:58.265839 [debug] [MainThread]: On master: BEGIN
[0m14:09:58.266162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:09:58.269150 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:09:58.269612 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.269915 [debug] [MainThread]: Using postgres connection "master"
[0m14:09:58.270199 [debug] [MainThread]: On master: COMMIT
[0m14:09:58.270632 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:09:58.270939 [debug] [MainThread]: On master: Close
[0m14:09:58.271418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:58.271713 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:09:58.272047 [info ] [MainThread]: 
[0m14:09:58.272405 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:09:58.273183 [debug] [MainThread]: Command end result
[0m14:09:58.310491 [info ] [MainThread]: 
[0m14:09:58.311040 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:58.311375 [info ] [MainThread]: 
[0m14:09:58.311828 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column pr.appointment_id does not exist
  LINE 47: join procedure_data pr on a.Appointment_id = pr.Appointment_...
                                                        ^
  HINT:  Perhaps you meant to reference the column "a.appointment_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:09:58.312152 [info ] [MainThread]: 
[0m14:09:58.312500 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:09:58.313295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88609874, "process_user_time": 2.000174, "process_kernel_time": 0.14494, "process_mem_max_rss": "114608", "process_out_blocks": "2840", "command_success": false, "process_in_blocks": "0"}
[0m14:09:58.313821 [debug] [MainThread]: Command `dbt run` failed at 14:09:58.313714 after 0.89 seconds
[0m14:09:58.314178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a48797a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a4c590c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778a4c590dd0>]}
[0m14:09:58.314537 [debug] [MainThread]: Flushing usage events
[0m14:11:40.313121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5aa791d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5ad6cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5b6e7910>]}


============================== 14:11:40.316103 | f04af574-4406-4402-a39f-b4c43e445c78 ==============================
[0m14:11:40.316103 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:11:40.316659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m fact_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:11:40.470027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5aa31150>]}
[0m14:11:40.518460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5e73cf90>]}
[0m14:11:40.519184 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:11:40.527923 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:11:40.639125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:11:40.639717 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:11:40.640052 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:11:40.830831 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:40.831343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5a978310>]}
[0m14:11:40.986965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b58e779d0>]}
[0m14:11:41.071174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b58cee750>]}
[0m14:11:41.071690 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:11:41.071978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b59000710>]}
[0m14:11:41.073552 [info ] [MainThread]: 
[0m14:11:41.074065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:41.074933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:11:41.112672 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:11:41.113048 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:11:41.113386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:41.118306 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:11:41.119635 [debug] [ThreadPool]: On list_my_db: Close
[0m14:11:41.124768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:11:41.130913 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:11:41.131270 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:11:41.131537 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:41.134553 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:11:41.134988 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:11:41.135313 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:41.137771 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:11:41.139262 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:11:41.139728 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:11:41.147213 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:41.147579 [debug] [MainThread]: On master: BEGIN
[0m14:11:41.147826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:41.150780 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:41.151173 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:41.151561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:41.167139 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:11:41.170183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b59135190>]}
[0m14:11:41.170638 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:41.171115 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:41.171400 [debug] [MainThread]: On master: BEGIN
[0m14:11:41.171977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:41.172321 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.172618 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:41.172865 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.173276 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:11:41.173569 [debug] [MainThread]: On master: Close
[0m14:11:41.174072 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:41.174429 [info ] [MainThread]: 
[0m14:11:41.176729 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:11:41.177264 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:11:41.178149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:11:41.178532 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:11:41.187066 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:11:41.187649 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:11:41.224984 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:11:41.225621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:11:41.225970 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:11:41.226259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:41.229520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:41.229953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:11:41.230314 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:11:41.231437 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:11:41.231854 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:11:41.232398 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:11:41.236035 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:11:41.237503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f04af574-4406-4402-a39f-b4c43e445c78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b53f74150>]}
[0m14:11:41.238091 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:11:41.238697 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:11:41.240289 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:41.240604 [debug] [MainThread]: On master: BEGIN
[0m14:11:41.240863 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:41.243910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:41.244406 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.244731 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:41.244990 [debug] [MainThread]: On master: COMMIT
[0m14:11:41.245383 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:11:41.245662 [debug] [MainThread]: On master: Close
[0m14:11:41.246091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:41.246348 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:11:41.246649 [info ] [MainThread]: 
[0m14:11:41.246983 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:11:41.247673 [debug] [MainThread]: Command end result
[0m14:11:41.347142 [info ] [MainThread]: 
[0m14:11:41.347672 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:11:41.348024 [info ] [MainThread]: 
[0m14:11:41.348514 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:11:41.348914 [info ] [MainThread]: 
[0m14:11:41.349347 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:11:41.350154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0818267, "process_user_time": 2.261835, "process_kernel_time": 0.129104, "process_mem_max_rss": "116520", "process_out_blocks": "2840", "command_success": false, "process_in_blocks": "0"}
[0m14:11:41.350632 [debug] [MainThread]: Command `dbt run` failed at 14:11:41.350526 after 1.08 seconds
[0m14:11:41.350997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5e990dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5e990b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4b5e990cd0>]}
[0m14:11:41.351313 [debug] [MainThread]: Flushing usage events
[0m14:11:56.617950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866fb22650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866fb4ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866fb4b890>]}


============================== 14:11:56.620597 | 39237a33-ae3b-4100-a53e-ea0325d7d501 ==============================
[0m14:11:56.620597 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:11:56.621372 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m fact_appointment', 'send_anonymous_usage_stats': 'True'}
[0m14:11:56.767994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866fb96250>]}
[0m14:11:56.816743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d8673884fd0>]}
[0m14:11:56.817476 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:11:56.826814 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:11:56.940196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:56.940845 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:11:57.129144 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:11:57.129620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866de20090>]}
[0m14:11:57.283496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d86721095d0>]}
[0m14:11:57.369680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866db3a210>]}
[0m14:11:57.370150 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:11:57.370474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866debea90>]}
[0m14:11:57.372320 [info ] [MainThread]: 
[0m14:11:57.372959 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:11:57.373861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:11:57.413455 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:11:57.413820 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:11:57.414094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:57.418586 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:11:57.419853 [debug] [ThreadPool]: On list_my_db: Close
[0m14:11:57.424599 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:11:57.430399 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:11:57.430735 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:11:57.430986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:57.434020 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:11:57.434388 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:11:57.434692 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:11:57.437159 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:11:57.438628 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:11:57.439062 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:11:57.446732 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.447083 [debug] [MainThread]: On master: BEGIN
[0m14:11:57.447331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:57.450421 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:57.450807 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.451200 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:11:57.466706 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:11:57.469606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866de67bd0>]}
[0m14:11:57.470014 [debug] [MainThread]: On master: ROLLBACK
[0m14:11:57.470522 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.470802 [debug] [MainThread]: On master: BEGIN
[0m14:11:57.471299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:57.471708 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.471992 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.472330 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.472838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:11:57.473132 [debug] [MainThread]: On master: Close
[0m14:11:57.473694 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:11:57.474053 [info ] [MainThread]: 
[0m14:11:57.476040 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:11:57.476587 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:11:57.477477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:11:57.477881 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:11:57.486046 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:11:57.486617 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:11:57.524413 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:11:57.525088 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:11:57.525451 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:11:57.525760 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:57.529040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:11:57.529465 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:11:57.529838 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:11:57.530910 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:11:57.531384 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:11:57.531946 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:11:57.535955 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:11:57.537352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39237a33-ae3b-4100-a53e-ea0325d7d501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866cfeded0>]}
[0m14:11:57.537913 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:11:57.538503 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:11:57.540044 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.540374 [debug] [MainThread]: On master: BEGIN
[0m14:11:57.540708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:57.543698 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:11:57.544110 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.544551 [debug] [MainThread]: Using postgres connection "master"
[0m14:11:57.544921 [debug] [MainThread]: On master: COMMIT
[0m14:11:57.545392 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:11:57.545718 [debug] [MainThread]: On master: Close
[0m14:11:57.546331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:57.546703 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:11:57.547061 [info ] [MainThread]: 
[0m14:11:57.547579 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:11:57.548482 [debug] [MainThread]: Command end result
[0m14:11:57.651587 [info ] [MainThread]: 
[0m14:11:57.652099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:11:57.652418 [info ] [MainThread]: 
[0m14:11:57.652843 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:11:57.653158 [info ] [MainThread]: 
[0m14:11:57.653516 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:11:57.654328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0794687, "process_user_time": 2.190492, "process_kernel_time": 0.144032, "process_mem_max_rss": "116356", "process_out_blocks": "2840", "command_success": false, "process_in_blocks": "0"}
[0m14:11:57.654901 [debug] [MainThread]: Command `dbt run` failed at 14:11:57.654784 after 1.08 seconds
[0m14:11:57.655326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866de18410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866de183d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d866de18dd0>]}
[0m14:11:57.655752 [debug] [MainThread]: Flushing usage events
[0m14:12:36.739719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b43be690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b43a7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b43be790>]}


============================== 14:12:36.742338 | 8488e891-2e24-40fb-b77b-1d66b7f3eeec ==============================
[0m14:12:36.742338 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:12:36.742875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_medical_procedure', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:36.876862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8488e891-2e24-40fb-b77b-1d66b7f3eeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b4374e50>]}
[0m14:12:36.923342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8488e891-2e24-40fb-b77b-1d66b7f3eeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b8080ed0>]}
[0m14:12:36.924000 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:12:36.932975 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:12:37.043932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:37.044280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:37.086191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8488e891-2e24-40fb-b77b-1d66b7f3eeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b2850e50>]}
[0m14:12:37.170382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8488e891-2e24-40fb-b77b-1d66b7f3eeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b2a8c5d0>]}
[0m14:12:37.170928 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:12:37.171261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8488e891-2e24-40fb-b77b-1d66b7f3eeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b43a7250>]}
[0m14:12:37.172909 [info ] [MainThread]: 
[0m14:12:37.173440 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:37.174370 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:12:37.215597 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:12:37.215977 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:12:37.216249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:37.220854 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:12:37.222130 [debug] [ThreadPool]: On list_my_db: Close
[0m14:12:37.227047 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:12:37.232873 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:12:37.233252 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:12:37.233517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:37.236773 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:12:37.237154 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:12:37.237453 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:12:37.239882 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:12:37.241339 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:12:37.241765 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:12:37.249544 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:37.249893 [debug] [MainThread]: On master: BEGIN
[0m14:12:37.250142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:37.253462 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:12:37.253943 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:37.254303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:12:37.269813 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:12:37.272969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8488e891-2e24-40fb-b77b-1d66b7f3eeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b1cf9690>]}
[0m14:12:37.273393 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:37.273872 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:37.274134 [debug] [MainThread]: On master: BEGIN
[0m14:12:37.274767 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:12:37.275150 [debug] [MainThread]: On master: COMMIT
[0m14:12:37.275418 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:37.275662 [debug] [MainThread]: On master: COMMIT
[0m14:12:37.276107 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:12:37.276398 [debug] [MainThread]: On master: Close
[0m14:12:37.276898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:37.277219 [info ] [MainThread]: 
[0m14:12:37.279227 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:12:37.279721 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:12:37.280537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:12:37.280949 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:12:37.288589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:12:37.289178 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:12:37.325720 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:12:37.326310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:12:37.326633 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:12:37.326911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:37.329897 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:12:37.330280 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:12:37.330643 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name
        "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        Appointment_id
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:12:37.331240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ""AppointmentID""
LINE 11:         "AppointmentID" as Appointment_id
                 ^

[0m14:12:37.331642 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: ROLLBACK
[0m14:12:37.332110 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:12:37.336036 [debug] [Thread-1 (]: Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near ""AppointmentID""
  LINE 11:         "AppointmentID" as Appointment_id
                   ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:12:37.337426 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8488e891-2e24-40fb-b77b-1d66b7f3eeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b1b080d0>]}
[0m14:12:37.338026 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_medical_procedure .............. [[31mERROR[0m in 0.06s]
[0m14:12:37.338626 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:12:37.340293 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:37.340642 [debug] [MainThread]: On master: BEGIN
[0m14:12:37.340909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:37.343702 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:12:37.344150 [debug] [MainThread]: On master: COMMIT
[0m14:12:37.344463 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:37.344730 [debug] [MainThread]: On master: COMMIT
[0m14:12:37.345142 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:12:37.345534 [debug] [MainThread]: On master: Close
[0m14:12:37.346117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:37.346594 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:12:37.347058 [info ] [MainThread]: 
[0m14:12:37.347721 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:12:37.348700 [debug] [MainThread]: Command end result
[0m14:12:37.383048 [info ] [MainThread]: 
[0m14:12:37.383493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:12:37.383794 [info ] [MainThread]: 
[0m14:12:37.384286 [error] [MainThread]:   Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near ""AppointmentID""
  LINE 11:         "AppointmentID" as Appointment_id
                   ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:12:37.384614 [info ] [MainThread]: 
[0m14:12:37.384994 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:12:37.386040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6899167, "process_user_time": 1.675283, "process_kernel_time": 0.130787, "process_mem_max_rss": "111708", "process_out_blocks": "1944", "command_success": false, "process_in_blocks": "0"}
[0m14:12:37.386741 [debug] [MainThread]: Command `dbt run` failed at 14:12:37.386606 after 0.69 seconds
[0m14:12:37.387210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b43bd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b43bcc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7529b82f4c50>]}
[0m14:12:37.387639 [debug] [MainThread]: Flushing usage events
[0m14:12:50.537063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab4729610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab4712690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab4711dd0>]}


============================== 14:12:50.539716 | 774135e8-7621-49a3-abac-54c48666632a ==============================
[0m14:12:50.539716 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:12:50.540185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:50.669587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab45f50d0>]}
[0m14:12:50.715391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab83f8fd0>]}
[0m14:12:50.716111 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:12:50.724631 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:12:50.834480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:50.835081 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:12:51.022177 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:12:51.022598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab2b3b1d0>]}
[0m14:12:51.177616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab2cbc150>]}
[0m14:12:51.260822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab27331d0>]}
[0m14:12:51.261300 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:12:51.261598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab230dfd0>]}
[0m14:12:51.263072 [info ] [MainThread]: 
[0m14:12:51.263563 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:51.264326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:12:51.302908 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:12:51.303268 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:12:51.303550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:51.307907 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:12:51.309182 [debug] [ThreadPool]: On list_my_db: Close
[0m14:12:51.314534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:12:51.320275 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:12:51.320625 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:12:51.320885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:51.324044 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:12:51.324444 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:12:51.324751 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:12:51.327167 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:12:51.328619 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:12:51.329063 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:12:51.336307 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:51.336656 [debug] [MainThread]: On master: BEGIN
[0m14:12:51.336904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:51.340248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:12:51.340661 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:51.341025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:12:51.356233 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:12:51.359563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab23c2990>]}
[0m14:12:51.360042 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:51.360544 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:51.360842 [debug] [MainThread]: On master: BEGIN
[0m14:12:51.361388 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:12:51.361736 [debug] [MainThread]: On master: COMMIT
[0m14:12:51.361995 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:51.362239 [debug] [MainThread]: On master: COMMIT
[0m14:12:51.362715 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:12:51.362997 [debug] [MainThread]: On master: Close
[0m14:12:51.363501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:12:51.363834 [info ] [MainThread]: 
[0m14:12:51.365993 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:12:51.366531 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:12:51.367287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:12:51.367753 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:12:51.374975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:12:51.375584 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:12:51.412941 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:12:51.413562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:12:51.413888 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:12:51.414177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:51.417416 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:12:51.417929 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:12:51.418358 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        Appointment_id
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:12:51.418971 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 21:         row_number() over (partition by Procedure_id order b...
                           ^

[0m14:12:51.419487 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: ROLLBACK
[0m14:12:51.420061 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:12:51.423677 [debug] [Thread-1 (]: Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "("
  LINE 21:         row_number() over (partition by Procedure_id order b...
                             ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:12:51.425195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '774135e8-7621-49a3-abac-54c48666632a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab13227d0>]}
[0m14:12:51.425854 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_medical_procedure .............. [[31mERROR[0m in 0.06s]
[0m14:12:51.426479 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:12:51.428090 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:51.428398 [debug] [MainThread]: On master: BEGIN
[0m14:12:51.428649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:51.431584 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:12:51.432052 [debug] [MainThread]: On master: COMMIT
[0m14:12:51.432364 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:51.432631 [debug] [MainThread]: On master: COMMIT
[0m14:12:51.433055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:12:51.433505 [debug] [MainThread]: On master: Close
[0m14:12:51.434074 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:51.434453 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:12:51.434787 [info ] [MainThread]: 
[0m14:12:51.435464 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:12:51.436459 [debug] [MainThread]: Command end result
[0m14:12:51.536067 [info ] [MainThread]: 
[0m14:12:51.536605 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:12:51.536932 [info ] [MainThread]: 
[0m14:12:51.537370 [error] [MainThread]:   Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "("
  LINE 21:         row_number() over (partition by Procedure_id order b...
                             ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:12:51.537696 [info ] [MainThread]: 
[0m14:12:51.538031 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:12:51.538835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0442994, "process_user_time": 2.121828, "process_kernel_time": 0.125989, "process_mem_max_rss": "115936", "process_out_blocks": "2832", "command_success": false, "process_in_blocks": "0"}
[0m14:12:51.539345 [debug] [MainThread]: Command `dbt run` failed at 14:12:51.539233 after 1.04 seconds
[0m14:12:51.539690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab866cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab866ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x781ab866ce10>]}
[0m14:12:51.540039 [debug] [MainThread]: Flushing usage events
[0m14:13:14.910127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46a0a9650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46a062950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46b2d2c50>]}


============================== 14:13:14.912771 | 30493df7-177b-428b-83ee-f7a22fdc1e3f ==============================
[0m14:13:14.912771 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:13:14.913276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:13:15.045636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa468738f50>]}
[0m14:13:15.092857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46a0dca50>]}
[0m14:13:15.093562 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:13:15.103076 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:13:15.212934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:13:15.213569 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:13:15.405917 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:13:15.406330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa468775710>]}
[0m14:13:15.561766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46878a750>]}
[0m14:13:15.648662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46baeaf50>]}
[0m14:13:15.649128 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:13:15.649463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa468775d90>]}
[0m14:13:15.651067 [info ] [MainThread]: 
[0m14:13:15.651761 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:15.652798 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:13:15.690508 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:13:15.690870 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:13:15.691127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:15.695600 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:13:15.696864 [debug] [ThreadPool]: On list_my_db: Close
[0m14:13:15.702322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:13:15.708203 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:13:15.708551 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:13:15.708837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:15.712473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:13:15.712880 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:13:15.713197 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:13:15.715677 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:13:15.717200 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:13:15.717651 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:13:15.725481 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:15.725812 [debug] [MainThread]: On master: BEGIN
[0m14:13:15.726069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:15.729196 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:15.729575 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:15.729925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:15.745323 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:13:15.748384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa467d40950>]}
[0m14:13:15.748796 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:15.749293 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:15.749576 [debug] [MainThread]: On master: BEGIN
[0m14:13:15.750136 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:15.750478 [debug] [MainThread]: On master: COMMIT
[0m14:13:15.750744 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:15.750993 [debug] [MainThread]: On master: COMMIT
[0m14:13:15.751386 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:15.751703 [debug] [MainThread]: On master: Close
[0m14:13:15.752179 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:15.752535 [info ] [MainThread]: 
[0m14:13:15.754554 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:13:15.755077 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:13:15.755827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:13:15.756239 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:13:15.763835 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.764583 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:13:15.801399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.802032 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.802374 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:13:15.802682 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:15.805876 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:13:15.806347 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.806770 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:13:15.808827 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:13:15.868328 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.868999 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m14:13:15.870124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:13:15.874674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.875174 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m14:13:15.876148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:13:15.893686 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:13:15.894151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.894480 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:13:15.895607 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:13:15.902021 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m14:13:15.907360 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:13:15.907750 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m14:13:15.909303 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:13:15.911659 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:13:15.913073 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30493df7-177b-428b-83ee-f7a22fdc1e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46850b610>]}
[0m14:13:15.913730 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:13:15.914435 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:13:15.915875 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:15.916239 [debug] [MainThread]: On master: BEGIN
[0m14:13:15.916534 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:15.919910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:15.920414 [debug] [MainThread]: On master: COMMIT
[0m14:13:15.920758 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:15.921051 [debug] [MainThread]: On master: COMMIT
[0m14:13:15.921541 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:15.921951 [debug] [MainThread]: On master: Close
[0m14:13:15.922543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:15.922949 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:13:15.923367 [info ] [MainThread]: 
[0m14:13:15.923799 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:13:15.924844 [debug] [MainThread]: Command end result
[0m14:13:15.961262 [info ] [MainThread]: 
[0m14:13:15.961736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:13:15.962037 [info ] [MainThread]: 
[0m14:13:15.962382 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:13:15.963158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0960807, "process_user_time": 2.244863, "process_kernel_time": 0.13581, "process_mem_max_rss": "115672", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m14:13:15.963631 [debug] [MainThread]: Command `dbt run` succeeded at 14:13:15.963527 after 1.10 seconds
[0m14:13:15.963973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46de5c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46dfe0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aa46dfe0b10>]}
[0m14:13:15.964289 [debug] [MainThread]: Flushing usage events
[0m14:13:32.436011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d346ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d2785b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d29477d0>]}


============================== 14:13:32.438603 | 1a32456b-2b6d-48c9-a6fa-1d4fba868cf0 ==============================
[0m14:13:32.438603 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:13:32.439212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m fact_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:13:32.584371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a32456b-2b6d-48c9-a6fa-1d4fba868cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d268e050>]}
[0m14:13:32.633007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a32456b-2b6d-48c9-a6fa-1d4fba868cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d6488bd0>]}
[0m14:13:32.633746 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:13:32.643576 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:13:32.754527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:13:32.754994 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:13:32.798105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a32456b-2b6d-48c9-a6fa-1d4fba868cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d2786f50>]}
[0m14:13:32.882964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a32456b-2b6d-48c9-a6fa-1d4fba868cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d0e32f10>]}
[0m14:13:32.883466 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:13:32.883773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a32456b-2b6d-48c9-a6fa-1d4fba868cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d2858790>]}
[0m14:13:32.885380 [info ] [MainThread]: 
[0m14:13:32.885947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:32.886787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:13:32.927133 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:13:32.927499 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:13:32.927770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:32.932290 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:13:32.933561 [debug] [ThreadPool]: On list_my_db: Close
[0m14:13:32.938607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:13:32.944539 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:13:32.944906 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:13:32.945268 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:32.948409 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:13:32.948796 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:13:32.949087 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:13:32.951574 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:13:32.953022 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:13:32.953386 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:13:32.961429 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:32.961788 [debug] [MainThread]: On master: BEGIN
[0m14:13:32.962038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:32.965297 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:32.965662 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:32.966015 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:32.981229 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:13:32.984177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a32456b-2b6d-48c9-a6fa-1d4fba868cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d270ed90>]}
[0m14:13:32.984565 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:32.985059 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:32.985326 [debug] [MainThread]: On master: BEGIN
[0m14:13:32.985949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:32.986238 [debug] [MainThread]: On master: COMMIT
[0m14:13:32.986506 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:32.986756 [debug] [MainThread]: On master: COMMIT
[0m14:13:32.987170 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:32.987481 [debug] [MainThread]: On master: Close
[0m14:13:32.987915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:32.988211 [info ] [MainThread]: 
[0m14:13:32.990469 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:13:32.991067 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:13:32.992421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:13:32.992862 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:13:33.001094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:13:33.001784 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:13:33.037113 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:13:33.038320 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:13:33.039629 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:13:33.040066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:33.043242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:13:33.043685 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:13:33.044041 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:13:33.045055 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:13:33.045568 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:13:33.046115 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:13:33.050293 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:13:33.051692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a32456b-2b6d-48c9-a6fa-1d4fba868cf0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189cbfb01d0>]}
[0m14:13:33.052273 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:13:33.052909 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:13:33.054668 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:33.055040 [debug] [MainThread]: On master: BEGIN
[0m14:13:33.055312 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:33.058217 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:33.058707 [debug] [MainThread]: On master: COMMIT
[0m14:13:33.058979 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:33.059236 [debug] [MainThread]: On master: COMMIT
[0m14:13:33.059688 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:33.059980 [debug] [MainThread]: On master: Close
[0m14:13:33.060429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:33.060751 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:13:33.061084 [info ] [MainThread]: 
[0m14:13:33.061467 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:13:33.062325 [debug] [MainThread]: Command end result
[0m14:13:33.095748 [info ] [MainThread]: 
[0m14:13:33.096240 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:13:33.096593 [info ] [MainThread]: 
[0m14:13:33.097007 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:13:33.097324 [info ] [MainThread]: 
[0m14:13:33.097669 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:13:33.098418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7036901, "process_user_time": 1.710917, "process_kernel_time": 0.14665, "process_mem_max_rss": "111924", "process_out_blocks": "1936", "command_success": false, "process_in_blocks": "0"}
[0m14:13:33.098883 [debug] [MainThread]: Command `dbt run` failed at 14:13:33.098780 after 0.70 seconds
[0m14:13:33.099222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d270b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d6710d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7189d6710cd0>]}
[0m14:13:33.099565 [debug] [MainThread]: Flushing usage events
[0m14:13:54.669751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72629770c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726295d166d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726295d17d50>]}


============================== 14:13:54.672372 | 3d8ed1dd-0c30-4f98-888b-30f801cc0b4f ==============================
[0m14:13:54.672372 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:13:54.672890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m fact_appointment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:13:54.803734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d8ed1dd-0c30-4f98-888b-30f801cc0b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726295d35c10>]}
[0m14:13:54.850236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d8ed1dd-0c30-4f98-888b-30f801cc0b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726299a30f50>]}
[0m14:13:54.850992 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:13:54.860287 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:13:54.973944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:13:54.974303 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:13:55.020275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d8ed1dd-0c30-4f98-888b-30f801cc0b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726294404450>]}
[0m14:13:55.108816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d8ed1dd-0c30-4f98-888b-30f801cc0b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7262941ce950>]}
[0m14:13:55.109323 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:13:55.109656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d8ed1dd-0c30-4f98-888b-30f801cc0b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726295d36390>]}
[0m14:13:55.111347 [info ] [MainThread]: 
[0m14:13:55.112277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:13:55.113294 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:13:55.153249 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:13:55.153637 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:13:55.153953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:13:55.158836 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:13:55.160129 [debug] [ThreadPool]: On list_my_db: Close
[0m14:13:55.165249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:13:55.171086 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:13:55.171457 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:13:55.171718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:13:55.174918 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:13:55.175273 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:13:55.175600 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:13:55.178062 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:13:55.179515 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:13:55.179948 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:13:55.188023 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:55.188380 [debug] [MainThread]: On master: BEGIN
[0m14:13:55.188638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:13:55.191622 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:55.191979 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:55.192352 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:13:55.207726 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:13:55.210714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d8ed1dd-0c30-4f98-888b-30f801cc0b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7262942fb990>]}
[0m14:13:55.211139 [debug] [MainThread]: On master: ROLLBACK
[0m14:13:55.211560 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:55.211827 [debug] [MainThread]: On master: BEGIN
[0m14:13:55.212323 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:55.212646 [debug] [MainThread]: On master: COMMIT
[0m14:13:55.212901 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:55.213154 [debug] [MainThread]: On master: COMMIT
[0m14:13:55.213487 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:55.213750 [debug] [MainThread]: On master: Close
[0m14:13:55.214180 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:13:55.214530 [info ] [MainThread]: 
[0m14:13:55.216403 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:13:55.216971 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:13:55.217758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:13:55.218224 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:13:55.226552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:13:55.227090 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:13:55.263304 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:13:55.263909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:13:55.264225 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:13:55.264524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:13:55.267586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:13:55.268013 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:13:55.268408 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:13:55.269544 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:13:55.270006 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:13:55.270529 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:13:55.274986 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:13:55.276397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d8ed1dd-0c30-4f98-888b-30f801cc0b4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7262935e7e10>]}
[0m14:13:55.276989 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:13:55.277603 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:13:55.279312 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:55.279685 [debug] [MainThread]: On master: BEGIN
[0m14:13:55.279966 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:13:55.282737 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:13:55.283154 [debug] [MainThread]: On master: COMMIT
[0m14:13:55.283456 [debug] [MainThread]: Using postgres connection "master"
[0m14:13:55.283720 [debug] [MainThread]: On master: COMMIT
[0m14:13:55.284175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:13:55.284558 [debug] [MainThread]: On master: Close
[0m14:13:55.285076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:13:55.285394 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:13:55.285714 [info ] [MainThread]: 
[0m14:13:55.286153 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:13:55.287347 [debug] [MainThread]: Command end result
[0m14:13:55.321367 [info ] [MainThread]: 
[0m14:13:55.321812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:13:55.322125 [info ] [MainThread]: 
[0m14:13:55.322533 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:13:55.322843 [info ] [MainThread]: 
[0m14:13:55.323169 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:13:55.323935 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6961758, "process_user_time": 1.760526, "process_kernel_time": 0.125966, "process_mem_max_rss": "111772", "process_out_blocks": "1936", "command_success": false, "process_in_blocks": "0"}
[0m14:13:55.324412 [debug] [MainThread]: Command `dbt run` failed at 14:13:55.324296 after 0.70 seconds
[0m14:13:55.324777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726295d17f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726295eafa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726295cedbd0>]}
[0m14:13:55.325104 [debug] [MainThread]: Flushing usage events
[0m14:14:08.431563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76451a4c45d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76451896b750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7645187f3a50>]}


============================== 14:14:08.434106 | cf838d15-2073-425b-9568-2f33af0e178c ==============================
[0m14:14:08.434106 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:14:08.434581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:14:08.564757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764518730290>]}
[0m14:14:08.611129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76451c4ad490>]}
[0m14:14:08.611853 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:08.620404 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:14:08.729340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:14:08.729930 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:14:08.916566 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:14:08.917025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764516eac1d0>]}
[0m14:14:09.074028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764516c1c9d0>]}
[0m14:14:09.157025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764516f4ee50>]}
[0m14:14:09.157497 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:14:09.157779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764516f10310>]}
[0m14:14:09.159231 [info ] [MainThread]: 
[0m14:14:09.159710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:09.160478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:14:09.198893 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:14:09.199282 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:14:09.199565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:09.204765 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:14:09.206038 [debug] [ThreadPool]: On list_my_db: Close
[0m14:14:09.210932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:14:09.216687 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:14:09.217053 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:14:09.217302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:09.220402 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:14:09.220760 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:14:09.221060 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:14:09.223470 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:14:09.224910 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:14:09.225306 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:14:09.232543 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.232908 [debug] [MainThread]: On master: BEGIN
[0m14:14:09.233186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:09.236250 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:09.236676 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.237056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:09.252969 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:14:09.255922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764516312450>]}
[0m14:14:09.256359 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:09.256852 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.257125 [debug] [MainThread]: On master: BEGIN
[0m14:14:09.257684 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:09.257978 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.258270 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.258551 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.258957 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:14:09.259243 [debug] [MainThread]: On master: Close
[0m14:14:09.259678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:09.259989 [info ] [MainThread]: 
[0m14:14:09.261839 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:14:09.262348 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:14:09.263146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:14:09.263686 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:14:09.271253 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.271901 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:14:09.310579 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.311231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.311594 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:14:09.311906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:09.315188 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:14:09.315638 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.316045 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        Appointment_id,
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:14:09.317953 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:14:09.375622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.376258 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m14:14:09.377346 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:14:09.381573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.382071 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m14:14:09.382960 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:14:09.401174 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:14:09.401726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.402083 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:14:09.453701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:14:09.469503 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m14:14:09.481132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:14:09.481911 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m14:14:09.484259 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:14:09.487762 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:14:09.490007 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf838d15-2073-425b-9568-2f33af0e178c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x764516310a50>]}
[0m14:14:09.490913 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.23s]
[0m14:14:09.491797 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:14:09.493369 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.493774 [debug] [MainThread]: On master: BEGIN
[0m14:14:09.494104 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:09.497596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:09.498096 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.498439 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:09.498728 [debug] [MainThread]: On master: COMMIT
[0m14:14:09.499216 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:14:09.499746 [debug] [MainThread]: On master: Close
[0m14:14:09.500283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:09.500844 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:14:09.501372 [info ] [MainThread]: 
[0m14:14:09.501845 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:14:09.502695 [debug] [MainThread]: Command end result
[0m14:14:09.539561 [info ] [MainThread]: 
[0m14:14:09.540118 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:14:09.540487 [info ] [MainThread]: 
[0m14:14:09.540823 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:14:09.541581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1519605, "process_user_time": 2.127844, "process_kernel_time": 0.119991, "process_mem_max_rss": "115952", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m14:14:09.542050 [debug] [MainThread]: Command `dbt run` succeeded at 14:14:09.541945 after 1.15 seconds
[0m14:14:09.542377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76451c5b0650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76451c734d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76451c734e10>]}
[0m14:14:09.542705 [debug] [MainThread]: Flushing usage events
[0m14:14:13.812792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe691364d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe692c7a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe6914d690>]}


============================== 14:14:13.815441 | e784b27f-7825-4393-a454-2d761c1ff116 ==============================
[0m14:14:13.815441 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:14:13.815969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m fact_appointment', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:14:13.949310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e784b27f-7825-4393-a454-2d761c1ff116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe677cdf90>]}
[0m14:14:13.996055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e784b27f-7825-4393-a454-2d761c1ff116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe67858e10>]}
[0m14:14:13.996756 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:14.005082 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:14:14.115224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:14.115625 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:14.157464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e784b27f-7825-4393-a454-2d761c1ff116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe678599d0>]}
[0m14:14:14.241573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e784b27f-7825-4393-a454-2d761c1ff116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe69105010>]}
[0m14:14:14.242110 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:14:14.242438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e784b27f-7825-4393-a454-2d761c1ff116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe675cc210>]}
[0m14:14:14.244086 [info ] [MainThread]: 
[0m14:14:14.244618 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:14.245420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:14:14.285720 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:14:14.286104 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:14:14.286411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:14.290882 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:14:14.292161 [debug] [ThreadPool]: On list_my_db: Close
[0m14:14:14.297159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:14:14.303497 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:14:14.303915 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:14:14.304191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:14.307663 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:14:14.308044 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:14:14.308371 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:14:14.310900 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:14:14.312395 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:14:14.312851 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:14:14.320867 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:14.321217 [debug] [MainThread]: On master: BEGIN
[0m14:14:14.321498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:14.324846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:14.325240 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:14.325621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:14.340966 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:14:14.344044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e784b27f-7825-4393-a454-2d761c1ff116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe69158090>]}
[0m14:14:14.344498 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:14.344988 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:14.345273 [debug] [MainThread]: On master: BEGIN
[0m14:14:14.345866 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:14.346239 [debug] [MainThread]: On master: COMMIT
[0m14:14:14.346524 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:14.346783 [debug] [MainThread]: On master: COMMIT
[0m14:14:14.347236 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:14:14.347536 [debug] [MainThread]: On master: Close
[0m14:14:14.348047 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:14:14.348391 [info ] [MainThread]: 
[0m14:14:14.350416 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:14:14.350937 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:14:14.351759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:14:14.352180 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:14:14.360733 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:14:14.361326 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:14:14.397378 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:14:14.397978 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:14:14.398297 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:14:14.398593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:14.402038 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:14:14.402618 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:14:14.403007 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:14:14.404206 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:14:14.404751 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:14:14.405330 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:14:14.409420 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:14:14.410784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e784b27f-7825-4393-a454-2d761c1ff116', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe66880790>]}
[0m14:14:14.411388 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:14:14.411987 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:14:14.413684 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:14.414008 [debug] [MainThread]: On master: BEGIN
[0m14:14:14.414259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:14.417121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:14:14.417543 [debug] [MainThread]: On master: COMMIT
[0m14:14:14.417954 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:14.418359 [debug] [MainThread]: On master: COMMIT
[0m14:14:14.418890 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:14:14.419275 [debug] [MainThread]: On master: Close
[0m14:14:14.419819 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:14.420142 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:14:14.420581 [info ] [MainThread]: 
[0m14:14:14.421038 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:14:14.422329 [debug] [MainThread]: Command end result
[0m14:14:14.458136 [info ] [MainThread]: 
[0m14:14:14.458654 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:14:14.458954 [info ] [MainThread]: 
[0m14:14:14.459326 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:14:14.459620 [info ] [MainThread]: 
[0m14:14:14.459912 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:14:14.460647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6893841, "process_user_time": 1.812201, "process_kernel_time": 0.133088, "process_mem_max_rss": "111880", "process_out_blocks": "1928", "command_success": false, "process_in_blocks": "0"}
[0m14:14:14.461113 [debug] [MainThread]: Command `dbt run` failed at 14:14:14.461011 after 0.69 seconds
[0m14:14:14.461457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe6d090d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe6d090b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dfe6d0903d0>]}
[0m14:14:14.461773 [debug] [MainThread]: Flushing usage events
[0m14:16:10.998634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f78ee750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f7c28d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f791fbd0>]}


============================== 14:16:11.001204 | a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1 ==============================
[0m14:16:11.001204 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:16:11.001769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m fact_appointment', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:11.129562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f7935c10>]}
[0m14:16:11.175931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06fb5f12d0>]}
[0m14:16:11.176658 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:11.186204 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:16:11.294952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:11.295321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:11.336921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f5fe9510>]}
[0m14:16:11.423731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f7864dd0>]}
[0m14:16:11.424205 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:16:11.424546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f5fa4090>]}
[0m14:16:11.426072 [info ] [MainThread]: 
[0m14:16:11.426634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:11.427509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:16:11.468119 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:16:11.468507 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:16:11.468767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:11.473821 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:16:11.475181 [debug] [ThreadPool]: On list_my_db: Close
[0m14:16:11.480483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:16:11.487243 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:16:11.487622 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:16:11.487870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:11.491064 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:16:11.491427 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:16:11.491717 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:16:11.494201 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:16:11.495689 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:16:11.496132 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:16:11.503921 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.504292 [debug] [MainThread]: On master: BEGIN
[0m14:16:11.504559 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:11.507729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:11.508083 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.508450 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:11.523976 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:16:11.527104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f78f6190>]}
[0m14:16:11.527519 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:11.527958 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.528234 [debug] [MainThread]: On master: BEGIN
[0m14:16:11.528853 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:11.529184 [debug] [MainThread]: On master: COMMIT
[0m14:16:11.529461 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.529724 [debug] [MainThread]: On master: COMMIT
[0m14:16:11.530165 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:16:11.530473 [debug] [MainThread]: On master: Close
[0m14:16:11.530966 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:11.531380 [info ] [MainThread]: 
[0m14:16:11.533671 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:16:11.534274 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:16:11.535114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:16:11.535535 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:16:11.543932 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:16:11.544504 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:16:11.579736 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:16:11.580450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:16:11.580789 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:16:11.581078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:11.585062 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:16:11.585508 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:16:11.585869 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:16:11.586931 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:16:11.587360 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:16:11.587958 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:16:11.591634 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:16:11.593042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a06d8a1f-9e92-4fd4-bee5-0f4bc6f039c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f5cf9dd0>]}
[0m14:16:11.593642 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:16:11.594230 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:16:11.595820 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.596126 [debug] [MainThread]: On master: BEGIN
[0m14:16:11.596425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:11.599293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:11.599787 [debug] [MainThread]: On master: COMMIT
[0m14:16:11.600091 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:11.600374 [debug] [MainThread]: On master: COMMIT
[0m14:16:11.600750 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:16:11.601035 [debug] [MainThread]: On master: Close
[0m14:16:11.601454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:11.601725 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:16:11.602031 [info ] [MainThread]: 
[0m14:16:11.602379 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:16:11.603140 [debug] [MainThread]: Command end result
[0m14:16:11.637305 [info ] [MainThread]: 
[0m14:16:11.638019 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:16:11.638400 [info ] [MainThread]: 
[0m14:16:11.638842 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:16:11.639162 [info ] [MainThread]: 
[0m14:16:11.639521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:16:11.640366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.68384725, "process_user_time": 1.689219, "process_kernel_time": 0.131861, "process_mem_max_rss": "111516", "process_out_blocks": "1944", "command_success": false, "process_in_blocks": "0"}
[0m14:16:11.640840 [debug] [MainThread]: Command `dbt run` failed at 14:16:11.640734 after 0.68 seconds
[0m14:16:11.641194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f8d4da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f78ed490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d06f6057bd0>]}
[0m14:16:11.641521 [debug] [MainThread]: Flushing usage events
[0m14:16:28.742027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d420b93d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d42178fc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d421f81dd0>]}


============================== 14:16:28.744695 | b78120de-c06b-4a7e-a64b-7b31df4eef89 ==============================
[0m14:16:28.744695 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:16:28.745222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fact_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:16:28.886422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b78120de-c06b-4a7e-a64b-7b31df4eef89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d420b90e90>]}
[0m14:16:28.933767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b78120de-c06b-4a7e-a64b-7b31df4eef89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d424854b10>]}
[0m14:16:28.934518 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:16:28.942869 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:16:29.051467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:16:29.052037 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:16:29.256915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b78120de-c06b-4a7e-a64b-7b31df4eef89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d420a9f750>]}
[0m14:16:29.339720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b78120de-c06b-4a7e-a64b-7b31df4eef89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d41eb16350>]}
[0m14:16:29.340200 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:16:29.340515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78120de-c06b-4a7e-a64b-7b31df4eef89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d41f2aa290>]}
[0m14:16:29.342053 [info ] [MainThread]: 
[0m14:16:29.342787 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:29.343827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:16:29.385022 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:16:29.385426 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:16:29.385698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:29.390501 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:16:29.392021 [debug] [ThreadPool]: On list_my_db: Close
[0m14:16:29.396867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:16:29.402588 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:16:29.402925 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:16:29.403201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:16:29.406406 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:16:29.406788 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:16:29.407092 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:16:29.409581 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:16:29.411112 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:16:29.411511 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:16:29.419592 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:29.419959 [debug] [MainThread]: On master: BEGIN
[0m14:16:29.420206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:29.423397 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:29.423745 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:29.424100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:16:29.439742 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:16:29.443046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b78120de-c06b-4a7e-a64b-7b31df4eef89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d41efb3d90>]}
[0m14:16:29.443497 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:29.444019 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:29.444352 [debug] [MainThread]: On master: BEGIN
[0m14:16:29.445167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:29.445787 [debug] [MainThread]: On master: COMMIT
[0m14:16:29.446159 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:29.446601 [debug] [MainThread]: On master: COMMIT
[0m14:16:29.446996 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:16:29.447280 [debug] [MainThread]: On master: Close
[0m14:16:29.447738 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:16:29.448048 [info ] [MainThread]: 
[0m14:16:29.450005 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:16:29.450555 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:16:29.451575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:16:29.452044 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:16:29.462001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:16:29.462687 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:16:29.497704 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:16:29.498317 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:16:29.498654 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:16:29.498943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:29.502192 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:16:29.502629 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:16:29.502988 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:16:29.504049 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointment_id" does not exist
LINE 28:             Appointment_id
                     ^

[0m14:16:29.504644 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:16:29.505261 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:16:29.509285 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:16:29.510715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b78120de-c06b-4a7e-a64b-7b31df4eef89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d41f252210>]}
[0m14:16:29.511318 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:16:29.511975 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:16:29.513620 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:29.513921 [debug] [MainThread]: On master: BEGIN
[0m14:16:29.514170 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:29.517121 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:16:29.517590 [debug] [MainThread]: On master: COMMIT
[0m14:16:29.517901 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:29.518176 [debug] [MainThread]: On master: COMMIT
[0m14:16:29.518550 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:16:29.518833 [debug] [MainThread]: On master: Close
[0m14:16:29.519239 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:29.519527 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:16:29.519866 [info ] [MainThread]: 
[0m14:16:29.520184 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:16:29.520892 [debug] [MainThread]: Command end result
[0m14:16:29.553869 [info ] [MainThread]: 
[0m14:16:29.554421 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:16:29.554766 [info ] [MainThread]: 
[0m14:16:29.555173 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "appointment_id" does not exist
  LINE 28:             Appointment_id
                       ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:16:29.555526 [info ] [MainThread]: 
[0m14:16:29.555895 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:16:29.556756 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8641163, "process_user_time": 1.981718, "process_kernel_time": 0.120739, "process_mem_max_rss": "114208", "process_out_blocks": "2840", "command_success": false, "process_in_blocks": "0"}
[0m14:16:29.557253 [debug] [MainThread]: Command `dbt run` failed at 14:16:29.557147 after 0.86 seconds
[0m14:16:29.557650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d420b9f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d420b9d290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70d41db66e10>]}
[0m14:16:29.557996 [debug] [MainThread]: Flushing usage events
[0m14:19:41.098741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea32564a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea325677b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea325a23550>]}


============================== 14:19:41.101462 | 5f750424-1b48-4fef-940f-de5d6565b539 ==============================
[0m14:19:41.101462 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:19:41.101962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:19:41.231782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea323d60d10>]}
[0m14:19:41.278254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea3293acf10>]}
[0m14:19:41.278985 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:19:41.287817 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:19:41.397576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:19:41.398148 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:19:41.398562 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:19:41.587409 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:19:41.587901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea325818090>]}
[0m14:19:41.740510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea323ab7b50>]}
[0m14:19:41.831304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea323b1d050>]}
[0m14:19:41.831799 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:19:41.832122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea323b0a6d0>]}
[0m14:19:41.833817 [info ] [MainThread]: 
[0m14:19:41.834464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:19:41.835413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:19:41.873552 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:19:41.873903 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:19:41.874160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:41.878721 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:19:41.879995 [debug] [ThreadPool]: On list_my_db: Close
[0m14:19:41.884852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:19:41.890491 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:19:41.890817 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:19:41.891078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:41.894408 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:19:41.894885 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:19:41.895195 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:19:41.898164 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:19:41.899850 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:19:41.900531 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:19:41.908741 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:41.909108 [debug] [MainThread]: On master: BEGIN
[0m14:19:41.909374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:41.912222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:41.912600 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:41.912957 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:19:41.928578 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:19:41.931556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea32235a050>]}
[0m14:19:41.932004 [debug] [MainThread]: On master: ROLLBACK
[0m14:19:41.932452 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:41.932747 [debug] [MainThread]: On master: BEGIN
[0m14:19:41.933325 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:41.933723 [debug] [MainThread]: On master: COMMIT
[0m14:19:41.933993 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:41.934240 [debug] [MainThread]: On master: COMMIT
[0m14:19:41.934668 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:41.934949 [debug] [MainThread]: On master: Close
[0m14:19:41.935418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:41.935756 [info ] [MainThread]: 
[0m14:19:41.938064 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:19:41.938582 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:19:41.939268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:19:41.939669 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:19:41.947022 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:19:41.947687 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:19:41.984213 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:19:41.984823 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:41.985150 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:19:41.985450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:41.988511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:19:41.988920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:41.989258 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name
      --  "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:19:41.989933 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "("
LINE 20:         row_number() over (partition by Procedure_id order b...
                           ^

[0m14:19:41.990420 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: ROLLBACK
[0m14:19:41.990936 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:19:41.994714 [debug] [Thread-1 (]: Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "("
  LINE 20:         row_number() over (partition by Procedure_id order b...
                             ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:19:41.996839 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f750424-1b48-4fef-940f-de5d6565b539', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea32236fbd0>]}
[0m14:19:41.997557 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_medical_procedure .............. [[31mERROR[0m in 0.06s]
[0m14:19:41.998263 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:19:41.999909 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:42.000209 [debug] [MainThread]: On master: BEGIN
[0m14:19:42.000468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:42.003550 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:42.004024 [debug] [MainThread]: On master: COMMIT
[0m14:19:42.004344 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:42.004610 [debug] [MainThread]: On master: COMMIT
[0m14:19:42.005009 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:42.005379 [debug] [MainThread]: On master: Close
[0m14:19:42.005865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:42.006187 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:19:42.006521 [info ] [MainThread]: 
[0m14:19:42.007021 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:19:42.008570 [debug] [MainThread]: Command end result
[0m14:19:42.108142 [info ] [MainThread]: 
[0m14:19:42.108615 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:19:42.108959 [info ] [MainThread]: 
[0m14:19:42.109372 [error] [MainThread]:   Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "("
  LINE 20:         row_number() over (partition by Procedure_id order b...
                             ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m14:19:42.109745 [info ] [MainThread]: 
[0m14:19:42.110082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:19:42.110903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0530779, "process_user_time": 2.074434, "process_kernel_time": 0.132899, "process_mem_max_rss": "116276", "process_out_blocks": "2840", "command_success": false, "process_in_blocks": "0"}
[0m14:19:42.111405 [debug] [MainThread]: Command `dbt run` failed at 14:19:42.111289 after 1.05 seconds
[0m14:19:42.111782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea323b08f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea323b08790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ea323b0a290>]}
[0m14:19:42.112123 [debug] [MainThread]: Flushing usage events
[0m14:19:51.134230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcb645090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcb938b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcb646190>]}


============================== 14:19:51.137023 | 898cc688-2531-48b3-81f1-ccd29edc3529 ==============================
[0m14:19:51.137023 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:19:51.137578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:19:51.292213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcb5fcf50>]}
[0m14:19:51.342348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcf319490>]}
[0m14:19:51.343128 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:19:51.352951 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:19:51.490135 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:19:51.490839 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:19:51.736541 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:19:51.737143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bc9ccc150>]}
[0m14:19:51.934018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bc9dcc2d0>]}
[0m14:19:52.033841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bc99e5a50>]}
[0m14:19:52.034428 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:19:52.034866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bc9aa1b10>]}
[0m14:19:52.036913 [info ] [MainThread]: 
[0m14:19:52.037576 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:19:52.038539 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:19:52.077869 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:19:52.078247 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:19:52.078530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:19:52.084005 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:19:52.085493 [debug] [ThreadPool]: On list_my_db: Close
[0m14:19:52.090944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:19:52.096788 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:19:52.097128 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:19:52.097380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:19:52.101129 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:19:52.101558 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:19:52.101947 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:19:52.104955 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:19:52.106862 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:19:52.107526 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:19:52.114919 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:52.115428 [debug] [MainThread]: On master: BEGIN
[0m14:19:52.115862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:19:52.120032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:52.120513 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:52.120969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:19:52.138157 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:19:52.141275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bc85420d0>]}
[0m14:19:52.141723 [debug] [MainThread]: On master: ROLLBACK
[0m14:19:52.142188 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:52.142501 [debug] [MainThread]: On master: BEGIN
[0m14:19:52.143074 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:52.143390 [debug] [MainThread]: On master: COMMIT
[0m14:19:52.143679 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:52.143930 [debug] [MainThread]: On master: COMMIT
[0m14:19:52.144313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:52.144595 [debug] [MainThread]: On master: Close
[0m14:19:52.145032 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:19:52.145341 [info ] [MainThread]: 
[0m14:19:52.147201 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:19:52.147730 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:19:52.148457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:19:52.148838 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:19:52.157156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.157757 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:19:52.195266 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.195899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.196229 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:19:52.196537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:19:52.200444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:19:52.200993 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.201549 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name
      --  "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:19:52.203993 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:19:52.271207 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.271922 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m14:19:52.273151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:52.277844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.278363 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m14:19:52.279368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:19:52.298171 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:19:52.298600 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.298921 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:19:52.350203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:19:52.360437 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m14:19:52.368425 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:19:52.369022 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m14:19:52.371219 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:19:52.374875 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:19:52.377164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '898cc688-2531-48b3-81f1-ccd29edc3529', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bc98e8d90>]}
[0m14:19:52.378168 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.23s]
[0m14:19:52.379026 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:19:52.380620 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:52.381055 [debug] [MainThread]: On master: BEGIN
[0m14:19:52.381451 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:19:52.385488 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:19:52.386203 [debug] [MainThread]: On master: COMMIT
[0m14:19:52.386722 [debug] [MainThread]: Using postgres connection "master"
[0m14:19:52.387193 [debug] [MainThread]: On master: COMMIT
[0m14:19:52.387937 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:19:52.388450 [debug] [MainThread]: On master: Close
[0m14:19:52.389156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:19:52.389664 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:19:52.390192 [info ] [MainThread]: 
[0m14:19:52.390722 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m14:19:52.391978 [debug] [MainThread]: Command end result
[0m14:19:52.428205 [info ] [MainThread]: 
[0m14:19:52.428730 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:19:52.429058 [info ] [MainThread]: 
[0m14:19:52.429415 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:19:52.430191 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3449664, "process_user_time": 2.420437, "process_kernel_time": 0.12187, "process_mem_max_rss": "116224", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m14:19:52.430690 [debug] [MainThread]: Command `dbt run` succeeded at 14:19:52.430584 after 1.35 seconds
[0m14:19:52.431036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcf41c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcf5a0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772bcf5a03d0>]}
[0m14:19:52.431376 [debug] [MainThread]: Flushing usage events
[0m14:21:18.447660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adb0426d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adb03d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adbcd88d0>]}


============================== 14:21:18.450240 | f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1 ==============================
[0m14:21:18.450240 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:21:18.450733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m fact_appointment', 'send_anonymous_usage_stats': 'True'}
[0m14:21:18.595770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0ad96b1810>]}
[0m14:21:18.648384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adecf4910>]}
[0m14:21:18.649109 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:21:18.659227 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:21:18.770800 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:21:18.771440 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:21:18.975581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0ad93e5d50>]}
[0m14:21:19.059027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0ad92b1f10>]}
[0m14:21:19.059574 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:21:19.059870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adb0036d0>]}
[0m14:21:19.061426 [info ] [MainThread]: 
[0m14:21:19.061984 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:21:19.062882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:21:19.101246 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:21:19.101651 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:21:19.101973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:19.106508 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:21:19.107788 [debug] [ThreadPool]: On list_my_db: Close
[0m14:21:19.112511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:21:19.118379 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:21:19.118736 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:21:19.118984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:19.122226 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:21:19.122715 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:21:19.123054 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:21:19.126037 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:21:19.127938 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:21:19.128628 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:21:19.135985 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:19.136314 [debug] [MainThread]: On master: BEGIN
[0m14:21:19.136579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:19.139743 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:21:19.140115 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:19.140487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:21:19.155778 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:21:19.158822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0ad8348510>]}
[0m14:21:19.159216 [debug] [MainThread]: On master: ROLLBACK
[0m14:21:19.159690 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:19.159949 [debug] [MainThread]: On master: BEGIN
[0m14:21:19.160395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:21:19.160681 [debug] [MainThread]: On master: COMMIT
[0m14:21:19.160954 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:19.161205 [debug] [MainThread]: On master: COMMIT
[0m14:21:19.161577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:21:19.161844 [debug] [MainThread]: On master: Close
[0m14:21:19.162416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:19.162863 [info ] [MainThread]: 
[0m14:21:19.165259 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:21:19.165815 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:21:19.166568 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:21:19.166967 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:21:19.175247 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:21:19.175828 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:21:19.212251 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:21:19.212911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:21:19.213317 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:21:19.213660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:19.217761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:21:19.218291 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:21:19.218808 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id
           
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Procedure_id = pr.Procedure_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:21:19.220121 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.procedure_id does not exist
LINE 48: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                   ^
HINT:  Perhaps you meant to reference the column "pr.procedure_id".

[0m14:21:19.220571 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:21:19.221139 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:21:19.224936 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column a.procedure_id does not exist
  LINE 48: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                     ^
  HINT:  Perhaps you meant to reference the column "pr.procedure_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:21:19.226415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1cf16f0-9d4d-4786-946f-5cfe2b9f8dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0ad9346610>]}
[0m14:21:19.227057 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:21:19.227677 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:21:19.229394 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:19.229687 [debug] [MainThread]: On master: BEGIN
[0m14:21:19.229936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:21:19.233182 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:21:19.233618 [debug] [MainThread]: On master: COMMIT
[0m14:21:19.233882 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:19.234129 [debug] [MainThread]: On master: COMMIT
[0m14:21:19.234555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:21:19.234845 [debug] [MainThread]: On master: Close
[0m14:21:19.235242 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:19.235514 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:21:19.235797 [info ] [MainThread]: 
[0m14:21:19.236102 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:21:19.236836 [debug] [MainThread]: Command end result
[0m14:21:19.270089 [info ] [MainThread]: 
[0m14:21:19.270655 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:21:19.271107 [info ] [MainThread]: 
[0m14:21:19.271626 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column a.procedure_id does not exist
  LINE 48: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                     ^
  HINT:  Perhaps you meant to reference the column "pr.procedure_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:21:19.272026 [info ] [MainThread]: 
[0m14:21:19.272421 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:21:19.273270 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8678977, "process_user_time": 2.009563, "process_kernel_time": 0.143825, "process_mem_max_rss": "114372", "process_out_blocks": "2840", "command_success": false, "process_in_blocks": "0"}
[0m14:21:19.273832 [debug] [MainThread]: Command `dbt run` failed at 14:21:19.273719 after 0.87 seconds
[0m14:21:19.274223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adaff8bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adef68d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0adef68c90>]}
[0m14:21:19.274572 [debug] [MainThread]: Flushing usage events
[0m14:22:47.384900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa3533f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa3648610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa3533ad0>]}


============================== 14:22:47.387618 | 9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0 ==============================
[0m14:22:47.387618 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:22:47.388262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_medical_procedure', 'send_anonymous_usage_stats': 'True'}
[0m14:22:47.518470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa327ed90>]}
[0m14:22:47.564970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa707ced0>]}
[0m14:22:47.565710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:22:47.575396 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:22:47.682818 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:22:47.683383 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:22:47.683760 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:22:47.873673 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:22:47.874150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa326f010>]}
[0m14:22:48.028120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa1787a10>]}
[0m14:22:48.110950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa13e0550>]}
[0m14:22:48.111417 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:22:48.111705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa1372450>]}
[0m14:22:48.113229 [info ] [MainThread]: 
[0m14:22:48.113775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:22:48.114619 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:22:48.153625 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:22:48.153972 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:22:48.154233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:48.158775 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:22:48.160084 [debug] [ThreadPool]: On list_my_db: Close
[0m14:22:48.165030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:22:48.171011 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:22:48.171381 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:22:48.171634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:48.174922 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:22:48.175306 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:22:48.175725 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:22:48.178496 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:22:48.180203 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:22:48.180940 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:22:48.188531 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.188889 [debug] [MainThread]: On master: BEGIN
[0m14:22:48.189134 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:48.192303 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:22:48.192685 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.193031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:22:48.208282 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:22:48.211158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa1329a90>]}
[0m14:22:48.211550 [debug] [MainThread]: On master: ROLLBACK
[0m14:22:48.211989 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.212259 [debug] [MainThread]: On master: BEGIN
[0m14:22:48.212843 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:22:48.213149 [debug] [MainThread]: On master: COMMIT
[0m14:22:48.213428 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.213672 [debug] [MainThread]: On master: COMMIT
[0m14:22:48.214059 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:22:48.214346 [debug] [MainThread]: On master: Close
[0m14:22:48.214815 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:48.215122 [info ] [MainThread]: 
[0m14:22:48.217212 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:22:48.217827 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:22:48.218726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:22:48.219163 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:22:48.227476 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.228098 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:22:48.264882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.265552 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.265883 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:22:48.266214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:48.270160 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:22:48.270713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.271071 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
       "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name
from pre_final
where procedure_row_number = 1
  );
[0m14:22:48.273181 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:22:48.331901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.332498 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m14:22:48.333554 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:22:48.337919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.338476 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m14:22:48.339492 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:22:48.356772 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:22:48.357189 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.357534 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:22:48.365439 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:22:48.372081 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m14:22:48.377381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:22:48.377817 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m14:22:48.379439 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:22:48.381666 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:22:48.383128 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ab86c2b-4753-4e89-9a87-c73a7b7a9aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa0230f50>]}
[0m14:22:48.383769 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:22:48.384447 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:22:48.385719 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.386020 [debug] [MainThread]: On master: BEGIN
[0m14:22:48.386270 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:48.389411 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:22:48.389785 [debug] [MainThread]: On master: COMMIT
[0m14:22:48.390126 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:48.390424 [debug] [MainThread]: On master: COMMIT
[0m14:22:48.390844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:22:48.391124 [debug] [MainThread]: On master: Close
[0m14:22:48.391643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:48.392073 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:22:48.392608 [info ] [MainThread]: 
[0m14:22:48.393107 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:22:48.394274 [debug] [MainThread]: Command end result
[0m14:22:48.429002 [info ] [MainThread]: 
[0m14:22:48.429483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:48.429791 [info ] [MainThread]: 
[0m14:22:48.430127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:22:48.430869 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0881841, "process_user_time": 2.106637, "process_kernel_time": 0.141572, "process_mem_max_rss": "115868", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m14:22:48.431344 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:48.431232 after 1.09 seconds
[0m14:22:48.431664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa72404d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa72d0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8fa72d1250>]}
[0m14:22:48.432050 [debug] [MainThread]: Flushing usage events
[0m14:23:32.710161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76009283d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760093c3f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600927f51d0>]}


============================== 14:23:32.712751 | f6eeaea2-7427-45f3-9697-91f30ee602fb ==============================
[0m14:23:32.712751 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:23:32.713275 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:23:32.850764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600927f5050>]}
[0m14:23:32.897797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600964f0650>]}
[0m14:23:32.898523 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:23:32.907504 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:23:33.030658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:23:33.031331 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m14:23:33.228448 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:23:33.228873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760090bd8d10>]}
[0m14:23:33.394698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760090acff10>]}
[0m14:23:33.479758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760090b6e090>]}
[0m14:23:33.480184 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:23:33.480465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76009273a950>]}
[0m14:23:33.481922 [info ] [MainThread]: 
[0m14:23:33.482425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:33.483232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:23:33.521166 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:23:33.521562 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:23:33.521857 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:33.526472 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:23:33.527728 [debug] [ThreadPool]: On list_my_db: Close
[0m14:23:33.532486 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:23:33.538447 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:23:33.538820 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:23:33.539078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:33.542395 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:23:33.542756 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:23:33.543058 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:23:33.545499 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:23:33.546984 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:23:33.547434 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:23:33.554925 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:33.555267 [debug] [MainThread]: On master: BEGIN
[0m14:23:33.555529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:33.558729 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:33.559119 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:33.559498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:33.575028 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:23:33.578062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760090b6c310>]}
[0m14:23:33.578505 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:33.578977 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:33.579253 [debug] [MainThread]: On master: BEGIN
[0m14:23:33.579779 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:33.580097 [debug] [MainThread]: On master: COMMIT
[0m14:23:33.580400 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:33.580670 [debug] [MainThread]: On master: COMMIT
[0m14:23:33.581205 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:33.581525 [debug] [MainThread]: On master: Close
[0m14:23:33.582039 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:33.582377 [info ] [MainThread]: 
[0m14:23:33.584565 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:23:33.585117 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m14:23:33.585934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m14:23:33.586303 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:23:33.593607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.594194 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:23:33.631169 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.631793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.632098 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m14:23:33.632384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:33.637373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:23:33.637836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.638182 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
       "AppointmentID" as Appointment_id
       
        from "my_db"."public"."Medical_Procedure"
),

pre_final as ( 
    select 
        Procedure_id,
        Procedure_name,
        Appointment_id,
        row_number() over (partition by Procedure_id order by Procedure_name ) as procedure_row_number
    from medical_procedure

)

select Procedure_id, Procedure_name, Appointment_id
from pre_final
where procedure_row_number = 1
  );
[0m14:23:33.640230 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:23:33.699590 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.700178 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m14:23:33.701234 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:33.705673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.706170 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m14:23:33.707107 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:23:33.724670 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:23:33.725144 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.725477 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m14:23:33.733541 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:23:33.740271 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m14:23:33.745444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m14:23:33.745825 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m14:23:33.747547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:23:33.749809 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m14:23:33.751367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6eeaea2-7427-45f3-9697-91f30ee602fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600907cdb10>]}
[0m14:23:33.752016 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:23:33.752703 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:23:33.753956 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:33.754288 [debug] [MainThread]: On master: BEGIN
[0m14:23:33.754553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:33.758235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:33.758699 [debug] [MainThread]: On master: COMMIT
[0m14:23:33.759013 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:33.759285 [debug] [MainThread]: On master: COMMIT
[0m14:23:33.759793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:33.760175 [debug] [MainThread]: On master: Close
[0m14:23:33.760724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:33.761059 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m14:23:33.761401 [info ] [MainThread]: 
[0m14:23:33.762055 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:23:33.763275 [debug] [MainThread]: Command end result
[0m14:23:33.798067 [info ] [MainThread]: 
[0m14:23:33.798567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:33.798880 [info ] [MainThread]: 
[0m14:23:33.799199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:23:33.799954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1335981, "process_user_time": 2.294182, "process_kernel_time": 0.155944, "process_mem_max_rss": "115732", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m14:23:33.800456 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:33.800330 after 1.13 seconds
[0m14:23:33.800965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7600965e0550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760090b64650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x760096764350>]}
[0m14:23:33.801397 [debug] [MainThread]: Flushing usage events
[0m14:23:53.146534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a7f819d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a7f82bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a7f80b50>]}


============================== 14:23:53.149160 | b6f0c215-0312-4aff-9fda-7a49f09191da ==============================
[0m14:23:53.149160 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:23:53.149646 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fact_appointment', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:53.280956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6f0c215-0312-4aff-9fda-7a49f09191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a7e829d0>]}
[0m14:23:53.330209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6f0c215-0312-4aff-9fda-7a49f09191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497abc45050>]}
[0m14:23:53.331008 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:23:53.340927 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:23:53.455508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:53.455862 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:53.498222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6f0c215-0312-4aff-9fda-7a49f09191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a65f0bd0>]}
[0m14:23:53.583699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6f0c215-0312-4aff-9fda-7a49f09191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a7f41a10>]}
[0m14:23:53.584167 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:23:53.584500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f0c215-0312-4aff-9fda-7a49f09191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a7dbcd10>]}
[0m14:23:53.586068 [info ] [MainThread]: 
[0m14:23:53.586607 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:23:53.587455 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:23:53.629861 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:23:53.630240 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:23:53.630521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:53.635285 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:23:53.636578 [debug] [ThreadPool]: On list_my_db: Close
[0m14:23:53.641391 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:23:53.647235 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:23:53.647596 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:23:53.647848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:23:53.651120 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:23:53.651530 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:23:53.651839 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:23:53.654285 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:23:53.655729 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:23:53.656162 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:23:53.664192 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:53.664551 [debug] [MainThread]: On master: BEGIN
[0m14:23:53.664800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:53.668000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:53.668399 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:53.668772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:23:53.684153 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:23:53.687192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6f0c215-0312-4aff-9fda-7a49f09191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a65bca10>]}
[0m14:23:53.687579 [debug] [MainThread]: On master: ROLLBACK
[0m14:23:53.688075 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:53.688360 [debug] [MainThread]: On master: BEGIN
[0m14:23:53.688961 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:53.689278 [debug] [MainThread]: On master: COMMIT
[0m14:23:53.689580 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:53.689843 [debug] [MainThread]: On master: COMMIT
[0m14:23:53.690266 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:53.690566 [debug] [MainThread]: On master: Close
[0m14:23:53.691015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:23:53.691368 [info ] [MainThread]: 
[0m14:23:53.693708 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:23:53.694302 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:23:53.695100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:23:53.695500 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:23:53.703912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:23:53.704506 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:23:53.740349 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:23:53.741001 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:23:53.741317 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:23:53.741643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:53.746371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:23:53.746819 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:23:53.747212 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id
           
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:23:53.748581 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column pr.appointment_id does not exist
LINE 48: join procedure_data pr on a.Appointment_id = pr.Appointment_...
                                                      ^
HINT:  Perhaps you meant to reference the column "a.appointment_id".

[0m14:23:53.749040 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:23:53.749571 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:23:53.753275 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column pr.appointment_id does not exist
  LINE 48: join procedure_data pr on a.Appointment_id = pr.Appointment_...
                                                        ^
  HINT:  Perhaps you meant to reference the column "a.appointment_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:23:53.754726 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6f0c215-0312-4aff-9fda-7a49f09191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a7e90f10>]}
[0m14:23:53.755402 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:23:53.756015 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:23:53.757597 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:53.757917 [debug] [MainThread]: On master: BEGIN
[0m14:23:53.758198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:23:53.761517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:23:53.761981 [debug] [MainThread]: On master: COMMIT
[0m14:23:53.762286 [debug] [MainThread]: Using postgres connection "master"
[0m14:23:53.762584 [debug] [MainThread]: On master: COMMIT
[0m14:23:53.763037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:23:53.763487 [debug] [MainThread]: On master: Close
[0m14:23:53.764071 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:53.764430 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:23:53.764760 [info ] [MainThread]: 
[0m14:23:53.765388 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:23:53.766856 [debug] [MainThread]: Command end result
[0m14:23:53.801467 [info ] [MainThread]: 
[0m14:23:53.801940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:23:53.802255 [info ] [MainThread]: 
[0m14:23:53.802664 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column pr.appointment_id does not exist
  LINE 48: join procedure_data pr on a.Appointment_id = pr.Appointment_...
                                                        ^
  HINT:  Perhaps you meant to reference the column "a.appointment_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:23:53.802976 [info ] [MainThread]: 
[0m14:23:53.803296 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:23:53.804078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.69876224, "process_user_time": 1.769488, "process_kernel_time": 0.125963, "process_mem_max_rss": "111548", "process_out_blocks": "1944", "command_success": false, "process_in_blocks": "0"}
[0m14:23:53.804580 [debug] [MainThread]: Command `dbt run` failed at 14:23:53.804469 after 0.70 seconds
[0m14:23:53.804941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497abe98cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497abe98c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7497a9af3190>]}
[0m14:23:53.805282 [debug] [MainThread]: Flushing usage events
[0m14:24:31.562304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f54054dad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f54056f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f54056ff90>]}


============================== 14:24:31.564948 | dff53b63-9b5b-494e-86ef-42a573082123 ==============================
[0m14:24:31.564948 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:24:31.565492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m fact_appointment', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:24:31.707798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dff53b63-9b5b-494e-86ef-42a573082123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f53ec52710>]}
[0m14:24:31.754521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dff53b63-9b5b-494e-86ef-42a573082123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f544240b50>]}
[0m14:24:31.755242 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:24:31.764288 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:24:31.877240 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:24:31.878005 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:24:32.083964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dff53b63-9b5b-494e-86ef-42a573082123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f53ec8f910>]}
[0m14:24:32.168274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dff53b63-9b5b-494e-86ef-42a573082123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f53e904d50>]}
[0m14:24:32.168805 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:24:32.169094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dff53b63-9b5b-494e-86ef-42a573082123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f54056ddd0>]}
[0m14:24:32.170686 [info ] [MainThread]: 
[0m14:24:32.171252 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:32.172112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:24:32.209286 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:24:32.209653 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:24:32.209915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:32.216164 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:24:32.217504 [debug] [ThreadPool]: On list_my_db: Close
[0m14:24:32.222386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:24:32.228189 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:24:32.228538 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:24:32.228803 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:32.232089 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:24:32.232516 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:24:32.232819 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:32.235289 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:24:32.236763 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:24:32.237178 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:24:32.245324 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.245710 [debug] [MainThread]: On master: BEGIN
[0m14:24:32.245972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:32.248952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:32.249395 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.249828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:32.265701 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:24:32.268792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dff53b63-9b5b-494e-86ef-42a573082123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f53ec73190>]}
[0m14:24:32.269182 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:32.269656 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.269941 [debug] [MainThread]: On master: BEGIN
[0m14:24:32.270416 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:32.270786 [debug] [MainThread]: On master: COMMIT
[0m14:24:32.271070 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.271317 [debug] [MainThread]: On master: COMMIT
[0m14:24:32.271735 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:32.272015 [debug] [MainThread]: On master: Close
[0m14:24:32.272525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:32.272837 [info ] [MainThread]: 
[0m14:24:32.274974 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:24:32.275491 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:24:32.276185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:24:32.276584 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:24:32.284711 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:24:32.285280 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:24:32.320536 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:24:32.321116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:24:32.321430 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:24:32.321720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:32.324931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:32.325367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:24:32.325728 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
           
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:24:32.328410 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:24:32.334466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:24:32.334857 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */
alter table "my_db"."public"."fact_appointment__dbt_tmp" rename to "fact_appointment"
[0m14:24:32.335690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:24:32.350771 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: COMMIT
[0m14:24:32.351149 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:24:32.351441 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: COMMIT
[0m14:24:32.403091 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:24:32.420041 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."fact_appointment__dbt_backup"
[0m14:24:32.432584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:24:32.433311 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */
drop view if exists "my_db"."public"."fact_appointment__dbt_backup" cascade
[0m14:24:32.434404 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:24:32.437998 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:24:32.440206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff53b63-9b5b-494e-86ef-42a573082123', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f53eb6a3d0>]}
[0m14:24:32.441115 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fact_appointment ....................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:24:32.441977 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:24:32.443546 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.443933 [debug] [MainThread]: On master: BEGIN
[0m14:24:32.444274 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:32.448502 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:32.449059 [debug] [MainThread]: On master: COMMIT
[0m14:24:32.449411 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:32.449750 [debug] [MainThread]: On master: COMMIT
[0m14:24:32.450284 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:32.450642 [debug] [MainThread]: On master: Close
[0m14:24:32.451123 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:32.451493 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:24:32.451935 [info ] [MainThread]: 
[0m14:24:32.452538 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:24:32.453514 [debug] [MainThread]: Command end result
[0m14:24:32.487724 [info ] [MainThread]: 
[0m14:24:32.488180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:32.488530 [info ] [MainThread]: 
[0m14:24:32.488868 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:24:32.489962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9777821, "process_user_time": 2.055762, "process_kernel_time": 0.139847, "process_mem_max_rss": "113992", "process_out_blocks": "2840", "process_in_blocks": "0"}
[0m14:24:32.490601 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:32.490489 after 0.98 seconds
[0m14:24:32.490945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f544344650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5444c8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75f5444c8e10>]}
[0m14:24:32.491286 [debug] [MainThread]: Flushing usage events
[0m14:24:53.360936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e29896a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e29896a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e2989b2ed0>]}


============================== 14:24:53.363477 | 32b0d0bb-c5c9-4002-887a-679862211da5 ==============================
[0m14:24:53.363477 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:24:53.363988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:24:53.496317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32b0d0bb-c5c9-4002-887a-679862211da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e298968d50>]}
[0m14:24:53.542827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32b0d0bb-c5c9-4002-887a-679862211da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e29c698b10>]}
[0m14:24:53.543552 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:24:53.552215 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:24:53.662700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:53.663051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:53.705450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32b0d0bb-c5c9-4002-887a-679862211da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e297030fd0>]}
[0m14:24:53.798930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32b0d0bb-c5c9-4002-887a-679862211da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e296b6bc50>]}
[0m14:24:53.799430 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:24:53.799721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32b0d0bb-c5c9-4002-887a-679862211da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e2970c4f90>]}
[0m14:24:53.801829 [info ] [MainThread]: 
[0m14:24:53.802416 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:53.807373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:24:53.854634 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:24:53.855043 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:24:53.855293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:53.860162 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:24:53.860579 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:24:53.860869 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:53.863343 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:24:53.864868 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:24:53.865327 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:24:53.873415 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:53.873765 [debug] [MainThread]: On master: BEGIN
[0m14:24:53.874014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:53.877203 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:53.877600 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:53.877954 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:53.894346 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:24:53.898326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32b0d0bb-c5c9-4002-887a-679862211da5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e29964e810>]}
[0m14:24:53.898717 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:53.899194 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:53.899480 [debug] [MainThread]: On master: BEGIN
[0m14:24:53.900082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:53.900406 [debug] [MainThread]: On master: COMMIT
[0m14:24:53.900665 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:53.900914 [debug] [MainThread]: On master: COMMIT
[0m14:24:53.901343 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:53.901648 [debug] [MainThread]: On master: Close
[0m14:24:53.902087 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:53.902463 [info ] [MainThread]: 
[0m14:24:53.905397 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:24:53.905957 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_billing_invoice_id .............................. [RUN]
[0m14:24:53.906460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:24:53.906847 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:24:53.922841 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:24:53.923669 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:24:53.939108 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:24:53.940016 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:24:53.940428 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m14:24:53.940807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:53.944347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:53.944797 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:24:53.945168 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:24:53.948368 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:53.952666 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m14:24:53.953240 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m14:24:53.953858 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.05s]
[0m14:24:53.954487 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:24:53.955032 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:24:53.955459 [info ] [Thread-1 (]: 2 of 9 START test not_null_dim_doctor_doctor_id ................................ [RUN]
[0m14:24:53.955976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:24:53.956393 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:24:53.960687 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:24:53.961232 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:24:53.963475 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:24:53.963949 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:24:53.964292 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m14:24:53.964640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:53.967584 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:53.967993 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:24:53.968325 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:24:53.969497 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:53.971070 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m14:24:53.971665 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m14:24:53.972309 [info ] [Thread-1 (]: 2 of 9 PASS not_null_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:24:53.973039 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:24:53.973774 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:24:53.974355 [info ] [Thread-1 (]: 3 of 9 START test not_null_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:24:53.974936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:24:53.975381 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:24:53.982388 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:24:53.983106 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:24:53.986180 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:24:53.986922 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:24:53.987308 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:24:53.987641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:53.990965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:53.991417 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:24:53.991776 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:24:53.993147 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:53.994596 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:24:53.995083 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:24:53.995646 [info ] [Thread-1 (]: 3 of 9 PASS not_null_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.02s]
[0m14:24:53.996218 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:24:53.996758 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:24:53.997202 [info ] [Thread-1 (]: 4 of 9 START test not_null_dim_patient_patient_id .............................. [RUN]
[0m14:24:53.997749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:24:53.998140 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:24:54.003723 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:24:54.004401 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:24:54.006898 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:24:54.007545 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:24:54.007909 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m14:24:54.008241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:54.011312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:54.011777 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:24:54.012141 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m14:24:54.013421 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:54.014914 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m14:24:54.015855 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m14:24:54.016695 [info ] [Thread-1 (]: 4 of 9 PASS not_null_dim_patient_patient_id .................................... [[32mPASS[0m in 0.02s]
[0m14:24:54.017511 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:24:54.018099 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:24:54.018763 [info ] [Thread-1 (]: 5 of 9 START test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m14:24:54.019488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549)
[0m14:24:54.019974 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:24:54.028948 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:24:54.029559 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:24:54.032162 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:24:54.032985 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:24:54.033387 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: BEGIN
[0m14:24:54.033718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:54.037495 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:54.037958 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:24:54.038378 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."dim_billing"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:24:54.042380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:54.044013 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: ROLLBACK
[0m14:24:54.044617 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: Close
[0m14:24:54.045229 [error] [Thread-1 (]: 5 of 9 FAIL 336 relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [[31mFAIL 336[0m in 0.03s]
[0m14:24:54.045901 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:24:54.046295 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:24:54.046768 [info ] [Thread-1 (]: 6 of 9 START test unique_dim_billing_invoice_id ................................ [RUN]
[0m14:24:54.047304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:24:54.047675 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:24:54.055623 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:24:54.056244 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:24:54.058708 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:24:54.059279 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:24:54.059614 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m14:24:54.059929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:54.063018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:54.063417 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:24:54.063743 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:24:54.068011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:54.070001 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m14:24:54.070672 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m14:24:54.071324 [info ] [Thread-1 (]: 6 of 9 PASS unique_dim_billing_invoice_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:24:54.072070 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:24:54.072541 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:24:54.073049 [info ] [Thread-1 (]: 7 of 9 START test unique_dim_doctor_doctor_id .................................. [RUN]
[0m14:24:54.073612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:24:54.073965 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:24:54.078104 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:24:54.078673 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:24:54.080957 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:24:54.081510 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:24:54.082083 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m14:24:54.082775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:54.086518 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:54.087043 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:24:54.087469 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:24:54.089382 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:54.090987 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m14:24:54.091461 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m14:24:54.092160 [info ] [Thread-1 (]: 7 of 9 PASS unique_dim_doctor_doctor_id ........................................ [[32mPASS[0m in 0.02s]
[0m14:24:54.092871 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:24:54.093312 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:24:54.093751 [info ] [Thread-1 (]: 8 of 9 START test unique_dim_medical_procedure_procedure_id .................... [RUN]
[0m14:24:54.094255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:24:54.094618 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:24:54.099496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:24:54.100152 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:24:54.103212 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:24:54.103954 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:24:54.104369 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:24:54.104752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:54.108031 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:54.108474 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:24:54.108812 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:24:54.111215 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:54.112673 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:24:54.113143 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:24:54.113897 [info ] [Thread-1 (]: 8 of 9 PASS unique_dim_medical_procedure_procedure_id .......................... [[32mPASS[0m in 0.02s]
[0m14:24:54.114672 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:24:54.115574 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:24:54.116482 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_patient_patient_id ................................ [RUN]
[0m14:24:54.117174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:24:54.117637 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:24:54.124566 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:24:54.125153 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:24:54.127666 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:24:54.128225 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:24:54.128627 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m14:24:54.129030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:54.132842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:24:54.133392 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:24:54.133763 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:24:54.135889 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:24:54.137598 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m14:24:54.138234 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m14:24:54.139145 [error] [Thread-1 (]: 9 of 9 FAIL 280 unique_dim_patient_patient_id .................................. [[31mFAIL 280[0m in 0.02s]
[0m14:24:54.139903 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:24:54.141217 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:54.141594 [debug] [MainThread]: On master: BEGIN
[0m14:24:54.141854 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:54.144756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:24:54.145252 [debug] [MainThread]: On master: COMMIT
[0m14:24:54.145576 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:54.145838 [debug] [MainThread]: On master: COMMIT
[0m14:24:54.146191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:24:54.146508 [debug] [MainThread]: On master: Close
[0m14:24:54.146989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:54.147374 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m14:24:54.147848 [info ] [MainThread]: 
[0m14:24:54.148637 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m14:24:54.151150 [debug] [MainThread]: Command end result
[0m14:24:54.188458 [info ] [MainThread]: 
[0m14:24:54.188985 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:24:54.189328 [info ] [MainThread]: 
[0m14:24:54.189762 [error] [MainThread]: [31mFailure in test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)[0m
[0m14:24:54.190184 [error] [MainThread]:   Got 336 results, configured to fail if != 0
[0m14:24:54.190497 [info ] [MainThread]: 
[0m14:24:54.190879 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/relationships_dim_billing_67d755ce333822e0ca7d372874c62656.sql
[0m14:24:54.191176 [info ] [MainThread]: 
[0m14:24:54.191565 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m14:24:54.191922 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m14:24:54.192203 [info ] [MainThread]: 
[0m14:24:54.192565 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m14:24:54.192844 [info ] [MainThread]: 
[0m14:24:54.193124 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m14:24:54.193902 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.8746225, "process_user_time": 1.851658, "process_kernel_time": 0.143508, "process_mem_max_rss": "113700", "process_out_blocks": "2136", "command_success": false, "process_in_blocks": "0"}
[0m14:24:54.194428 [debug] [MainThread]: Command `dbt test` failed at 14:24:54.194305 after 0.88 seconds
[0m14:24:54.194780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e298df01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e29c90cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e298970190>]}
[0m14:24:54.195130 [debug] [MainThread]: Flushing usage events
[0m14:34:40.926314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6602792290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a660102f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a66027902d0>]}


============================== 14:34:40.929018 | 3afcf284-c3cc-40d6-ab69-5c02a69553ea ==============================
[0m14:34:40.929018 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:34:40.929503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:41.059176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3afcf284-c3cc-40d6-ab69-5c02a69553ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65ff1abf50>]}
[0m14:34:41.105394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3afcf284-c3cc-40d6-ab69-5c02a69553ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6604788f90>]}
[0m14:34:41.106113 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:34:41.114669 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:34:41.223774 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:34:41.224605 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/schema.yml
[0m14:34:41.410554 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:34:41.411014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3afcf284-c3cc-40d6-ab69-5c02a69553ea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65ff211450>]}
[0m14:34:41.573473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3afcf284-c3cc-40d6-ab69-5c02a69553ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65fe703850>]}
[0m14:34:41.663992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3afcf284-c3cc-40d6-ab69-5c02a69553ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65fdfc7b50>]}
[0m14:34:41.664461 [info ] [MainThread]: Found 5 seeds, 10 models, 9 data tests, 415 macros
[0m14:34:41.664747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3afcf284-c3cc-40d6-ab69-5c02a69553ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65fe703290>]}
[0m14:34:41.666865 [info ] [MainThread]: 
[0m14:34:41.667391 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:34:41.671892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:34:41.711347 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:34:41.711757 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:34:41.712015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:41.716205 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.716583 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:34:41.716881 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:34:41.719417 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:34:41.721121 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:34:41.721670 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:34:41.780187 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:41.780760 [debug] [MainThread]: On master: BEGIN
[0m14:34:41.781185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:34:41.785505 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.786074 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:41.786639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:34:41.805504 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:34:41.809629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3afcf284-c3cc-40d6-ab69-5c02a69553ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a65febc6f10>]}
[0m14:34:41.810039 [debug] [MainThread]: On master: ROLLBACK
[0m14:34:41.810583 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:41.810871 [debug] [MainThread]: On master: BEGIN
[0m14:34:41.811494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.811951 [debug] [MainThread]: On master: COMMIT
[0m14:34:41.812235 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:41.812511 [debug] [MainThread]: On master: COMMIT
[0m14:34:41.812978 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:34:41.813270 [debug] [MainThread]: On master: Close
[0m14:34:41.813788 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:34:41.814129 [info ] [MainThread]: 
[0m14:34:41.816551 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:34:41.817025 [info ] [Thread-1 (]: 1 of 9 START test not_null_dim_billing_invoice_id .............................. [RUN]
[0m14:34:41.817604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:34:41.817985 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:34:41.832095 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:34:41.833160 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:34:41.848470 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:34:41.849157 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:34:41.849557 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m14:34:41.849860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:41.853053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.853506 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:34:41.853841 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:34:41.856676 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:41.861081 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m14:34:41.861690 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m14:34:41.862301 [info ] [Thread-1 (]: 1 of 9 PASS not_null_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.04s]
[0m14:34:41.862985 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:34:41.863419 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:34:41.863798 [info ] [Thread-1 (]: 2 of 9 START test not_null_dim_doctor_doctor_id ................................ [RUN]
[0m14:34:41.864405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:34:41.864761 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:34:41.868820 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:34:41.869382 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:34:41.871712 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:34:41.872206 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:34:41.872532 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m14:34:41.872821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:41.876390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.876999 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:34:41.877551 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:34:41.879063 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:41.880687 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m14:34:41.881202 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m14:34:41.881967 [info ] [Thread-1 (]: 2 of 9 PASS not_null_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:34:41.882878 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:34:41.883321 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:34:41.883839 [info ] [Thread-1 (]: 3 of 9 START test not_null_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:34:41.884635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:34:41.885155 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:34:41.889660 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:34:41.890233 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:34:41.893050 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:34:41.893915 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:34:41.894329 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:34:41.894663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:41.898009 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.898425 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:34:41.898769 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:34:41.900271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:41.902521 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:34:41.903197 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:34:41.904240 [info ] [Thread-1 (]: 3 of 9 PASS not_null_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.02s]
[0m14:34:41.905183 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:34:41.905751 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:34:41.906206 [info ] [Thread-1 (]: 4 of 9 START test not_null_dim_patient_patient_id .............................. [RUN]
[0m14:34:41.906702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:34:41.907041 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:34:41.912088 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:34:41.912689 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:34:41.915102 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:34:41.915635 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:34:41.915980 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m14:34:41.916285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:41.919450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.919855 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:34:41.920189 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m14:34:41.921479 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:41.922875 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m14:34:41.923309 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m14:34:41.923895 [info ] [Thread-1 (]: 4 of 9 PASS not_null_dim_patient_patient_id .................................... [[32mPASS[0m in 0.02s]
[0m14:34:41.924985 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:34:41.925997 [debug] [Thread-1 (]: Began running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:34:41.926714 [info ] [Thread-1 (]: 5 of 9 START test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [RUN]
[0m14:34:41.927423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549)
[0m14:34:41.928024 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:34:41.934119 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:34:41.934749 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:34:41.938823 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:34:41.939430 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:34:41.939768 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: BEGIN
[0m14:34:41.940084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:41.944065 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.944590 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"
[0m14:34:41.945054 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select patient_id as from_field
    from "my_db"."public"."dim_billing"
    where patient_id is not null
),

parent as (
    select patient_id as to_field
    from "my_db"."public"."dim_patient"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m14:34:41.949411 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:41.951208 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: ROLLBACK
[0m14:34:41.951778 [debug] [Thread-1 (]: On test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549: Close
[0m14:34:41.952397 [error] [Thread-1 (]: 5 of 9 FAIL 336 relationships_dim_billing_patient_id__patient_id__ref_dim_patient_  [[31mFAIL 336[0m in 0.03s]
[0m14:34:41.953026 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549
[0m14:34:41.953439 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:34:41.953784 [info ] [Thread-1 (]: 6 of 9 START test unique_dim_billing_invoice_id ................................ [RUN]
[0m14:34:41.954368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.relationships_dim_billing_patient_id__patient_id__ref_dim_patient_.cbd7622549, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:34:41.954734 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:34:41.962879 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:34:41.963513 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:34:41.966309 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:34:41.966886 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:34:41.967220 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m14:34:41.967539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:41.970877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.971276 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:34:41.971634 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:34:41.975750 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:41.977593 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m14:34:41.978256 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m14:34:41.979105 [info ] [Thread-1 (]: 6 of 9 PASS unique_dim_billing_invoice_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:34:41.980034 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:34:41.980601 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:34:41.981166 [info ] [Thread-1 (]: 7 of 9 START test unique_dim_doctor_doctor_id .................................. [RUN]
[0m14:34:41.981699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:34:41.982069 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:34:41.986564 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:34:41.987111 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:34:41.989414 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:34:41.989894 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:34:41.990206 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m14:34:41.990639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:41.994930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:41.995439 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:34:41.995943 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:34:41.998046 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:41.999666 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m14:34:42.000172 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m14:34:42.001146 [info ] [Thread-1 (]: 7 of 9 PASS unique_dim_doctor_doctor_id ........................................ [[32mPASS[0m in 0.02s]
[0m14:34:42.001865 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:34:42.002308 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:34:42.002756 [info ] [Thread-1 (]: 8 of 9 START test unique_dim_medical_procedure_procedure_id .................... [RUN]
[0m14:34:42.003229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:34:42.003582 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:34:42.008094 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:34:42.009431 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:34:42.012612 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:34:42.013309 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:34:42.013708 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:34:42.014038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:42.017498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:42.017905 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:34:42.018251 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:34:42.020707 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:42.022127 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:34:42.022593 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:34:42.023232 [info ] [Thread-1 (]: 8 of 9 PASS unique_dim_medical_procedure_procedure_id .......................... [[32mPASS[0m in 0.02s]
[0m14:34:42.023903 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:34:42.024378 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:34:42.025369 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_patient_patient_id ................................ [RUN]
[0m14:34:42.026300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:34:42.026746 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:34:42.031725 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:34:42.032409 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:34:42.034935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:34:42.035521 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:34:42.035905 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m14:34:42.036239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:42.039444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:34:42.039888 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:34:42.040261 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:34:42.042590 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:34:42.044409 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m14:34:42.045219 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m14:34:42.046294 [error] [Thread-1 (]: 9 of 9 FAIL 280 unique_dim_patient_patient_id .................................. [[31mFAIL 280[0m in 0.02s]
[0m14:34:42.047202 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:34:42.048505 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:42.048854 [debug] [MainThread]: On master: BEGIN
[0m14:34:42.049119 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:34:42.052417 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:34:42.052845 [debug] [MainThread]: On master: COMMIT
[0m14:34:42.053162 [debug] [MainThread]: Using postgres connection "master"
[0m14:34:42.053491 [debug] [MainThread]: On master: COMMIT
[0m14:34:42.053928 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:34:42.054242 [debug] [MainThread]: On master: Close
[0m14:34:42.054693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:42.054987 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m14:34:42.055346 [info ] [MainThread]: 
[0m14:34:42.055718 [info ] [MainThread]: Finished running 9 data tests in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m14:34:42.057557 [debug] [MainThread]: Command end result
[0m14:34:42.099936 [info ] [MainThread]: 
[0m14:34:42.100400 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:34:42.100731 [info ] [MainThread]: 
[0m14:34:42.101122 [error] [MainThread]: [31mFailure in test relationships_dim_billing_patient_id__patient_id__ref_dim_patient_ (models/marts/appointment/schema.yml)[0m
[0m14:34:42.101487 [error] [MainThread]:   Got 336 results, configured to fail if != 0
[0m14:34:42.101767 [info ] [MainThread]: 
[0m14:34:42.102116 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/relationships_dim_billing_67d755ce333822e0ca7d372874c62656.sql
[0m14:34:42.102411 [info ] [MainThread]: 
[0m14:34:42.102760 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m14:34:42.103091 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m14:34:42.103366 [info ] [MainThread]: 
[0m14:34:42.103705 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m14:34:42.104003 [info ] [MainThread]: 
[0m14:34:42.104310 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=2 SKIP=0 TOTAL=9
[0m14:34:42.105092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.2194707, "process_user_time": 2.21374, "process_kernel_time": 0.141727, "process_mem_max_rss": "117276", "process_out_blocks": "3032", "command_success": false, "process_in_blocks": "0"}
[0m14:34:42.105550 [debug] [MainThread]: Command `dbt test` failed at 14:34:42.105447 after 1.22 seconds
[0m14:34:42.105923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a66049fcb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a66049fccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6600a73610>]}
[0m14:34:42.106415 [debug] [MainThread]: Flushing usage events
[0m14:40:42.033143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d212052e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2120848d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2120848c10>]}


============================== 14:40:42.035927 | 25f10800-8ee6-477a-b985-ec652441dbcb ==============================
[0m14:40:42.035927 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:40:42.036482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:40:42.191466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25f10800-8ee6-477a-b985-ec652441dbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2120500b10>]}
[0m14:40:42.252237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25f10800-8ee6-477a-b985-ec652441dbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d21241fca10>]}
[0m14:40:42.253064 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:40:42.268790 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:40:42.405415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:42.406192 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/schema.yml
[0m14:40:42.636073 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:40:42.636621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25f10800-8ee6-477a-b985-ec652441dbcb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d211eca0a50>]}
[0m14:40:42.816644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25f10800-8ee6-477a-b985-ec652441dbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2120439b90>]}
[0m14:40:42.926381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25f10800-8ee6-477a-b985-ec652441dbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d211d9c7d50>]}
[0m14:40:42.926873 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:40:42.927188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f10800-8ee6-477a-b985-ec652441dbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d211e52ce50>]}
[0m14:40:42.929525 [info ] [MainThread]: 
[0m14:40:42.931505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:42.938332 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:40:42.977825 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:40:42.978172 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:40:42.978477 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:42.984653 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:40:42.985088 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:40:42.985408 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:40:42.988051 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:40:42.989590 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:40:42.990040 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:40:42.998266 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:42.998649 [debug] [MainThread]: On master: BEGIN
[0m14:40:42.998896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:43.002194 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.002576 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:43.002969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:40:43.019800 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:40:43.024053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25f10800-8ee6-477a-b985-ec652441dbcb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d211c982050>]}
[0m14:40:43.024477 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:43.024950 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:43.025282 [debug] [MainThread]: On master: BEGIN
[0m14:40:43.025909 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.026255 [debug] [MainThread]: On master: COMMIT
[0m14:40:43.026556 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:43.026831 [debug] [MainThread]: On master: COMMIT
[0m14:40:43.027261 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:40:43.027576 [debug] [MainThread]: On master: Close
[0m14:40:43.028083 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:40:43.028408 [info ] [MainThread]: 
[0m14:40:43.032089 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:40:43.032596 [info ] [Thread-1 (]: 1 of 8 START test not_null_dim_billing_invoice_id .............................. [RUN]
[0m14:40:43.117101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:40:43.117817 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:40:43.142121 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:40:43.142778 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:40:43.172757 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:40:43.174349 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:40:43.174871 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m14:40:43.175277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.179165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.179773 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:40:43.180425 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:40:43.188198 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.197000 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m14:40:43.198068 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m14:40:43.199909 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.08s]
[0m14:40:43.202561 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:40:43.206254 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:40:43.207843 [info ] [Thread-1 (]: 2 of 8 START test not_null_dim_doctor_doctor_id ................................ [RUN]
[0m14:40:43.208908 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:40:43.209859 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:40:43.220301 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:40:43.222984 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:40:43.228680 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:40:43.229901 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:40:43.230629 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m14:40:43.231779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.239681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.240758 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:40:43.241746 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:40:43.244292 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.247565 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m14:40:43.248670 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m14:40:43.249926 [info ] [Thread-1 (]: 2 of 8 PASS not_null_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.04s]
[0m14:40:43.255758 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:40:43.257242 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:40:43.258476 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:40:43.260637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:40:43.261446 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:40:43.268793 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:40:43.271152 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:40:43.275715 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:40:43.276802 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:40:43.277441 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:40:43.278006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.282260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.282875 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:40:43.283419 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:40:43.286958 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.292119 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:40:43.294393 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:40:43.296170 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.04s]
[0m14:40:43.298571 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:40:43.299902 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:40:43.301093 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_patient_patient_id .............................. [RUN]
[0m14:40:43.302477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:40:43.303979 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:40:43.315288 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:40:43.316280 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:40:43.321578 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:40:43.322665 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:40:43.323262 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m14:40:43.323756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.328206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.328757 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:40:43.329184 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m14:40:43.330738 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.332638 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m14:40:43.333233 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m14:40:43.334150 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_patient_patient_id .................................... [[32mPASS[0m in 0.03s]
[0m14:40:43.336025 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:40:43.337207 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:40:43.337954 [info ] [Thread-1 (]: 5 of 8 START test unique_dim_billing_invoice_id ................................ [RUN]
[0m14:40:43.338801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:40:43.339253 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:40:43.346993 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:40:43.347648 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:40:43.350253 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:40:43.351350 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:40:43.351953 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m14:40:43.352685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.357243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.357809 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:40:43.358167 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:40:43.361859 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.363609 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m14:40:43.364250 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m14:40:43.365091 [info ] [Thread-1 (]: 5 of 8 PASS unique_dim_billing_invoice_id ...................................... [[32mPASS[0m in 0.03s]
[0m14:40:43.365773 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:40:43.366300 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:40:43.366830 [info ] [Thread-1 (]: 6 of 8 START test unique_dim_doctor_doctor_id .................................. [RUN]
[0m14:40:43.367635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:40:43.368541 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:40:43.377468 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:40:43.378067 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:40:43.380750 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:40:43.381307 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:40:43.381656 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m14:40:43.381980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.386517 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.387377 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:40:43.388091 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:40:43.390254 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.392273 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m14:40:43.392911 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m14:40:43.393683 [info ] [Thread-1 (]: 6 of 8 PASS unique_dim_doctor_doctor_id ........................................ [[32mPASS[0m in 0.03s]
[0m14:40:43.394484 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:40:43.394953 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:40:43.395482 [info ] [Thread-1 (]: 7 of 8 START test unique_dim_medical_procedure_procedure_id .................... [RUN]
[0m14:40:43.396202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:40:43.396662 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:40:43.402597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:40:43.403837 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:40:43.408763 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:40:43.409753 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:40:43.410346 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:40:43.410860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.414740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.415384 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:40:43.415799 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:40:43.420374 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.423485 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:40:43.424103 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:40:43.425313 [info ] [Thread-1 (]: 7 of 8 PASS unique_dim_medical_procedure_procedure_id .......................... [[32mPASS[0m in 0.03s]
[0m14:40:43.426461 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:40:43.427167 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:40:43.427817 [info ] [Thread-1 (]: 8 of 8 START test unique_dim_patient_patient_id ................................ [RUN]
[0m14:40:43.428441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:40:43.428861 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:40:43.433895 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:40:43.435431 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:40:43.441048 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:40:43.442074 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:40:43.442634 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m14:40:43.443033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:43.446415 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.446853 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:40:43.447287 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:40:43.449281 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:40:43.452412 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m14:40:43.454032 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m14:40:43.456049 [error] [Thread-1 (]: 8 of 8 FAIL 280 unique_dim_patient_patient_id .................................. [[31mFAIL 280[0m in 0.03s]
[0m14:40:43.457650 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:40:43.459626 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:43.460038 [debug] [MainThread]: On master: BEGIN
[0m14:40:43.460395 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:43.463946 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:40:43.464416 [debug] [MainThread]: On master: COMMIT
[0m14:40:43.464773 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:43.465059 [debug] [MainThread]: On master: COMMIT
[0m14:40:43.465538 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:40:43.465871 [debug] [MainThread]: On master: Close
[0m14:40:43.466371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:43.466725 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m14:40:43.467107 [info ] [MainThread]: 
[0m14:40:43.468045 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m14:40:43.473810 [debug] [MainThread]: Command end result
[0m14:40:43.524657 [info ] [MainThread]: 
[0m14:40:43.525138 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:40:43.525559 [info ] [MainThread]: 
[0m14:40:43.526026 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m14:40:43.526608 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m14:40:43.526951 [info ] [MainThread]: 
[0m14:40:43.527396 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m14:40:43.527754 [info ] [MainThread]: 
[0m14:40:43.528075 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m14:40:43.529003 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.5440607, "process_user_time": 2.519149, "process_kernel_time": 0.160626, "process_mem_max_rss": "117204", "process_out_blocks": "2976", "command_success": false, "process_in_blocks": "0"}
[0m14:40:43.529632 [debug] [MainThread]: Command `dbt test` failed at 14:40:43.529507 after 1.54 seconds
[0m14:40:43.530089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2124470cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d21244703d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d2120555590>]}
[0m14:40:43.530579 [debug] [MainThread]: Flushing usage events
[0m14:41:21.362980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a114b9c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1148eb850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1148eb5d0>]}


============================== 14:41:21.365709 | 4e5b0151-bc1c-4ab4-997e-d7ddb2cdae1d ==============================
[0m14:41:21.365709 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:41:21.366254 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:21.502124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e5b0151-bc1c-4ab4-997e-d7ddb2cdae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1149457d0>]}
[0m14:41:21.549642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e5b0151-bc1c-4ab4-997e-d7ddb2cdae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1185dcb50>]}
[0m14:41:21.550381 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:41:21.559170 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:41:21.665973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:21.666377 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:21.708668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e5b0151-bc1c-4ab4-997e-d7ddb2cdae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1148c28d0>]}
[0m14:41:21.801460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e5b0151-bc1c-4ab4-997e-d7ddb2cdae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a112acbe90>]}
[0m14:41:21.801928 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:41:21.802259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5b0151-bc1c-4ab4-997e-d7ddb2cdae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a113055550>]}
[0m14:41:21.804354 [info ] [MainThread]: 
[0m14:41:21.804899 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:21.809498 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:41:21.853353 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:41:21.853725 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:41:21.853996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:21.858569 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:41:21.858996 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:41:21.859384 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:41:21.861971 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:41:21.863490 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:41:21.863971 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:41:21.871556 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:21.871914 [debug] [MainThread]: On master: BEGIN
[0m14:41:21.872208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:21.875395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:41:21.875795 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:21.876154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:41:21.892587 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:41:21.896581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e5b0151-bc1c-4ab4-997e-d7ddb2cdae1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a112af2b90>]}
[0m14:41:21.896964 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:21.897495 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:21.897771 [debug] [MainThread]: On master: BEGIN
[0m14:41:21.898406 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:41:21.898855 [debug] [MainThread]: On master: COMMIT
[0m14:41:21.899134 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:21.899391 [debug] [MainThread]: On master: COMMIT
[0m14:41:21.899859 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:41:21.900150 [debug] [MainThread]: On master: Close
[0m14:41:21.900640 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:41:21.900956 [info ] [MainThread]: 
[0m14:41:21.903441 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:41:21.903929 [info ] [Thread-1 (]: 1 of 8 START test not_null_dim_billing_invoice_id .............................. [RUN]
[0m14:41:21.904456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:41:21.904831 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:41:21.921773 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:41:21.922376 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:41:21.937931 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:41:21.938547 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:41:21.938874 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m14:41:21.939170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:21.942454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:21.942862 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:41:21.943193 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:41:21.946045 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:21.950034 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m14:41:21.950620 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m14:41:21.951216 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.05s]
[0m14:41:21.951857 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:41:21.952282 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:41:21.952755 [info ] [Thread-1 (]: 2 of 8 START test not_null_dim_doctor_doctor_id ................................ [RUN]
[0m14:41:21.953239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:41:21.953603 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:41:21.957690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:41:21.958264 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:41:21.960553 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:41:21.961098 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:41:21.961434 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m14:41:21.961729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:21.964842 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:21.965302 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:41:21.965662 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:41:21.967369 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:21.969381 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m14:41:21.970003 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m14:41:21.970895 [info ] [Thread-1 (]: 2 of 8 PASS not_null_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:41:21.971715 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:41:21.972166 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:41:21.972726 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:41:21.973270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:41:21.973630 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:41:21.978398 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:41:21.978963 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:41:21.982825 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:41:21.983813 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:41:21.984425 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:41:21.984935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:21.988260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:21.988752 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:41:21.989094 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:41:21.990489 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:21.991945 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:41:21.992453 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:41:21.993111 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.02s]
[0m14:41:21.993765 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:41:21.994222 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:41:21.994978 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_patient_patient_id .............................. [RUN]
[0m14:41:21.995625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:41:21.996024 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:41:22.000849 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:41:22.001556 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:41:22.004134 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:41:22.004938 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:41:22.005367 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m14:41:22.005708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:22.008705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:22.009173 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:41:22.009541 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m14:41:22.011430 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:22.013312 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m14:41:22.014046 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m14:41:22.015182 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_patient_patient_id .................................... [[32mPASS[0m in 0.02s]
[0m14:41:22.016226 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:41:22.016789 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:41:22.017312 [info ] [Thread-1 (]: 5 of 8 START test unique_dim_billing_invoice_id ................................ [RUN]
[0m14:41:22.017861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:41:22.018227 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:41:22.024808 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:41:22.025406 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:41:22.029317 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:41:22.031146 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:41:22.031851 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m14:41:22.032284 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:22.035503 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:22.035925 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:41:22.036283 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:41:22.039805 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:22.041365 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m14:41:22.041978 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m14:41:22.042622 [info ] [Thread-1 (]: 5 of 8 PASS unique_dim_billing_invoice_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:41:22.043255 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:41:22.043682 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:41:22.044267 [info ] [Thread-1 (]: 6 of 8 START test unique_dim_doctor_doctor_id .................................. [RUN]
[0m14:41:22.045479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:41:22.046211 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:41:22.052442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:41:22.053013 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:41:22.055413 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:41:22.055971 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:41:22.056297 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m14:41:22.056611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:22.059954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:22.060379 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:41:22.060878 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:41:22.063751 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:22.065969 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m14:41:22.066937 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m14:41:22.067744 [info ] [Thread-1 (]: 6 of 8 PASS unique_dim_doctor_doctor_id ........................................ [[32mPASS[0m in 0.02s]
[0m14:41:22.068551 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:41:22.069061 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:41:22.069558 [info ] [Thread-1 (]: 7 of 8 START test unique_dim_medical_procedure_procedure_id .................... [RUN]
[0m14:41:22.070085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:41:22.070455 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:41:22.074557 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:41:22.075143 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:41:22.077658 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:41:22.078610 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:41:22.079241 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:41:22.079683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:22.083499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:22.083992 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:41:22.084380 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:41:22.087115 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:22.088703 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:41:22.089233 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:41:22.090017 [info ] [Thread-1 (]: 7 of 8 PASS unique_dim_medical_procedure_procedure_id .......................... [[32mPASS[0m in 0.02s]
[0m14:41:22.090884 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:41:22.091459 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:41:22.092029 [info ] [Thread-1 (]: 8 of 8 START test unique_dim_patient_patient_id ................................ [RUN]
[0m14:41:22.092500 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:41:22.092839 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:41:22.098189 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:41:22.098867 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:41:22.101485 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:41:22.102264 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:41:22.102648 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m14:41:22.102972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:22.106047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:41:22.106483 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:41:22.106821 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:41:22.108611 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:41:22.110087 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m14:41:22.110545 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m14:41:22.111220 [error] [Thread-1 (]: 8 of 8 FAIL 280 unique_dim_patient_patient_id .................................. [[31mFAIL 280[0m in 0.02s]
[0m14:41:22.112860 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:41:22.114430 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:22.114835 [debug] [MainThread]: On master: BEGIN
[0m14:41:22.115121 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:22.118658 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:41:22.119220 [debug] [MainThread]: On master: COMMIT
[0m14:41:22.119610 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:22.119913 [debug] [MainThread]: On master: COMMIT
[0m14:41:22.120303 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:41:22.120624 [debug] [MainThread]: On master: Close
[0m14:41:22.121048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:22.121311 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m14:41:22.121735 [info ] [MainThread]: 
[0m14:41:22.122087 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:41:22.123851 [debug] [MainThread]: Command end result
[0m14:41:22.161161 [info ] [MainThread]: 
[0m14:41:22.162000 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:41:22.162765 [info ] [MainThread]: 
[0m14:41:22.163272 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m14:41:22.163707 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m14:41:22.164006 [info ] [MainThread]: 
[0m14:41:22.164472 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m14:41:22.164812 [info ] [MainThread]: 
[0m14:41:22.165156 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m14:41:22.166017 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.8443711, "process_user_time": 1.829573, "process_kernel_time": 0.140659, "process_mem_max_rss": "113912", "process_out_blocks": "2088", "command_success": false, "process_in_blocks": "0"}
[0m14:41:22.166556 [debug] [MainThread]: Command `dbt test` failed at 14:41:22.166445 after 0.85 seconds
[0m14:41:22.166919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a114a83d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a114909990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a114908d50>]}
[0m14:41:22.167366 [debug] [MainThread]: Flushing usage events
[0m14:44:03.989718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78edbf4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ed903e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ed90d410>]}


============================== 14:44:03.992316 | 25986a57-0025-4807-923d-1095adca75f4 ==============================
[0m14:44:03.992316 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:44:03.992832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim patient', 'send_anonymous_usage_stats': 'True'}
[0m14:44:04.125136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25986a57-0025-4807-923d-1095adca75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ed7c22d0>]}
[0m14:44:04.171313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25986a57-0025-4807-923d-1095adca75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78f15e8b10>]}
[0m14:44:04.172038 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:44:04.181899 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:44:04.290938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:04.291536 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:44:04.480128 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:44:04.480636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '25986a57-0025-4807-923d-1095adca75f4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ebe62110>]}
[0m14:44:04.630557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25986a57-0025-4807-923d-1095adca75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ebcff8d0>]}
[0m14:44:04.713314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25986a57-0025-4807-923d-1095adca75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78eb5b8750>]}
[0m14:44:04.713828 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:44:04.714114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25986a57-0025-4807-923d-1095adca75f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ebfcccd0>]}
[0m14:44:04.714780 [warn ] [MainThread]: The selection criterion 'dim' does not match any enabled nodes
[0m14:44:04.715172 [warn ] [MainThread]: The selection criterion 'patient' does not match any enabled nodes
[0m14:44:04.716268 [info ] [MainThread]: 
[0m14:44:04.716615 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:44:04.717063 [debug] [MainThread]: Command end result
[0m14:44:04.744404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.79765826, "process_user_time": 1.848049, "process_kernel_time": 0.116003, "process_mem_max_rss": "108536", "process_out_blocks": "2776", "process_in_blocks": "0"}
[0m14:44:04.744885 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:04.744785 after 0.80 seconds
[0m14:44:04.745190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78eda88110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78ed901a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d78f16f8790>]}
[0m14:44:04.745526 [debug] [MainThread]: Flushing usage events
[0m14:44:19.623578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19ef53eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19ef585a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19ef707f90>]}


============================== 14:44:19.626123 | 6c4724c3-db45-4471-9dec-9be9425cddc0 ==============================
[0m14:44:19.626123 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:44:19.626667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_patient', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:19.756109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c4724c3-db45-4471-9dec-9be9425cddc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19ef476c50>]}
[0m14:44:19.802260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c4724c3-db45-4471-9dec-9be9425cddc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19f3268950>]}
[0m14:44:19.802978 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:44:19.813751 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:44:19.923695 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:19.924091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:19.967812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c4724c3-db45-4471-9dec-9be9425cddc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19edc00290>]}
[0m14:44:20.050905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c4724c3-db45-4471-9dec-9be9425cddc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19edc5b4d0>]}
[0m14:44:20.051459 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:44:20.051766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4724c3-db45-4471-9dec-9be9425cddc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19edcd8410>]}
[0m14:44:20.053500 [info ] [MainThread]: 
[0m14:44:20.054109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:20.055013 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:44:20.097295 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:44:20.097767 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:44:20.098069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:20.102718 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:44:20.103973 [debug] [ThreadPool]: On list_my_db: Close
[0m14:44:20.109367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:44:20.115757 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:44:20.116130 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:44:20.116393 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:20.119889 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:44:20.120274 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:44:20.120595 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:44:20.123123 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:44:20.124597 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:44:20.125057 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:44:20.132431 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:20.132780 [debug] [MainThread]: On master: BEGIN
[0m14:44:20.133047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:20.136272 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:20.136658 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:20.137029 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:20.153271 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:44:20.157199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4724c3-db45-4471-9dec-9be9425cddc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19f0225290>]}
[0m14:44:20.157619 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:20.158100 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:20.158387 [debug] [MainThread]: On master: BEGIN
[0m14:44:20.158981 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:20.159285 [debug] [MainThread]: On master: COMMIT
[0m14:44:20.159568 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:20.159825 [debug] [MainThread]: On master: COMMIT
[0m14:44:20.160214 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:20.160489 [debug] [MainThread]: On master: Close
[0m14:44:20.160980 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:20.161310 [info ] [MainThread]: 
[0m14:44:20.164594 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m14:44:20.165181 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m14:44:20.165800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m14:44:20.166312 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m14:44:20.174695 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m14:44:20.175266 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m14:44:20.211387 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m14:44:20.211994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:44:20.212316 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m14:44:20.212644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:20.216294 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:20.216753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:44:20.217094 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
)
select distinct * from patient
order by patient_id
  );
[0m14:44:20.218889 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:44:20.225305 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:44:20.225713 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient" rename to "dim_patient__dbt_backup"
[0m14:44:20.226362 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:20.229499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:44:20.229885 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m14:44:20.230519 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:20.246094 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m14:44:20.246520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:44:20.246853 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m14:44:20.298184 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:20.307890 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_patient__dbt_backup"
[0m14:44:20.315099 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:44:20.315646 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
drop view if exists "my_db"."public"."dim_patient__dbt_backup" cascade
[0m14:44:20.318310 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:44:20.321761 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m14:44:20.324623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4724c3-db45-4471-9dec-9be9425cddc0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19ecd9c050>]}
[0m14:44:20.325813 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_patient ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m14:44:20.326839 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m14:44:20.328626 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:20.329075 [debug] [MainThread]: On master: BEGIN
[0m14:44:20.329457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:20.334141 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:20.334662 [debug] [MainThread]: On master: COMMIT
[0m14:44:20.335051 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:20.335456 [debug] [MainThread]: On master: COMMIT
[0m14:44:20.336050 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:20.336492 [debug] [MainThread]: On master: Close
[0m14:44:20.337149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:20.337770 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m14:44:20.338144 [info ] [MainThread]: 
[0m14:44:20.338694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:44:20.339745 [debug] [MainThread]: Command end result
[0m14:44:20.375670 [info ] [MainThread]: 
[0m14:44:20.376199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:20.376580 [info ] [MainThread]: 
[0m14:44:20.376923 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:44:20.377716 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7958517, "process_user_time": 1.784749, "process_kernel_time": 0.134829, "process_mem_max_rss": "111456", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m14:44:20.378275 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:20.378128 after 0.80 seconds
[0m14:44:20.378752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19ef707e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19f3374710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a19f34d0310>]}
[0m14:44:20.379283 [debug] [MainThread]: Flushing usage events
[0m14:44:31.055852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d28b9e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d28ea0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d28b56190>]}


============================== 14:44:31.058578 | b051b3a8-f860-4d0d-8372-51292a3ad0cd ==============================
[0m14:44:31.058578 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:44:31.059092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m fact_appointment', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:44:31.186827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b051b3a8-f860-4d0d-8372-51292a3ad0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d28a84250>]}
[0m14:44:31.233057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b051b3a8-f860-4d0d-8372-51292a3ad0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2c890850>]}
[0m14:44:31.233779 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:44:31.242969 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:44:31.355042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:31.355408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:31.398707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b051b3a8-f860-4d0d-8372-51292a3ad0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2701c1d0>]}
[0m14:44:31.483049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b051b3a8-f860-4d0d-8372-51292a3ad0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2720c050>]}
[0m14:44:31.483513 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:44:31.483824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b051b3a8-f860-4d0d-8372-51292a3ad0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2a485c50>]}
[0m14:44:31.485364 [info ] [MainThread]: 
[0m14:44:31.485935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:31.486837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:44:31.526965 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:44:31.527320 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:44:31.527603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:31.532195 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:44:31.533566 [debug] [ThreadPool]: On list_my_db: Close
[0m14:44:31.538437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:44:31.544288 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:44:31.544634 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:44:31.544886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:31.548140 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:44:31.548521 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:44:31.548809 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:44:31.551366 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:44:31.552880 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:44:31.553285 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:44:31.561162 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:31.561513 [debug] [MainThread]: On master: BEGIN
[0m14:44:31.561767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:31.565008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:31.565376 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:31.565728 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:31.583288 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:44:31.586211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b051b3a8-f860-4d0d-8372-51292a3ad0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d271d6150>]}
[0m14:44:31.586631 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:31.587053 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:31.587347 [debug] [MainThread]: On master: BEGIN
[0m14:44:31.588024 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:31.588503 [debug] [MainThread]: On master: COMMIT
[0m14:44:31.588930 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:31.589343 [debug] [MainThread]: On master: COMMIT
[0m14:44:31.589876 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:31.590289 [debug] [MainThread]: On master: Close
[0m14:44:31.590925 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:31.591377 [info ] [MainThread]: 
[0m14:44:31.593543 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:44:31.594087 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:44:31.595582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:44:31.596120 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:44:31.605893 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:44:31.606539 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:44:31.641850 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:44:31.642474 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:44:31.642816 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:44:31.643116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:31.646390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:31.646862 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:44:31.647238 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
           
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:44:31.649949 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:44:31.656183 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:44:31.656611 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */
alter table "my_db"."public"."fact_appointment__dbt_tmp" rename to "fact_appointment"
[0m14:44:31.657418 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:44:31.670720 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: COMMIT
[0m14:44:31.671170 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:44:31.671541 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: COMMIT
[0m14:44:31.722697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:44:31.733373 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."fact_appointment__dbt_backup"
[0m14:44:31.741988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:44:31.742719 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */
drop view if exists "my_db"."public"."fact_appointment__dbt_backup" cascade
[0m14:44:31.743727 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:44:31.747572 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:44:31.749755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b051b3a8-f860-4d0d-8372-51292a3ad0cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d264e7f90>]}
[0m14:44:31.750736 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fact_appointment ....................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:44:31.751657 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:44:31.753151 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:31.753598 [debug] [MainThread]: On master: BEGIN
[0m14:44:31.753910 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:31.758094 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:31.758646 [debug] [MainThread]: On master: COMMIT
[0m14:44:31.758982 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:31.759310 [debug] [MainThread]: On master: COMMIT
[0m14:44:31.759865 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:31.760287 [debug] [MainThread]: On master: Close
[0m14:44:31.761275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:31.761786 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:44:31.762158 [info ] [MainThread]: 
[0m14:44:31.762613 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m14:44:31.763757 [debug] [MainThread]: Command end result
[0m14:44:31.795879 [info ] [MainThread]: 
[0m14:44:31.796317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:31.796644 [info ] [MainThread]: 
[0m14:44:31.797061 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:44:31.797883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.783555, "process_user_time": 1.792893, "process_kernel_time": 0.125852, "process_mem_max_rss": "111100", "process_out_blocks": "1936", "process_in_blocks": "0"}
[0m14:44:31.798381 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:31.798264 after 0.78 seconds
[0m14:44:31.798704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2c988690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2cae4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x710d2cae4b50>]}
[0m14:44:31.799016 [debug] [MainThread]: Flushing usage events
[0m14:44:38.534530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ecb96690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ecb89110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ecb8ad10>]}


============================== 14:44:38.537100 | 0e12889b-7610-4d89-b40f-de21740edbb4 ==============================
[0m14:44:38.537100 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:44:38.537702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:44:38.671650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0e12889b-7610-4d89-b40f-de21740edbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2eca638d0>]}
[0m14:44:38.717924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0e12889b-7610-4d89-b40f-de21740edbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2f084cd90>]}
[0m14:44:38.718651 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:44:38.728077 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:44:38.867742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:38.868084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:38.910700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0e12889b-7610-4d89-b40f-de21740edbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ed7ab090>]}
[0m14:44:39.004321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0e12889b-7610-4d89-b40f-de21740edbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ead19410>]}
[0m14:44:39.004820 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:44:39.005128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e12889b-7610-4d89-b40f-de21740edbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ec9c8e10>]}
[0m14:44:39.007305 [info ] [MainThread]: 
[0m14:44:39.008034 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:39.012944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:44:39.054593 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:44:39.054981 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:44:39.055255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:39.059787 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.060253 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:44:39.060568 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:44:39.063479 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:44:39.065233 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:44:39.065718 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:44:39.073508 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:39.073975 [debug] [MainThread]: On master: BEGIN
[0m14:44:39.074285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:39.077475 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.077844 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:39.078208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:39.094361 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:44:39.098326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0e12889b-7610-4d89-b40f-de21740edbb4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2eca9ad50>]}
[0m14:44:39.098720 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:39.099156 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:39.099439 [debug] [MainThread]: On master: BEGIN
[0m14:44:39.100032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.100324 [debug] [MainThread]: On master: COMMIT
[0m14:44:39.100607 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:39.100861 [debug] [MainThread]: On master: COMMIT
[0m14:44:39.101254 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:39.101594 [debug] [MainThread]: On master: Close
[0m14:44:39.102034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:39.102364 [info ] [MainThread]: 
[0m14:44:39.105141 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:44:39.105727 [info ] [Thread-1 (]: 1 of 8 START test not_null_dim_billing_invoice_id .............................. [RUN]
[0m14:44:39.106262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:44:39.106621 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:44:39.123237 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:44:39.124051 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:44:39.139439 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:44:39.140192 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:44:39.140662 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m14:44:39.141033 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.144579 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.145030 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:44:39.145397 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:44:39.148266 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.152208 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m14:44:39.152775 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m14:44:39.153764 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.05s]
[0m14:44:39.154957 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:44:39.155447 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:44:39.155959 [info ] [Thread-1 (]: 2 of 8 START test not_null_dim_doctor_doctor_id ................................ [RUN]
[0m14:44:39.156546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:44:39.156901 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:44:39.161200 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:44:39.161780 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:44:39.164080 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:44:39.164607 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:44:39.164923 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m14:44:39.165210 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.168261 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.168682 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:44:39.169014 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:44:39.170323 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.172031 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m14:44:39.172675 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m14:44:39.173682 [info ] [Thread-1 (]: 2 of 8 PASS not_null_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:44:39.174762 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:44:39.175276 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:44:39.175743 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:44:39.176265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:44:39.176620 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:44:39.180886 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:44:39.181504 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:44:39.186057 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:44:39.187327 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:44:39.187747 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:44:39.188064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.191399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.191860 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:44:39.192198 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:44:39.193536 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.194968 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:44:39.195406 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:44:39.195942 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.02s]
[0m14:44:39.196677 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:44:39.197260 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:44:39.197787 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_patient_patient_id .............................. [RUN]
[0m14:44:39.198318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:44:39.198802 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:44:39.204318 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:44:39.205023 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:44:39.207596 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:44:39.208140 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:44:39.208626 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m14:44:39.208937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.211987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.212422 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:44:39.212757 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m14:44:39.214164 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.215640 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m14:44:39.216067 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m14:44:39.216642 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_patient_patient_id .................................... [[32mPASS[0m in 0.02s]
[0m14:44:39.217362 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:44:39.217806 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:44:39.218269 [info ] [Thread-1 (]: 5 of 8 START test unique_dim_billing_invoice_id ................................ [RUN]
[0m14:44:39.218791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:44:39.219139 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:44:39.226922 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:44:39.227561 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:44:39.230273 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:44:39.230861 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:44:39.231184 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m14:44:39.231499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.234445 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.234858 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:44:39.235182 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:44:39.239271 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.241435 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m14:44:39.242029 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m14:44:39.242875 [info ] [Thread-1 (]: 5 of 8 PASS unique_dim_billing_invoice_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:44:39.243787 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:44:39.244388 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:44:39.244984 [info ] [Thread-1 (]: 6 of 8 START test unique_dim_doctor_doctor_id .................................. [RUN]
[0m14:44:39.245531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:44:39.245974 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:44:39.250186 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:44:39.250753 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:44:39.253009 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:44:39.253858 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:44:39.254384 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m14:44:39.254756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.258484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.258949 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:44:39.259299 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:44:39.261297 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.262932 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m14:44:39.263410 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m14:44:39.264073 [info ] [Thread-1 (]: 6 of 8 PASS unique_dim_doctor_doctor_id ........................................ [[32mPASS[0m in 0.02s]
[0m14:44:39.264804 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:44:39.265247 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:44:39.265812 [info ] [Thread-1 (]: 7 of 8 START test unique_dim_medical_procedure_procedure_id .................... [RUN]
[0m14:44:39.266309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:44:39.266704 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:44:39.272458 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:44:39.273271 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:44:39.276967 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:44:39.277724 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:44:39.278125 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:44:39.278454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.282170 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.282600 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:44:39.282940 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:44:39.285371 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.287106 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:44:39.288120 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:44:39.289240 [info ] [Thread-1 (]: 7 of 8 PASS unique_dim_medical_procedure_procedure_id .......................... [[32mPASS[0m in 0.02s]
[0m14:44:39.290205 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:44:39.290781 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:44:39.291262 [info ] [Thread-1 (]: 8 of 8 START test unique_dim_patient_patient_id ................................ [RUN]
[0m14:44:39.291784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:44:39.292176 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:44:39.296626 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:44:39.297207 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:44:39.299549 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:44:39.300044 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:44:39.300373 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m14:44:39.300674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:39.304497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.305024 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:44:39.305448 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:44:39.308299 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:44:39.310140 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m14:44:39.310818 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m14:44:39.311810 [error] [Thread-1 (]: 8 of 8 FAIL 280 unique_dim_patient_patient_id .................................. [[31mFAIL 280[0m in 0.02s]
[0m14:44:39.312692 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:44:39.313863 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:39.314187 [debug] [MainThread]: On master: BEGIN
[0m14:44:39.314463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:39.317366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:44:39.317784 [debug] [MainThread]: On master: COMMIT
[0m14:44:39.318078 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:39.318343 [debug] [MainThread]: On master: COMMIT
[0m14:44:39.318721 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:44:39.319001 [debug] [MainThread]: On master: Close
[0m14:44:39.319486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:39.319958 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m14:44:39.320704 [info ] [MainThread]: 
[0m14:44:39.321367 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:44:39.323713 [debug] [MainThread]: Command end result
[0m14:44:39.360450 [info ] [MainThread]: 
[0m14:44:39.360917 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:44:39.361273 [info ] [MainThread]: 
[0m14:44:39.361680 [error] [MainThread]: [31mFailure in test unique_dim_patient_patient_id (models/marts/appointment/schema.yml)[0m
[0m14:44:39.362040 [error] [MainThread]:   Got 280 results, configured to fail if != 0
[0m14:44:39.362321 [info ] [MainThread]: 
[0m14:44:39.362680 [info ] [MainThread]:   compiled code at target/compiled/dbt_modeling/models/marts/appointment/schema.yml/unique_dim_patient_patient_id.sql
[0m14:44:39.362984 [info ] [MainThread]: 
[0m14:44:39.363291 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m14:44:39.364060 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.872062, "process_user_time": 1.824026, "process_kernel_time": 0.158135, "process_mem_max_rss": "113916", "process_out_blocks": "2088", "command_success": false, "process_in_blocks": "0"}
[0m14:44:39.364543 [debug] [MainThread]: Command `dbt test` failed at 14:44:39.364442 after 0.87 seconds
[0m14:44:39.364893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ece3a010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2ecb8aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74c2f0aa0c10>]}
[0m14:44:39.365228 [debug] [MainThread]: Flushing usage events
[0m14:48:11.103171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515a10ae610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515a10add50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515a10ae150>]}


============================== 14:48:11.105832 | 55ba8894-0aba-4f70-a26a-491df474bcc9 ==============================
[0m14:48:11.105832 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:48:11.106347 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim patient', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:48:11.239741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ba8894-0aba-4f70-a26a-491df474bcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515a0fe94d0>]}
[0m14:48:11.286432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ba8894-0aba-4f70-a26a-491df474bcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515a1d4c550>]}
[0m14:48:11.287181 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:48:11.296054 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:48:11.404667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:48:11.405317 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:48:11.610993 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:48:11.611588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '55ba8894-0aba-4f70-a26a-491df474bcc9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75159f475890>]}
[0m14:48:11.772195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ba8894-0aba-4f70-a26a-491df474bcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75159f4d6910>]}
[0m14:48:11.860206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ba8894-0aba-4f70-a26a-491df474bcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75159edc0250>]}
[0m14:48:11.860716 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:48:11.861055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ba8894-0aba-4f70-a26a-491df474bcc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75159f83b390>]}
[0m14:48:11.861845 [warn ] [MainThread]: The selection criterion 'dim' does not match any enabled nodes
[0m14:48:11.862415 [warn ] [MainThread]: The selection criterion 'patient' does not match any enabled nodes
[0m14:48:11.863630 [info ] [MainThread]: 
[0m14:48:11.863993 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:48:11.864537 [debug] [MainThread]: Command end result
[0m14:48:11.893777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.83207345, "process_user_time": 1.901323, "process_kernel_time": 0.117019, "process_mem_max_rss": "108636", "process_out_blocks": "2776", "process_in_blocks": "0"}
[0m14:48:11.894298 [debug] [MainThread]: Command `dbt run` succeeded at 14:48:11.894193 after 0.83 seconds
[0m14:48:11.894631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515a10b8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7515a4e84950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75159f779c90>]}
[0m14:48:11.894968 [debug] [MainThread]: Flushing usage events
[0m14:49:14.142871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7b29be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7b424090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7b2854d0>]}


============================== 14:49:14.145704 | b0648011-862a-4763-8692-7bb30087b60c ==============================
[0m14:49:14.145704 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:49:14.146224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim patient', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:14.283836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0648011-862a-4763-8692-7bb30087b60c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de799629d0>]}
[0m14:49:14.334927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0648011-862a-4763-8692-7bb30087b60c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de799a1550>]}
[0m14:49:14.335671 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:49:14.345011 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:49:14.457198 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:14.457843 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:49:14.646580 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:49:14.647074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b0648011-862a-4763-8692-7bb30087b60c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7961ae10>]}
[0m14:49:14.799519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0648011-862a-4763-8692-7bb30087b60c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de79961d10>]}
[0m14:49:14.883917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0648011-862a-4763-8692-7bb30087b60c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de796b5010>]}
[0m14:49:14.884370 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:49:14.884650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0648011-862a-4763-8692-7bb30087b60c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7c785910>]}
[0m14:49:14.885290 [warn ] [MainThread]: The selection criterion 'dim' does not match any enabled nodes
[0m14:49:14.885690 [warn ] [MainThread]: The selection criterion 'patient' does not match any enabled nodes
[0m14:49:14.886778 [info ] [MainThread]: 
[0m14:49:14.887116 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:49:14.887605 [debug] [MainThread]: Command end result
[0m14:49:14.915038 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.81501734, "process_user_time": 2.072751, "process_kernel_time": 0.122985, "process_mem_max_rss": "108796", "process_out_blocks": "2776", "process_in_blocks": "0"}
[0m14:49:14.915578 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:14.915476 after 0.82 seconds
[0m14:49:14.915888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7b27e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7b2a7bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72de7f054790>]}
[0m14:49:14.916213 [debug] [MainThread]: Flushing usage events
[0m14:49:23.808437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7726501ed850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7726501d7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7726501edfd0>]}


============================== 14:49:23.811002 | d5b6b233-0010-45a9-8541-93096a67ad63 ==============================
[0m14:49:23.811002 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:49:23.811508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim patient', 'send_anonymous_usage_stats': 'True'}
[0m14:49:23.957693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd5b6b233-0010-45a9-8541-93096a67ad63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7726501ee990>]}
[0m14:49:24.007791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd5b6b233-0010-45a9-8541-93096a67ad63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e931b90>]}
[0m14:49:24.008549 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:49:24.018330 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:49:24.133956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:49:24.134610 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:49:24.322084 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:49:24.322549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd5b6b233-0010-45a9-8541-93096a67ad63', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e968d10>]}
[0m14:49:24.473429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5b6b233-0010-45a9-8541-93096a67ad63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e79d5d0>]}
[0m14:49:24.560756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5b6b233-0010-45a9-8541-93096a67ad63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e5d3590>]}
[0m14:49:24.561273 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:49:24.561591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5b6b233-0010-45a9-8541-93096a67ad63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e80f1d0>]}
[0m14:49:24.562235 [warn ] [MainThread]: The selection criterion 'dim' does not match any enabled nodes
[0m14:49:24.562685 [warn ] [MainThread]: The selection criterion 'patient' does not match any enabled nodes
[0m14:49:24.563912 [info ] [MainThread]: 
[0m14:49:24.564272 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:49:24.564803 [debug] [MainThread]: Command end result
[0m14:49:24.595313 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.83324295, "process_user_time": 2.033575, "process_kernel_time": 0.114976, "process_mem_max_rss": "108548", "process_out_blocks": "2768", "process_in_blocks": "0"}
[0m14:49:24.595900 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:24.595787 after 0.83 seconds
[0m14:49:24.596246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772650367e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772650367950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77264e5c7a10>]}
[0m14:49:24.596614 [debug] [MainThread]: Flushing usage events
[0m14:49:49.334583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a243966210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a243958d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a24393f210>]}


============================== 14:49:49.337185 | 28f08663-ccb1-4e39-9d6e-70d434236cf5 ==============================
[0m14:49:49.337185 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:49:49.337744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_patient', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:49:49.486820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28f08663-ccb1-4e39-9d6e-70d434236cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a24200c990>]}
[0m14:49:49.535349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28f08663-ccb1-4e39-9d6e-70d434236cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2476409d0>]}
[0m14:49:49.536062 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:49:49.545380 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:49:49.656486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:49.656845 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:49.699391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28f08663-ccb1-4e39-9d6e-70d434236cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a241fe8c10>]}
[0m14:49:49.787937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28f08663-ccb1-4e39-9d6e-70d434236cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a24202bad0>]}
[0m14:49:49.788463 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:49:49.788768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f08663-ccb1-4e39-9d6e-70d434236cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2439650d0>]}
[0m14:49:49.790481 [info ] [MainThread]: 
[0m14:49:49.791071 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:49.791976 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:49:49.833960 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:49:49.834352 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:49:49.834625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:49.839532 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:49:49.840818 [debug] [ThreadPool]: On list_my_db: Close
[0m14:49:49.845683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:49:49.851652 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:49:49.852016 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:49:49.852281 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:49.855566 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:49:49.855946 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:49:49.856256 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:49:49.858736 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:49:49.860205 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:49:49.860653 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:49:49.868163 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:49.868549 [debug] [MainThread]: On master: BEGIN
[0m14:49:49.868832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:49.871832 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:49.872212 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:49.872646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:49.888918 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:49:49.893014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28f08663-ccb1-4e39-9d6e-70d434236cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a241d29750>]}
[0m14:49:49.893501 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:49.894025 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:49.894320 [debug] [MainThread]: On master: BEGIN
[0m14:49:49.894990 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:49.895307 [debug] [MainThread]: On master: COMMIT
[0m14:49:49.895615 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:49.895899 [debug] [MainThread]: On master: COMMIT
[0m14:49:49.896321 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:49:49.896624 [debug] [MainThread]: On master: Close
[0m14:49:49.897097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:49:49.897445 [info ] [MainThread]: 
[0m14:49:49.900732 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m14:49:49.901377 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m14:49:49.901858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m14:49:49.902210 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m14:49:49.909955 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m14:49:49.910734 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m14:49:49.947539 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m14:49:49.948275 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:49:49.948668 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m14:49:49.948954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:49.953185 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:49:49.953686 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:49:49.954054 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
)

select distinct * from patient
order by patient_id
  );
[0m14:49:49.956014 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:49:49.962494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:49:49.962920 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient" rename to "dim_patient__dbt_backup"
[0m14:49:49.963679 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:49.966720 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:49:49.967106 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m14:49:49.967863 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:49:49.983643 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m14:49:49.984049 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:49:49.984382 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m14:49:49.985471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:49:49.991442 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_patient__dbt_backup"
[0m14:49:49.996145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:49:49.996592 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
drop view if exists "my_db"."public"."dim_patient__dbt_backup" cascade
[0m14:49:49.998688 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:49:50.001241 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m14:49:50.002842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28f08663-ccb1-4e39-9d6e-70d434236cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a241d2b7d0>]}
[0m14:49:50.003629 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_patient ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m14:49:50.004290 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m14:49:50.005440 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:50.005761 [debug] [MainThread]: On master: BEGIN
[0m14:49:50.006050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:50.009273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:49:50.009784 [debug] [MainThread]: On master: COMMIT
[0m14:49:50.010106 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:50.010388 [debug] [MainThread]: On master: COMMIT
[0m14:49:50.010902 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:49:50.011201 [debug] [MainThread]: On master: Close
[0m14:49:50.011758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:50.012186 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m14:49:50.012572 [info ] [MainThread]: 
[0m14:49:50.012993 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:49:50.014223 [debug] [MainThread]: Command end result
[0m14:49:50.050870 [info ] [MainThread]: 
[0m14:49:50.051550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:50.052146 [info ] [MainThread]: 
[0m14:49:50.052583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:49:50.053469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7639008, "process_user_time": 1.932716, "process_kernel_time": 0.133911, "process_mem_max_rss": "111048", "process_out_blocks": "1928", "process_in_blocks": "0"}
[0m14:49:50.053985 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:50.053878 after 0.76 seconds
[0m14:49:50.054325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a243d77fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a247750750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73a2478ac450>]}
[0m14:49:50.054673 [debug] [MainThread]: Flushing usage events
[0m14:51:20.045620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ee72ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ee748fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503eea3ccd0>]}


============================== 14:51:20.048119 | eb116207-7dba-49d6-88fe-852b7093d3ab ==============================
[0m14:51:20.048119 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:51:20.048686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_patient', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:51:20.180011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ee585490>]}
[0m14:51:20.228101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503f2444fd0>]}
[0m14:51:20.228823 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:51:20.238140 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:51:20.347171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:20.347805 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:51:20.536705 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:51:20.537155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ece94ad0>]}
[0m14:51:20.689208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ecb8b650>]}
[0m14:51:20.773328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ec3bc250>]}
[0m14:51:20.773869 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:51:20.774219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ee755350>]}
[0m14:51:20.775789 [info ] [MainThread]: 
[0m14:51:20.776373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:20.777279 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:51:20.816131 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:51:20.816699 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:51:20.817072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:20.821754 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:51:20.823066 [debug] [ThreadPool]: On list_my_db: Close
[0m14:51:20.827889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:51:20.833717 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:51:20.834068 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:51:20.834315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:20.838035 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:51:20.838483 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:51:20.838837 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:51:20.841338 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:51:20.842824 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:51:20.843275 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:51:20.850675 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:20.851004 [debug] [MainThread]: On master: BEGIN
[0m14:51:20.851252 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:20.854752 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:51:20.855119 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:20.855481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:20.870760 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:51:20.873973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ec7d6e10>]}
[0m14:51:20.874432 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:20.874914 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:20.875204 [debug] [MainThread]: On master: BEGIN
[0m14:51:20.875822 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:51:20.876207 [debug] [MainThread]: On master: COMMIT
[0m14:51:20.876479 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:20.876718 [debug] [MainThread]: On master: COMMIT
[0m14:51:20.877135 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:51:20.877430 [debug] [MainThread]: On master: Close
[0m14:51:20.877910 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:51:20.878233 [info ] [MainThread]: 
[0m14:51:20.880436 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m14:51:20.881017 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m14:51:20.881807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m14:51:20.882183 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m14:51:20.889358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m14:51:20.890012 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m14:51:20.927284 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m14:51:20.927897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:51:20.928207 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m14:51:20.928506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:20.931599 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:51:20.932046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:51:20.932391 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
)

select  *, count (*) as count 
from patient
group by patient_id
having count > 1
order by patient_id
  );
[0m14:51:20.933282 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "count" does not exist
LINE 14: having count > 1
                ^

[0m14:51:20.933663 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: ROLLBACK
[0m14:51:20.934181 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m14:51:20.938024 [debug] [Thread-1 (]: Database Error in model dim_patient (models/marts/description/dim_patient.sql)
  column "count" does not exist
  LINE 14: having count > 1
                  ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_patient.sql
[0m14:51:20.939517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb116207-7dba-49d6-88fe-852b7093d3ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503ec7ebd90>]}
[0m14:51:20.940148 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_patient ........................ [[31mERROR[0m in 0.06s]
[0m14:51:20.940771 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m14:51:20.942449 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:20.942763 [debug] [MainThread]: On master: BEGIN
[0m14:51:20.943012 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:20.945787 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:51:20.946237 [debug] [MainThread]: On master: COMMIT
[0m14:51:20.946526 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:20.946774 [debug] [MainThread]: On master: COMMIT
[0m14:51:20.947123 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:51:20.947399 [debug] [MainThread]: On master: Close
[0m14:51:20.947808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:20.948083 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m14:51:20.948394 [info ] [MainThread]: 
[0m14:51:20.948768 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:51:20.949699 [debug] [MainThread]: Command end result
[0m14:51:21.043876 [info ] [MainThread]: 
[0m14:51:21.044351 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:51:21.044660 [info ] [MainThread]: 
[0m14:51:21.045064 [error] [MainThread]:   Database Error in model dim_patient (models/marts/description/dim_patient.sql)
  column "count" does not exist
  LINE 14: having count > 1
                  ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_patient.sql
[0m14:51:21.045364 [info ] [MainThread]: 
[0m14:51:21.045693 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:51:21.046449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0420986, "process_user_time": 2.202824, "process_kernel_time": 0.143988, "process_mem_max_rss": "116052", "process_out_blocks": "2808", "command_success": false, "process_in_blocks": "0"}
[0m14:51:21.046928 [debug] [MainThread]: Command `dbt run` failed at 14:51:21.046823 after 1.04 seconds
[0m14:51:21.047290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503f269cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503f269cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7503f269c490>]}
[0m14:51:21.047633 [debug] [MainThread]: Flushing usage events
[0m14:52:55.606816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b277e4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b277590d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2773b710>]}


============================== 14:52:55.609681 | b2a8f202-c2b1-4518-ba83-8d82612eff04 ==============================
[0m14:52:55.609681 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:52:55.610219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_patient', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:52:55.754083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2764ca90>]}
[0m14:52:55.801552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2b474ed0>]}
[0m14:52:55.802275 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:55.811407 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:52:55.922558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:55.923180 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:52:56.115653 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:52:56.116122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b25bc7a90>]}
[0m14:52:56.269782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b25e7d850>]}
[0m14:52:56.353561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2764f190>]}
[0m14:52:56.354073 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:52:56.354368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b29133c50>]}
[0m14:52:56.355927 [info ] [MainThread]: 
[0m14:52:56.356485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:56.357345 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:52:56.397257 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:52:56.397658 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:52:56.397918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:56.402545 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:52:56.404038 [debug] [ThreadPool]: On list_my_db: Close
[0m14:52:56.408977 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:52:56.414611 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:52:56.414958 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:52:56.415203 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:56.418404 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:52:56.418751 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:52:56.419040 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:52:56.421548 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:52:56.423040 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:52:56.423479 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:52:56.431079 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:56.431432 [debug] [MainThread]: On master: BEGIN
[0m14:52:56.431692 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:56.434846 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:56.435223 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:56.435589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:56.450891 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:52:56.453886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b283f1490>]}
[0m14:52:56.454324 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:56.454798 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:56.455085 [debug] [MainThread]: On master: BEGIN
[0m14:52:56.455708 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:56.456024 [debug] [MainThread]: On master: COMMIT
[0m14:52:56.456280 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:56.456539 [debug] [MainThread]: On master: COMMIT
[0m14:52:56.456967 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:56.457247 [debug] [MainThread]: On master: Close
[0m14:52:56.457748 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:52:56.458081 [info ] [MainThread]: 
[0m14:52:56.460616 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m14:52:56.461200 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m14:52:56.461979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m14:52:56.462353 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m14:52:56.469529 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m14:52:56.470173 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m14:52:56.506479 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m14:52:56.507098 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:52:56.507424 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m14:52:56.507740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:56.510865 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:52:56.511255 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:52:56.511702 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
),


duplicate_patients as (
    select 
        *,
        count(*) as patient_count 
    from patient
    group by 
        patient_id,
        email 
    having count(*) > 1  
)

select *
from duplicate_patients
order by patient_id;
  );
[0m14:52:56.512364 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 25: order by patient_id;
                            ^

[0m14:52:56.512734 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: ROLLBACK
[0m14:52:56.513234 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m14:52:56.517221 [debug] [Thread-1 (]: Database Error in model dim_patient (models/marts/description/dim_patient.sql)
  syntax error at or near ";"
  LINE 25: order by patient_id;
                              ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_patient.sql
[0m14:52:56.519534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2a8f202-c2b1-4518-ba83-8d82612eff04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2575fd10>]}
[0m14:52:56.520595 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_patient ........................ [[31mERROR[0m in 0.06s]
[0m14:52:56.521591 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m14:52:56.523632 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:56.523955 [debug] [MainThread]: On master: BEGIN
[0m14:52:56.524225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:56.527293 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:52:56.527715 [debug] [MainThread]: On master: COMMIT
[0m14:52:56.527982 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:56.528234 [debug] [MainThread]: On master: COMMIT
[0m14:52:56.528641 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:52:56.528985 [debug] [MainThread]: On master: Close
[0m14:52:56.529472 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:56.529912 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m14:52:56.530443 [info ] [MainThread]: 
[0m14:52:56.531399 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m14:52:56.533054 [debug] [MainThread]: Command end result
[0m14:52:56.639114 [info ] [MainThread]: 
[0m14:52:56.639629 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:56.640024 [info ] [MainThread]: 
[0m14:52:56.640449 [error] [MainThread]:   Database Error in model dim_patient (models/marts/description/dim_patient.sql)
  syntax error at or near ";"
  LINE 25: order by patient_id;
                              ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_patient.sql
[0m14:52:56.640773 [info ] [MainThread]: 
[0m14:52:56.641129 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:52:56.642025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.0801466, "process_user_time": 2.228416, "process_kernel_time": 0.154167, "process_mem_max_rss": "116264", "process_out_blocks": "2816", "command_success": false, "process_in_blocks": "0"}
[0m14:52:56.642615 [debug] [MainThread]: Command `dbt run` failed at 14:52:56.642499 after 1.08 seconds
[0m14:52:56.643040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2b6ccdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2b6ccd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x721b2b6cced0>]}
[0m14:52:56.643395 [debug] [MainThread]: Flushing usage events
[0m14:53:03.941036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9475aab4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9475ac3450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9475aab010>]}


============================== 14:53:03.944164 | 35fa903e-71c8-4494-92b6-4af2c1a2017c ==============================
[0m14:53:03.944164 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:53:03.944775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_patient', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:53:04.091351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9475ac3250>]}
[0m14:53:04.150142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d94797bca50>]}
[0m14:53:04.150883 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:53:04.161373 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:53:04.318179 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:04.318979 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:53:04.521233 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:53:04.521759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9473f1b950>]}
[0m14:53:04.697932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d94759f10d0>]}
[0m14:53:04.790861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d94733146d0>]}
[0m14:53:04.791388 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:53:04.791693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9477686e10>]}
[0m14:53:04.793269 [info ] [MainThread]: 
[0m14:53:04.793810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:04.794714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:53:04.833458 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:53:04.833838 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:53:04.834096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:04.838526 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:53:04.839941 [debug] [ThreadPool]: On list_my_db: Close
[0m14:53:04.845255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:53:04.851006 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:53:04.851358 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:53:04.851640 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:04.855350 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:53:04.855746 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:53:04.856050 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:53:04.858699 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:53:04.860177 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:53:04.860698 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:53:04.868870 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:04.869220 [debug] [MainThread]: On master: BEGIN
[0m14:53:04.869479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:04.872682 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:04.873129 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:04.873511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:04.889230 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:53:04.892472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9473bc1f10>]}
[0m14:53:04.892972 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:04.893394 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:04.893659 [debug] [MainThread]: On master: BEGIN
[0m14:53:04.894178 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:04.894547 [debug] [MainThread]: On master: COMMIT
[0m14:53:04.894871 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:04.895227 [debug] [MainThread]: On master: COMMIT
[0m14:53:04.895747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:04.896090 [debug] [MainThread]: On master: Close
[0m14:53:04.896702 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:04.897293 [info ] [MainThread]: 
[0m14:53:04.899515 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m14:53:04.900108 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m14:53:04.901028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m14:53:04.901513 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m14:53:04.909784 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m14:53:04.910735 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m14:53:04.947649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m14:53:04.948261 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:04.948594 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m14:53:04.948887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:04.952238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:04.952645 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:04.952968 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
),


duplicate_patients as (
    select 
        *,
        count(*) as patient_count 
    from patient
    group by 
        patient_id,
        email 
    having count(*) > 1  
)

select *
from duplicate_patients
order by patient_id
  );
[0m14:53:04.954175 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patient.first_name" must appear in the GROUP BY clause or be used in an aggregate function
LINE 14:         *,
                 ^

[0m14:53:04.954579 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: ROLLBACK
[0m14:53:04.955096 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m14:53:04.959179 [debug] [Thread-1 (]: Database Error in model dim_patient (models/marts/description/dim_patient.sql)
  column "patient.first_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 14:         *,
                   ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_patient.sql
[0m14:53:04.960567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35fa903e-71c8-4494-92b6-4af2c1a2017c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9472744610>]}
[0m14:53:04.961176 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_patient ........................ [[31mERROR[0m in 0.06s]
[0m14:53:04.961832 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m14:53:04.963396 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:04.963717 [debug] [MainThread]: On master: BEGIN
[0m14:53:04.964063 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:04.967160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:04.967591 [debug] [MainThread]: On master: COMMIT
[0m14:53:04.967855 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:04.968102 [debug] [MainThread]: On master: COMMIT
[0m14:53:04.968473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:04.968747 [debug] [MainThread]: On master: Close
[0m14:53:04.969134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:04.969397 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m14:53:04.969679 [info ] [MainThread]: 
[0m14:53:04.970010 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:53:04.970733 [debug] [MainThread]: Command end result
[0m14:53:05.069304 [info ] [MainThread]: 
[0m14:53:05.069792 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:05.070142 [info ] [MainThread]: 
[0m14:53:05.070586 [error] [MainThread]:   Database Error in model dim_patient (models/marts/description/dim_patient.sql)
  column "patient.first_name" must appear in the GROUP BY clause or be used in an aggregate function
  LINE 14:         *,
                   ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_patient.sql
[0m14:53:05.070947 [info ] [MainThread]: 
[0m14:53:05.071301 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:05.072150 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1804854, "process_user_time": 2.348535, "process_kernel_time": 0.144032, "process_mem_max_rss": "116124", "process_out_blocks": "2808", "command_success": false, "process_in_blocks": "0"}
[0m14:53:05.072669 [debug] [MainThread]: Command `dbt run` failed at 14:53:05.072533 after 1.18 seconds
[0m14:53:05.073021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9475a6f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9475a6f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9475a6f5d0>]}
[0m14:53:05.073355 [debug] [MainThread]: Flushing usage events
[0m14:53:26.768290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e64a6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e64c6d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e64a6590>]}


============================== 14:53:26.771550 | 0b1a8e28-afbb-4610-ac1a-1164e1762556 ==============================
[0m14:53:26.771550 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:53:26.772165 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_patient', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:53:26.917006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e64c7e90>]}
[0m14:53:26.965306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652ea1ccc10>]}
[0m14:53:26.966037 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:53:26.975313 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:53:27.086338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:27.087081 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m14:53:27.276303 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:53:27.276782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e4c6bcd0>]}
[0m14:53:27.431135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e489e690>]}
[0m14:53:27.517157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e41c4390>]}
[0m14:53:27.517719 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:53:27.518070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e4c1eb10>]}
[0m14:53:27.519699 [info ] [MainThread]: 
[0m14:53:27.520394 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:27.521386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:53:27.562080 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:53:27.562471 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:53:27.562733 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:27.567388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:53:27.568773 [debug] [ThreadPool]: On list_my_db: Close
[0m14:53:27.573710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:53:27.579399 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:53:27.579726 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:53:27.579989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:27.583088 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:53:27.583529 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:53:27.583827 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:53:27.586288 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:53:27.587776 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:53:27.588266 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:53:27.595513 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:27.595864 [debug] [MainThread]: On master: BEGIN
[0m14:53:27.596110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:27.599321 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:27.599694 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:27.600055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:27.615452 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:53:27.618551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e4146710>]}
[0m14:53:27.619037 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:27.619533 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:27.619876 [debug] [MainThread]: On master: BEGIN
[0m14:53:27.620517 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:27.620884 [debug] [MainThread]: On master: COMMIT
[0m14:53:27.621180 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:27.621452 [debug] [MainThread]: On master: COMMIT
[0m14:53:27.621901 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:27.622205 [debug] [MainThread]: On master: Close
[0m14:53:27.622681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:27.623006 [info ] [MainThread]: 
[0m14:53:27.625255 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m14:53:27.625885 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m14:53:27.626694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m14:53:27.627079 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m14:53:27.634282 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m14:53:27.634905 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m14:53:27.671605 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m14:53:27.672223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:27.672579 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m14:53:27.672890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:27.676124 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:27.676650 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:27.676996 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
),


duplicate_patients as (
    select patient_id,email,
        count(*) as patient_count 
    from patient
    group by 
        patient_id,
        email 
    having count(*) > 1  
)

select *
from duplicate_patients
order by patient_id
  );
[0m14:53:27.679231 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:53:27.738658 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:27.739303 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient" rename to "dim_patient__dbt_backup"
[0m14:53:27.740457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:27.744909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:27.745416 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m14:53:27.746348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:53:27.764311 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m14:53:27.764775 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:27.765087 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m14:53:27.766102 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:53:27.772507 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_patient__dbt_backup"
[0m14:53:27.777443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m14:53:27.777838 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
drop view if exists "my_db"."public"."dim_patient__dbt_backup" cascade
[0m14:53:27.779403 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:53:27.781637 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m14:53:27.783110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b1a8e28-afbb-4610-ac1a-1164e1762556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652e49a8e50>]}
[0m14:53:27.783731 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_patient ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m14:53:27.784388 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m14:53:27.785657 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:27.785981 [debug] [MainThread]: On master: BEGIN
[0m14:53:27.786239 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:27.789779 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:27.790211 [debug] [MainThread]: On master: COMMIT
[0m14:53:27.790558 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:27.790822 [debug] [MainThread]: On master: COMMIT
[0m14:53:27.791248 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:27.791577 [debug] [MainThread]: On master: Close
[0m14:53:27.792159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:27.792574 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m14:53:27.793012 [info ] [MainThread]: 
[0m14:53:27.793434 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m14:53:27.794680 [debug] [MainThread]: Command end result
[0m14:53:27.831100 [info ] [MainThread]: 
[0m14:53:27.831574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:27.831919 [info ] [MainThread]: 
[0m14:53:27.832276 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:53:27.833730 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1135964, "process_user_time": 2.232757, "process_kernel_time": 0.142728, "process_mem_max_rss": "115284", "process_out_blocks": "2816", "process_in_blocks": "0"}
[0m14:53:27.834622 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:27.834450 after 1.11 seconds
[0m14:53:27.835106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652ea2dc750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652ea438dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7652ea438ed0>]}
[0m14:53:27.835549 [debug] [MainThread]: Flushing usage events
[0m14:53:54.025344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced73b8edd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced73b8d8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced73b8e590>]}


============================== 14:53:54.027946 | 9c429d59-20d9-48a8-82a4-9c35ca6d3838 ==============================
[0m14:53:54.027946 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:53:54.028462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fact_appointment', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:53:54.163172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c429d59-20d9-48a8-82a4-9c35ca6d3838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced72261710>]}
[0m14:53:54.211420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c429d59-20d9-48a8-82a4-9c35ca6d3838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced778cd010>]}
[0m14:53:54.212134 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:53:54.221524 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:53:54.336490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:54.336884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:54.380162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c429d59-20d9-48a8-82a4-9c35ca6d3838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced72067010>]}
[0m14:53:54.467587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c429d59-20d9-48a8-82a4-9c35ca6d3838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced73af7d90>]}
[0m14:53:54.468045 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:53:54.468372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c429d59-20d9-48a8-82a4-9c35ca6d3838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced74f66350>]}
[0m14:53:54.469890 [info ] [MainThread]: 
[0m14:53:54.470461 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:54.471351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:53:54.512353 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:53:54.512729 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:53:54.512992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:54.517268 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:53:54.518594 [debug] [ThreadPool]: On list_my_db: Close
[0m14:53:54.523540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:53:54.529638 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:53:54.529989 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:53:54.530249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:54.533519 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:53:54.533925 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:53:54.534218 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:53:54.536898 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:53:54.538515 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:53:54.539043 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:53:54.546633 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:54.547000 [debug] [MainThread]: On master: BEGIN
[0m14:53:54.547283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:54.550591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:54.550966 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:54.551364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:54.567100 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:53:54.570490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c429d59-20d9-48a8-82a4-9c35ca6d3838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced71fae890>]}
[0m14:53:54.570944 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:54.571521 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:54.571820 [debug] [MainThread]: On master: BEGIN
[0m14:53:54.572375 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:54.572679 [debug] [MainThread]: On master: COMMIT
[0m14:53:54.572964 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:54.573249 [debug] [MainThread]: On master: COMMIT
[0m14:53:54.573647 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:54.573983 [debug] [MainThread]: On master: Close
[0m14:53:54.574572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:53:54.574976 [info ] [MainThread]: 
[0m14:53:54.577223 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:53:54.577792 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:53:54.579418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:53:54.579872 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:53:54.589610 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:53:54.590322 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:53:54.627672 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:53:54.628369 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:53:54.628844 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:53:54.629158 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:54.632148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:53:54.632586 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:53:54.632945 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
           
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:53:54.633861 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "first_name" does not exist
LINE 17:         First_name,
                 ^

[0m14:53:54.634273 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: ROLLBACK
[0m14:53:54.634764 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:53:54.638594 [debug] [Thread-1 (]: Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "first_name" does not exist
  LINE 17:         First_name,
                   ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:53:54.640042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9c429d59-20d9-48a8-82a4-9c35ca6d3838', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced7230b750>]}
[0m14:53:54.640640 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fact_appointment ................... [[31mERROR[0m in 0.06s]
[0m14:53:54.641241 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:53:54.642883 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:54.643274 [debug] [MainThread]: On master: BEGIN
[0m14:53:54.643617 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:54.646762 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:53:54.647175 [debug] [MainThread]: On master: COMMIT
[0m14:53:54.647516 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:54.647790 [debug] [MainThread]: On master: COMMIT
[0m14:53:54.648182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:53:54.648472 [debug] [MainThread]: On master: Close
[0m14:53:54.648932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:54.649295 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:53:54.649703 [info ] [MainThread]: 
[0m14:53:54.650121 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:53:54.650972 [debug] [MainThread]: Command end result
[0m14:53:54.684045 [info ] [MainThread]: 
[0m14:53:54.684545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:54.684873 [info ] [MainThread]: 
[0m14:53:54.685306 [error] [MainThread]:   Database Error in model fact_appointment (models/marts/appointment/fact_appointment.sql)
  column "first_name" does not exist
  LINE 17:         First_name,
                   ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fact_appointment.sql
[0m14:53:54.685627 [info ] [MainThread]: 
[0m14:53:54.685951 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:54.686701 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7040311, "process_user_time": 1.73146, "process_kernel_time": 0.129809, "process_mem_max_rss": "111636", "process_out_blocks": "1928", "command_success": false, "process_in_blocks": "0"}
[0m14:53:54.687159 [debug] [MainThread]: Command `dbt run` failed at 14:53:54.687057 after 0.70 seconds
[0m14:53:54.687522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced73d57f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced73d579d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ced77b20dd0>]}
[0m14:53:54.687830 [debug] [MainThread]: Flushing usage events
[0m14:54:31.832463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c47362890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c4738ed50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c4738fe50>]}


============================== 14:54:31.835047 | b2f48bba-286e-4f9d-8740-8d0f88b98c15 ==============================
[0m14:54:31.835047 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:54:31.835522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m fact_appointment', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:54:31.965477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2f48bba-286e-4f9d-8740-8d0f88b98c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c473abb10>]}
[0m14:54:32.012180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2f48bba-286e-4f9d-8740-8d0f88b98c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c4b0c4fd0>]}
[0m14:54:32.012899 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:54:32.021424 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:54:32.132051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:32.132646 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fact_appointment.sql
[0m14:54:32.337723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2f48bba-286e-4f9d-8740-8d0f88b98c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c4579f050>]}
[0m14:54:32.420585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2f48bba-286e-4f9d-8740-8d0f88b98c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c456dc0d0>]}
[0m14:54:32.421043 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:54:32.421323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f48bba-286e-4f9d-8740-8d0f88b98c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c45a06f90>]}
[0m14:54:32.422822 [info ] [MainThread]: 
[0m14:54:32.423325 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:32.424181 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m14:54:32.464772 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m14:54:32.465170 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m14:54:32.465457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:32.469851 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m14:54:32.471138 [debug] [ThreadPool]: On list_my_db: Close
[0m14:54:32.476228 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m14:54:32.482201 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:54:32.482572 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:54:32.482829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:32.486056 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:32.486465 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:54:32.486754 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:54:32.489233 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m14:54:32.490764 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:54:32.491284 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:54:32.498747 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:32.499104 [debug] [MainThread]: On master: BEGIN
[0m14:54:32.499371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:32.502521 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:32.502886 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:32.503234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:32.518572 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m14:54:32.521393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2f48bba-286e-4f9d-8740-8d0f88b98c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c456da050>]}
[0m14:54:32.521805 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:32.522237 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:32.522516 [debug] [MainThread]: On master: BEGIN
[0m14:54:32.523100 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:32.523441 [debug] [MainThread]: On master: COMMIT
[0m14:54:32.523690 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:32.523947 [debug] [MainThread]: On master: COMMIT
[0m14:54:32.524358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:32.524616 [debug] [MainThread]: On master: Close
[0m14:54:32.525052 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:32.525403 [info ] [MainThread]: 
[0m14:54:32.527682 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:54:32.528401 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fact_appointment ............................ [RUN]
[0m14:54:32.529198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fact_appointment)
[0m14:54:32.529618 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:54:32.537919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:54:32.538490 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:54:32.575527 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fact_appointment"
[0m14:54:32.576129 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:54:32.576457 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: BEGIN
[0m14:54:32.576809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:32.580083 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:32.580499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:54:32.580861 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */

  create view "my_db"."public"."fact_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        email
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
           
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m14:54:32.583496 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m14:54:32.589558 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:54:32.589951 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */
alter table "my_db"."public"."fact_appointment__dbt_tmp" rename to "fact_appointment"
[0m14:54:32.590797 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m14:54:32.605935 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: COMMIT
[0m14:54:32.606456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:54:32.606808 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: COMMIT
[0m14:54:32.634409 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m14:54:32.640854 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."fact_appointment__dbt_backup"
[0m14:54:32.645813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fact_appointment"
[0m14:54:32.646206 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fact_appointment"} */
drop view if exists "my_db"."public"."fact_appointment__dbt_backup" cascade
[0m14:54:32.646866 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m14:54:32.649081 [debug] [Thread-1 (]: On model.dbt_modeling.fact_appointment: Close
[0m14:54:32.650558 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2f48bba-286e-4f9d-8740-8d0f88b98c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c45840890>]}
[0m14:54:32.651250 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fact_appointment ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:54:32.651883 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:54:32.653059 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:32.653379 [debug] [MainThread]: On master: BEGIN
[0m14:54:32.653652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:32.657076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:32.657569 [debug] [MainThread]: On master: COMMIT
[0m14:54:32.657889 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:32.658249 [debug] [MainThread]: On master: COMMIT
[0m14:54:32.658703 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:32.658996 [debug] [MainThread]: On master: Close
[0m14:54:32.659437 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:32.659788 [debug] [MainThread]: Connection 'model.dbt_modeling.fact_appointment' was properly closed.
[0m14:54:32.660162 [info ] [MainThread]: 
[0m14:54:32.660595 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m14:54:32.661792 [debug] [MainThread]: Command end result
[0m14:54:32.694173 [info ] [MainThread]: 
[0m14:54:32.694691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:32.695015 [info ] [MainThread]: 
[0m14:54:32.695344 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:54:32.696082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9060711, "process_user_time": 1.923578, "process_kernel_time": 0.139041, "process_mem_max_rss": "114276", "process_out_blocks": "2816", "process_in_blocks": "0"}
[0m14:54:32.696566 [debug] [MainThread]: Command `dbt run` succeeded at 14:54:32.696463 after 0.91 seconds
[0m14:54:32.696882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c47523a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c473b5690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717c4769ced0>]}
[0m14:54:32.697204 [debug] [MainThread]: Flushing usage events
[0m14:54:39.139982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb792d0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb7943fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb792c5e10>]}


============================== 14:54:39.142484 | 21062fc4-ae7a-4290-818a-c5493f2e3cb5 ==============================
[0m14:54:39.142484 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:54:39.142983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:54:39.271982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21062fc4-ae7a-4290-818a-c5493f2e3cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb779a9e10>]}
[0m14:54:39.317943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21062fc4-ae7a-4290-818a-c5493f2e3cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb7cf747d0>]}
[0m14:54:39.318679 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:54:39.327631 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:54:39.438044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:54:39.438409 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:54:39.481630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21062fc4-ae7a-4290-818a-c5493f2e3cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb77740590>]}
[0m14:54:39.575769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21062fc4-ae7a-4290-818a-c5493f2e3cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb77471a90>]}
[0m14:54:39.576244 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:54:39.576620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21062fc4-ae7a-4290-818a-c5493f2e3cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb7786f790>]}
[0m14:54:39.578797 [info ] [MainThread]: 
[0m14:54:39.579381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:39.584384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:54:39.628219 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:54:39.628615 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:54:39.628872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:39.633271 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.633707 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:54:39.634036 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:54:39.636517 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:54:39.637988 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:54:39.638366 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:54:39.645924 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:39.646291 [debug] [MainThread]: On master: BEGIN
[0m14:54:39.646567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:39.649944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.650293 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:39.650664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:39.666817 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:54:39.670786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21062fc4-ae7a-4290-818a-c5493f2e3cb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb769c21d0>]}
[0m14:54:39.671185 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:39.671668 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:39.671942 [debug] [MainThread]: On master: BEGIN
[0m14:54:39.672414 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.672728 [debug] [MainThread]: On master: COMMIT
[0m14:54:39.673008 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:39.673286 [debug] [MainThread]: On master: COMMIT
[0m14:54:39.673724 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:39.674052 [debug] [MainThread]: On master: Close
[0m14:54:39.674537 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:54:39.674910 [info ] [MainThread]: 
[0m14:54:39.677506 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:54:39.677945 [info ] [Thread-1 (]: 1 of 8 START test not_null_dim_billing_invoice_id .............................. [RUN]
[0m14:54:39.678437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:54:39.678821 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:54:39.694349 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:54:39.694944 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:54:39.709917 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:54:39.710517 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:54:39.710836 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: BEGIN
[0m14:54:39.711131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.714613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.715159 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:54:39.715561 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select invoice_id
from "my_db"."public"."dim_billing"
where invoice_id is null



      
    ) dbt_internal_test
[0m14:54:39.718743 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.722873 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: ROLLBACK
[0m14:54:39.723423 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def: Close
[0m14:54:39.724037 [info ] [Thread-1 (]: 1 of 8 PASS not_null_dim_billing_invoice_id .................................... [[32mPASS[0m in 0.05s]
[0m14:54:39.724671 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:54:39.725107 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:54:39.725599 [info ] [Thread-1 (]: 2 of 8 START test not_null_dim_doctor_doctor_id ................................ [RUN]
[0m14:54:39.726133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:54:39.726644 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:54:39.731238 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:54:39.731862 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:54:39.734224 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:54:39.734749 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:54:39.735093 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: BEGIN
[0m14:54:39.735416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.738528 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.738956 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:54:39.739320 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select doctor_id
from "my_db"."public"."dim_doctor"
where doctor_id is null



      
    ) dbt_internal_test
[0m14:54:39.740522 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.741949 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: ROLLBACK
[0m14:54:39.742352 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5: Close
[0m14:54:39.742967 [info ] [Thread-1 (]: 2 of 8 PASS not_null_dim_doctor_doctor_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:54:39.743664 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:54:39.744236 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:54:39.744829 [info ] [Thread-1 (]: 3 of 8 START test not_null_dim_medical_procedure_procedure_id .................. [RUN]
[0m14:54:39.745380 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:54:39.745927 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:54:39.750869 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:54:39.751497 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:54:39.755224 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:54:39.755899 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:54:39.756309 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: BEGIN
[0m14:54:39.756802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.761240 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.762092 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:54:39.762571 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select procedure_id
from "my_db"."public"."dim_medical_procedure"
where procedure_id is null



      
    ) dbt_internal_test
[0m14:54:39.764176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.765643 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: ROLLBACK
[0m14:54:39.766165 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c: Close
[0m14:54:39.766811 [info ] [Thread-1 (]: 3 of 8 PASS not_null_dim_medical_procedure_procedure_id ........................ [[32mPASS[0m in 0.02s]
[0m14:54:39.767445 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:54:39.767855 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:54:39.768298 [info ] [Thread-1 (]: 4 of 8 START test not_null_dim_patient_patient_id .............................. [RUN]
[0m14:54:39.768793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:54:39.769119 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:54:39.773664 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:54:39.774667 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:54:39.778821 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:54:39.779791 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:54:39.780140 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: BEGIN
[0m14:54:39.780453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.783473 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.783876 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:54:39.784218 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select patient_id
from "my_db"."public"."dim_patient"
where patient_id is null



      
    ) dbt_internal_test
[0m14:54:39.785681 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.787150 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: ROLLBACK
[0m14:54:39.787618 [debug] [Thread-1 (]: On test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d: Close
[0m14:54:39.788191 [info ] [Thread-1 (]: 4 of 8 PASS not_null_dim_patient_patient_id .................................... [[32mPASS[0m in 0.02s]
[0m14:54:39.788842 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:54:39.789286 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:54:39.789801 [info ] [Thread-1 (]: 5 of 8 START test unique_dim_billing_invoice_id ................................ [RUN]
[0m14:54:39.790290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:54:39.790652 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:54:39.800039 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:54:39.800803 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:54:39.803255 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:54:39.803831 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:54:39.804156 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: BEGIN
[0m14:54:39.804458 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.807522 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.807963 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:54:39.808306 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    invoice_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_billing"
where invoice_id is not null
group by invoice_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:54:39.812470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.814849 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: ROLLBACK
[0m14:54:39.815558 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad: Close
[0m14:54:39.816470 [info ] [Thread-1 (]: 5 of 8 PASS unique_dim_billing_invoice_id ...................................... [[32mPASS[0m in 0.03s]
[0m14:54:39.817446 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:54:39.818103 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:54:39.818718 [info ] [Thread-1 (]: 6 of 8 START test unique_dim_doctor_doctor_id .................................. [RUN]
[0m14:54:39.819232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:54:39.819608 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:54:39.823690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:54:39.824221 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:54:39.826650 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:54:39.827661 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:54:39.828151 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: BEGIN
[0m14:54:39.828487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.832359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.832818 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:54:39.833165 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    doctor_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_doctor"
where doctor_id is not null
group by doctor_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:54:39.835114 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.836637 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: ROLLBACK
[0m14:54:39.837173 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb: Close
[0m14:54:39.837757 [info ] [Thread-1 (]: 6 of 8 PASS unique_dim_doctor_doctor_id ........................................ [[32mPASS[0m in 0.02s]
[0m14:54:39.838456 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:54:39.838913 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:54:39.839323 [info ] [Thread-1 (]: 7 of 8 START test unique_dim_medical_procedure_procedure_id .................... [RUN]
[0m14:54:39.839835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:54:39.840164 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:54:39.845239 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:54:39.845980 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:54:39.848972 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:54:39.849696 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:54:39.850084 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: BEGIN
[0m14:54:39.850410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.853729 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.854134 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:54:39.854502 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    procedure_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_medical_procedure"
where procedure_id is not null
group by procedure_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:54:39.856924 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.858353 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: ROLLBACK
[0m14:54:39.858831 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5: Close
[0m14:54:39.859683 [info ] [Thread-1 (]: 7 of 8 PASS unique_dim_medical_procedure_procedure_id .......................... [[32mPASS[0m in 0.02s]
[0m14:54:39.861169 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:54:39.861969 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:54:39.862611 [info ] [Thread-1 (]: 8 of 8 START test unique_dim_patient_patient_id ................................ [RUN]
[0m14:54:39.863324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:54:39.863830 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:54:39.868489 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:54:39.869060 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:54:39.871416 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:54:39.871918 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:54:39.872249 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: BEGIN
[0m14:54:39.872567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:54:39.875629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.876042 [debug] [Thread-1 (]: Using postgres connection "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:54:39.876424 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    patient_id as unique_field,
    count(*) as n_records

from "my_db"."public"."dim_patient"
where patient_id is not null
group by patient_id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:54:39.879106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.0 seconds
[0m14:54:39.881135 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: ROLLBACK
[0m14:54:39.881951 [debug] [Thread-1 (]: On test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61: Close
[0m14:54:39.882764 [info ] [Thread-1 (]: 8 of 8 PASS unique_dim_patient_patient_id ...................................... [[32mPASS[0m in 0.02s]
[0m14:54:39.883505 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:54:39.884820 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:39.885203 [debug] [MainThread]: On master: BEGIN
[0m14:54:39.885505 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:39.888734 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:54:39.889153 [debug] [MainThread]: On master: COMMIT
[0m14:54:39.889485 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:39.889781 [debug] [MainThread]: On master: COMMIT
[0m14:54:39.890183 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m14:54:39.890492 [debug] [MainThread]: On master: Close
[0m14:54:39.890922 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:39.891201 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m14:54:39.891566 [info ] [MainThread]: 
[0m14:54:39.891929 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m14:54:39.893708 [debug] [MainThread]: Command end result
[0m14:54:39.931698 [info ] [MainThread]: 
[0m14:54:39.932269 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:39.932675 [info ] [MainThread]: 
[0m14:54:39.933025 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m14:54:39.933907 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.83515257, "process_user_time": 1.817194, "process_kernel_time": 0.138938, "process_mem_max_rss": "113556", "process_out_blocks": "2072", "process_in_blocks": "0"}
[0m14:54:39.934451 [debug] [MainThread]: Command `dbt test` succeeded at 14:54:39.934325 after 0.84 seconds
[0m14:54:39.934802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb792d3a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb7943fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb7d078650>]}
[0m14:54:39.935197 [debug] [MainThread]: Flushing usage events
[0m14:56:23.502128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045f7cf8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045f7cfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045f652710>]}


============================== 14:56:23.504891 | 1e0e3ee0-c566-4a99-be24-d6b94d7054a5 ==============================
[0m14:56:23.504891 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:56:23.505375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:56:23.642234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e0e3ee0-c566-4a99-be24-d6b94d7054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045f65c750>]}
[0m14:56:23.689971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e0e3ee0-c566-4a99-be24-d6b94d7054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730463344c50>]}
[0m14:56:23.690690 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:56:23.699533 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m14:56:23.810038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:23.810430 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:23.851637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e0e3ee0-c566-4a99-be24-d6b94d7054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045dcd1390>]}
[0m14:56:23.862592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e0e3ee0-c566-4a99-be24-d6b94d7054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045dd4b7d0>]}
[0m14:56:23.863091 [info ] [MainThread]: Found 5 seeds, 10 models, 8 data tests, 415 macros
[0m14:56:23.863391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e0e3ee0-c566-4a99-be24-d6b94d7054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045f64c490>]}
[0m14:56:23.865619 [info ] [MainThread]: 
[0m14:56:23.866152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:23.870813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db_public'
[0m14:56:23.913262 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:56:23.913663 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m14:56:23.913910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:23.918534 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:23.919029 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m14:56:23.919350 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:56:23.921933 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
[0m14:56:23.923458 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m14:56:23.923878 [debug] [ThreadPool]: On list_my_db_public: Close
[0m14:56:23.931423 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:23.931803 [debug] [MainThread]: On master: BEGIN
[0m14:56:23.932066 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:23.935306 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m14:56:23.935705 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:23.936083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:56:23.951975 [debug] [MainThread]: SQL status: SELECT 14 in 0.0 seconds
[0m14:56:23.955900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e0e3ee0-c566-4a99-be24-d6b94d7054a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045dd6b4d0>]}
[0m14:56:23.956301 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:23.956809 [debug] [MainThread]: On master: Close
[0m14:56:23.957254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:56:23.957599 [info ] [MainThread]: 
[0m14:56:23.959690 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Appointment
[0m14:56:23.960184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now seed.dbt_modeling.Appointment)
[0m14:56:23.960518 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Appointment
[0m14:56:23.967755 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Appointment
[0m14:56:23.968601 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Appointment
[0m14:56:23.969188 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Billing
[0m14:56:23.970394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Appointment, now seed.dbt_modeling.Billing)
[0m14:56:23.970952 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Billing
[0m14:56:23.972994 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Billing
[0m14:56:23.973803 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Billing
[0m14:56:23.974204 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Doctor
[0m14:56:23.974843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Billing, now seed.dbt_modeling.Doctor)
[0m14:56:23.975186 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Doctor
[0m14:56:23.977396 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Doctor
[0m14:56:23.978219 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Doctor
[0m14:56:23.978630 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Medical_Procedure
[0m14:56:23.978983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Doctor, now seed.dbt_modeling.Medical_Procedure)
[0m14:56:23.979286 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Medical_Procedure
[0m14:56:23.981168 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Medical_Procedure
[0m14:56:23.981784 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Medical_Procedure
[0m14:56:23.982124 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Patient
[0m14:56:23.982466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Medical_Procedure, now seed.dbt_modeling.Patient)
[0m14:56:23.982770 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Patient
[0m14:56:23.984785 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Patient
[0m14:56:23.985991 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Patient
[0m14:56:23.986746 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m14:56:23.987477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Patient, now model.dbt_modeling.stg_appointment)
[0m14:56:23.987872 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m14:56:23.990864 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m14:56:23.991423 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m14:56:23.992197 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m14:56:23.992595 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m14:56:23.993002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.stg_appointment, now model.dbt_modeling.dim_billing)
[0m14:56:23.993307 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m14:56:23.996054 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m14:56:23.996546 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m14:56:23.997168 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m14:56:23.997532 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m14:56:23.997880 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.dim_billing, now model.dbt_modeling.stg_billing)
[0m14:56:23.998192 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m14:56:24.001300 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m14:56:24.001876 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m14:56:24.002547 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m14:56:24.002918 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_doctor
[0m14:56:24.003261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.stg_billing, now model.dbt_modeling.dim_doctor)
[0m14:56:24.003576 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_doctor
[0m14:56:24.006159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_doctor"
[0m14:56:24.006633 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_doctor
[0m14:56:24.007407 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_doctor
[0m14:56:24.007755 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m14:56:24.008092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.dim_doctor, now model.dbt_modeling.dim_medical_procedure)
[0m14:56:24.008416 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m14:56:24.010870 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m14:56:24.011501 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m14:56:24.012146 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m14:56:24.012495 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_doctor
[0m14:56:24.012875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.dim_medical_procedure, now model.dbt_modeling.stg_doctor)
[0m14:56:24.013179 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_doctor
[0m14:56:24.016047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_doctor"
[0m14:56:24.016862 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_doctor
[0m14:56:24.017579 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_doctor
[0m14:56:24.017931 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_medical_procedure
[0m14:56:24.018400 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.stg_doctor, now model.dbt_modeling.stg_medical_procedure)
[0m14:56:24.018768 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_medical_procedure
[0m14:56:24.021481 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_medical_procedure"
[0m14:56:24.021972 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_medical_procedure
[0m14:56:24.022589 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_medical_procedure
[0m14:56:24.022931 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_patient
[0m14:56:24.023270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.stg_medical_procedure, now model.dbt_modeling.stg_patient)
[0m14:56:24.023611 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_patient
[0m14:56:24.026172 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_patient"
[0m14:56:24.026680 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_patient
[0m14:56:24.027292 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_patient
[0m14:56:24.027667 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:56:24.028015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.stg_patient, now test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def)
[0m14:56:24.028329 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:56:24.041655 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def"
[0m14:56:24.042286 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:56:24.042976 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def
[0m14:56:24.043325 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:56:24.043687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_billing_invoice_id.5769994def, now test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad)
[0m14:56:24.044009 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:56:24.049853 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad"
[0m14:56:24.050317 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:56:24.050939 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad
[0m14:56:24.051262 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:56:24.051598 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_billing_invoice_id.0fc1b3c7ad, now test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5)
[0m14:56:24.051893 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:56:24.055871 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5"
[0m14:56:24.056394 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:56:24.057053 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5
[0m14:56:24.057408 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:56:24.057750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_doctor_doctor_id.608c9150a5, now test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb)
[0m14:56:24.058049 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:56:24.061692 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb"
[0m14:56:24.062219 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:56:24.062811 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb
[0m14:56:24.063145 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:56:24.063481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_doctor_doctor_id.209e4831bb, now test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c)
[0m14:56:24.063779 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:56:24.067365 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c"
[0m14:56:24.067930 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:56:24.068550 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c
[0m14:56:24.068889 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:56:24.069241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_medical_procedure_procedure_id.d8c834430c, now test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5)
[0m14:56:24.069570 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:56:24.073453 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5"
[0m14:56:24.074048 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:56:24.074683 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5
[0m14:56:24.075020 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m14:56:24.075371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.unique_dim_medical_procedure_procedure_id.11eab700f5, now model.dbt_modeling.dim_patient)
[0m14:56:24.075664 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m14:56:24.078418 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m14:56:24.079057 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m14:56:24.079717 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m14:56:24.080478 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fact_appointment
[0m14:56:24.080843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.dim_patient, now model.dbt_modeling.fact_appointment)
[0m14:56:24.081156 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fact_appointment
[0m14:56:24.084933 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fact_appointment"
[0m14:56:24.085443 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fact_appointment
[0m14:56:24.086093 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fact_appointment
[0m14:56:24.086542 [debug] [Thread-1 (]: Began running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:56:24.086918 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_modeling.fact_appointment, now test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d)
[0m14:56:24.087228 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:56:24.091392 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d"
[0m14:56:24.091950 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:56:24.092576 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d
[0m14:56:24.092937 [debug] [Thread-1 (]: Began running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:56:24.093280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_modeling.not_null_dim_patient_patient_id.57b243776d, now test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61)
[0m14:56:24.093599 [debug] [Thread-1 (]: Began compiling node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:56:24.097304 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61"
[0m14:56:24.097876 [debug] [Thread-1 (]: Began executing node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:56:24.098540 [debug] [Thread-1 (]: Finished running node test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61
[0m14:56:24.099449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:24.099723 [debug] [MainThread]: Connection 'test.dbt_modeling.unique_dim_patient_patient_id.a04074ae61' was properly closed.
[0m14:56:24.103049 [debug] [MainThread]: Command end result
[0m14:56:24.184401 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:56:24.184705 [info ] [MainThread]: Building catalog
[0m14:56:24.194889 [debug] [ThreadPool]: Acquiring new postgres connection 'my_db.information_schema'
[0m14:56:24.203791 [debug] [ThreadPool]: Using postgres connection "my_db.information_schema"
[0m14:56:24.204196 [debug] [ThreadPool]: On my_db.information_schema: BEGIN
[0m14:56:24.204470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:24.208141 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m14:56:24.208515 [debug] [ThreadPool]: Using postgres connection "my_db.information_schema"
[0m14:56:24.208908 [debug] [ThreadPool]: On my_db.information_schema: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "my_db.information_schema"} */

    
    

    select
        'my_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_billing')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_patient')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('Patient')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('Doctor')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_billing')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_medical_procedure')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_patient')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('Appointment')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('Medical_Procedure')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_doctor')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('Billing')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_medical_procedure')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('fact_appointment')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_appointment')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_doctor')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:56:24.212922 [debug] [ThreadPool]: SQL status: SELECT 56 in 0.0 seconds
[0m14:56:24.218687 [debug] [ThreadPool]: On my_db.information_schema: ROLLBACK
[0m14:56:24.219265 [debug] [ThreadPool]: On my_db.information_schema: Close
[0m14:56:24.256120 [info ] [MainThread]: Catalog written to /usr/app/dbt/target/catalog.json
[0m14:56:24.257108 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.7972699, "process_user_time": 1.784592, "process_kernel_time": 0.126971, "process_mem_max_rss": "111420", "process_out_blocks": "5120", "process_in_blocks": "0"}
[0m14:56:24.257712 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:56:24.257613 after 0.80 seconds
[0m14:56:24.257990 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:56:24.258222 [debug] [MainThread]: Connection 'my_db.information_schema' was properly closed.
[0m14:56:24.258510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730463725850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045f7cff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73045ce428d0>]}
[0m14:56:24.258821 [debug] [MainThread]: Flushing usage events
[0m14:59:18.101834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f1290fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f12792b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f12792850>]}


============================== 14:59:18.104618 | 3d5f476e-0977-4283-96e6-a5eade310908 ==============================
[0m14:59:18.104618 [info ] [MainThread]: Running with dbt=1.8.3
[0m14:59:18.105108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:59:18.236321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d5f476e-0977-4283-96e6-a5eade310908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f127c9350>]}
[0m14:59:18.283189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d5f476e-0977-4283-96e6-a5eade310908', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f1646cd50>]}
[0m15:01:38.428518 [error] [MainThread]: Encountered an error:

[0m15:01:38.431349 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:01:38.432736 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 140.37408, "process_user_time": 1.365923, "process_kernel_time": 0.120047, "process_mem_max_rss": "100968", "process_out_blocks": "3160", "command_success": false, "process_in_blocks": "0"}
[0m15:01:38.433644 [debug] [MainThread]: Command `dbt docs serve` failed at 15:01:38.433478 after 140.38 seconds
[0m15:01:38.434168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f1290fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f166d8dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1f12788c90>]}
[0m15:01:38.434767 [debug] [MainThread]: Flushing usage events
[0m15:01:48.961837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767625746810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767625702dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767625727c10>]}


============================== 15:01:48.970313 | 29e7ffcc-7d0d-45b5-b897-96e74d2e48c9 ==============================
[0m15:01:48.970313 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:01:48.971942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs serve --port 8081', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:01:49.128950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29e7ffcc-7d0d-45b5-b897-96e74d2e48c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767625702c10>]}
[0m15:01:49.176292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29e7ffcc-7d0d-45b5-b897-96e74d2e48c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767629430ed0>]}
[0m15:02:42.490018 [error] [MainThread]: Encountered an error:

[0m15:02:42.498351 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:02:42.502436 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 53.65202, "process_user_time": 1.413922, "process_kernel_time": 0.103213, "process_mem_max_rss": "99356", "process_out_blocks": "2968", "command_success": false, "process_in_blocks": "0"}
[0m15:02:42.505763 [debug] [MainThread]: Command `dbt docs serve` failed at 15:02:42.505071 after 53.66 seconds
[0m15:02:42.507900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7676296a4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767625750290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767623e14490>]}
[0m15:02:42.510394 [debug] [MainThread]: Flushing usage events
[0m15:03:21.789980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564949ad350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x756494b2bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75649498e990>]}


============================== 15:03:21.792905 | d4ece4ed-c5c2-4901-bdbd-0af01537cc24 ==============================
[0m15:03:21.792905 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:03:21.793520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8081', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:03:21.961659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4ece4ed-c5c2-4901-bdbd-0af01537cc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564948f21d0>]}
[0m15:03:22.021287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4ece4ed-c5c2-4901-bdbd-0af01537cc24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75649866c1d0>]}
[0m15:03:55.977814 [error] [MainThread]: Encountered an error:

[0m15:03:55.984956 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:03:55.988601 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 34.251617, "process_user_time": 1.684403, "process_kernel_time": 0.12903, "process_mem_max_rss": "99020", "process_out_blocks": "2976", "command_success": false, "process_in_blocks": "0"}
[0m15:03:55.991233 [debug] [MainThread]: Command `dbt docs serve` failed at 15:03:55.990669 after 34.25 seconds
[0m15:03:55.992938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564988f4fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564949ade10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7564949ad450>]}
[0m15:03:55.994817 [debug] [MainThread]: Flushing usage events
[0m15:04:00.983957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c801da0b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c801d9e5710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c801da0b010>]}


============================== 15:04:00.986526 | 5e1c0705-a43f-493b-8796-1630294091d2 ==============================
[0m15:04:00.986526 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:04:00.987026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8081', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:04:01.119885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e1c0705-a43f-493b-8796-1630294091d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c801d8f87d0>]}
[0m15:04:01.167042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e1c0705-a43f-493b-8796-1630294091d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c80217487d0>]}
[0m15:04:50.996854 [error] [MainThread]: Encountered an error:

[0m15:04:51.005176 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 101, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 247, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 294, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/main.py", line 303, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/local/lib/python3.11/socketserver.py", line 233, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:04:51.009196 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 50.07003, "process_user_time": 1.347901, "process_kernel_time": 0.114501, "process_mem_max_rss": "98976", "process_out_blocks": "2968", "command_success": false, "process_in_blocks": "0"}
[0m15:04:51.012613 [debug] [MainThread]: Command `dbt docs serve` failed at 15:04:51.011779 after 50.07 seconds
[0m15:04:51.014862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c801da35b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c801da2a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c801d9e7b90>]}
[0m15:04:51.016740 [debug] [MainThread]: Flushing usage events
[0m15:06:25.770513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d3de3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d3dc3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d51fddd0>]}


============================== 15:06:25.773004 | 059a06c6-9c01-4a0d-a315-d91d4d317da1 ==============================
[0m15:06:25.773004 [info ] [MainThread]: Running with dbt=1.8.3
[0m15:06:25.773542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve --host 0.0.0.0 --port 8080', 'send_anonymous_usage_stats': 'True'}
[0m15:06:25.918362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '059a06c6-9c01-4a0d-a315-d91d4d317da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d3c12450>]}
[0m15:06:25.967665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '059a06c6-9c01-4a0d-a315-d91d4d317da1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7827d7a94d90>]}
