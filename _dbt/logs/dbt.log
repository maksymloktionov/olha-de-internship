[0m07:36:57.354102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d7900ef9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78ff26e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d79020c150>]}


============================== 07:36:57.359722 | 418b0303-12d3-469d-a50d-51a2553eee22 ==============================
[0m07:36:57.359722 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:36:57.360233 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:36:57.486514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e64fe90>]}
[0m07:36:57.533298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e685550>]}
[0m07:36:57.534051 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:36:57.545269 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m07:36:57.546297 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m07:36:57.546947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e68a990>]}
[0m07:36:58.358294 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of `seed.dbt_modeling.Medical
Procedure`
[0m07:36:58.359014 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. For more information: https://docs.getdbt.com
/reference/global-configs/legacy-behaviors#require_resource_names_without_spaces
Run again with `--debug` to see them all.
[0m07:36:58.359493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e4c9710>]}
[0m07:36:58.366864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78fe3ac90>]}
[0m07:36:58.428870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e4d4a50>]}
[0m07:36:58.429355 [info ] [MainThread]: Found 5 seeds, 415 macros
[0m07:36:58.429766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e45f390>]}
[0m07:36:58.431660 [info ] [MainThread]: 
[0m07:36:58.432186 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:36:58.436739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m07:36:58.525634 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m07:36:58.526213 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m07:36:58.526661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:36:58.535760 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m07:36:58.537108 [debug] [ThreadPool]: On list_my_db: Close
[0m07:36:58.538713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m07:36:58.544738 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m07:36:58.545087 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m07:36:58.545354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:36:58.548921 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.549293 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m07:36:58.549617 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:36:58.552529 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:36:58.553778 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m07:36:58.554245 [debug] [ThreadPool]: On list_my_db_public: Close
[0m07:36:58.558944 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.559299 [debug] [MainThread]: On master: BEGIN
[0m07:36:58.559569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:36:58.562886 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.563273 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.563711 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:36:58.566834 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:36:58.568097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e45fa10>]}
[0m07:36:58.568505 [debug] [MainThread]: On master: ROLLBACK
[0m07:36:58.569104 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.569402 [debug] [MainThread]: On master: BEGIN
[0m07:36:58.569994 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.570299 [debug] [MainThread]: On master: COMMIT
[0m07:36:58.570584 [debug] [MainThread]: Using postgres connection "master"
[0m07:36:58.570843 [debug] [MainThread]: On master: COMMIT
[0m07:36:58.571262 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:36:58.571570 [debug] [MainThread]: On master: Close
[0m07:36:58.572011 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:36:58.572332 [info ] [MainThread]: 
[0m07:36:58.580587 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Appointment
[0m07:36:58.581157 [info ] [Thread-1 (]: 1 of 5 START seed file public.Appointment ...................................... [RUN]
[0m07:36:58.581713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now seed.dbt_modeling.Appointment)
[0m07:36:58.582056 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Appointment
[0m07:36:58.582395 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Appointment
[0m07:36:58.670407 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:58.670780 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: BEGIN
[0m07:36:58.671077 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:58.674488 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:36:58.674900 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:58.675190 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Appointment"} */

    create table "my_db"."public"."Appointment" ("AppointmentID" integer,"Date" date,"Time" timestamp without time zone,"PatientID" integer,"DoctorID" integer)
  
[0m07:36:58.676747 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:36:59.204518 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:59.204929 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: 
          insert into "my_db"."public"."Appointment" ("AppointmentID", "Date", "Time", "PatientID", "DoctorID") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%...
[0m07:36:59.218942 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:36:59.224071 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Appointment"
[0m07:36:59.239045 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: COMMIT
[0m07:36:59.239384 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Appointment"
[0m07:36:59.239669 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: COMMIT
[0m07:36:59.247876 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:36:59.249750 [debug] [Thread-1 (]: On seed.dbt_modeling.Appointment: Close
[0m07:36:59.251118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d779fd0>]}
[0m07:36:59.251712 [info ] [Thread-1 (]: 1 of 5 OK loaded seed file public.Appointment .................................. [[32mINSERT 1000[0m in 0.67s]
[0m07:36:59.252464 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Appointment
[0m07:36:59.252912 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Billing
[0m07:36:59.253380 [info ] [Thread-1 (]: 2 of 5 START seed file public.Billing .......................................... [RUN]
[0m07:36:59.253962 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Appointment, now seed.dbt_modeling.Billing)
[0m07:36:59.254303 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Billing
[0m07:36:59.254634 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Billing
[0m07:36:59.275249 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.275717 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: BEGIN
[0m07:36:59.276020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:59.279537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:36:59.279985 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.280295 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Billing"} */

    create table "my_db"."public"."Billing" ("InvoiceID" text,"PatientID" integer,"Items" text,"Amount" integer)
  
[0m07:36:59.283162 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:36:59.677815 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.678222 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: 
          insert into "my_db"."public"."Billing" ("InvoiceID", "PatientID", "Items", "Amount") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,...
[0m07:36:59.685965 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:36:59.686786 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Billing"
[0m07:36:59.688434 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: COMMIT
[0m07:36:59.688728 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Billing"
[0m07:36:59.689014 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: COMMIT
[0m07:36:59.697054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:36:59.698037 [debug] [Thread-1 (]: On seed.dbt_modeling.Billing: Close
[0m07:36:59.698674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78e648250>]}
[0m07:36:59.699130 [info ] [Thread-1 (]: 2 of 5 OK loaded seed file public.Billing ...................................... [[32mINSERT 1000[0m in 0.44s]
[0m07:36:59.699764 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Billing
[0m07:36:59.700239 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Doctor
[0m07:36:59.700821 [info ] [Thread-1 (]: 3 of 5 START seed file public.Doctor ........................................... [RUN]
[0m07:36:59.701284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Billing, now seed.dbt_modeling.Doctor)
[0m07:36:59.701646 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Doctor
[0m07:36:59.701944 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Doctor
[0m07:36:59.715666 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:36:59.716118 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: BEGIN
[0m07:36:59.716432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:36:59.720163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:36:59.720618 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:36:59.720937 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Doctor"} */

    create table "my_db"."public"."Doctor" ("DoctorID" integer,"DoctorName" text,"Specialization" text,"DoctorContact" text)
  
[0m07:36:59.723987 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:37:00.121959 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:37:00.122367 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: 
          insert into "my_db"."public"."Doctor" ("DoctorID", "DoctorName", "Specialization", "DoctorContact") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s...
[0m07:37:00.129443 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:37:00.130235 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Doctor"
[0m07:37:00.131739 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: COMMIT
[0m07:37:00.132032 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Doctor"
[0m07:37:00.132290 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: COMMIT
[0m07:37:00.140640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.141626 [debug] [Thread-1 (]: On seed.dbt_modeling.Doctor: Close
[0m07:37:00.142167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d68a0d0>]}
[0m07:37:00.142661 [info ] [Thread-1 (]: 3 of 5 OK loaded seed file public.Doctor ....................................... [[32mINSERT 1000[0m in 0.44s]
[0m07:37:00.143272 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Doctor
[0m07:37:00.143826 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Medical Procedure
[0m07:37:00.144325 [info ] [Thread-1 (]: 4 of 5 START seed file public.Medical Procedure ................................ [RUN]
[0m07:37:00.144795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Doctor, now seed.dbt_modeling.Medical Procedure)
[0m07:37:00.145114 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Medical Procedure
[0m07:37:00.145414 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Medical Procedure
[0m07:37:00.164530 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.164961 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: BEGIN
[0m07:37:00.165369 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:00.169272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:37:00.169812 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.170170 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Medical Procedure"} */

    create table "my_db"."public"."Medical Procedure" ("ProcedureID" integer,"ProcedureName" text,"AppointmentID" integer)
  
[0m07:37:00.173028 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:37:00.470189 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.470616 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: 
          insert into "my_db"."public"."Medical Procedure" ("ProcedureID", "ProcedureName", "AppointmentID") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),...
[0m07:37:00.476646 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:37:00.477365 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.478949 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: COMMIT
[0m07:37:00.479262 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Medical Procedure"
[0m07:37:00.479577 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: COMMIT
[0m07:37:00.488238 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.489073 [debug] [Thread-1 (]: On seed.dbt_modeling.Medical Procedure: Close
[0m07:37:00.489550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d651d50>]}
[0m07:37:00.490017 [info ] [Thread-1 (]: 4 of 5 OK loaded seed file public.Medical Procedure ............................ [[32mINSERT 1000[0m in 0.34s]
[0m07:37:00.490673 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Medical Procedure
[0m07:37:00.491244 [debug] [Thread-1 (]: Began running node seed.dbt_modeling.Patient
[0m07:37:00.492273 [info ] [Thread-1 (]: 5 of 5 START seed file public.Patient .......................................... [RUN]
[0m07:37:00.493058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_modeling.Medical Procedure, now seed.dbt_modeling.Patient)
[0m07:37:00.493529 [debug] [Thread-1 (]: Began compiling node seed.dbt_modeling.Patient
[0m07:37:00.493838 [debug] [Thread-1 (]: Began executing node seed.dbt_modeling.Patient
[0m07:37:00.509310 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.509811 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: BEGIN
[0m07:37:00.510250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:37:00.514126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m07:37:00.514625 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.514952 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "seed.dbt_modeling.Patient"} */

    create table "my_db"."public"."Patient" ("PatientID" integer,"firstname" text,"lastname" text,"email" text)
  
[0m07:37:00.517700 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.0 seconds
[0m07:37:00.904974 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.905403 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: 
          insert into "my_db"."public"."Patient" ("PatientID", "firstname", "lastname", "email") values
          (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m07:37:00.912383 [debug] [Thread-1 (]: SQL status: INSERT 0 1000 in 0.0 seconds
[0m07:37:00.913143 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_modeling.Patient"
[0m07:37:00.914580 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: COMMIT
[0m07:37:00.914877 [debug] [Thread-1 (]: Using postgres connection "seed.dbt_modeling.Patient"
[0m07:37:00.915129 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: COMMIT
[0m07:37:00.923294 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.924313 [debug] [Thread-1 (]: On seed.dbt_modeling.Patient: Close
[0m07:37:00.924875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '418b0303-12d3-469d-a50d-51a2553eee22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78d646150>]}
[0m07:37:00.925368 [info ] [Thread-1 (]: 5 of 5 OK loaded seed file public.Patient ...................................... [[32mINSERT 1000[0m in 0.43s]
[0m07:37:00.925969 [debug] [Thread-1 (]: Finished running node seed.dbt_modeling.Patient
[0m07:37:00.927215 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:00.927552 [debug] [MainThread]: On master: BEGIN
[0m07:37:00.927872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:37:00.930690 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:37:00.931065 [debug] [MainThread]: On master: COMMIT
[0m07:37:00.931368 [debug] [MainThread]: Using postgres connection "master"
[0m07:37:00.931677 [debug] [MainThread]: On master: COMMIT
[0m07:37:00.932094 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:37:00.932402 [debug] [MainThread]: On master: Close
[0m07:37:00.932860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:00.933169 [debug] [MainThread]: Connection 'seed.dbt_modeling.Patient' was properly closed.
[0m07:37:00.933713 [info ] [MainThread]: 
[0m07:37:00.934269 [info ] [MainThread]: Finished running 5 seeds in 0 hours 0 minutes and 2.50 seconds (2.50s).
[0m07:37:00.935878 [debug] [MainThread]: Command end result
[0m07:37:00.962507 [info ] [MainThread]: 
[0m07:37:00.963016 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:37:00.963430 [info ] [MainThread]: 
[0m07:37:00.963799 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:37:00.964573 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.650707, "process_user_time": 4.554528, "process_kernel_time": 0.137743, "process_mem_max_rss": "115548", "process_out_blocks": "2800", "process_in_blocks": "0"}
[0m07:37:00.965041 [debug] [MainThread]: Command `dbt seed` succeeded at 07:37:00.964940 after 3.65 seconds
[0m07:37:00.965356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78ff53850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d78ff99850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d793d586d0>]}
[0m07:37:00.965679 [debug] [MainThread]: Flushing usage events
[0m07:45:20.235188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb0d6f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb11b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb297950>]}


============================== 07:45:20.237822 | f525dd9f-8a41-4bed-a8e0-09d1fdeb0d4a ==============================
[0m07:45:20.237822 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:45:20.238302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m07:45:20.245177 [info ] [MainThread]: dbt version: 1.8.3
[0m07:45:20.245801 [info ] [MainThread]: python version: 3.11.2
[0m07:45:20.246274 [info ] [MainThread]: python path: /usr/local/bin/python
[0m07:45:20.246694 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.31
[0m07:45:20.301291 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m07:45:20.301736 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m07:45:20.302048 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m07:45:20.302529 [info ] [MainThread]: adapter type: postgres
[0m07:45:20.302838 [info ] [MainThread]: adapter version: 1.8.2
[0m07:45:20.395828 [info ] [MainThread]: Configuration:
[0m07:45:20.396332 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m07:45:20.396743 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m07:45:20.397056 [info ] [MainThread]: Required dependencies:
[0m07:45:20.397398 [debug] [MainThread]: Executing "git --help"
[0m07:45:20.399150 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m07:45:20.399595 [debug] [MainThread]: STDERR: "b''"
[0m07:45:20.399908 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m07:45:20.400204 [info ] [MainThread]: Connection:
[0m07:45:20.400557 [info ] [MainThread]:   host: db
[0m07:45:20.400858 [info ] [MainThread]:   port: 5432
[0m07:45:20.401142 [info ] [MainThread]:   user: user
[0m07:45:20.401431 [info ] [MainThread]:   database: my_db
[0m07:45:20.401768 [info ] [MainThread]:   schema: public
[0m07:45:20.402108 [info ] [MainThread]:   connect_timeout: 10
[0m07:45:20.402473 [info ] [MainThread]:   role: None
[0m07:45:20.402812 [info ] [MainThread]:   search_path: None
[0m07:45:20.403114 [info ] [MainThread]:   keepalives_idle: 0
[0m07:45:20.403436 [info ] [MainThread]:   sslmode: None
[0m07:45:20.403746 [info ] [MainThread]:   sslcert: None
[0m07:45:20.404045 [info ] [MainThread]:   sslkey: None
[0m07:45:20.404377 [info ] [MainThread]:   sslrootcert: None
[0m07:45:20.404712 [info ] [MainThread]:   application_name: dbt
[0m07:45:20.405032 [info ] [MainThread]:   retries: 1
[0m07:45:20.405659 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:45:20.407662 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m07:45:20.438077 [debug] [MainThread]: Using postgres connection "debug"
[0m07:45:20.438469 [debug] [MainThread]: On debug: select 1 as id
[0m07:45:20.438745 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:45:20.443534 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m07:45:20.444923 [debug] [MainThread]: On debug: Close
[0m07:45:20.445432 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m07:45:20.445876 [info ] [MainThread]: [32mAll checks passed![0m
[0m07:45:20.446984 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.25241503, "process_user_time": 1.274704, "process_kernel_time": 0.111798, "process_mem_max_rss": "104772", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m07:45:20.447763 [debug] [MainThread]: Command `dbt debug` succeeded at 07:45:20.447575 after 0.25 seconds
[0m07:45:20.448209 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m07:45:20.448696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cb297dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36cf1c97d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36c987c0d0>]}
[0m07:45:20.449227 [debug] [MainThread]: Flushing usage events
[0m07:47:23.289031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a13ba4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a13add10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a152b810>]}


============================== 07:47:23.291525 | f7e5e815-b0ab-4c5f-a314-01cbadf094cd ==============================
[0m07:47:23.291525 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:47:23.291990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:47:23.420274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699fa8ef50>]}
[0m07:47:23.466002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699fad2550>]}
[0m07:47:23.466716 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:47:23.476096 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m07:47:23.546992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:47:23.547320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:47:23.547636 [warn ] [MainThread]: [[33mWARNING[0m]: Found spaces in the name of `seed.dbt_modeling.Medical
Procedure`
[0m07:47:23.548016 [warn ] [MainThread]: [[33mWARNING[0m]: Spaces found in 1 resource name(s). This is deprecated, and
may lead to errors when using dbt. For more information: https://docs.getdbt.com
/reference/global-configs/legacy-behaviors#require_resource_names_without_spaces
Run again with `--debug` to see them all.
[0m07:47:23.548326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699f9c5ed0>]}
[0m07:47:23.570091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699fa76950>]}
[0m07:47:23.626856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699f8f54d0>]}
[0m07:47:23.627305 [info ] [MainThread]: Found 5 seeds, 415 macros
[0m07:47:23.627640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7e5e815-b0ab-4c5f-a314-01cbadf094cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d699f944690>]}
[0m07:47:23.629117 [info ] [MainThread]: 
[0m07:47:23.629448 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:47:23.631079 [debug] [MainThread]: Command end result
[0m07:47:23.654901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4060835, "process_user_time": 1.423436, "process_kernel_time": 0.12686, "process_mem_max_rss": "102304", "process_out_blocks": "1608", "process_in_blocks": "0"}
[0m07:47:23.655402 [debug] [MainThread]: Command `dbt run` succeeded at 07:47:23.655297 after 0.41 seconds
[0m07:47:23.655737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a5258510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a51646d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d69a52e8cd0>]}
[0m07:47:23.656062 [debug] [MainThread]: Flushing usage events
[0m07:47:57.546246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4d7f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4c740810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4baefb50>]}


============================== 07:47:57.548794 | 8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28 ==============================
[0m07:47:57.548794 [info ] [MainThread]: Running with dbt=1.8.3
[0m07:47:57.549283 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m07:47:57.680339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4ba3d310>]}
[0m07:47:57.726084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4f7ec650>]}
[0m07:47:57.726818 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m07:47:57.735575 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m07:47:57.804221 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m07:47:57.804687 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://seeds/Medical_Procedure.csv
[0m07:47:57.804969 [debug] [MainThread]: Partial parsing: deleted file: dbt_modeling://seeds/Medical Procedure.csv
[0m07:47:57.960584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4a2524d0>]}
[0m07:47:58.011608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4a11df50>]}
[0m07:47:58.012094 [info ] [MainThread]: Found 5 seeds, 415 macros
[0m07:47:58.012383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ae3e1a5-ed84-40cb-9a88-8bd4198b5a28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba49eb9d50>]}
[0m07:47:58.013874 [info ] [MainThread]: 
[0m07:47:58.014179 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:47:58.014722 [debug] [MainThread]: Command end result
[0m07:47:58.037151 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.53253675, "process_user_time": 1.571654, "process_kernel_time": 0.101912, "process_mem_max_rss": "104364", "process_out_blocks": "2392", "process_in_blocks": "0"}
[0m07:47:58.037706 [debug] [MainThread]: Command `dbt run` succeeded at 07:47:58.037599 after 0.53 seconds
[0m07:47:58.038080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4bb11390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4bb13190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ba4f8dc750>]}
[0m07:47:58.038400 [debug] [MainThread]: Flushing usage events
[0m08:12:06.550398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d37110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d16e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a443416e010>]}


============================== 08:12:06.552865 | 8d3b41a5-9fa8-4508-ac0c-6fb67e76ec63 ==============================
[0m08:12:06.552865 [info ] [MainThread]: Running with dbt=1.8.3
[0m08:12:06.553322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:12:06.560063 [info ] [MainThread]: dbt version: 1.8.3
[0m08:12:06.560484 [info ] [MainThread]: python version: 3.11.2
[0m08:12:06.560863 [info ] [MainThread]: python path: /usr/local/bin/python
[0m08:12:06.561189 [info ] [MainThread]: os info: Linux-6.8.0-45-generic-x86_64-with-glibc2.31
[0m08:12:06.616994 [info ] [MainThread]: Using profiles dir at /usr/app/dbt
[0m08:12:06.617466 [info ] [MainThread]: Using profiles.yml file at /usr/app/dbt/profiles.yml
[0m08:12:06.617849 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt/dbt_project.yml
[0m08:12:06.618366 [info ] [MainThread]: adapter type: postgres
[0m08:12:06.618661 [info ] [MainThread]: adapter version: 1.8.2
[0m08:12:06.702726 [info ] [MainThread]: Configuration:
[0m08:12:06.703164 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m08:12:06.703497 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m08:12:06.703844 [info ] [MainThread]: Required dependencies:
[0m08:12:06.704128 [debug] [MainThread]: Executing "git --help"
[0m08:12:06.705797 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m08:12:06.706168 [debug] [MainThread]: STDERR: "b''"
[0m08:12:06.706444 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m08:12:06.706685 [info ] [MainThread]: Connection:
[0m08:12:06.706976 [info ] [MainThread]:   host: db
[0m08:12:06.707229 [info ] [MainThread]:   port: 5432
[0m08:12:06.707514 [info ] [MainThread]:   user: user
[0m08:12:06.707749 [info ] [MainThread]:   database: my_db
[0m08:12:06.708024 [info ] [MainThread]:   schema: public
[0m08:12:06.708261 [info ] [MainThread]:   connect_timeout: 10
[0m08:12:06.708524 [info ] [MainThread]:   role: None
[0m08:12:06.708869 [info ] [MainThread]:   search_path: None
[0m08:12:06.709178 [info ] [MainThread]:   keepalives_idle: 0
[0m08:12:06.709564 [info ] [MainThread]:   sslmode: None
[0m08:12:06.709932 [info ] [MainThread]:   sslcert: None
[0m08:12:06.710254 [info ] [MainThread]:   sslkey: None
[0m08:12:06.710542 [info ] [MainThread]:   sslrootcert: None
[0m08:12:06.710812 [info ] [MainThread]:   application_name: dbt
[0m08:12:06.711095 [info ] [MainThread]:   retries: 1
[0m08:12:06.711573 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m08:12:06.712936 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m08:12:06.741153 [debug] [MainThread]: Using postgres connection "debug"
[0m08:12:06.741657 [debug] [MainThread]: On debug: select 1 as id
[0m08:12:06.741953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:12:06.747815 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:12:06.748770 [debug] [MainThread]: On debug: Close
[0m08:12:06.749080 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m08:12:06.749441 [info ] [MainThread]: [32mAll checks passed![0m
[0m08:12:06.750277 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.23987165, "process_user_time": 1.276169, "process_kernel_time": 0.109928, "process_mem_max_rss": "104876", "process_out_blocks": "24", "process_in_blocks": "0"}
[0m08:12:06.750793 [debug] [MainThread]: Command `dbt debug` succeeded at 08:12:06.750683 after 0.24 seconds
[0m08:12:06.751089 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m08:12:06.751389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4433137510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d50e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a4432d349d0>]}
[0m08:12:06.751719 [debug] [MainThread]: Flushing usage events
[0m09:59:34.952325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95352a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953564c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95352ac50>]}


============================== 09:59:34.954975 | 27cea84a-ea6b-44c2-bebd-356dbd37bbe6 ==============================
[0m09:59:34.954975 [info ] [MainThread]: Running with dbt=1.8.3
[0m09:59:34.955523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m09:59:35.086272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27cea84a-ea6b-44c2-bebd-356dbd37bbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953458d50>]}
[0m09:59:35.132304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27cea84a-ea6b-44c2-bebd-356dbd37bbe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa951c75710>]}
[0m09:59:35.133039 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:59:35.142361 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m09:59:35.213872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m09:59:35.214442 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m09:59:35.214747 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m09:59:35.215022 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m09:59:35.215298 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m09:59:35.215578 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m09:59:35.215879 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m09:59:35.216144 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m09:59:35.216439 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m09:59:35.216698 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m09:59:35.216960 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m09:59:35.217218 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m09:59:35.398897 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  expected token 'end of print statement', got '{'
    line 6
      from {{ref{'Billing'}}}
[0m09:59:35.399752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.48984078, "process_user_time": 1.569898, "process_kernel_time": 0.104726, "process_mem_max_rss": "104040", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m09:59:35.400186 [debug] [MainThread]: Command `dbt run` failed at 09:59:35.400093 after 0.49 seconds
[0m09:59:35.400518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9536f3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953573350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa953571610>]}
[0m09:59:35.400809 [debug] [MainThread]: Flushing usage events
[0m10:00:01.788492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392d9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392da890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392d9910>]}


============================== 10:00:01.791260 | ac37b9cf-e7ff-4ef2-8f9b-f574d1a59921 ==============================
[0m10:00:01.791260 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:00:01.791794 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:00:01.926469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac37b9cf-e7ff-4ef2-8f9b-f574d1a59921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32392e4690>]}
[0m10:00:01.979530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac37b9cf-e7ff-4ef2-8f9b-f574d1a59921', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a323cf8c7d0>]}
[0m10:00:01.980292 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:00:01.990156 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:00:02.074706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:00:02.075185 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:00:02.075532 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:00:02.075819 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:00:02.076100 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:00:02.076393 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:00:02.076676 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:00:02.076957 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:00:02.077236 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:00:02.077521 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:00:02.077803 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:00:02.078068 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:00:02.266592 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  expected token 'end of print statement', got '{'
    line 6
      from {{ref{'Billing'}}}
[0m10:00:02.267459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5271763, "process_user_time": 1.675611, "process_kernel_time": 0.108909, "process_mem_max_rss": "104124", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m10:00:02.267923 [debug] [MainThread]: Command `dbt run` failed at 10:00:02.267826 after 0.53 seconds
[0m10:00:02.268250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a323945bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3239292dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a32376bc350>]}
[0m10:00:02.268655 [debug] [MainThread]: Flushing usage events
[0m10:01:15.313912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc61ae7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc6380090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc636f750>]}


============================== 10:01:15.316960 | 40b85ae8-a772-487d-8908-c37960118856 ==============================
[0m10:01:15.316960 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:01:15.317619 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:01:15.462167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40b85ae8-a772-487d-8908-c37960118856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc6221810>]}
[0m10:01:15.516984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40b85ae8-a772-487d-8908-c37960118856', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc9edc790>]}
[0m10:01:15.517838 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:01:15.528959 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:01:15.606553 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:01:15.607086 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:01:15.607439 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:01:15.607769 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:01:15.608097 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:01:15.608429 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:01:15.608754 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:01:15.609074 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:01:15.609403 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:01:15.609728 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:01:15.610071 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:01:15.610396 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:01:15.817677 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  expected token 'end of print statement', got '{'
    line 6
      from {{ref{'Billing'}}
[0m10:01:15.818661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5525623, "process_user_time": 1.597338, "process_kernel_time": 0.139854, "process_mem_max_rss": "104308", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m10:01:15.819223 [debug] [MainThread]: Command `dbt run` failed at 10:01:15.819107 after 0.55 seconds
[0m10:01:15.819625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc61f4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cc63800d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x731cca2c5890>]}
[0m10:01:15.819988 [debug] [MainThread]: Flushing usage events
[0m10:02:20.968977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc5d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc5fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc3ee50>]}


============================== 10:02:20.971972 | 138a316e-db16-48d1-89c8-840b8bd45246 ==============================
[0m10:02:20.971972 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:02:20.972620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:02:21.119819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '138a316e-db16-48d1-89c8-840b8bd45246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc8a550>]}
[0m10:02:21.175594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '138a316e-db16-48d1-89c8-840b8bd45246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109a3812d0>]}
[0m10:02:21.176386 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:02:21.185886 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:02:21.260252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:02:21.261067 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:02:21.261704 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:02:21.262053 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:02:21.262367 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:02:21.262673 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:02:21.263011 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:02:21.263309 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:02:21.263634 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:02:21.263943 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:02:21.264234 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:02:21.264531 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:02:21.459789 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_modeling.stg_medical_procedure' (models/staging/healthcare/stg_medical_procedure.sql) depends on a node named 'Medical_procedure' which was not found
[0m10:02:21.460853 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.54143715, "process_user_time": 1.753141, "process_kernel_time": 0.12094, "process_mem_max_rss": "104428", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m10:02:21.461461 [debug] [MainThread]: Command `dbt run` failed at 10:02:21.461351 after 0.54 seconds
[0m10:02:21.461830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bde80d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109bc5ef50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73109fbb8b50>]}
[0m10:02:21.462228 [debug] [MainThread]: Flushing usage events
[0m10:03:03.668381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb723d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abceba50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abcebe50>]}


============================== 10:03:03.670996 | 8a638b71-df0a-41a3-8f67-aebb9d2a080e ==============================
[0m10:03:03.670996 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:03:03.671683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:03:03.801309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576aa1fdfd0>]}
[0m10:03:03.848114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576af835090>]}
[0m10:03:03.848847 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:03:03.857590 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:03:03.933440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 11 files added, 0 files changed.
[0m10:03:03.933994 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_schema.yml
[0m10:03:03.934294 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m10:03:03.934595 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_billing.sql
[0m10:03:03.934864 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m10:03:03.935131 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:03:03.935399 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:03:03.935673 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m10:03:03.935948 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:03:03.936202 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:03:03.936461 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/marts/description/dim_patient.sql
[0m10:03:03.936712 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:03:04.169836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576a9f99190>]}
[0m10:03:04.238541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576a9f6a750>]}
[0m10:03:04.239003 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:03:04.239298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb5bc10>]}
[0m10:03:04.240730 [info ] [MainThread]: 
[0m10:03:04.241261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:04.242178 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:03:04.280197 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:03:04.280557 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:03:04.280831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:04.285428 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:03:04.286704 [debug] [ThreadPool]: On list_my_db: Close
[0m10:03:04.291678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:03:04.297524 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:04.297884 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:03:04.298136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:04.301290 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.301676 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:04.301969 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:03:04.304417 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:03:04.305774 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:03:04.306211 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:03:04.312602 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.313036 [debug] [MainThread]: On master: BEGIN
[0m10:03:04.313317 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:04.316508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.316872 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.317234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:04.325482 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:03:04.326675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576aa0c8090>]}
[0m10:03:04.327066 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:04.327589 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.327902 [debug] [MainThread]: On master: BEGIN
[0m10:03:04.328420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.328734 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.328992 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.329240 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.329615 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:04.329878 [debug] [MainThread]: On master: Close
[0m10:03:04.330311 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:04.330659 [info ] [MainThread]: 
[0m10:03:04.332583 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:03:04.333099 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:03:04.333582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:03:04.333979 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:03:04.341292 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:03:04.342073 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:03:04.378084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:03:04.378751 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:04.379059 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:03:04.379355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:04.382340 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.382755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:04.383091 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date ,
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment;
  );
[0m10:03:04.383647 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 12:     from "my_db"."public"."Appointment"        
             ^

[0m10:03:04.384059 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:03:04.384581 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:03:04.388211 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 12:     from "my_db"."public"."Appointment"        
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:04.389808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a638b71-df0a-41a3-8f67-aebb9d2a080e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576a9f54190>]}
[0m10:03:04.390540 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:03:04.391239 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:03:04.392882 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.393193 [debug] [MainThread]: On master: BEGIN
[0m10:03:04.393458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:04.396476 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:04.396962 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.397227 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:04.397484 [debug] [MainThread]: On master: COMMIT
[0m10:03:04.397923 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:04.398207 [debug] [MainThread]: On master: Close
[0m10:03:04.398629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:04.398887 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:03:04.399170 [info ] [MainThread]: 
[0m10:03:04.399542 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:03:04.400256 [debug] [MainThread]: Command end result
[0m10:03:04.430920 [info ] [MainThread]: 
[0m10:03:04.431403 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:03:04.431708 [info ] [MainThread]: 
[0m10:03:04.432097 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 12:     from "my_db"."public"."Appointment"        
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:04.432407 [info ] [MainThread]: 
[0m10:03:04.432717 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:03:04.433460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.808034, "process_user_time": 1.844303, "process_kernel_time": 0.131735, "process_mem_max_rss": "114076", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m10:03:04.433930 [debug] [MainThread]: Command `dbt run` failed at 10:03:04.433827 after 0.81 seconds
[0m10:03:04.434265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb73790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576abb71850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7576afaa8e10>]}
[0m10:03:04.434604 [debug] [MainThread]: Flushing usage events
[0m10:03:28.601216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4b1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4691d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4b2d90>]}


============================== 10:03:28.603935 | c58acae2-a985-47ac-b864-27ccae52ae8a ==============================
[0m10:03:28.603935 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:03:28.604549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:03:28.748355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4b1c90>]}
[0m10:03:28.798287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf379a10>]}
[0m10:03:28.799031 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:03:28.807934 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:03:28.903111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:03:28.903742 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:03:29.100844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cda51590>]}
[0m10:03:29.167914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cd8ddbd0>]}
[0m10:03:29.168413 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:03:29.168697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cda229d0>]}
[0m10:03:29.170297 [info ] [MainThread]: 
[0m10:03:29.170997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:29.171884 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:03:29.208972 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:03:29.209323 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:03:29.209591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:29.213881 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:03:29.215152 [debug] [ThreadPool]: On list_my_db: Close
[0m10:03:29.220902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:03:29.226730 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:29.227064 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:03:29.227315 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:03:29.230501 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.230923 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:03:29.231230 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:03:29.234000 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:03:29.235404 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:03:29.235851 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:03:29.242436 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.242775 [debug] [MainThread]: On master: BEGIN
[0m10:03:29.243025 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:29.246279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.246669 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.247021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:29.255323 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:03:29.256535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf36ff90>]}
[0m10:03:29.256921 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:29.257401 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.257753 [debug] [MainThread]: On master: BEGIN
[0m10:03:29.258356 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.258689 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.258954 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.259200 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.259620 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:29.259918 [debug] [MainThread]: On master: Close
[0m10:03:29.260359 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:03:29.260679 [info ] [MainThread]: 
[0m10:03:29.262689 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:03:29.263183 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:03:29.263668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:03:29.264034 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:03:29.273008 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:03:29.273738 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:03:29.310496 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:03:29.311135 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:29.311495 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:03:29.311824 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:03:29.315101 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.315584 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:03:29.316033 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment;
  );
[0m10:03:29.316788 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 14: select * from raw_appointment;
                                      ^

[0m10:03:29.317254 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:03:29.317852 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:03:29.321555 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near ";"
  LINE 14: select * from raw_appointment;
                                        ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:29.322982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c58acae2-a985-47ac-b864-27ccae52ae8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf6400d0>]}
[0m10:03:29.323588 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:03:29.324199 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:03:29.325781 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.326081 [debug] [MainThread]: On master: BEGIN
[0m10:03:29.326347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:29.329310 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:03:29.329737 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.330038 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:29.330292 [debug] [MainThread]: On master: COMMIT
[0m10:03:29.330747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:03:29.331037 [debug] [MainThread]: On master: Close
[0m10:03:29.331449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:29.331701 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:03:29.332004 [info ] [MainThread]: 
[0m10:03:29.332442 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:03:29.333277 [debug] [MainThread]: Command end result
[0m10:03:29.360571 [info ] [MainThread]: 
[0m10:03:29.361030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:03:29.361327 [info ] [MainThread]: 
[0m10:03:29.361719 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near ";"
  LINE 14: select * from raw_appointment;
                                        ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:03:29.362011 [info ] [MainThread]: 
[0m10:03:29.362309 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:03:29.363098 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80480886, "process_user_time": 1.946281, "process_kernel_time": 0.133539, "process_mem_max_rss": "113708", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:03:29.363742 [debug] [MainThread]: Command `dbt run` failed at 10:03:29.363609 after 0.81 seconds
[0m10:03:29.364133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf4bd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf45f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7935cf45f9d0>]}
[0m10:03:29.364510 [debug] [MainThread]: Flushing usage events
[0m10:04:02.327099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730117298a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011759cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730117252690>]}


============================== 10:04:02.330070 | f66d359a-95d7-45e6-938d-af4e2b335cab ==============================
[0m10:04:02.330070 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:04:02.330630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:04:02.472677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011597a6d0>]}
[0m10:04:02.520399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011af8c690>]}
[0m10:04:02.521120 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:04:02.530106 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:04:02.624386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:04:02.624964 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:04:02.818129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730115a06490>]}
[0m10:04:02.884429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730115310210>]}
[0m10:04:02.884870 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:04:02.885174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301156c3790>]}
[0m10:04:02.886510 [info ] [MainThread]: 
[0m10:04:02.887026 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:04:02.887791 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:04:02.924801 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:04:02.925160 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:04:02.925422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:04:02.929987 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:04:02.931330 [debug] [ThreadPool]: On list_my_db: Close
[0m10:04:02.936395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:04:02.942092 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:04:02.942448 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:04:02.942721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:04:02.945972 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:04:02.946373 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:04:02.946680 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:04:02.949094 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:04:02.950414 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:04:02.950835 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:04:02.957076 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.957462 [debug] [MainThread]: On master: BEGIN
[0m10:04:02.957781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:04:02.960964 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:02.961345 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.961702 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:04:02.970051 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:04:02.971277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7301147e89d0>]}
[0m10:04:02.971682 [debug] [MainThread]: On master: ROLLBACK
[0m10:04:02.972099 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.972432 [debug] [MainThread]: On master: BEGIN
[0m10:04:02.973078 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:02.973404 [debug] [MainThread]: On master: COMMIT
[0m10:04:02.973687 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:02.973935 [debug] [MainThread]: On master: COMMIT
[0m10:04:02.974296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:04:02.974575 [debug] [MainThread]: On master: Close
[0m10:04:02.974991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:04:02.975316 [info ] [MainThread]: 
[0m10:04:02.977207 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:04:02.977710 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:04:02.978238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:04:02.978613 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:04:02.986946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:04:02.987769 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:04:03.024407 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:04:03.025081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:04:03.025435 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:04:03.025725 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:04:03.029681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:04:03.030085 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:04:03.030430 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment
  );
[0m10:04:03.031240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointmentid" does not exist
LINE 8:     select  AppointmentID as Appointment_id,
                    ^
HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".

[0m10:04:03.031626 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:04:03.032140 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:04:03.036040 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:04:03.037757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66d359a-95d7-45e6-938d-af4e2b335cab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011479b150>]}
[0m10:04:03.038505 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:04:03.039223 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:04:03.040902 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:03.041293 [debug] [MainThread]: On master: BEGIN
[0m10:04:03.041645 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:04:03.044591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:04:03.044986 [debug] [MainThread]: On master: COMMIT
[0m10:04:03.045251 [debug] [MainThread]: Using postgres connection "master"
[0m10:04:03.045531 [debug] [MainThread]: On master: COMMIT
[0m10:04:03.045909 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:04:03.046199 [debug] [MainThread]: On master: Close
[0m10:04:03.046657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:04:03.046945 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:04:03.047330 [info ] [MainThread]: 
[0m10:04:03.047777 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:04:03.048615 [debug] [MainThread]: Command end result
[0m10:04:03.076874 [info ] [MainThread]: 
[0m10:04:03.077375 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:04:03.077706 [info ] [MainThread]: 
[0m10:04:03.078385 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:04:03.079046 [info ] [MainThread]: 
[0m10:04:03.079593 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:04:03.080590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80230737, "process_user_time": 1.934022, "process_kernel_time": 0.121938, "process_mem_max_rss": "114144", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m10:04:03.081271 [debug] [MainThread]: Command `dbt run` failed at 10:04:03.081143 after 0.80 seconds
[0m10:04:03.081710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011b1e0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011b1e0350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73011b1e0b10>]}
[0m10:04:03.082051 [debug] [MainThread]: Flushing usage events
[0m10:07:24.847346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce352e0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce352dd2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce35463fd0>]}


============================== 10:07:24.849957 | c12b5bf0-b07f-46be-ad32-5e5bccafff24 ==============================
[0m10:07:24.849957 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:07:24.850531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:07:25.000537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce3396da90>]}
[0m10:07:25.049703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce38fd4fd0>]}
[0m10:07:25.050439 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:07:25.060218 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:07:25.156051 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:07:25.156634 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m10:07:25.352156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce33968dd0>]}
[0m10:07:25.418833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce336efc10>]}
[0m10:07:25.419287 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:07:25.419592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce336be610>]}
[0m10:07:25.421062 [info ] [MainThread]: 
[0m10:07:25.421620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:25.422505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:07:25.462394 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:07:25.462761 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:07:25.463029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:25.467515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:07:25.468814 [debug] [ThreadPool]: On list_my_db: Close
[0m10:07:25.473524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:07:25.479385 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:07:25.479719 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:07:25.479976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:25.483135 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.483608 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:07:25.483903 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:07:25.486470 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:07:25.487854 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:07:25.488327 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:07:25.495057 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.495515 [debug] [MainThread]: On master: BEGIN
[0m10:07:25.495805 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:25.498954 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.499483 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.499858 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:25.508547 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:07:25.509744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce33a29ed0>]}
[0m10:07:25.510180 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:25.510724 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.511051 [debug] [MainThread]: On master: BEGIN
[0m10:07:25.511529 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.511837 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.512098 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.512354 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.512755 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:25.513038 [debug] [MainThread]: On master: Close
[0m10:07:25.513507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:07:25.513857 [info ] [MainThread]: 
[0m10:07:25.515804 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:07:25.516302 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:07:25.516779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:07:25.517195 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:07:25.525806 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:07:25.526512 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:07:25.563968 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:07:25.564607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:07:25.564950 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:07:25.565272 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:07:25.568500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.568953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:07:25.569293 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    with raw_appointment as (
    select  AppointmentID as Appointment_id,
            PatientID as Patient_id,
            DoctorID as Doctor_id,
            to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"        
)
select * from raw_appointment
  );
[0m10:07:25.570015 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointmentid" does not exist
LINE 8:     select  AppointmentID as Appointment_id,
                    ^
HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".

[0m10:07:25.570497 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:07:25.571103 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:07:25.574884 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:07:25.576447 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c12b5bf0-b07f-46be-ad32-5e5bccafff24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce327e8c90>]}
[0m10:07:25.577099 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:07:25.577729 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:07:25.579320 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.579633 [debug] [MainThread]: On master: BEGIN
[0m10:07:25.579892 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:25.582949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:25.583390 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.583710 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:25.583969 [debug] [MainThread]: On master: COMMIT
[0m10:07:25.584363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:25.584675 [debug] [MainThread]: On master: Close
[0m10:07:25.585106 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:25.585476 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:07:25.585801 [info ] [MainThread]: 
[0m10:07:25.586156 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:07:25.587062 [debug] [MainThread]: Command end result
[0m10:07:25.615855 [info ] [MainThread]: 
[0m10:07:25.616327 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:07:25.616704 [info ] [MainThread]: 
[0m10:07:25.617180 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 8:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:07:25.617597 [info ] [MainThread]: 
[0m10:07:25.618019 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:07:25.619066 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8174661, "process_user_time": 2.001389, "process_kernel_time": 0.132091, "process_mem_max_rss": "113912", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m10:07:25.619657 [debug] [MainThread]: Command `dbt run` failed at 10:07:25.619512 after 0.82 seconds
[0m10:07:25.620043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce36707250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce352ed550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cce351c84d0>]}
[0m10:07:25.620439 [debug] [MainThread]: Flushing usage events
[0m10:10:52.001211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee40cc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee587750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee40cdd0>]}


============================== 10:10:52.003902 | c52f6033-9ed8-4f01-9e41-aa10ea977e4c ==============================
[0m10:10:52.003902 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:10:52.004421 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:10:52.154115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ee419910>]}
[0m10:10:52.203990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227f20d0fd0>]}
[0m10:10:52.204710 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:10:52.213974 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:10:52.308992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:10:52.309604 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:10:52.503977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec7d1a10>]}
[0m10:10:52.570922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec831d50>]}
[0m10:10:52.571383 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:10:52.571667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec847490>]}
[0m10:10:52.573124 [info ] [MainThread]: 
[0m10:10:52.573830 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:10:52.574787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:10:52.612190 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:10:52.612545 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:10:52.612807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:10:52.617299 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:10:52.618536 [debug] [ThreadPool]: On list_my_db: Close
[0m10:10:52.623281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:10:52.629040 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:10:52.629392 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:10:52.629664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:10:52.632920 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.633315 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:10:52.633621 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:10:52.636099 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:10:52.637545 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:10:52.637994 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:10:52.643969 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.644310 [debug] [MainThread]: On master: BEGIN
[0m10:10:52.644605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:10:52.647781 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.648154 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.648515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:10:52.656748 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:10:52.657949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ec77ad50>]}
[0m10:10:52.658344 [debug] [MainThread]: On master: ROLLBACK
[0m10:10:52.658794 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.659070 [debug] [MainThread]: On master: BEGIN
[0m10:10:52.659616 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.659940 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.660208 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.660468 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.660806 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:10:52.661086 [debug] [MainThread]: On master: Close
[0m10:10:52.661572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:10:52.662011 [info ] [MainThread]: 
[0m10:10:52.664175 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:10:52.664745 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:10:52.665277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:10:52.665666 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:10:52.673722 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:10:52.674428 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:10:52.711074 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:10:52.711677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:10:52.712011 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:10:52.712304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:10:52.715451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.715973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:10:52.716320 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  AppointmentID as Appointment_id,
        PatientID as Patient_id,
        DoctorID as Doctor_id,
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:10:52.717093 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "appointmentid" does not exist
LINE 7:     select  AppointmentID as Appointment_id,
                    ^
HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".

[0m10:10:52.717540 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:10:52.718119 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:10:52.721768 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 7:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:10:52.723281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c52f6033-9ed8-4f01-9e41-aa10ea977e4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ebba9750>]}
[0m10:10:52.723968 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:10:52.724630 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:10:52.726203 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.726528 [debug] [MainThread]: On master: BEGIN
[0m10:10:52.726792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:10:52.729674 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:10:52.730202 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.730592 [debug] [MainThread]: Using postgres connection "master"
[0m10:10:52.730845 [debug] [MainThread]: On master: COMMIT
[0m10:10:52.731235 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:10:52.731513 [debug] [MainThread]: On master: Close
[0m10:10:52.731966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:10:52.732328 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:10:52.732757 [info ] [MainThread]: 
[0m10:10:52.733200 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:10:52.734099 [debug] [MainThread]: Command end result
[0m10:10:52.761416 [info ] [MainThread]: 
[0m10:10:52.761850 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:10:52.762155 [info ] [MainThread]: 
[0m10:10:52.762541 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "appointmentid" does not exist
  LINE 7:     select  AppointmentID as Appointment_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Appointment.AppointmentID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:10:52.762854 [info ] [MainThread]: 
[0m10:10:52.763158 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:10:52.763908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8096432, "process_user_time": 1.958181, "process_kernel_time": 0.132741, "process_mem_max_rss": "113764", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:10:52.764371 [debug] [MainThread]: Command `dbt run` failed at 10:10:52.764261 after 0.81 seconds
[0m10:10:52.764708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227f2324c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227f2324d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7227ef9162d0>]}
[0m10:10:52.765025 [debug] [MainThread]: Flushing usage events
[0m10:12:22.720724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34cad790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac360c6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34cad210>]}


============================== 10:12:22.723278 | 66218f85-b12e-4179-a5e4-da2dd0537812 ==============================
[0m10:12:22.723278 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:12:22.723765 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_patient', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:12:22.855811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34cae490>]}
[0m10:12:22.902215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac38971010>]}
[0m10:12:22.902928 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:12:22.912094 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:12:23.006457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:12:23.006819 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:12:23.038033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac33380350>]}
[0m10:12:23.106260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac333c49d0>]}
[0m10:12:23.106774 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:12:23.107050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac333415d0>]}
[0m10:12:23.108667 [info ] [MainThread]: 
[0m10:12:23.109277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:12:23.110078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:12:23.150703 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:12:23.151100 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:12:23.151361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:12:23.156247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:12:23.157593 [debug] [ThreadPool]: On list_my_db: Close
[0m10:12:23.162464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:12:23.168280 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:12:23.168634 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:12:23.168879 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:12:23.172521 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.172971 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:12:23.173264 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:12:23.175970 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:12:23.177416 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:12:23.177867 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:12:23.184316 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.184682 [debug] [MainThread]: On master: BEGIN
[0m10:12:23.184990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:23.188266 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.188678 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.189037 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:12:23.197557 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:12:23.198743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac3269d4d0>]}
[0m10:12:23.199141 [debug] [MainThread]: On master: ROLLBACK
[0m10:12:23.199625 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.199940 [debug] [MainThread]: On master: BEGIN
[0m10:12:23.200396 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.200703 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.200962 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.201205 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.201596 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:12:23.201884 [debug] [MainThread]: On master: Close
[0m10:12:23.202307 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:12:23.202656 [info ] [MainThread]: 
[0m10:12:23.204518 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_patient
[0m10:12:23.205046 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_patient ................................. [RUN]
[0m10:12:23.205529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_patient)
[0m10:12:23.205985 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_patient
[0m10:12:23.213820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_patient"
[0m10:12:23.214401 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_patient
[0m10:12:23.250023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_patient"
[0m10:12:23.250605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:12:23.250918 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: BEGIN
[0m10:12:23.251197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:12:23.254671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.255145 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:12:23.255471 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */

  create view "my_db"."public"."stg_patient__dbt_tmp"
    
    
  as (
    select  PatientID as Patient_id,
        firstname as First_name,
        lastname as Last_name,
        email as Email
    from "my_db"."public"."Patient"
  );
[0m10:12:23.256240 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patientid" does not exist
LINE 7:     select  PatientID as Patient_id,
                    ^
HINT:  Perhaps you meant to reference the column "Patient.PatientID".

[0m10:12:23.256810 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: ROLLBACK
[0m10:12:23.257478 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: Close
[0m10:12:23.261361 [debug] [Thread-1 (]: Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:12:23.262796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '66218f85-b12e-4179-a5e4-da2dd0537812', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac3243c6d0>]}
[0m10:12:23.263418 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_patient ........................ [[31mERROR[0m in 0.06s]
[0m10:12:23.264020 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_patient
[0m10:12:23.265590 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.265897 [debug] [MainThread]: On master: BEGIN
[0m10:12:23.266147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:12:23.269315 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:12:23.269743 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.270029 [debug] [MainThread]: Using postgres connection "master"
[0m10:12:23.270293 [debug] [MainThread]: On master: COMMIT
[0m10:12:23.270781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:12:23.271098 [debug] [MainThread]: On master: Close
[0m10:12:23.271515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:12:23.271771 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_patient' was properly closed.
[0m10:12:23.272048 [info ] [MainThread]: 
[0m10:12:23.272371 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:12:23.273054 [debug] [MainThread]: Command end result
[0m10:12:23.303015 [info ] [MainThread]: 
[0m10:12:23.303507 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:12:23.303998 [info ] [MainThread]: 
[0m10:12:23.304613 [error] [MainThread]:   Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:12:23.305004 [info ] [MainThread]: 
[0m10:12:23.305402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:12:23.306257 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6269651, "process_user_time": 1.681997, "process_kernel_time": 0.121638, "process_mem_max_rss": "111124", "process_out_blocks": "1736", "command_success": false, "process_in_blocks": "0"}
[0m10:12:23.306958 [debug] [MainThread]: Command `dbt run` failed at 10:12:23.306821 after 0.63 seconds
[0m10:12:23.307475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34fa0a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34baff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ac34c5b890>]}
[0m10:12:23.307915 [debug] [MainThread]: Flushing usage events
[0m10:17:47.886612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca4e3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2ccb8f85d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca4cb8d0>]}


============================== 10:17:47.889759 | 6ee12512-37a7-41ef-87be-ef3de98d37f6 ==============================
[0m10:17:47.889759 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:17:47.890273 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_patient', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:48.035134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca3afd90>]}
[0m10:17:48.082259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cce1a5050>]}
[0m10:17:48.083042 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:48.091837 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:17:48.186720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:17:48.187290 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:17:48.187631 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m10:17:48.187974 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m10:17:48.188286 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:17:48.401561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc8a40ed0>]}
[0m10:17:48.480625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca4e36d0>]}
[0m10:17:48.481139 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:17:48.481571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc8c1bc10>]}
[0m10:17:48.483146 [info ] [MainThread]: 
[0m10:17:48.483722 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:48.484585 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:17:48.521281 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:17:48.521679 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:17:48.521943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:48.526461 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:17:48.527805 [debug] [ThreadPool]: On list_my_db: Close
[0m10:17:48.533464 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:17:48.539194 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:48.539571 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:17:48.539824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:48.543167 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.543549 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:48.543875 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:17:48.546945 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:17:48.548591 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:17:48.549120 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:17:48.554966 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.555414 [debug] [MainThread]: On master: BEGIN
[0m10:17:48.555764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:48.558929 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.559282 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.559646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:48.568119 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:17:48.569365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc88e29d0>]}
[0m10:17:48.569772 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:48.570181 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.570539 [debug] [MainThread]: On master: BEGIN
[0m10:17:48.571037 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.571376 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.571661 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.571933 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.572308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:48.572606 [debug] [MainThread]: On master: Close
[0m10:17:48.573064 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:48.573405 [info ] [MainThread]: 
[0m10:17:48.575362 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_patient
[0m10:17:48.575903 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_patient ................................. [RUN]
[0m10:17:48.576458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_patient)
[0m10:17:48.576821 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_patient
[0m10:17:48.585181 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_patient"
[0m10:17:48.585769 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_patient
[0m10:17:48.622802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_patient"
[0m10:17:48.623443 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:17:48.623794 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: BEGIN
[0m10:17:48.624090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:48.627507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.627949 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m10:17:48.628308 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */

  create view "my_db"."public"."stg_patient__dbt_tmp"
    
    
  as (
    select  PatientID as Patient_id,
        firstname as First_name,
        lastname as Last_name,
        email as Email
    from "my_db"."public"."Patient"
  );
[0m10:17:48.629441 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patientid" does not exist
LINE 7:     select  PatientID as Patient_id,
                    ^
HINT:  Perhaps you meant to reference the column "Patient.PatientID".

[0m10:17:48.630041 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: ROLLBACK
[0m10:17:48.630598 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: Close
[0m10:17:48.634303 [debug] [Thread-1 (]: Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:17:48.635803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ee12512-37a7-41ef-87be-ef3de98d37f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cc7993ed0>]}
[0m10:17:48.636430 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_patient ........................ [[31mERROR[0m in 0.06s]
[0m10:17:48.637013 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_patient
[0m10:17:48.638555 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.638863 [debug] [MainThread]: On master: BEGIN
[0m10:17:48.639115 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:48.641884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:48.642310 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.642620 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:48.642871 [debug] [MainThread]: On master: COMMIT
[0m10:17:48.643238 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:48.643532 [debug] [MainThread]: On master: Close
[0m10:17:48.643923 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:48.644181 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_patient' was properly closed.
[0m10:17:48.644545 [info ] [MainThread]: 
[0m10:17:48.644990 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:17:48.645740 [debug] [MainThread]: Command end result
[0m10:17:48.674023 [info ] [MainThread]: 
[0m10:17:48.674493 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:17:48.674817 [info ] [MainThread]: 
[0m10:17:48.675203 [error] [MainThread]:   Database Error in model stg_patient (models/staging/healthcare/stg_patient.sql)
  column "patientid" does not exist
  LINE 7:     select  PatientID as Patient_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Patient.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_patient.sql
[0m10:17:48.675529 [info ] [MainThread]: 
[0m10:17:48.675858 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:17:48.676629 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8418663, "process_user_time": 2.010538, "process_kernel_time": 0.133902, "process_mem_max_rss": "113812", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:17:48.677089 [debug] [MainThread]: Command `dbt run` failed at 10:17:48.676984 after 0.84 seconds
[0m10:17:48.677452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca668110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca498c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2cca48f950>]}
[0m10:17:48.677775 [debug] [MainThread]: Flushing usage events
[0m10:17:54.655105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c536550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3d21e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c57f610>]}


============================== 10:17:54.657747 | 9d89f372-71a8-4216-9e8a-6b0ca5fbc46c ==============================
[0m10:17:54.657747 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:17:54.658262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:17:54.787622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c4bce50>]}
[0m10:17:54.833235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3ac892d0>]}
[0m10:17:54.833943 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:17:54.845082 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:17:54.940193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:17:54.940561 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:17:54.971176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3abdc350>]}
[0m10:17:55.038742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3ac9f6d0>]}
[0m10:17:55.039200 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:17:55.039512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3acc2e50>]}
[0m10:17:55.040890 [info ] [MainThread]: 
[0m10:17:55.041464 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:17:55.042350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:17:55.082947 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:17:55.083324 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:17:55.083587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:17:55.088533 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:17:55.090051 [debug] [ThreadPool]: On list_my_db: Close
[0m10:17:55.094940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:17:55.100817 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:55.101162 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:17:55.101448 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:17:55.104576 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.104932 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:17:55.105218 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:17:55.107668 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:17:55.109000 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:17:55.109403 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:17:55.115927 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.116277 [debug] [MainThread]: On master: BEGIN
[0m10:17:55.116554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:17:55.119814 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.120183 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.120551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:17:55.128723 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:17:55.129932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d3c535910>]}
[0m10:17:55.130323 [debug] [MainThread]: On master: ROLLBACK
[0m10:17:55.130788 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.131110 [debug] [MainThread]: On master: BEGIN
[0m10:17:55.131631 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.131951 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.132218 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.132499 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.132832 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:55.133096 [debug] [MainThread]: On master: Close
[0m10:17:55.133585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:17:55.134006 [info ] [MainThread]: 
[0m10:17:55.136223 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:17:55.136786 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:17:55.137353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:17:55.137732 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:17:55.145109 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:17:55.145697 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:17:55.183429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:17:55.184075 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:17:55.184429 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:17:55.184734 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:17:55.188044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.188488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:17:55.188830 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:17:55.189628 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Date " does not exist
LINE 10:         to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH...
                              ^
HINT:  Perhaps you meant to reference the column "Appointment.Date".

[0m10:17:55.190010 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:17:55.190523 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:17:55.194230 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "Date " does not exist
  LINE 10:         to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:17:55.195636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d89f372-71a8-4216-9e8a-6b0ca5fbc46c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d39c134d0>]}
[0m10:17:55.196215 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:17:55.196851 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:17:55.198465 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.198792 [debug] [MainThread]: On master: BEGIN
[0m10:17:55.199054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:17:55.201713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:17:55.202136 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.202433 [debug] [MainThread]: Using postgres connection "master"
[0m10:17:55.202686 [debug] [MainThread]: On master: COMMIT
[0m10:17:55.203033 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:17:55.203295 [debug] [MainThread]: On master: Close
[0m10:17:55.203749 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:17:55.204003 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:17:55.204283 [info ] [MainThread]: 
[0m10:17:55.204644 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:17:55.205359 [debug] [MainThread]: Command end result
[0m10:17:55.234331 [info ] [MainThread]: 
[0m10:17:55.234892 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:17:55.235294 [info ] [MainThread]: 
[0m10:17:55.235711 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "Date " does not exist
  LINE 10:         to_timestamp("Date "|| ' ' || "Time", 'YYYY-MM-DD HH...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:17:55.236023 [info ] [MainThread]: 
[0m10:17:55.236359 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:17:55.237143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.62433565, "process_user_time": 1.662354, "process_kernel_time": 0.13179, "process_mem_max_rss": "111484", "process_out_blocks": "1720", "command_success": false, "process_in_blocks": "0"}
[0m10:17:55.237623 [debug] [MainThread]: Command `dbt run` failed at 10:17:55.237519 after 0.62 seconds
[0m10:17:55.237970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d404c0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d404c0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773d404c0dd0>]}
[0m10:17:55.238298 [debug] [MainThread]: Flushing usage events
[0m10:19:08.353401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd3fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd3d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd3eb90>]}


============================== 10:19:08.356104 | e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9 ==============================
[0m10:19:08.356104 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:19:08.356672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:19:08.499487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd6b590>]}
[0m10:19:08.546198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721f5e1550>]}
[0m10:19:08.546988 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:19:08.555402 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:19:08.649805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:08.650401 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:19:08.843870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd1c390>]}
[0m10:19:08.910163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721c399790>]}
[0m10:19:08.910615 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:19:08.910893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721bd3f3d0>]}
[0m10:19:08.912248 [info ] [MainThread]: 
[0m10:19:08.912778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:08.913785 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:19:08.952659 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:19:08.953028 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:19:08.953286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:08.957715 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:19:08.959160 [debug] [ThreadPool]: On list_my_db: Close
[0m10:19:08.964062 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:19:08.969829 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:08.970164 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:19:08.970444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:08.974020 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:19:08.974480 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:08.974768 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:19:08.977398 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:19:08.978779 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:19:08.979258 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:19:08.986268 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.986637 [debug] [MainThread]: On master: BEGIN
[0m10:19:08.986881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:08.990026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:08.990390 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:08.990745 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:08.998996 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:19:09.000198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721c496710>]}
[0m10:19:09.000611 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:09.001054 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.001401 [debug] [MainThread]: On master: BEGIN
[0m10:19:09.002045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:09.002363 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.002628 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.002883 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.003294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:09.003585 [debug] [MainThread]: On master: Close
[0m10:19:09.004010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:09.004344 [info ] [MainThread]: 
[0m10:19:09.006219 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:19:09.006756 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:19:09.007314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:19:09.007699 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:19:09.017263 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:19:09.018065 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:19:09.054793 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:19:09.055528 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:09.055870 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:19:09.056184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:09.060270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:19:09.060792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:09.061124 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:19:09.061927 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                              ^
HINT:  Perhaps you meant to reference the column "Appointment.Date".

[0m10:19:09.062313 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:19:09.062891 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:19:09.066596 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:09.068029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ec71cc-bbe0-4982-a6ee-48bcab1f22e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721b1e1890>]}
[0m10:19:09.068627 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:19:09.069231 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:19:09.070848 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.071179 [debug] [MainThread]: On master: BEGIN
[0m10:19:09.071506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:09.074888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:09.075300 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.075590 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:09.075846 [debug] [MainThread]: On master: COMMIT
[0m10:19:09.076199 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:09.076494 [debug] [MainThread]: On master: Close
[0m10:19:09.076882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:09.077130 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:19:09.077447 [info ] [MainThread]: 
[0m10:19:09.077783 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:19:09.078475 [debug] [MainThread]: Command end result
[0m10:19:09.104674 [info ] [MainThread]: 
[0m10:19:09.105215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:19:09.105684 [info ] [MainThread]: 
[0m10:19:09.106186 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:09.106694 [info ] [MainThread]: 
[0m10:19:09.107111 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:09.108016 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.80226326, "process_user_time": 1.965816, "process_kernel_time": 0.136848, "process_mem_max_rss": "113812", "process_out_blocks": "2552", "command_success": false, "process_in_blocks": "0"}
[0m10:19:09.108609 [debug] [MainThread]: Command `dbt run` failed at 10:19:09.108473 after 0.80 seconds
[0m10:19:09.108996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dd495d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721e030f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78721dcf42d0>]}
[0m10:19:09.109324 [debug] [MainThread]: Flushing usage events
[0m10:19:26.251044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896320190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896608cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896321cd0>]}


============================== 10:19:26.253788 | 7107570a-9459-4ffc-af13-a4fe10f2f02c ==============================
[0m10:19:26.253788 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:19:26.254330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:19:26.403406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896322290>]}
[0m10:19:26.450005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89a031010>]}
[0m10:19:26.450768 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:19:26.459586 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:19:26.554965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:19:26.555559 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:19:26.747963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8949a5c90>]}
[0m10:19:26.816696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89470b5d0>]}
[0m10:19:26.817145 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m10:19:26.817465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8946d1110>]}
[0m10:19:26.818903 [info ] [MainThread]: 
[0m10:19:26.819522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:19:26.820621 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:19:26.859288 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:19:26.859720 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:19:26.859998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:19:26.865070 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:19:26.866356 [debug] [ThreadPool]: On list_my_db: Close
[0m10:19:26.871075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:19:26.876900 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:26.877233 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:19:26.877497 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:19:26.881157 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.881640 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:19:26.881925 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:19:26.884369 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:19:26.885718 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:19:26.886186 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:19:26.892396 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.892735 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.892985 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:19:26.896322 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.896696 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.897080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:19:26.905427 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:19:26.906595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc894772210>]}
[0m10:19:26.906981 [debug] [MainThread]: On master: ROLLBACK
[0m10:19:26.907434 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.907718 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.908332 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.908644 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.908905 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.909150 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.909567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:26.909845 [debug] [MainThread]: On master: Close
[0m10:19:26.910270 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:19:26.910624 [info ] [MainThread]: 
[0m10:19:26.912587 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:19:26.913126 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:19:26.913649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:19:26.914072 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:19:26.922492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:19:26.923097 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:19:26.960017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:19:26.960651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:26.961024 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:19:26.961355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:19:26.965199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.965644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:19:26.966002 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:19:26.966578 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 11:     from "my_db"."public"."Appointment"
             ^

[0m10:19:26.967025 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:19:26.967557 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:19:26.971246 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."public"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:26.972794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7107570a-9459-4ffc-af13-a4fe10f2f02c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8937b4990>]}
[0m10:19:26.973488 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:19:26.974192 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:19:26.976365 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.976733 [debug] [MainThread]: On master: BEGIN
[0m10:19:26.976989 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:19:26.980167 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:19:26.980581 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.980913 [debug] [MainThread]: Using postgres connection "master"
[0m10:19:26.981167 [debug] [MainThread]: On master: COMMIT
[0m10:19:26.981555 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:19:26.981911 [debug] [MainThread]: On master: Close
[0m10:19:26.982451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:19:26.982874 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:19:26.983419 [info ] [MainThread]: 
[0m10:19:26.984125 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:19:26.985164 [debug] [MainThread]: Command end result
[0m10:19:27.014411 [info ] [MainThread]: 
[0m10:19:27.014882 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:19:27.015224 [info ] [MainThread]: 
[0m10:19:27.015603 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."public"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:19:27.015912 [info ] [MainThread]: 
[0m10:19:27.016205 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:19:27.016993 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81263226, "process_user_time": 1.90631, "process_kernel_time": 0.144644, "process_mem_max_rss": "113756", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m10:19:27.017531 [debug] [MainThread]: Command `dbt run` failed at 10:19:27.017410 after 0.81 seconds
[0m10:19:27.017877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc8963216d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc89649c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc896733fd0>]}
[0m10:19:27.018192 [debug] [MainThread]: Flushing usage events
[0m10:27:16.354807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a84ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a84e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a84fbd0>]}


============================== 10:27:16.357567 | 4561db34-0cf4-4f9f-9753-d9be643401dc ==============================
[0m10:27:16.357567 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:27:16.358150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:27:16.511895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a7a2550>]}
[0m10:27:16.563450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7e54c650>]}
[0m10:27:16.564152 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:27:16.575223 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:27:16.676913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m10:27:16.677451 [debug] [MainThread]: Partial parsing: added file: dbt_modeling://models/staging/healthcare/src_healthcare.yml
[0m10:27:16.677809 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:27:16.916749 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m10:27:16.917266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78cbc7d0>]}
[0m10:27:17.100741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78dd7710>]}
[0m10:27:17.196176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78333ed0>]}
[0m10:27:17.196724 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:27:17.197049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78ec4790>]}
[0m10:27:17.198650 [info ] [MainThread]: 
[0m10:27:17.199220 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:17.200189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:27:17.243250 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:27:17.243690 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:27:17.243998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:17.249068 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:27:17.250583 [debug] [ThreadPool]: On list_my_db: Close
[0m10:27:17.256907 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:27:17.263922 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:17.264354 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:27:17.264653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:17.268474 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.268918 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:17.269247 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:27:17.272388 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:27:17.274171 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:27:17.274961 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:27:17.282384 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.282799 [debug] [MainThread]: On master: BEGIN
[0m10:27:17.283118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:17.286865 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.287366 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.287791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:17.297599 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:27:17.299059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7779e490>]}
[0m10:27:17.299649 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:17.300464 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.300889 [debug] [MainThread]: On master: BEGIN
[0m10:27:17.301487 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.301884 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.302180 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.302476 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.302932 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:17.303252 [debug] [MainThread]: On master: Close
[0m10:27:17.303773 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:17.304130 [info ] [MainThread]: 
[0m10:27:17.306442 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:27:17.307130 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:27:17.307848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:27:17.308357 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:27:17.318647 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:27:17.319688 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:27:17.364889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:27:17.365622 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:17.366017 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:27:17.366370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:17.369990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.370466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:17.370876 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."healthcare"."Appointment"
  );
[0m10:27:17.371552 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 11:     from "my_db"."healthcare"."Appointment"
             ^

[0m10:27:17.371952 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:27:17.372535 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:27:17.376975 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."healthcare"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:17.378599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4561db34-0cf4-4f9f-9753-d9be643401dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb77be3790>]}
[0m10:27:17.379276 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.07s]
[0m10:27:17.379950 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:27:17.382104 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.382523 [debug] [MainThread]: On master: BEGIN
[0m10:27:17.382823 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:17.386001 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:17.386428 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.386729 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:17.387010 [debug] [MainThread]: On master: COMMIT
[0m10:27:17.387374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:17.387681 [debug] [MainThread]: On master: Close
[0m10:27:17.388119 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:17.388401 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:27:17.388720 [info ] [MainThread]: 
[0m10:27:17.389053 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.19 seconds (0.19s).
[0m10:27:17.389751 [debug] [MainThread]: Command end result
[0m10:27:17.493608 [info ] [MainThread]: 
[0m10:27:17.494083 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:17.494463 [info ] [MainThread]: 
[0m10:27:17.494842 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "from"
  LINE 11:     from "my_db"."healthcare"."Appointment"
               ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:17.495146 [info ] [MainThread]: 
[0m10:27:17.495469 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:17.496277 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.1869818, "process_user_time": 2.325418, "process_kernel_time": 0.144963, "process_mem_max_rss": "116480", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m10:27:17.496764 [debug] [MainThread]: Command `dbt run` failed at 10:27:17.496658 after 1.19 seconds
[0m10:27:17.497164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7a9f00d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb7e7c0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74bb78c90fd0>]}
[0m10:27:17.497499 [debug] [MainThread]: Flushing usage events
[0m10:27:44.546564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa56a70050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d77dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d77610>]}


============================== 10:27:44.549188 | c3016f0c-dddb-4543-83e3-bc29237aee6c ==============================
[0m10:27:44.549188 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:27:44.549723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:27:44.694276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d977d0>]}
[0m10:27:44.742459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa58a7c850>]}
[0m10:27:44.743204 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:27:44.752305 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:27:44.871971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:27:44.872570 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:27:45.095588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5350dd50>]}
[0m10:27:45.187691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa53193ed0>]}
[0m10:27:45.188139 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:27:45.188423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa53078c50>]}
[0m10:27:45.189719 [info ] [MainThread]: 
[0m10:27:45.190190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:27:45.190948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:27:45.230811 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:27:45.231228 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:27:45.231530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:27:45.236452 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:27:45.237746 [debug] [ThreadPool]: On list_my_db: Close
[0m10:27:45.242593 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:27:45.248984 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:45.249388 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:27:45.249777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:27:45.252961 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.253372 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:27:45.253703 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:27:45.256208 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:27:45.257634 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:27:45.258118 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:27:45.264151 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.264537 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.264791 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:27:45.268007 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.268367 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.268723 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:27:45.277063 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:27:45.278295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5350d0d0>]}
[0m10:27:45.278729 [debug] [MainThread]: On master: ROLLBACK
[0m10:27:45.279193 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.279512 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.280084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.280410 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.280672 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.280915 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.281317 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:45.281595 [debug] [MainThread]: On master: Close
[0m10:27:45.282024 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:27:45.282343 [info ] [MainThread]: 
[0m10:27:45.284163 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:27:45.284675 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:27:45.285155 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:27:45.285559 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:27:45.292670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:27:45.293246 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:27:45.329925 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:27:45.330562 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:45.330889 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:27:45.331190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:27:45.334426 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.334835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:27:45.335168 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."healthcare"."Appointment"
  );
[0m10:27:45.335860 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "healthcare.Appointment" does not exist
LINE 11:     from "my_db"."healthcare"."Appointment"
                  ^

[0m10:27:45.336243 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:27:45.336863 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:27:45.341018 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  relation "healthcare.Appointment" does not exist
  LINE 11:     from "my_db"."healthcare"."Appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:45.343079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3016f0c-dddb-4543-83e3-bc29237aee6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa531cce10>]}
[0m10:27:45.343766 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:27:45.344398 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:27:45.345938 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.346244 [debug] [MainThread]: On master: BEGIN
[0m10:27:45.346572 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:27:45.349608 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:27:45.350136 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.350564 [debug] [MainThread]: Using postgres connection "master"
[0m10:27:45.350933 [debug] [MainThread]: On master: COMMIT
[0m10:27:45.351456 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:27:45.351830 [debug] [MainThread]: On master: Close
[0m10:27:45.352324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:27:45.352723 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:27:45.353136 [info ] [MainThread]: 
[0m10:27:45.353593 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:27:45.354837 [debug] [MainThread]: Command end result
[0m10:27:45.385213 [info ] [MainThread]: 
[0m10:27:45.385649 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:27:45.386001 [info ] [MainThread]: 
[0m10:27:45.386406 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  relation "healthcare.Appointment" does not exist
  LINE 11:     from "my_db"."healthcare"."Appointment"
                    ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:27:45.386706 [info ] [MainThread]: 
[0m10:27:45.387035 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:27:45.387803 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8838664, "process_user_time": 2.004778, "process_kernel_time": 0.146691, "process_mem_max_rss": "114308", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m10:27:45.388271 [debug] [MainThread]: Command `dbt run` failed at 10:27:45.388169 after 0.88 seconds
[0m10:27:45.388621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54f1c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa55088e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa54d76f10>]}
[0m10:27:45.388930 [debug] [MainThread]: Flushing usage events
[0m10:28:23.551404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa55eb2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa5605190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa55eac90>]}


============================== 10:28:23.554130 | 8ccfa49a-5ca4-4e70-b904-b5e4d98ce062 ==============================
[0m10:28:23.554130 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:28:23.554917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:28:23.698405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3ccffd0>]}
[0m10:28:23.746298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa92c8f90>]}
[0m10:28:23.747103 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:28:23.756244 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:28:23.874203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:28:23.874809 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:28:24.098767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3d23bd0>]}
[0m10:28:24.191947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3a221d0>]}
[0m10:28:24.192604 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:28:24.192946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa38fc210>]}
[0m10:28:24.194496 [info ] [MainThread]: 
[0m10:28:24.195032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:28:24.195901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:28:24.234354 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:28:24.234728 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:28:24.234985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:28:24.239596 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:28:24.240870 [debug] [ThreadPool]: On list_my_db: Close
[0m10:28:24.245631 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:28:24.251926 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:28:24.252289 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:28:24.252553 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:28:24.255797 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.256187 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:28:24.256530 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:28:24.259415 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:28:24.261002 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:28:24.261667 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:28:24.268040 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.268407 [debug] [MainThread]: On master: BEGIN
[0m10:28:24.268696 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:28:24.271884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.272229 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.272628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:28:24.281069 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:28:24.282264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa38ee650>]}
[0m10:28:24.282667 [debug] [MainThread]: On master: ROLLBACK
[0m10:28:24.283168 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.283508 [debug] [MainThread]: On master: BEGIN
[0m10:28:24.284101 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.284421 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.284678 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.284921 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.285312 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:28:24.285649 [debug] [MainThread]: On master: Close
[0m10:28:24.286068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:28:24.286402 [info ] [MainThread]: 
[0m10:28:24.288321 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:28:24.288863 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:28:24.289415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:28:24.289810 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:28:24.299598 [debug] [Thread-1 (]: Compilation Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  'raw' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:28:24.300889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ccfa49a-5ca4-4e70-b904-b5e4d98ce062', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa3a3ad10>]}
[0m10:28:24.301492 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.01s]
[0m10:28:24.302034 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:28:24.303594 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.303916 [debug] [MainThread]: On master: BEGIN
[0m10:28:24.304185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:28:24.307093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:28:24.307577 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.307867 [debug] [MainThread]: Using postgres connection "master"
[0m10:28:24.308119 [debug] [MainThread]: On master: COMMIT
[0m10:28:24.308532 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:28:24.308941 [debug] [MainThread]: On master: Close
[0m10:28:24.309697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:28:24.310066 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:28:24.310438 [info ] [MainThread]: 
[0m10:28:24.311130 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m10:28:24.312411 [debug] [MainThread]: Command end result
[0m10:28:24.342367 [info ] [MainThread]: 
[0m10:28:24.343015 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:28:24.343432 [info ] [MainThread]: 
[0m10:28:24.343886 [error] [MainThread]:   Compilation Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  'raw' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m10:28:24.344229 [info ] [MainThread]: 
[0m10:28:24.344627 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:28:24.345501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8421289, "process_user_time": 1.957011, "process_kernel_time": 0.14685, "process_mem_max_rss": "113888", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m10:28:24.345975 [debug] [MainThread]: Command `dbt run` failed at 10:28:24.345871 after 0.84 seconds
[0m10:28:24.346359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa5605190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa5606a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9fa38f4510>]}
[0m10:28:24.346697 [debug] [MainThread]: Flushing usage events
[0m10:29:12.044090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9d9a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9d8ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9dbdd0>]}


============================== 10:29:12.047223 | bb11609f-8d6a-4b67-9854-e351fe5ab634 ==============================
[0m10:29:12.047223 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:29:12.047849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_appointment', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:12.196373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eed9910d0>]}
[0m10:29:12.246493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef169ce90>]}
[0m10:29:12.247266 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:12.256202 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:29:12.380979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:12.381559 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:29:12.600668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eec04fd90>]}
[0m10:29:12.693084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eebc88290>]}
[0m10:29:12.693595 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:29:12.693900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eebd633d0>]}
[0m10:29:12.695558 [info ] [MainThread]: 
[0m10:29:12.696149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:12.697061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:29:12.735629 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:29:12.735980 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:29:12.736235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:12.741106 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:29:12.742516 [debug] [ThreadPool]: On list_my_db: Close
[0m10:29:12.747626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:29:12.753428 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:12.753764 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:29:12.754025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:12.757206 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.757633 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:12.757935 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:12.760384 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m10:29:12.761704 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:29:12.762162 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:29:12.768704 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.769077 [debug] [MainThread]: On master: BEGIN
[0m10:29:12.769331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:12.772925 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.773434 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.773837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:12.782943 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:29:12.784169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eeb142a90>]}
[0m10:29:12.784615 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:12.785087 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.785371 [debug] [MainThread]: On master: BEGIN
[0m10:29:12.785948 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.786253 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.786529 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.786776 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.787182 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:12.787476 [debug] [MainThread]: On master: Close
[0m10:29:12.787904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:12.788238 [info ] [MainThread]: 
[0m10:29:12.790093 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:29:12.790603 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:29:12.791106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:29:12.791490 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:29:12.799262 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:29:12.800024 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:29:12.835830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:29:12.836532 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.836894 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:29:12.837234 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:12.840969 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.841526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.841898 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id
      --  to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:29:12.843433 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:29:12.849478 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.849911 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment__dbt_tmp" rename to "stg_appointment"
[0m10:29:12.850617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:29:12.864831 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:29:12.865273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.865621 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:29:12.866805 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:29:12.872758 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_appointment__dbt_backup"
[0m10:29:12.877587 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:12.878121 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
drop view if exists "my_db"."public"."stg_appointment__dbt_backup" cascade
[0m10:29:12.878854 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:29:12.881084 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:29:12.882550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb11609f-8d6a-4b67-9854-e351fe5ab634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eead1f890>]}
[0m10:29:12.883286 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_appointment ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m10:29:12.883944 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:29:12.885249 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.885554 [debug] [MainThread]: On master: BEGIN
[0m10:29:12.885801 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:12.889199 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:12.889767 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.890054 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:12.890312 [debug] [MainThread]: On master: COMMIT
[0m10:29:12.890793 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:12.891101 [debug] [MainThread]: On master: Close
[0m10:29:12.891653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:12.891972 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:29:12.892450 [info ] [MainThread]: 
[0m10:29:12.892997 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m10:29:12.893971 [debug] [MainThread]: Command end result
[0m10:29:12.924061 [info ] [MainThread]: 
[0m10:29:12.924884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:29:12.925308 [info ] [MainThread]: 
[0m10:29:12.925714 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:29:12.926631 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.93048716, "process_user_time": 2.019577, "process_kernel_time": 0.143685, "process_mem_max_rss": "113872", "process_out_blocks": "2600", "process_in_blocks": "0"}
[0m10:29:12.927169 [debug] [MainThread]: Command `dbt run` succeeded at 10:29:12.927056 after 0.93 seconds
[0m10:29:12.927528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755ef1794710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eedb60110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755eedb60150>]}
[0m10:29:12.927877 [debug] [MainThread]: Flushing usage events
[0m10:29:33.066442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc39b4e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc39b1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc39b0890>]}


============================== 10:29:33.069085 | 488e3f49-83f3-40e3-af43-34df01d6708e ==============================
[0m10:29:33.069085 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:29:33.069657 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_appointment', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:29:33.217680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3b37f50>]}
[0m10:29:33.268372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3880510>]}
[0m10:29:33.269316 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:33.280107 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:29:33.403021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:33.403629 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:29:33.624700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1dae150>]}
[0m10:29:33.717313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1d17f50>]}
[0m10:29:33.717815 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:29:33.718147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1df4d50>]}
[0m10:29:33.719740 [info ] [MainThread]: 
[0m10:29:33.720417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:33.721372 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:29:33.760100 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:29:33.760476 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:29:33.760740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:33.765248 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:29:33.766521 [debug] [ThreadPool]: On list_my_db: Close
[0m10:29:33.771383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:29:33.777290 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:33.777651 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:29:33.777914 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:33.781401 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.781774 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:33.782090 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:33.784973 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:29:33.786515 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:29:33.787195 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:29:33.793409 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.793766 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.794014 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:33.797207 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.797609 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.797965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:33.807082 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:29:33.808646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc46595d0>]}
[0m10:29:33.809039 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:33.809506 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.809779 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.810316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.810630 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.810916 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.811163 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.811578 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:33.811858 [debug] [MainThread]: On master: Close
[0m10:29:33.812278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:33.812627 [info ] [MainThread]: 
[0m10:29:33.814528 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:29:33.815057 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:29:33.815572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:29:33.815942 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:29:33.823434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:29:33.824027 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:29:33.860310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:29:33.860940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:33.861264 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:29:33.861565 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:33.865220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.865698 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:33.866036 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:29:33.866673 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "to_timestamp"
LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                 ^

[0m10:29:33.867112 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:29:33.867676 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:29:33.871630 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "to_timestamp"
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                   ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:33.873009 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '488e3f49-83f3-40e3-af43-34df01d6708e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc1dcfb10>]}
[0m10:29:33.873609 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:29:33.874201 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:29:33.875902 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.876270 [debug] [MainThread]: On master: BEGIN
[0m10:29:33.876588 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:33.879537 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:33.879961 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.880253 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:33.880542 [debug] [MainThread]: On master: COMMIT
[0m10:29:33.880934 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:33.881207 [debug] [MainThread]: On master: Close
[0m10:29:33.881627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:33.881876 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:29:33.882166 [info ] [MainThread]: 
[0m10:29:33.882515 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:29:33.883204 [debug] [MainThread]: Command end result
[0m10:29:33.915898 [info ] [MainThread]: 
[0m10:29:33.916960 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:29:33.917611 [info ] [MainThread]: 
[0m10:29:33.918226 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  syntax error at or near "to_timestamp"
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                   ^
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:33.918584 [info ] [MainThread]: 
[0m10:29:33.918891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:33.919645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9016032, "process_user_time": 2.000214, "process_kernel_time": 0.148792, "process_mem_max_rss": "114160", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m10:29:33.920113 [debug] [MainThread]: Command `dbt run` failed at 10:29:33.920007 after 0.90 seconds
[0m10:29:33.920472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3997890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc3997510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73efc2097c50>]}
[0m10:29:33.920788 [debug] [MainThread]: Flushing usage events
[0m10:29:45.219408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e9437fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e947d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e947d3d0>]}


============================== 10:29:45.221962 | 96d07ed7-0296-4163-8b48-c300358bd4e9 ==============================
[0m10:29:45.221962 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:29:45.222512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_appointment', 'send_anonymous_usage_stats': 'True'}
[0m10:29:45.366163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e947e110>]}
[0m10:29:45.414881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92ed1508d0>]}
[0m10:29:45.415617 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:29:45.424520 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:29:45.544254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:29:45.544834 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:29:45.772697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e7a1dd50>]}
[0m10:29:45.865817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e787ffd0>]}
[0m10:29:45.866309 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:29:45.866622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e78b1550>]}
[0m10:29:45.868054 [info ] [MainThread]: 
[0m10:29:45.868577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:29:45.869433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:29:45.910551 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:29:45.910923 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:29:45.911187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:29:45.915727 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:29:45.917021 [debug] [ThreadPool]: On list_my_db: Close
[0m10:29:45.921944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:29:45.927867 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:45.928235 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:29:45.928523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:29:45.931796 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:29:45.932203 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:29:45.932526 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:29:45.935134 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:29:45.936610 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:29:45.937121 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:29:45.943349 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.943699 [debug] [MainThread]: On master: BEGIN
[0m10:29:45.943958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:29:45.946859 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:45.947234 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.947639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:29:45.956656 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:29:45.958180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e796a710>]}
[0m10:29:45.958600 [debug] [MainThread]: On master: ROLLBACK
[0m10:29:45.959072 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.959358 [debug] [MainThread]: On master: BEGIN
[0m10:29:45.959945 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:45.960241 [debug] [MainThread]: On master: COMMIT
[0m10:29:45.960515 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:45.960762 [debug] [MainThread]: On master: COMMIT
[0m10:29:45.961168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:45.961463 [debug] [MainThread]: On master: Close
[0m10:29:45.961887 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:29:45.962228 [info ] [MainThread]: 
[0m10:29:45.964132 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:29:45.964633 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:29:45.965218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:29:45.965595 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:29:45.974318 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:29:45.975072 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:29:46.010575 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:29:46.011175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:46.011520 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:29:46.011799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:29:46.014920 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:29:46.015342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:29:46.015757 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:29:46.016513 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "date" does not exist
LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                              ^
HINT:  Perhaps you meant to reference the column "Appointment.Date".

[0m10:29:46.016894 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: ROLLBACK
[0m10:29:46.017573 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:29:46.021554 [debug] [Thread-1 (]: Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:46.022953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96d07ed7-0296-4163-8b48-c300358bd4e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e65264d0>]}
[0m10:29:46.023549 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_appointment .................... [[31mERROR[0m in 0.06s]
[0m10:29:46.024154 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:29:46.025708 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:46.026028 [debug] [MainThread]: On master: BEGIN
[0m10:29:46.026311 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:29:46.029392 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:29:46.029828 [debug] [MainThread]: On master: COMMIT
[0m10:29:46.030116 [debug] [MainThread]: Using postgres connection "master"
[0m10:29:46.030374 [debug] [MainThread]: On master: COMMIT
[0m10:29:46.030780 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:29:46.031062 [debug] [MainThread]: On master: Close
[0m10:29:46.031467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:29:46.031724 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:29:46.032002 [info ] [MainThread]: 
[0m10:29:46.032324 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:29:46.032988 [debug] [MainThread]: Command end result
[0m10:29:46.062943 [info ] [MainThread]: 
[0m10:29:46.063537 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:29:46.063915 [info ] [MainThread]: 
[0m10:29:46.064371 [error] [MainThread]:   Database Error in model stg_appointment (models/staging/healthcare/stg_appointment.sql)
  column "date" does not exist
  LINE 10:         to_timestamp(Date || ' ' || Time, 'YYYY-MM-DD HH24:M...
                                ^
  HINT:  Perhaps you meant to reference the column "Appointment.Date".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_appointment.sql
[0m10:29:46.064728 [info ] [MainThread]: 
[0m10:29:46.065085 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:29:46.065918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8882614, "process_user_time": 2.001606, "process_kernel_time": 0.144899, "process_mem_max_rss": "114384", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m10:29:46.066409 [debug] [MainThread]: Command `dbt run` failed at 10:29:46.066286 after 0.89 seconds
[0m10:29:46.066775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e948b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92e9778b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a92ed3d8c90>]}
[0m10:29:46.067100 [debug] [MainThread]: Flushing usage events
[0m10:30:09.029999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa04f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fb7f750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa01110>]}


============================== 10:30:09.032914 | e2285b22-dba7-4fdc-bdca-558bb8d94661 ==============================
[0m10:30:09.032914 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:30:09.033557 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_appointment', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:30:09.178966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fb7ff50>]}
[0m10:30:09.227211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a36c8fd0>]}
[0m10:30:09.228237 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:30:09.239623 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:30:09.361414 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:30:09.362004 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_appointment.sql
[0m10:30:09.636832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659df27290>]}
[0m10:30:09.729782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659dd84650>]}
[0m10:30:09.730351 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:30:09.730657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659dfd17d0>]}
[0m10:30:09.732014 [info ] [MainThread]: 
[0m10:30:09.732532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:30:09.733410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:30:09.773652 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:30:09.774040 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:30:09.774316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:30:09.778786 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:30:09.780512 [debug] [ThreadPool]: On list_my_db: Close
[0m10:30:09.785608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:30:09.791501 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:30:09.791865 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:30:09.792118 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:30:09.795811 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.796407 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:30:09.796736 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:30:09.799302 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:30:09.800707 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:30:09.801128 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:30:09.807248 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.807621 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.807876 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:30:09.811011 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.811374 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.811780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:30:09.820976 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:30:09.822470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659dce3810>]}
[0m10:30:09.822864 [debug] [MainThread]: On master: ROLLBACK
[0m10:30:09.823356 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.823639 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.824246 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.824554 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.824814 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.825061 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.825466 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:09.825756 [debug] [MainThread]: On master: Close
[0m10:30:09.826183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:30:09.826516 [info ] [MainThread]: 
[0m10:30:09.828402 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_appointment
[0m10:30:09.828914 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_appointment ............................. [RUN]
[0m10:30:09.829421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_appointment)
[0m10:30:09.829817 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_appointment
[0m10:30:09.837649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_appointment"
[0m10:30:09.838257 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_appointment
[0m10:30:09.874727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_appointment"
[0m10:30:09.875367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.875700 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: BEGIN
[0m10:30:09.875991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:30:09.879615 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.880381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.880757 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */

  create view "my_db"."public"."stg_appointment__dbt_tmp"
    
    
  as (
    select  "AppointmentID" as Appointment_id,
        "PatientID" as Patient_id,
        "DoctorID" as Doctor_id,
        to_timestamp("Date" || ' ' || "Time", 'YYYY-MM-DD HH24:MI:SS') as Appointment_date 
    from "my_db"."public"."Appointment"
  );
[0m10:30:09.882482 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:30:09.889120 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.889516 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment" rename to "stg_appointment__dbt_backup"
[0m10:30:09.890159 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:09.893233 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.893594 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
alter table "my_db"."public"."stg_appointment__dbt_tmp" rename to "stg_appointment"
[0m10:30:09.894171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:30:09.909782 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:30:09.910223 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.910536 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: COMMIT
[0m10:30:09.911549 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m10:30:09.917423 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_appointment__dbt_backup"
[0m10:30:09.921984 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_appointment"
[0m10:30:09.922322 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_appointment"} */
drop view if exists "my_db"."public"."stg_appointment__dbt_backup" cascade
[0m10:30:09.923954 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m10:30:09.926157 [debug] [Thread-1 (]: On model.dbt_modeling.stg_appointment: Close
[0m10:30:09.927519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2285b22-dba7-4fdc-bdca-558bb8d94661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659cdcfb90>]}
[0m10:30:09.928183 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_appointment ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m10:30:09.928809 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_appointment
[0m10:30:09.929936 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.930242 [debug] [MainThread]: On master: BEGIN
[0m10:30:09.930530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:30:09.934068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:30:09.934465 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.934776 [debug] [MainThread]: Using postgres connection "master"
[0m10:30:09.935040 [debug] [MainThread]: On master: COMMIT
[0m10:30:09.935422 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:30:09.935701 [debug] [MainThread]: On master: Close
[0m10:30:09.936103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:30:09.936397 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_appointment' was properly closed.
[0m10:30:09.936735 [info ] [MainThread]: 
[0m10:30:09.937144 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m10:30:09.937991 [debug] [MainThread]: Command end result
[0m10:30:09.971083 [info ] [MainThread]: 
[0m10:30:09.971569 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:30:09.971875 [info ] [MainThread]: 
[0m10:30:09.972217 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:30:09.973011 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.99253845, "process_user_time": 2.096279, "process_kernel_time": 0.12378, "process_mem_max_rss": "113928", "process_out_blocks": "2592", "process_in_blocks": "0"}
[0m10:30:09.973516 [debug] [MainThread]: Command `dbt run` succeeded at 10:30:09.973403 after 0.99 seconds
[0m10:30:09.973853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa13450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f659fa13510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65a37c0710>]}
[0m10:30:09.974204 [debug] [MainThread]: Flushing usage events
[0m10:57:22.525956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d7e7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d272990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d273dd0>]}


============================== 10:57:22.528600 | dceb85d6-6f16-4883-9625-974504ee95c6 ==============================
[0m10:57:22.528600 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:57:22.529225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_billing', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:22.671239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d19ce90>]}
[0m10:57:22.717427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x730550f50510>]}
[0m10:57:22.718164 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:22.728277 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:57:22.845439 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:22.846016 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:57:23.063768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d29e590>]}
[0m10:57:23.154955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054b5d4110>]}
[0m10:57:23.155417 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:57:23.155736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054b6b9110>]}
[0m10:57:23.157150 [info ] [MainThread]: 
[0m10:57:23.157709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:23.158566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:57:23.196955 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:57:23.197298 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:57:23.197586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:23.201902 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:57:23.203171 [debug] [ThreadPool]: On list_my_db: Close
[0m10:57:23.207995 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:57:23.213842 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:23.214270 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:57:23.214584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:23.217941 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.218345 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:23.218685 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:57:23.221254 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:57:23.222686 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:57:23.223175 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:57:23.229401 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.229735 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.229989 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:23.233284 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.233656 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.234026 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:23.243116 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:57:23.244590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054a579350>]}
[0m10:57:23.244998 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:23.245425 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.245688 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.246262 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.246568 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.246831 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.247076 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.247494 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:23.247785 [debug] [MainThread]: On master: Close
[0m10:57:23.248212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:23.248548 [info ] [MainThread]: 
[0m10:57:23.250519 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:57:23.251047 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:57:23.251537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:57:23.251935 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:57:23.259475 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:57:23.260056 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:57:23.296116 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:57:23.296663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:23.296991 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:57:23.297275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:23.301003 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.301437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:23.301784 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceId "as Invoice_id,
        "PatientID "as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m10:57:23.302517 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "InvoiceId " does not exist
LINE 7:     select  "InvoiceId "as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:57:23.302915 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:57:23.303429 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:57:23.307102 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId "as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:23.308508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dceb85d6-6f16-4883-9625-974504ee95c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054a114e10>]}
[0m10:57:23.309097 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:57:23.309703 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:57:23.311433 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.311774 [debug] [MainThread]: On master: BEGIN
[0m10:57:23.312040 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:23.315163 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:23.315611 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.315888 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:23.316141 [debug] [MainThread]: On master: COMMIT
[0m10:57:23.316597 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:23.316968 [debug] [MainThread]: On master: Close
[0m10:57:23.317571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:23.317970 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:57:23.318395 [info ] [MainThread]: 
[0m10:57:23.318872 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:57:23.320158 [debug] [MainThread]: Command end result
[0m10:57:23.350717 [info ] [MainThread]: 
[0m10:57:23.351321 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:57:23.351708 [info ] [MainThread]: 
[0m10:57:23.352186 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId "as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:23.352516 [info ] [MainThread]: 
[0m10:57:23.352895 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:23.353646 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8740776, "process_user_time": 2.005954, "process_kernel_time": 0.145778, "process_mem_max_rss": "114464", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m10:57:23.354125 [debug] [MainThread]: Command `dbt run` failed at 10:57:23.354023 after 0.87 seconds
[0m10:57:23.354472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d273dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d404210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73054d27fad0>]}
[0m10:57:23.354807 [debug] [MainThread]: Flushing usage events
[0m10:57:56.256910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd93390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd48c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd8c1d0>]}


============================== 10:57:56.259611 | 27b2c526-50bf-425c-9f06-78e9cd5d7dc6 ==============================
[0m10:57:56.259611 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:57:56.260110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:57:56.388029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a467410>]}
[0m10:57:56.434874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840faaced0>]}
[0m10:57:56.435605 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:57:56.445717 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:57:56.562543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:57:56.563090 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:57:56.782695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a2fb6d0>]}
[0m10:57:56.873903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bcbbb50>]}
[0m10:57:56.874381 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:57:56.874674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840bd528d0>]}
[0m10:57:56.876045 [info ] [MainThread]: 
[0m10:57:56.876587 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:57:56.877425 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:57:56.918376 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:57:56.918756 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:57:56.919019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:57:56.923882 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:57:56.925236 [debug] [ThreadPool]: On list_my_db: Close
[0m10:57:56.930329 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:57:56.936111 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:56.936457 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:57:56.936721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:57:56.939937 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:57:56.940350 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:57:56.940679 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:57:56.943115 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:57:56.944535 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:57:56.945026 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:57:56.951168 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.951606 [debug] [MainThread]: On master: BEGIN
[0m10:57:56.951878 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:57:56.955160 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:56.955601 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.955989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:57:56.965276 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:57:56.966809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a1f5250>]}
[0m10:57:56.967213 [debug] [MainThread]: On master: ROLLBACK
[0m10:57:56.967698 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.967992 [debug] [MainThread]: On master: BEGIN
[0m10:57:56.968444 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:56.968793 [debug] [MainThread]: On master: COMMIT
[0m10:57:56.969076 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:56.969361 [debug] [MainThread]: On master: COMMIT
[0m10:57:56.969787 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:56.970090 [debug] [MainThread]: On master: Close
[0m10:57:56.970554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:57:56.970910 [info ] [MainThread]: 
[0m10:57:56.972759 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:57:56.973288 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:57:56.973784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:57:56.974175 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:57:56.981989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:57:56.982670 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:57:57.018941 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:57:57.019641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:57.020016 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:57:57.020409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:57:57.023496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:57:57.023910 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:57:57.024234 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceId " as Invoice_id,
        "PatientID " as Patient_id,
        "Items",
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m10:57:57.025024 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "InvoiceId " does not exist
LINE 7:     select  "InvoiceId " as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:57:57.025471 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:57:57.026031 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:57:57.030476 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:57.032056 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27b2c526-50bf-425c-9f06-78e9cd5d7dc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840a12a250>]}
[0m10:57:57.032679 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:57:57.033284 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:57:57.034820 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:57.035136 [debug] [MainThread]: On master: BEGIN
[0m10:57:57.035425 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:57:57.038170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:57:57.038633 [debug] [MainThread]: On master: COMMIT
[0m10:57:57.038953 [debug] [MainThread]: Using postgres connection "master"
[0m10:57:57.039230 [debug] [MainThread]: On master: COMMIT
[0m10:57:57.039634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:57:57.039918 [debug] [MainThread]: On master: Close
[0m10:57:57.040326 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:57:57.040617 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:57:57.040923 [info ] [MainThread]: 
[0m10:57:57.041269 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:57:57.041995 [debug] [MainThread]: Command end result
[0m10:57:57.075025 [info ] [MainThread]: 
[0m10:57:57.075500 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:57:57.075803 [info ] [MainThread]: 
[0m10:57:57.076179 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceId " does not exist
  LINE 7:     select  "InvoiceId " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:57:57.076491 [info ] [MainThread]: 
[0m10:57:57.076786 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:57:57.077647 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8619785, "process_user_time": 1.880381, "process_kernel_time": 0.148713, "process_mem_max_rss": "114292", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m10:57:57.078521 [debug] [MainThread]: Command `dbt run` failed at 10:57:57.078367 after 0.86 seconds
[0m10:57:57.078911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840fd04c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77840fd04dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x778408db0e10>]}
[0m10:57:57.079264 [debug] [MainThread]: Flushing usage events
[0m10:58:20.013879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f72e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f777dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f775090>]}


============================== 10:58:20.016459 | efa82402-2273-49cf-a7eb-b88531ee0c26 ==============================
[0m10:58:20.016459 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:58:20.016967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:58:20.147097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f6b1410>]}
[0m10:58:20.192917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa63430a50>]}
[0m10:58:20.193646 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:58:20.203373 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:58:20.318609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:58:20.319200 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:58:20.535895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5dba5010>]}
[0m10:58:20.628986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5db01050>]}
[0m10:58:20.629469 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:58:20.629771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5d75ed90>]}
[0m10:58:20.631127 [info ] [MainThread]: 
[0m10:58:20.631630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:58:20.632460 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:58:20.672547 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:58:20.672993 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:58:20.673276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:58:20.678309 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:58:20.679681 [debug] [ThreadPool]: On list_my_db: Close
[0m10:58:20.684655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:58:20.691114 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:58:20.691508 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:58:20.691883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:58:20.695232 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.695664 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:58:20.695965 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:58:20.698403 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:58:20.699743 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:58:20.700151 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:58:20.706893 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.707265 [debug] [MainThread]: On master: BEGIN
[0m10:58:20.707550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:58:20.710677 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.711050 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.711411 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:58:20.720552 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:58:20.721995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5f621450>]}
[0m10:58:20.722430 [debug] [MainThread]: On master: ROLLBACK
[0m10:58:20.722910 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.723188 [debug] [MainThread]: On master: BEGIN
[0m10:58:20.723816 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.724165 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.724463 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.724728 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.725191 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:58:20.725490 [debug] [MainThread]: On master: Close
[0m10:58:20.725958 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:20.726264 [info ] [MainThread]: 
[0m10:58:20.728232 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:58:20.728766 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:58:20.729356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:58:20.729784 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:58:20.737823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:58:20.738562 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:58:20.774890 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:58:20.775516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:58:20.775845 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:58:20.776137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:58:20.779500 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.779947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:58:20.780292 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID " as Invoice_id,
        "PatientID " as Patient_id,
        "Items",
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m10:58:20.781050 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "InvoiceID " does not exist
LINE 7:     select  "InvoiceID " as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:58:20.781438 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:58:20.781969 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:58:20.785672 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceID " does not exist
  LINE 7:     select  "InvoiceID " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:58:20.787322 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efa82402-2273-49cf-a7eb-b88531ee0c26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5de938d0>]}
[0m10:58:20.787987 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:58:20.788597 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:58:20.790228 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.790535 [debug] [MainThread]: On master: BEGIN
[0m10:58:20.790800 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:58:20.793678 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:58:20.794117 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.794478 [debug] [MainThread]: Using postgres connection "master"
[0m10:58:20.794739 [debug] [MainThread]: On master: COMMIT
[0m10:58:20.795106 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:58:20.795384 [debug] [MainThread]: On master: Close
[0m10:58:20.795783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:58:20.796050 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:58:20.796327 [info ] [MainThread]: 
[0m10:58:20.796677 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:58:20.797397 [debug] [MainThread]: Command end result
[0m10:58:20.828081 [info ] [MainThread]: 
[0m10:58:20.828664 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:58:20.829029 [info ] [MainThread]: 
[0m10:58:20.829605 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "InvoiceID " does not exist
  LINE 7:     select  "InvoiceID " as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:58:20.830006 [info ] [MainThread]: 
[0m10:58:20.830435 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:58:20.831301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.85898364, "process_user_time": 1.898164, "process_kernel_time": 0.127809, "process_mem_max_rss": "114488", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m10:58:20.831807 [debug] [MainThread]: Command `dbt run` failed at 10:58:20.831702 after 0.86 seconds
[0m10:58:20.832163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5fa6ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa5dce96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77aa636b8c90>]}
[0m10:58:20.832497 [debug] [MainThread]: Flushing usage events
[0m10:59:45.357640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb555e5a650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb555e5b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb555e5add0>]}


============================== 10:59:45.360365 | 37f7e44b-f3dc-4e7a-83aa-2cf584728cf4 ==============================
[0m10:59:45.360365 [info ] [MainThread]: Running with dbt=1.8.3
[0m10:59:45.360925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:59:45.505546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb5544e0bd0>]}
[0m10:59:45.553267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb559b4cf10>]}
[0m10:59:45.553951 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m10:59:45.564155 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m10:59:45.684624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:59:45.685261 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m10:59:45.905197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb554252190>]}
[0m10:59:45.996828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb554161850>]}
[0m10:59:45.997259 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m10:59:45.997561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb55458ffd0>]}
[0m10:59:45.998882 [info ] [MainThread]: 
[0m10:59:45.999393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:59:46.000172 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m10:59:46.039937 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m10:59:46.040375 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m10:59:46.040655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:46.045693 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m10:59:46.047147 [debug] [ThreadPool]: On list_my_db: Close
[0m10:59:46.052387 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m10:59:46.058478 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:59:46.058824 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m10:59:46.059076 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:59:46.062289 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.062655 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m10:59:46.062953 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m10:59:46.065386 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:59:46.066706 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m10:59:46.067159 [debug] [ThreadPool]: On list_my_db_public: Close
[0m10:59:46.073764 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.074122 [debug] [MainThread]: On master: BEGIN
[0m10:59:46.074425 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:59:46.077466 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.077870 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.078222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:59:46.087237 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:59:46.088781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb55415a3d0>]}
[0m10:59:46.089203 [debug] [MainThread]: On master: ROLLBACK
[0m10:59:46.089815 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.090222 [debug] [MainThread]: On master: BEGIN
[0m10:59:46.090960 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.091327 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.091618 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.091889 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.092261 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:59:46.092543 [debug] [MainThread]: On master: Close
[0m10:59:46.092991 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:59:46.093346 [info ] [MainThread]: 
[0m10:59:46.095596 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m10:59:46.096139 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m10:59:46.096675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m10:59:46.097022 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m10:59:46.104594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m10:59:46.105349 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m10:59:46.141771 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m10:59:46.142386 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:59:46.142723 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m10:59:46.143011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:59:46.146193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.146617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m10:59:46.146957 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  InvoiceID  as Invoice_id,
        PatientID  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m10:59:46.147685 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "invoiceid" does not exist
LINE 7:     select  InvoiceID  as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m10:59:46.148077 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m10:59:46.148575 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m10:59:46.152502 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID  as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:59:46.153942 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f7e44b-f3dc-4e7a-83aa-2cf584728cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb5541ca090>]}
[0m10:59:46.154546 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m10:59:46.155127 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m10:59:46.156657 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.156972 [debug] [MainThread]: On master: BEGIN
[0m10:59:46.157229 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:59:46.160051 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:59:46.160467 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.160758 [debug] [MainThread]: Using postgres connection "master"
[0m10:59:46.161021 [debug] [MainThread]: On master: COMMIT
[0m10:59:46.161415 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:59:46.161711 [debug] [MainThread]: On master: Close
[0m10:59:46.162186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:46.162539 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m10:59:46.162966 [info ] [MainThread]: 
[0m10:59:46.163476 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:59:46.164588 [debug] [MainThread]: Command end result
[0m10:59:46.194362 [info ] [MainThread]: 
[0m10:59:46.194808 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:59:46.195137 [info ] [MainThread]: 
[0m10:59:46.195577 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID  as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m10:59:46.195888 [info ] [MainThread]: 
[0m10:59:46.196246 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:59:46.196996 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.88652784, "process_user_time": 2.021291, "process_kernel_time": 0.137951, "process_mem_max_rss": "114672", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m10:59:46.197455 [debug] [MainThread]: Command `dbt run` failed at 10:59:46.197352 after 0.89 seconds
[0m10:59:46.197791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb5545c6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb559da0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cb559da0c50>]}
[0m10:59:46.198107 [debug] [MainThread]: Flushing usage events
[0m11:00:25.227241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683de3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96840fcc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683db11d0>]}


============================== 11:00:25.229794 | 1036a25d-4f91-4d54-911b-0d84eba48287 ==============================
[0m11:00:25.229794 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:00:25.230290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:00:25.360574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683c27450>]}
[0m11:00:25.406296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683dba550>]}
[0m11:00:25.407020 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:00:25.415707 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:00:25.536643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:00:25.537233 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:00:25.755933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9682542a50>]}
[0m11:00:25.846628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96821be590>]}
[0m11:00:25.847090 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:00:25.847378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96821d2e90>]}
[0m11:00:25.848795 [info ] [MainThread]: 
[0m11:00:25.849393 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:25.850225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:00:25.888906 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:00:25.889290 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:00:25.889585 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:25.894369 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:00:25.895623 [debug] [ThreadPool]: On list_my_db: Close
[0m11:00:25.901156 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:00:25.907050 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:25.907396 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:00:25.907650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:25.910707 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.911064 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:25.911364 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:00:25.913751 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:00:25.915106 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:00:25.915560 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:00:25.922324 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.922693 [debug] [MainThread]: On master: BEGIN
[0m11:00:25.922953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:25.926057 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.926429 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.926783 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:25.935764 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:25.937210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9684358210>]}
[0m11:00:25.937637 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:25.938099 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.938447 [debug] [MainThread]: On master: BEGIN
[0m11:00:25.939052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.939371 [debug] [MainThread]: On master: COMMIT
[0m11:00:25.939641 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:25.939885 [debug] [MainThread]: On master: COMMIT
[0m11:00:25.940259 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:25.940560 [debug] [MainThread]: On master: Close
[0m11:00:25.940999 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:25.941318 [info ] [MainThread]: 
[0m11:00:25.943319 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:00:25.943870 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:00:25.944453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:00:25.944844 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:00:25.952522 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:00:25.953105 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:00:25.989785 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:00:25.990543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:25.990975 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:00:25.991350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:25.994293 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:25.994758 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:25.995116 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  InvoiceID as Invoice_id,
        PatientID  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:00:25.995870 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "invoiceid" does not exist
LINE 7:     select  InvoiceID as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m11:00:25.996242 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:00:25.996776 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:00:26.000487 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:26.002556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1036a25d-4f91-4d54-911b-0d84eba48287', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96821d2910>]}
[0m11:00:26.003211 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:00:26.003832 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:00:26.005529 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.005858 [debug] [MainThread]: On master: BEGIN
[0m11:00:26.006135 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:26.009256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:26.009745 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.010041 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:26.010318 [debug] [MainThread]: On master: COMMIT
[0m11:00:26.010727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:26.011052 [debug] [MainThread]: On master: Close
[0m11:00:26.011687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:26.012012 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:00:26.012383 [info ] [MainThread]: 
[0m11:00:26.012999 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:00:26.014185 [debug] [MainThread]: Command end result
[0m11:00:26.046171 [info ] [MainThread]: 
[0m11:00:26.046612 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:00:26.046902 [info ] [MainThread]: 
[0m11:00:26.047266 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:26.047570 [info ] [MainThread]: 
[0m11:00:26.047870 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:00:26.048606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8627668, "process_user_time": 1.935678, "process_kernel_time": 0.136624, "process_mem_max_rss": "114212", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m11:00:26.049068 [debug] [MainThread]: Command `dbt run` failed at 11:00:26.048960 after 0.86 seconds
[0m11:00:26.049409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683e05490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9683f88110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9685301710>]}
[0m11:00:26.049721 [debug] [MainThread]: Flushing usage events
[0m11:00:44.900878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3912821c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3912ad4490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39129bbd10>]}


============================== 11:00:44.903434 | e05dd429-6bdd-4fb8-8252-fe551f3eefa5 ==============================
[0m11:00:44.903434 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:00:44.903987 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_billing', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:00:45.030742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910ea95d0>]}
[0m11:00:45.076881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39164ed050>]}
[0m11:00:45.077563 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:00:45.086241 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:00:45.203694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:00:45.204287 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:00:45.422669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910ba8050>]}
[0m11:00:45.514040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910c56790>]}
[0m11:00:45.514553 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:00:45.514838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910c5fbd0>]}
[0m11:00:45.516247 [info ] [MainThread]: 
[0m11:00:45.516804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:00:45.517678 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:00:45.556703 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:00:45.557096 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:00:45.557384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:00:45.562451 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:00:45.563752 [debug] [ThreadPool]: On list_my_db: Close
[0m11:00:45.568487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:00:45.574264 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:45.574602 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:00:45.574866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:00:45.578490 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.578908 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:00:45.579211 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:00:45.581685 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:00:45.583041 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:00:45.583480 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:00:45.590061 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.590403 [debug] [MainThread]: On master: BEGIN
[0m11:00:45.590657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:00:45.593759 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.594169 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.594544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:00:45.603653 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:00:45.605169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3910d63e90>]}
[0m11:00:45.605593 [debug] [MainThread]: On master: ROLLBACK
[0m11:00:45.606064 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.606345 [debug] [MainThread]: On master: BEGIN
[0m11:00:45.606937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.607229 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.607507 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.607755 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.608127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:45.608418 [debug] [MainThread]: On master: Close
[0m11:00:45.608851 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:00:45.609196 [info ] [MainThread]: 
[0m11:00:45.610995 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:00:45.611508 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:00:45.612005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:00:45.612451 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:00:45.619836 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:00:45.620426 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:00:45.655138 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:00:45.655747 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:45.656061 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:00:45.656366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:00:45.659710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.660326 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:00:45.660691 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID " as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:00:45.661429 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "PatientID " does not exist
LINE 8:         "PatientID " as Patient_id,
                ^
HINT:  Perhaps you meant to reference the column "Billing.PatientID".

[0m11:00:45.661869 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:00:45.662369 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:00:45.666036 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:45.667445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05dd429-6bdd-4fb8-8252-fe551f3eefa5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f390ff95290>]}
[0m11:00:45.668036 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.05s]
[0m11:00:45.668631 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:00:45.670246 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.670556 [debug] [MainThread]: On master: BEGIN
[0m11:00:45.670824 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:00:45.673944 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:00:45.674390 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.674690 [debug] [MainThread]: Using postgres connection "master"
[0m11:00:45.674960 [debug] [MainThread]: On master: COMMIT
[0m11:00:45.675374 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:00:45.675685 [debug] [MainThread]: On master: Close
[0m11:00:45.676186 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:00:45.676656 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:00:45.677067 [info ] [MainThread]: 
[0m11:00:45.677614 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:00:45.678899 [debug] [MainThread]: Command end result
[0m11:00:45.710953 [info ] [MainThread]: 
[0m11:00:45.711861 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:00:45.712404 [info ] [MainThread]: 
[0m11:00:45.713106 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:00:45.713482 [info ] [MainThread]: 
[0m11:00:45.713812 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:00:45.714593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8549311, "process_user_time": 1.877543, "process_kernel_time": 0.110913, "process_mem_max_rss": "114284", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m11:00:45.715111 [debug] [MainThread]: Command `dbt run` failed at 11:00:45.714999 after 0.86 seconds
[0m11:00:45.715542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39168d58d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39129c8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3916760f50>]}
[0m11:00:45.715893 [debug] [MainThread]: Flushing usage events
[0m11:01:05.020938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a01963c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a01afb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a019634d0>]}


============================== 11:01:05.023567 | ce84fa02-c7b5-4976-83f8-5229db52a647 ==============================
[0m11:01:05.023567 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:05.024115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_billing', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:01:05.153375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a019cc1d0>]}
[0m11:01:05.200322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a000a0550>]}
[0m11:01:05.201025 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:01:05.209726 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:01:05.327692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:01:05.328031 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:01:05.376494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849fffef590>]}
[0m11:01:05.467683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849fff19d10>]}
[0m11:01:05.468165 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:01:05.468456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a032838d0>]}
[0m11:01:05.469852 [info ] [MainThread]: 
[0m11:01:05.470551 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:05.471478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:01:05.510479 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:01:05.510840 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:05.511096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:05.515468 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:01:05.516823 [debug] [ThreadPool]: On list_my_db: Close
[0m11:01:05.521781 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:01:05.527610 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:05.527933 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:01:05.528188 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:05.531359 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.531724 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:05.532029 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:01:05.534486 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:01:05.535851 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:01:05.536215 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:01:05.542462 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.542805 [debug] [MainThread]: On master: BEGIN
[0m11:01:05.543095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:05.546369 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.546743 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.547111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:01:05.556358 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:01:05.557822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849ffd42e10>]}
[0m11:01:05.558235 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:05.558709 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.558991 [debug] [MainThread]: On master: BEGIN
[0m11:01:05.559424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.559694 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.559943 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.560184 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.560603 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:05.560886 [debug] [MainThread]: On master: Close
[0m11:01:05.561309 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:05.561646 [info ] [MainThread]: 
[0m11:01:05.563625 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:01:05.564137 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:01:05.564617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:01:05.565024 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:01:05.572753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:01:05.573367 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:01:05.610150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:01:05.610770 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:05.611101 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:01:05.611402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:05.614590 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.614982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:05.615322 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID " as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:01:05.616661 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "PatientID " does not exist
LINE 8:         "PatientID " as Patient_id,
                ^
HINT:  Perhaps you meant to reference the column "Billing.PatientID".

[0m11:01:05.617285 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:01:05.617908 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:01:05.621673 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:05.623052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce84fa02-c7b5-4976-83f8-5229db52a647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7849ff2b3c50>]}
[0m11:01:05.623635 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:01:05.624219 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:01:05.625767 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.626164 [debug] [MainThread]: On master: BEGIN
[0m11:01:05.626461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:05.629218 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:05.629649 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.629969 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:05.630246 [debug] [MainThread]: On master: COMMIT
[0m11:01:05.630648 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:05.630945 [debug] [MainThread]: On master: Close
[0m11:01:05.631362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:05.631627 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:01:05.631958 [info ] [MainThread]: 
[0m11:01:05.632327 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:01:05.633144 [debug] [MainThread]: Command end result
[0m11:01:05.663142 [info ] [MainThread]: 
[0m11:01:05.663716 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:05.664053 [info ] [MainThread]: 
[0m11:01:05.664505 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "PatientID " does not exist
  LINE 8:         "PatientID " as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:05.664829 [info ] [MainThread]: 
[0m11:01:05.665179 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:05.666294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6867025, "process_user_time": 1.690054, "process_kernel_time": 0.120932, "process_mem_max_rss": "111464", "process_out_blocks": "1760", "command_success": false, "process_in_blocks": "0"}
[0m11:01:05.666988 [debug] [MainThread]: Command `dbt run` failed at 11:01:05.666875 after 0.69 seconds
[0m11:01:05.667378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a018c1f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a02dba390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784a01983090>]}
[0m11:01:05.667757 [debug] [MainThread]: Flushing usage events
[0m11:01:23.991175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f93d9b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f93d07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f9553750>]}


============================== 11:01:23.993728 | 430bb237-918d-4257-9e2f-6faa9c2beb52 ==============================
[0m11:01:23.993728 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:23.994427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_billing', 'send_anonymous_usage_stats': 'True'}
[0m11:01:24.123872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f920b650>]}
[0m11:01:24.170055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fd09c710>]}
[0m11:01:24.170790 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:01:24.179633 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:01:24.296193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:24.296768 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:01:24.519217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f79608d0>]}
[0m11:01:24.612744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f7756910>]}
[0m11:01:24.613264 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:01:24.613587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f77ee090>]}
[0m11:01:24.615001 [info ] [MainThread]: 
[0m11:01:24.615589 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:24.616485 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:01:24.657813 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:01:24.658194 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:24.658659 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:24.663496 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:01:24.664874 [debug] [ThreadPool]: On list_my_db: Close
[0m11:01:24.669803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:01:24.675698 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:24.676049 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:01:24.676300 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:24.679321 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.679701 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:24.679989 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:01:24.682492 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:01:24.683852 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:01:24.684239 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:01:24.690486 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.690866 [debug] [MainThread]: On master: BEGIN
[0m11:01:24.691122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:24.694177 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.694638 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.695031 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:01:24.704052 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:01:24.705601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f7a35650>]}
[0m11:01:24.706086 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:24.706537 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.706848 [debug] [MainThread]: On master: BEGIN
[0m11:01:24.707316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.707650 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.707954 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.708230 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.708679 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:24.708983 [debug] [MainThread]: On master: Close
[0m11:01:24.709476 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:24.709880 [info ] [MainThread]: 
[0m11:01:24.712082 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:01:24.712624 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:01:24.713106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:01:24.713601 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:01:24.722540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:01:24.723178 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:01:24.757947 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:01:24.758605 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:24.758916 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:01:24.759198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:24.762890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.763345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:24.763672 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        PatientID  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:01:24.764503 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "patientid" does not exist
LINE 8:         PatientID  as Patient_id,
                ^
HINT:  Perhaps you meant to reference the column "Billing.PatientID".

[0m11:01:24.764897 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:01:24.765450 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:01:24.769184 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "patientid" does not exist
  LINE 8:         PatientID  as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:24.770599 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '430bb237-918d-4257-9e2f-6faa9c2beb52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f7a4ed50>]}
[0m11:01:24.771200 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:01:24.771817 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:01:24.773475 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.773823 [debug] [MainThread]: On master: BEGIN
[0m11:01:24.774101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:24.777032 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:24.777522 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.777833 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:24.778106 [debug] [MainThread]: On master: COMMIT
[0m11:01:24.778473 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:24.778761 [debug] [MainThread]: On master: Close
[0m11:01:24.779166 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:24.779444 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:01:24.779758 [info ] [MainThread]: 
[0m11:01:24.780079 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:01:24.780784 [debug] [MainThread]: Command end result
[0m11:01:24.810738 [info ] [MainThread]: 
[0m11:01:24.811463 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:24.812044 [info ] [MainThread]: 
[0m11:01:24.812637 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "patientid" does not exist
  LINE 8:         PatientID  as Patient_id,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.PatientID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:24.813081 [info ] [MainThread]: 
[0m11:01:24.813521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:24.814404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.86440617, "process_user_time": 1.875233, "process_kernel_time": 0.144863, "process_mem_max_rss": "114616", "process_out_blocks": "2592", "command_success": false, "process_in_blocks": "0"}
[0m11:01:24.814948 [debug] [MainThread]: Command `dbt run` failed at 11:01:24.814842 after 0.87 seconds
[0m11:01:24.815297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fd2f0c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4fd2f0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4f93beed0>]}
[0m11:01:24.815634 [debug] [MainThread]: Flushing usage events
[0m11:01:54.718953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5945da590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb594623d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb594622750>]}


============================== 11:01:54.721903 | b5d885f9-a7b5-464e-9eb1-2180c3f32ab9 ==============================
[0m11:01:54.721903 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:01:54.722597 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:01:54.864249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb592ce4050>]}
[0m11:01:54.912110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5982d5010>]}
[0m11:01:54.912845 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:01:54.922312 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:01:55.040720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:01:55.041325 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:01:55.267770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb592b63dd0>]}
[0m11:01:55.361397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb592a02fd0>]}
[0m11:01:55.361901 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:01:55.362188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5928e1710>]}
[0m11:01:55.363623 [info ] [MainThread]: 
[0m11:01:55.364201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:01:55.365089 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:01:55.402777 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:01:55.403135 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:01:55.403408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:01:55.407677 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:01:55.408954 [debug] [ThreadPool]: On list_my_db: Close
[0m11:01:55.413737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:01:55.419730 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:55.420102 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:01:55.420362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:01:55.423434 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.423805 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:01:55.424094 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:01:55.426545 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:01:55.427896 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:01:55.428297 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:01:55.434351 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.434790 [debug] [MainThread]: On master: BEGIN
[0m11:01:55.435148 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:01:55.438419 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.438836 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.439327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:01:55.448417 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:01:55.449997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb59529d5d0>]}
[0m11:01:55.450457 [debug] [MainThread]: On master: ROLLBACK
[0m11:01:55.450979 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.451289 [debug] [MainThread]: On master: BEGIN
[0m11:01:55.451979 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.452320 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.452622 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.452885 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.453281 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:55.453601 [debug] [MainThread]: On master: Close
[0m11:01:55.454057 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:01:55.454420 [info ] [MainThread]: 
[0m11:01:55.456590 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:01:55.457167 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:01:55.457792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:01:55.458308 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:01:55.466063 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:01:55.466877 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:01:55.502691 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:01:55.503321 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:55.503634 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:01:55.503912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:01:55.507547 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.508031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:01:55.508401 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        Items,
        Amount
    from "my_db"."public"."Billing"
  );
[0m11:01:55.509247 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "items" does not exist
LINE 9:         Items,
                ^
HINT:  Perhaps you meant to reference the column "Billing.Items".

[0m11:01:55.509674 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m11:01:55.510181 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:01:55.513831 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "items" does not exist
  LINE 9:         Items,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.Items".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:55.515316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d885f9-a7b5-464e-9eb1-2180c3f32ab9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5919d3b90>]}
[0m11:01:55.515992 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:01:55.516603 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:01:55.518276 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.518643 [debug] [MainThread]: On master: BEGIN
[0m11:01:55.518925 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:01:55.522045 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:01:55.522502 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.522798 [debug] [MainThread]: Using postgres connection "master"
[0m11:01:55.523058 [debug] [MainThread]: On master: COMMIT
[0m11:01:55.523527 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:01:55.523980 [debug] [MainThread]: On master: Close
[0m11:01:55.524642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:01:55.524987 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:01:55.525494 [info ] [MainThread]: 
[0m11:01:55.526250 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:01:55.527662 [debug] [MainThread]: Command end result
[0m11:01:55.558184 [info ] [MainThread]: 
[0m11:01:55.558716 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:01:55.559062 [info ] [MainThread]: 
[0m11:01:55.559470 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "items" does not exist
  LINE 9:         Items,
                  ^
  HINT:  Perhaps you meant to reference the column "Billing.Items".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m11:01:55.559813 [info ] [MainThread]: 
[0m11:01:55.560136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:01:55.560931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8905146, "process_user_time": 1.990506, "process_kernel_time": 0.127775, "process_mem_max_rss": "114204", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m11:01:55.561452 [debug] [MainThread]: Command `dbt run` failed at 11:01:55.561301 after 0.89 seconds
[0m11:01:55.561812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb59462d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5947b0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb5983c47d0>]}
[0m11:01:55.562140 [debug] [MainThread]: Flushing usage events
[0m11:02:08.051261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ec08c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ebeb8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205f82abd0>]}


============================== 11:02:08.053866 | e5660aeb-9f0a-4228-a811-6486c847dfe6 ==============================
[0m11:02:08.053866 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:02:08.054441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_billing', 'send_anonymous_usage_stats': 'True'}
[0m11:02:08.184010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d30fe90>]}
[0m11:02:08.230279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d34d210>]}
[0m11:02:08.231009 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:02:08.239882 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:02:08.360680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:08.361326 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:02:08.579864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205cfd8b10>]}
[0m11:02:08.671680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205cfb8390>]}
[0m11:02:08.672181 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:02:08.672511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d30e210>]}
[0m11:02:08.673978 [info ] [MainThread]: 
[0m11:02:08.674591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:08.675497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:02:08.713470 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:02:08.713831 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:02:08.714096 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:08.718593 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:02:08.719877 [debug] [ThreadPool]: On list_my_db: Close
[0m11:02:08.724663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:02:08.730683 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:08.731041 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:02:08.731367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:08.734383 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.734786 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:08.735082 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:08.737617 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:02:08.739044 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:02:08.739463 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:02:08.745977 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.746462 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.746735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:08.749891 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.750249 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.750639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:08.759684 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:02:08.761371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ec41b10>]}
[0m11:02:08.761858 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:08.762313 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.762592 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.763157 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.763468 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.763732 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.763987 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.764366 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:08.764628 [debug] [MainThread]: On master: Close
[0m11:02:08.765060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:08.765370 [info ] [MainThread]: 
[0m11:02:08.767214 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m11:02:08.767736 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m11:02:08.768267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m11:02:08.768660 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m11:02:08.776727 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m11:02:08.777639 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m11:02:08.813797 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m11:02:08.814432 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.814780 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m11:02:08.815074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:08.818387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.818808 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.819154 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items",
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m11:02:08.820651 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:02:08.826843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.827233 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
alter table "my_db"."public"."stg_billing__dbt_tmp" rename to "stg_billing"
[0m11:02:08.827892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:02:08.841539 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m11:02:08.841930 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.842254 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m11:02:08.872646 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:02:08.887829 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_billing__dbt_backup"
[0m11:02:08.898051 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m11:02:08.898685 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
drop view if exists "my_db"."public"."stg_billing__dbt_backup" cascade
[0m11:02:08.899555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:02:08.902948 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m11:02:08.904766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5660aeb-9f0a-4228-a811-6486c847dfe6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205d065890>]}
[0m11:02:08.905626 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_billing ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m11:02:08.906517 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m11:02:08.907912 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.908277 [debug] [MainThread]: On master: BEGIN
[0m11:02:08.908574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:08.912452 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:08.912893 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.913169 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:08.913439 [debug] [MainThread]: On master: COMMIT
[0m11:02:08.913828 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:08.914110 [debug] [MainThread]: On master: Close
[0m11:02:08.914660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:08.915108 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m11:02:08.915618 [info ] [MainThread]: 
[0m11:02:08.916143 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m11:02:08.917594 [debug] [MainThread]: Command end result
[0m11:02:08.951491 [info ] [MainThread]: 
[0m11:02:08.951962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:08.952268 [info ] [MainThread]: 
[0m11:02:08.952613 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:02:08.953366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.94890964, "process_user_time": 2.068142, "process_kernel_time": 0.134944, "process_mem_max_rss": "113980", "process_out_blocks": "2584", "process_in_blocks": "0"}
[0m11:02:08.953833 [debug] [MainThread]: Command `dbt run` succeeded at 11:02:08.953729 after 0.95 seconds
[0m11:02:08.954163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x792062aec690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ebb7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79205ebb7910>]}
[0m11:02:08.954503 [debug] [MainThread]: Flushing usage events
[0m11:02:34.726945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965ae050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965ad0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965ad4d0>]}


============================== 11:02:34.729525 | 33db9efe-d426-46ce-b886-e0516d88a27e ==============================
[0m11:02:34.729525 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:02:34.730026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_doctor', 'send_anonymous_usage_stats': 'True'}
[0m11:02:34.871626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e965acb50>]}
[0m11:02:34.919194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94cd1310>]}
[0m11:02:34.919887 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:02:34.930362 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:02:35.048164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:02:35.048520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:02:35.097323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94bc7ad0>]}
[0m11:02:35.189462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94c06910>]}
[0m11:02:35.189974 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:02:35.190253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94bdc290>]}
[0m11:02:35.191704 [info ] [MainThread]: 
[0m11:02:35.192209 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:02:35.193032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:02:35.232098 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:02:35.232453 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:02:35.232713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:35.237111 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:02:35.238349 [debug] [ThreadPool]: On list_my_db: Close
[0m11:02:35.243098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:02:35.248938 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:35.249289 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:02:35.249567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:02:35.252750 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.253115 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:02:35.253429 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:02:35.255878 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:02:35.257222 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:02:35.257663 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:02:35.264221 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.264631 [debug] [MainThread]: On master: BEGIN
[0m11:02:35.264891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:02:35.267840 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.268238 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.268626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:02:35.278407 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:02:35.280119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94c3ad50>]}
[0m11:02:35.280525 [debug] [MainThread]: On master: ROLLBACK
[0m11:02:35.280926 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.281183 [debug] [MainThread]: On master: BEGIN
[0m11:02:35.281590 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.281876 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.282127 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.282376 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.282719 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:35.282978 [debug] [MainThread]: On master: Close
[0m11:02:35.283461 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:35.283893 [info ] [MainThread]: 
[0m11:02:35.286047 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_doctor
[0m11:02:35.286551 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_doctor .................................. [RUN]
[0m11:02:35.287015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_doctor)
[0m11:02:35.287466 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_doctor
[0m11:02:35.295271 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_doctor"
[0m11:02:35.295814 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_doctor
[0m11:02:35.333681 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_doctor"
[0m11:02:35.334488 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:02:35.334862 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: BEGIN
[0m11:02:35.335180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:02:35.338448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.338854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:02:35.339186 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */

  create view "my_db"."public"."stg_doctor__dbt_tmp"
    
    
  as (
    select  DoctorID as Doctor_id,
        DoctorName as Doctor_name,
        Specialization,
        DoctorContact as Doctor_contact
    from "my_db"."public"."Doctor"
  );
[0m11:02:35.339879 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "doctorid" does not exist
LINE 7:     select  DoctorID as Doctor_id,
                    ^
HINT:  Perhaps you meant to reference the column "Doctor.DoctorID".

[0m11:02:35.340282 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: ROLLBACK
[0m11:02:35.340901 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: Close
[0m11:02:35.344602 [debug] [Thread-1 (]: Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "doctorid" does not exist
  LINE 7:     select  DoctorID as Doctor_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:02:35.346064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33db9efe-d426-46ce-b886-e0516d88a27e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e94950610>]}
[0m11:02:35.346691 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_doctor ......................... [[31mERROR[0m in 0.06s]
[0m11:02:35.347287 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_doctor
[0m11:02:35.348890 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.349182 [debug] [MainThread]: On master: BEGIN
[0m11:02:35.349450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:02:35.352395 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:02:35.352822 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.353130 [debug] [MainThread]: Using postgres connection "master"
[0m11:02:35.353451 [debug] [MainThread]: On master: COMMIT
[0m11:02:35.353837 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:02:35.354127 [debug] [MainThread]: On master: Close
[0m11:02:35.354548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:35.354825 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_doctor' was properly closed.
[0m11:02:35.355137 [info ] [MainThread]: 
[0m11:02:35.355489 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:02:35.356183 [debug] [MainThread]: Command end result
[0m11:02:35.386304 [info ] [MainThread]: 
[0m11:02:35.386867 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:02:35.387242 [info ] [MainThread]: 
[0m11:02:35.387692 [error] [MainThread]:   Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "doctorid" does not exist
  LINE 7:     select  DoctorID as Doctor_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:02:35.388018 [info ] [MainThread]: 
[0m11:02:35.388393 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:02:35.389190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.71130633, "process_user_time": 1.793819, "process_kernel_time": 0.138985, "process_mem_max_rss": "111780", "process_out_blocks": "1760", "command_success": false, "process_in_blocks": "0"}
[0m11:02:35.389683 [debug] [MainThread]: Command `dbt run` failed at 11:02:35.389579 after 0.71 seconds
[0m11:02:35.390035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e96727dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e96564ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c3e96566310>]}
[0m11:02:35.390376 [debug] [MainThread]: Flushing usage events
[0m11:03:02.005538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e2244b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e22420910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e2244a290>]}


============================== 11:03:02.008104 | 04ff815a-cd8c-4622-bfda-bb23ac3dfd60 ==============================
[0m11:03:02.008104 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:03:02.008608 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_doctor', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:03:02.140346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e22356c10>]}
[0m11:03:02.186245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e20b8d2d0>]}
[0m11:03:02.186932 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:03:02.195432 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:03:02.312448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:02.313044 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m11:03:02.530410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e208a7010>]}
[0m11:03:02.622139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e207cff90>]}
[0m11:03:02.622658 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:03:02.622932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e20a12cd0>]}
[0m11:03:02.624359 [info ] [MainThread]: 
[0m11:03:02.624863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:02.625681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:03:02.665054 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:03:02.665493 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:03:02.665767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:02.670772 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:03:02.672169 [debug] [ThreadPool]: On list_my_db: Close
[0m11:03:02.677275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:03:02.683171 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:02.683536 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:03:02.683800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:02.687012 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.687430 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:02.687735 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:03:02.690280 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:03:02.691799 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:03:02.692480 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:03:02.699159 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.699546 [debug] [MainThread]: On master: BEGIN
[0m11:03:02.699827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:02.702902 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.703343 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.703744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:02.713451 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:03:02.715232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e1f73d210>]}
[0m11:03:02.715683 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:02.716184 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.716494 [debug] [MainThread]: On master: BEGIN
[0m11:03:02.717083 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.717417 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.717722 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.718004 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.718382 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:02.718686 [debug] [MainThread]: On master: Close
[0m11:03:02.719122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:02.719452 [info ] [MainThread]: 
[0m11:03:02.721413 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_doctor
[0m11:03:02.721913 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_doctor .................................. [RUN]
[0m11:03:02.722494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_doctor)
[0m11:03:02.722862 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_doctor
[0m11:03:02.730207 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_doctor"
[0m11:03:02.730807 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_doctor
[0m11:03:02.766500 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_doctor"
[0m11:03:02.767116 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:02.767444 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: BEGIN
[0m11:03:02.767732 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:02.770650 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.771047 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:02.771389 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */

  create view "my_db"."public"."stg_doctor__dbt_tmp"
    
    
  as (
    select  "DoctorID" as Doctor_id,
        "DoctorName "as Doctor_name,
        "Specialization",
        "DoctorContact" as Doctor_contact
    from "my_db"."public"."Doctor"
  );
[0m11:03:02.771983 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "DoctorName " does not exist
LINE 8:         "DoctorName "as Doctor_name,
                ^
HINT:  Perhaps you meant to reference the column "Doctor.DoctorName".

[0m11:03:02.772326 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: ROLLBACK
[0m11:03:02.772821 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: Close
[0m11:03:02.776538 [debug] [Thread-1 (]: Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "DoctorName " does not exist
  LINE 8:         "DoctorName "as Doctor_name,
                  ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorName".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:03:02.778503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04ff815a-cd8c-4622-bfda-bb23ac3dfd60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e2075f010>]}
[0m11:03:02.779193 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_doctor ......................... [[31mERROR[0m in 0.05s]
[0m11:03:02.779795 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_doctor
[0m11:03:02.781623 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.781984 [debug] [MainThread]: On master: BEGIN
[0m11:03:02.782237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:02.785301 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:02.785727 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.785992 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:02.786256 [debug] [MainThread]: On master: COMMIT
[0m11:03:02.786659 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:02.786944 [debug] [MainThread]: On master: Close
[0m11:03:02.787353 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:02.787609 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_doctor' was properly closed.
[0m11:03:02.787890 [info ] [MainThread]: 
[0m11:03:02.788213 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:03:02.788864 [debug] [MainThread]: Command end result
[0m11:03:02.817496 [info ] [MainThread]: 
[0m11:03:02.817958 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:03:02.818266 [info ] [MainThread]: 
[0m11:03:02.818745 [error] [MainThread]:   Database Error in model stg_doctor (models/staging/healthcare/stg_doctor.sql)
  column "DoctorName " does not exist
  LINE 8:         "DoctorName "as Doctor_name,
                  ^
  HINT:  Perhaps you meant to reference the column "Doctor.DoctorName".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_doctor.sql
[0m11:03:02.819193 [info ] [MainThread]: 
[0m11:03:02.819671 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:03:02.820653 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8570106, "process_user_time": 1.977956, "process_kernel_time": 0.160915, "process_mem_max_rss": "114600", "process_out_blocks": "2600", "command_success": false, "process_in_blocks": "0"}
[0m11:03:02.821210 [debug] [MainThread]: Command `dbt run` failed at 11:03:02.821093 after 0.86 seconds
[0m11:03:02.821623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e22477850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e263c4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740e263c4390>]}
[0m11:03:02.821969 [debug] [MainThread]: Flushing usage events
[0m11:03:18.998830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0f07cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c10da0d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0f0a8a10>]}


============================== 11:03:19.001558 | e97816cb-07ae-4d2a-ac51-0fe1ddf37491 ==============================
[0m11:03:19.001558 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:03:19.002069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_doctor', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:03:19.170073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d74d2d0>]}
[0m11:03:19.219914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0ef90510>]}
[0m11:03:19.220669 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:03:19.230085 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:03:19.350740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:19.351342 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_doctor.sql
[0m11:03:19.574091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d64bd10>]}
[0m11:03:19.667910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d510890>]}
[0m11:03:19.668418 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:03:19.668701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c10a81150>]}
[0m11:03:19.670125 [info ] [MainThread]: 
[0m11:03:19.670701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:19.671685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:03:19.710417 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:03:19.710793 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:03:19.711116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:19.715553 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:03:19.716826 [debug] [ThreadPool]: On list_my_db: Close
[0m11:03:19.721837 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:03:19.727598 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:19.727962 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:03:19.728264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:19.731900 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.732305 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:19.732669 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:03:19.735539 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m11:03:19.736960 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:03:19.737491 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:03:19.744262 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.744647 [debug] [MainThread]: On master: BEGIN
[0m11:03:19.744978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:19.748147 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.748543 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.748909 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:19.758760 [debug] [MainThread]: SQL status: SELECT 2 in 0.0 seconds
[0m11:03:19.760468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d511690>]}
[0m11:03:19.760853 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:19.761332 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.761614 [debug] [MainThread]: On master: BEGIN
[0m11:03:19.762184 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.762535 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.762795 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.763046 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.763382 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:19.763643 [debug] [MainThread]: On master: Close
[0m11:03:19.764055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:19.764373 [info ] [MainThread]: 
[0m11:03:19.766344 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_doctor
[0m11:03:19.766863 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_doctor .................................. [RUN]
[0m11:03:19.767422 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_doctor)
[0m11:03:19.767824 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_doctor
[0m11:03:19.775374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_doctor"
[0m11:03:19.775985 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_doctor
[0m11:03:19.811411 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_doctor"
[0m11:03:19.812039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.812396 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: BEGIN
[0m11:03:19.812721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:19.815800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.816205 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.816559 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */

  create view "my_db"."public"."stg_doctor__dbt_tmp"
    
    
  as (
    select  "DoctorID" as Doctor_id,
        "DoctorName" as Doctor_name,
        "Specialization",
        "DoctorContact" as Doctor_contact
    from "my_db"."public"."Doctor"
  );
[0m11:03:19.818422 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:03:19.824674 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.825077 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */
alter table "my_db"."public"."stg_doctor__dbt_tmp" rename to "stg_doctor"
[0m11:03:19.825767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:03:19.839882 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: COMMIT
[0m11:03:19.840349 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.840651 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: COMMIT
[0m11:03:19.841757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:03:19.847551 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_doctor__dbt_backup"
[0m11:03:19.852081 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_doctor"
[0m11:03:19.852464 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_doctor"} */
drop view if exists "my_db"."public"."stg_doctor__dbt_backup" cascade
[0m11:03:19.853067 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:03:19.855297 [debug] [Thread-1 (]: On model.dbt_modeling.stg_doctor: Close
[0m11:03:19.856817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e97816cb-07ae-4d2a-ac51-0fe1ddf37491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c0d1a39d0>]}
[0m11:03:19.857587 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_doctor ............................. [[32mCREATE VIEW[0m in 0.09s]
[0m11:03:19.858233 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_doctor
[0m11:03:19.859364 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.859653 [debug] [MainThread]: On master: BEGIN
[0m11:03:19.859913 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:19.862956 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:19.863419 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.863831 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:19.864199 [debug] [MainThread]: On master: COMMIT
[0m11:03:19.864759 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:19.865166 [debug] [MainThread]: On master: Close
[0m11:03:19.865752 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:19.866129 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_doctor' was properly closed.
[0m11:03:19.866519 [info ] [MainThread]: 
[0m11:03:19.866954 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:03:19.867887 [debug] [MainThread]: Command end result
[0m11:03:19.898181 [info ] [MainThread]: 
[0m11:03:19.898725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:19.899108 [info ] [MainThread]: 
[0m11:03:19.899450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:03:19.900275 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9443655, "process_user_time": 2.019065, "process_kernel_time": 0.145292, "process_mem_max_rss": "114064", "process_out_blocks": "2592", "process_in_blocks": "0"}
[0m11:03:19.900799 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:19.900694 after 0.94 seconds
[0m11:03:19.901119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c12f7c550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c12eb0790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4c1300c310>]}
[0m11:03:19.901481 [debug] [MainThread]: Flushing usage events
[0m11:03:51.465112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f52a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f570bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f570fd0>]}


============================== 11:03:51.467760 | 49afd10c-f618-4deb-982a-620def6d5b0c ==============================
[0m11:03:51.467760 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:03:51.468304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m stg_medical_procedure', 'send_anonymous_usage_stats': 'True'}
[0m11:03:51.599075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f457350>]}
[0m11:03:51.646972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827dcb5650>]}
[0m11:03:51.647675 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:03:51.656576 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:03:51.771824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:03:51.772381 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_medical_procedure.sql
[0m11:03:51.989395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827da4b790>]}
[0m11:03:52.081906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827d9cef10>]}
[0m11:03:52.082372 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:03:52.082659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827d977b10>]}
[0m11:03:52.084166 [info ] [MainThread]: 
[0m11:03:52.084756 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:03:52.085690 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:03:52.125121 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:03:52.125495 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:03:52.125763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:52.130602 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:03:52.131981 [debug] [ThreadPool]: On list_my_db: Close
[0m11:03:52.137074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:03:52.142786 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:52.143133 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:03:52.143420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:03:52.147005 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.147497 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:03:52.147800 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:03:52.150354 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
[0m11:03:52.151757 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:03:52.152211 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:03:52.158638 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.158979 [debug] [MainThread]: On master: BEGIN
[0m11:03:52.159228 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:03:52.162143 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.162527 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.162896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:03:52.174016 [debug] [MainThread]: SQL status: SELECT 3 in 0.0 seconds
[0m11:03:52.175853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827d965990>]}
[0m11:03:52.176242 [debug] [MainThread]: On master: ROLLBACK
[0m11:03:52.176682 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.176965 [debug] [MainThread]: On master: BEGIN
[0m11:03:52.177403 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.177671 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.177923 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.178160 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.178534 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:52.178811 [debug] [MainThread]: On master: Close
[0m11:03:52.179236 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:52.179612 [info ] [MainThread]: 
[0m11:03:52.181482 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.181981 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_medical_procedure ....................... [RUN]
[0m11:03:52.182457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_medical_procedure)
[0m11:03:52.182915 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.190489 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.191077 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.226829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.227407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.227746 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: BEGIN
[0m11:03:52.228025 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:03:52.231537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.231994 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.232368 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_medical_procedure"} */

  create view "my_db"."public"."stg_medical_procedure__dbt_tmp"
    
    
  as (
    select  "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
    from "my_db"."public"."Medical_Procedure"
  );
[0m11:03:52.234188 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:03:52.240241 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.240640 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_medical_procedure"} */
alter table "my_db"."public"."stg_medical_procedure__dbt_tmp" rename to "stg_medical_procedure"
[0m11:03:52.241342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:03:52.255259 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: COMMIT
[0m11:03:52.255663 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.255967 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: COMMIT
[0m11:03:52.263820 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:03:52.270229 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_medical_procedure__dbt_backup"
[0m11:03:52.274852 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_medical_procedure"
[0m11:03:52.275199 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_medical_procedure"} */
drop view if exists "my_db"."public"."stg_medical_procedure__dbt_backup" cascade
[0m11:03:52.275787 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:03:52.277970 [debug] [Thread-1 (]: On model.dbt_modeling.stg_medical_procedure: Close
[0m11:03:52.279398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49afd10c-f618-4deb-982a-620def6d5b0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827c936850>]}
[0m11:03:52.280094 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_medical_procedure .................. [[32mCREATE VIEW[0m in 0.10s]
[0m11:03:52.280790 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_medical_procedure
[0m11:03:52.281935 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.282251 [debug] [MainThread]: On master: BEGIN
[0m11:03:52.282513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:03:52.285910 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:03:52.286286 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.286611 [debug] [MainThread]: Using postgres connection "master"
[0m11:03:52.286887 [debug] [MainThread]: On master: COMMIT
[0m11:03:52.287280 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:03:52.287569 [debug] [MainThread]: On master: Close
[0m11:03:52.287965 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:52.288216 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_medical_procedure' was properly closed.
[0m11:03:52.288527 [info ] [MainThread]: 
[0m11:03:52.288855 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m11:03:52.289534 [debug] [MainThread]: Command end result
[0m11:03:52.320457 [info ] [MainThread]: 
[0m11:03:52.321052 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:52.321419 [info ] [MainThread]: 
[0m11:03:52.321749 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:03:52.322548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8999287, "process_user_time": 1.886749, "process_kernel_time": 0.133698, "process_mem_max_rss": "114024", "process_out_blocks": "2592", "process_in_blocks": "0"}
[0m11:03:52.323034 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:52.322930 after 0.90 seconds
[0m11:03:52.323358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f57f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72827f6ebe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728283454550>]}
[0m11:03:52.323681 [debug] [MainThread]: Flushing usage events
[0m11:04:33.806460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898ed2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898f1b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898f19210>]}


============================== 11:04:33.808952 | 237a20f3-d777-437b-a358-7b516ffe2e1f ==============================
[0m11:04:33.808952 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:04:33.809508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_patient', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:04:33.939529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898f24490>]}
[0m11:04:33.985724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c589cbdcfd0>]}
[0m11:04:33.986460 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:04:33.995450 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:04:34.114189 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:04:34.114775 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_patient.sql
[0m11:04:34.333090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5897572690>]}
[0m11:04:34.425328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5897327e90>]}
[0m11:04:34.425831 [info ] [MainThread]: Found 5 seeds, 10 models, 2 data tests, 1 source, 415 macros
[0m11:04:34.426111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c58972f2e90>]}
[0m11:04:34.427513 [info ] [MainThread]: 
[0m11:04:34.428046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:04:34.428857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:04:34.468158 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:04:34.468515 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:04:34.468772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:04:34.473247 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:04:34.474512 [debug] [ThreadPool]: On list_my_db: Close
[0m11:04:34.479378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:04:34.485189 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:04:34.485542 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:04:34.485790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:04:34.488950 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.489356 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:04:34.489655 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:04:34.492127 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.0 seconds
[0m11:04:34.493529 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:04:34.494004 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:04:34.500665 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.501010 [debug] [MainThread]: On master: BEGIN
[0m11:04:34.501260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:04:34.504404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.504782 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.505134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:04:34.516563 [debug] [MainThread]: SQL status: SELECT 4 in 0.0 seconds
[0m11:04:34.518780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5898e24710>]}
[0m11:04:34.519162 [debug] [MainThread]: On master: ROLLBACK
[0m11:04:34.519727 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.520003 [debug] [MainThread]: On master: BEGIN
[0m11:04:34.520446 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.520773 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.521038 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.521282 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.521746 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:04:34.522028 [debug] [MainThread]: On master: Close
[0m11:04:34.522526 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:04:34.522844 [info ] [MainThread]: 
[0m11:04:34.524990 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_patient
[0m11:04:34.525548 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_patient ................................. [RUN]
[0m11:04:34.526029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_patient)
[0m11:04:34.526433 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_patient
[0m11:04:34.534347 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_patient"
[0m11:04:34.534976 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_patient
[0m11:04:34.570284 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_patient"
[0m11:04:34.570913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.571256 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: BEGIN
[0m11:04:34.571597 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:04:34.574790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.575208 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.575582 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */

  create view "my_db"."public"."stg_patient__dbt_tmp"
    
    
  as (
    select  "PatientID" as Patient_id,
        "firstname" as First_name,
        "lastname" as Last_name,
        "email" as Email
    from "my_db"."public"."Patient"
  );
[0m11:04:34.577211 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:04:34.584136 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.584581 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */
alter table "my_db"."public"."stg_patient__dbt_tmp" rename to "stg_patient"
[0m11:04:34.585265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:04:34.599315 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: COMMIT
[0m11:04:34.599753 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.600069 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: COMMIT
[0m11:04:34.628585 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:04:34.635277 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_patient__dbt_backup"
[0m11:04:34.640221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_patient"
[0m11:04:34.640635 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_patient"} */
drop view if exists "my_db"."public"."stg_patient__dbt_backup" cascade
[0m11:04:34.641267 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:04:34.643543 [debug] [Thread-1 (]: On model.dbt_modeling.stg_patient: Close
[0m11:04:34.644922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '237a20f3-d777-437b-a358-7b516ffe2e1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c5895ff4110>]}
[0m11:04:34.645661 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_patient ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m11:04:34.646332 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_patient
[0m11:04:34.647633 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.647929 [debug] [MainThread]: On master: BEGIN
[0m11:04:34.648177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:04:34.651372 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:04:34.651811 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.652259 [debug] [MainThread]: Using postgres connection "master"
[0m11:04:34.652714 [debug] [MainThread]: On master: COMMIT
[0m11:04:34.653296 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:04:34.653783 [debug] [MainThread]: On master: Close
[0m11:04:34.654498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:04:34.655057 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_patient' was properly closed.
[0m11:04:34.655719 [info ] [MainThread]: 
[0m11:04:34.656346 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m11:04:34.658043 [debug] [MainThread]: Command end result
[0m11:04:34.689249 [info ] [MainThread]: 
[0m11:04:34.689794 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:04:34.690106 [info ] [MainThread]: 
[0m11:04:34.690450 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:04:34.691243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.92606986, "process_user_time": 1.900854, "process_kernel_time": 0.114809, "process_mem_max_rss": "114044", "process_out_blocks": "2600", "process_in_blocks": "0"}
[0m11:04:34.691750 [debug] [MainThread]: Command `dbt run` succeeded at 11:04:34.691639 after 0.93 seconds
[0m11:04:34.692089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c589cccc7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c58963f2710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c58990a0090>]}
[0m11:04:34.692456 [debug] [MainThread]: Flushing usage events
[0m11:20:30.079723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532510fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532693750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532513310>]}


============================== 11:20:30.082304 | 558a09be-9250-4ce8-a044-099dad9eb713 ==============================
[0m11:20:30.082304 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:20:30.082849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_billing', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:30.210924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5331948d0>]}
[0m11:20:30.257780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc536204a10>]}
[0m11:20:30.258542 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:20:30.268207 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:20:30.385355 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 2 files changed.
[0m11:20:30.386046 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:20:30.386383 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m11:20:30.583182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5309ee4d0>]}
[0m11:20:30.651105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5305218d0>]}
[0m11:20:30.651566 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:20:30.651873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc530ab6dd0>]}
[0m11:20:30.653182 [info ] [MainThread]: 
[0m11:20:30.653678 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:30.654452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:20:30.690208 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:20:30.690561 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:20:30.690870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:30.695640 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:20:30.697048 [debug] [ThreadPool]: On list_my_db: Close
[0m11:20:30.702233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:20:30.707981 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:30.708311 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:20:30.708584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:30.712304 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.712838 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:30.713158 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:20:30.715882 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:20:30.717382 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:20:30.717866 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:20:30.725255 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.725621 [debug] [MainThread]: On master: BEGIN
[0m11:20:30.725900 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:30.729068 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.729488 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.729896 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:30.742288 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:20:30.744753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc530a4ee10>]}
[0m11:20:30.745212 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:30.745717 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.746011 [debug] [MainThread]: On master: BEGIN
[0m11:20:30.746556 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.746940 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.747295 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.747586 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.747983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:30.748280 [debug] [MainThread]: On master: Close
[0m11:20:30.748774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:30.749195 [info ] [MainThread]: 
[0m11:20:30.751164 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:20:30.751698 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:20:30.752301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:20:30.752719 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:20:30.760189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:20:30.760833 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:20:30.796625 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:20:30.797294 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:30.797652 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:20:30.798042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:30.801243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.801702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:30.802056 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum(Amount) as total_amount
from billing
group by Invoice_id,Patient_id,Procedure
order by total_amount desc;
  );
[0m11:20:30.802750 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: order by total_amount desc;
                                   ^

[0m11:20:30.803162 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: ROLLBACK
[0m11:20:30.803687 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:20:30.807560 [debug] [Thread-1 (]: Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  syntax error at or near ";"
  LINE 22: order by total_amount desc;
                                     ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:30.809013 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '558a09be-9250-4ce8-a044-099dad9eb713', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc52f95e010>]}
[0m11:20:30.809694 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:20:30.810376 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:20:30.811951 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.812378 [debug] [MainThread]: On master: BEGIN
[0m11:20:30.812674 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:30.815641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:30.816057 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.816353 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:30.816624 [debug] [MainThread]: On master: COMMIT
[0m11:20:30.817035 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:30.817326 [debug] [MainThread]: On master: Close
[0m11:20:30.817748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:30.818013 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:20:30.818383 [info ] [MainThread]: 
[0m11:20:30.818735 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m11:20:30.819463 [debug] [MainThread]: Command end result
[0m11:20:30.850841 [info ] [MainThread]: 
[0m11:20:30.851286 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:30.851602 [info ] [MainThread]: 
[0m11:20:30.852004 [error] [MainThread]:   Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  syntax error at or near ";"
  LINE 22: order by total_amount desc;
                                     ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:30.852305 [info ] [MainThread]: 
[0m11:20:30.852650 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:20:30.853384 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81496894, "process_user_time": 1.835742, "process_kernel_time": 0.122715, "process_mem_max_rss": "114076", "process_out_blocks": "2560", "command_success": false, "process_in_blocks": "0"}
[0m11:20:30.853869 [debug] [MainThread]: Command `dbt run` failed at 11:20:30.853767 after 0.82 seconds
[0m11:20:30.854221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc532510ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc53251fbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cc5324d0150>]}
[0m11:20:30.854575 [debug] [MainThread]: Flushing usage events
[0m11:20:48.281231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f7521d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f88ee710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f7522890>]}


============================== 11:20:48.283994 | b46a27a9-dd90-4846-bb93-57fd9608f567 ==============================
[0m11:20:48.283994 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:20:48.284683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_billing', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:20:48.413219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f77b0290>]}
[0m11:20:48.459399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724fb23cf50>]}
[0m11:20:48.460077 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:20:48.469461 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:20:48.561628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:20:48.562200 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:20:48.757326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f7433ed0>]}
[0m11:20:48.832253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f5c9c1d0>]}
[0m11:20:48.832762 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:20:48.833130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f59ab450>]}
[0m11:20:48.834776 [info ] [MainThread]: 
[0m11:20:48.835381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:20:48.836327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:20:48.875267 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:20:48.875632 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:20:48.875936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:20:48.880595 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:20:48.881848 [debug] [ThreadPool]: On list_my_db: Close
[0m11:20:48.887413 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:20:48.893388 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:48.893761 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:20:48.894011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:20:48.897142 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.897625 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:20:48.897919 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:20:48.900507 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:20:48.902155 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:20:48.902772 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:20:48.909580 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.909924 [debug] [MainThread]: On master: BEGIN
[0m11:20:48.910169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:20:48.913424 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.913809 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.914180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:20:48.926653 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:20:48.928932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f5582050>]}
[0m11:20:48.929380 [debug] [MainThread]: On master: ROLLBACK
[0m11:20:48.929866 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.930158 [debug] [MainThread]: On master: BEGIN
[0m11:20:48.930757 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.931078 [debug] [MainThread]: On master: COMMIT
[0m11:20:48.931356 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:48.931617 [debug] [MainThread]: On master: COMMIT
[0m11:20:48.932011 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:48.932330 [debug] [MainThread]: On master: Close
[0m11:20:48.932872 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:20:48.933210 [info ] [MainThread]: 
[0m11:20:48.935679 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:20:48.936445 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:20:48.936984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:20:48.937348 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:20:48.945887 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:20:48.946715 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:20:48.983975 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:20:48.984616 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:48.985018 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:20:48.985479 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:20:48.988956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:20:48.989394 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:20:48.989779 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum(Amount) as total_amount
from billing
group by Invoice_id,Patient_id,Procedure
order by total_amount desc
  );
[0m11:20:48.990594 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 19:     sum(Amount) as total_amount
                 ^
HINT:  Perhaps you meant to reference the column "billing.Amount".

[0m11:20:48.990967 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: ROLLBACK
[0m11:20:48.991471 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:20:48.995970 [debug] [Thread-1 (]: Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  column "amount" does not exist
  LINE 19:     sum(Amount) as total_amount
                   ^
  HINT:  Perhaps you meant to reference the column "billing.Amount".
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:48.997395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b46a27a9-dd90-4846-bb93-57fd9608f567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f4588990>]}
[0m11:20:48.997970 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_billing ........................ [[31mERROR[0m in 0.06s]
[0m11:20:48.998559 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:20:49.000210 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:49.000548 [debug] [MainThread]: On master: BEGIN
[0m11:20:49.000816 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:20:49.004108 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:20:49.004496 [debug] [MainThread]: On master: COMMIT
[0m11:20:49.004788 [debug] [MainThread]: Using postgres connection "master"
[0m11:20:49.005046 [debug] [MainThread]: On master: COMMIT
[0m11:20:49.005483 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:20:49.005777 [debug] [MainThread]: On master: Close
[0m11:20:49.006195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:20:49.006460 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:20:49.006753 [info ] [MainThread]: 
[0m11:20:49.007095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:20:49.007773 [debug] [MainThread]: Command end result
[0m11:20:49.033393 [info ] [MainThread]: 
[0m11:20:49.033830 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:20:49.034142 [info ] [MainThread]: 
[0m11:20:49.034536 [error] [MainThread]:   Database Error in model dim_billing (models/marts/description/dim_billing.sql)
  column "amount" does not exist
  LINE 19:     sum(Amount) as total_amount
                   ^
  HINT:  Perhaps you meant to reference the column "billing.Amount".
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_billing.sql
[0m11:20:49.034865 [info ] [MainThread]: 
[0m11:20:49.035216 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:20:49.036432 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8012521, "process_user_time": 1.845092, "process_kernel_time": 0.148926, "process_mem_max_rss": "113912", "process_out_blocks": "2552", "command_success": false, "process_in_blocks": "0"}
[0m11:20:49.037072 [debug] [MainThread]: Command `dbt run` failed at 11:20:49.036938 after 0.80 seconds
[0m11:20:49.037477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724f793ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724fb494dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7724fb494450>]}
[0m11:20:49.037838 [debug] [MainThread]: Flushing usage events
[0m11:21:11.711897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b15dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b13f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b13f8d0>]}


============================== 11:21:11.714532 | e7c406a9-aae3-4521-abf8-a453c4f5ea79 ==============================
[0m11:21:11.714532 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:21:11.715148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_billing', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:21:11.859419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437980fa90>]}
[0m11:21:11.906904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7343798812d0>]}
[0m11:21:11.907627 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:21:11.917064 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:21:12.008145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:21:12.008673 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:21:12.199531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437951f190>]}
[0m11:21:12.264963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7343795a99d0>]}
[0m11:21:12.265470 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:21:12.265758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7343795d3410>]}
[0m11:21:12.267261 [info ] [MainThread]: 
[0m11:21:12.267841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:21:12.269053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:21:12.305694 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:21:12.306060 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:21:12.306353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:12.311110 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:21:12.312458 [debug] [ThreadPool]: On list_my_db: Close
[0m11:21:12.317322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:21:12.323121 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:21:12.323461 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:21:12.323719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:12.326917 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.327332 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:21:12.327671 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:21:12.330188 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.0 seconds
[0m11:21:12.331676 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:21:12.332130 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:21:12.339616 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.339954 [debug] [MainThread]: On master: BEGIN
[0m11:21:12.340205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:21:12.343366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.343725 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.344086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:21:12.356165 [debug] [MainThread]: SQL status: SELECT 5 in 0.0 seconds
[0m11:21:12.358362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734379897cd0>]}
[0m11:21:12.358756 [debug] [MainThread]: On master: ROLLBACK
[0m11:21:12.359206 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.359498 [debug] [MainThread]: On master: BEGIN
[0m11:21:12.360147 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.360521 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.360785 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.361050 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.361470 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:21:12.361745 [debug] [MainThread]: On master: Close
[0m11:21:12.362192 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:12.362593 [info ] [MainThread]: 
[0m11:21:12.364717 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:21:12.365412 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:21:12.365913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:21:12.366343 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:21:12.374627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:21:12.375196 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:21:12.411820 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:21:12.412851 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.413378 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:21:12.413736 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:12.416889 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.417318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.417714 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") as total_amount
from billing
group by Invoice_id,Patient_id,Procedure
order by total_amount desc
  );
[0m11:21:12.419811 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:21:12.425853 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.426240 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m11:21:12.426931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:21:12.441003 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:21:12.441439 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.441746 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:21:12.449539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:21:12.455766 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m11:21:12.460450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:21:12.460813 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m11:21:12.461369 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:21:12.463556 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:21:12.465533 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7c406a9-aae3-4521-abf8-a453c4f5ea79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734379182bd0>]}
[0m11:21:12.466473 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m11:21:12.467138 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:21:12.468370 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.468667 [debug] [MainThread]: On master: BEGIN
[0m11:21:12.468916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:21:12.471756 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:21:12.472225 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.472548 [debug] [MainThread]: Using postgres connection "master"
[0m11:21:12.472899 [debug] [MainThread]: On master: COMMIT
[0m11:21:12.473313 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:21:12.473657 [debug] [MainThread]: On master: Close
[0m11:21:12.474160 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:12.474558 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:21:12.474959 [info ] [MainThread]: 
[0m11:21:12.475346 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m11:21:12.476400 [debug] [MainThread]: Command end result
[0m11:21:12.505160 [info ] [MainThread]: 
[0m11:21:12.505628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:12.505980 [info ] [MainThread]: 
[0m11:21:12.506332 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:21:12.507106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8374216, "process_user_time": 1.954775, "process_kernel_time": 0.139912, "process_mem_max_rss": "113536", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:21:12.507576 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:12.507471 after 0.84 seconds
[0m11:21:12.507899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437b16b550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437f22d890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73437ef34710>]}
[0m11:21:12.508210 [debug] [MainThread]: Flushing usage events
[0m11:26:22.470091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec24f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec24f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58edf58f90>]}


============================== 11:26:22.472658 | 943fc1bb-ef01-44d3-9684-83a27217eb88 ==============================
[0m11:26:22.472658 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:26:22.473189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_billing', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:26:22.600109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec133510>]}
[0m11:26:22.645913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58eff55010>]}
[0m11:26:22.646600 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:26:22.655397 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:26:22.748872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:26:22.749424 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:26:22.941308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea8313d0>]}
[0m11:26:23.007500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea6cbb90>]}
[0m11:26:23.007947 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:26:23.008247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea9c8050>]}
[0m11:26:23.009670 [info ] [MainThread]: 
[0m11:26:23.010221 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:26:23.011068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:26:23.048647 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:26:23.049043 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:26:23.049345 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:26:23.053910 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:26:23.055197 [debug] [ThreadPool]: On list_my_db: Close
[0m11:26:23.060020 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:26:23.066093 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:26:23.066464 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:26:23.066721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:26:23.069850 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.070208 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:26:23.070540 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:26:23.073033 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:26:23.074462 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:26:23.074895 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:26:23.081879 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.082226 [debug] [MainThread]: On master: BEGIN
[0m11:26:23.082491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:23.085491 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.085848 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.086203 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:26:23.099228 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m11:26:23.101833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea570890>]}
[0m11:26:23.102285 [debug] [MainThread]: On master: ROLLBACK
[0m11:26:23.102788 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.103084 [debug] [MainThread]: On master: BEGIN
[0m11:26:23.103719 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.104046 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.104313 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.104586 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.105015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:26:23.105302 [debug] [MainThread]: On master: Close
[0m11:26:23.105827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:26:23.106197 [info ] [MainThread]: 
[0m11:26:23.108323 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:26:23.108879 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:26:23.109461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:26:23.109872 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:26:23.118177 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:26:23.118792 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:26:23.155040 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:26:23.155673 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.156025 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:26:23.156348 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:26:23.159448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.159963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.160301 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select 
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc
  );
[0m11:26:23.162223 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:26:23.168979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.169383 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m11:26:23.170138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:26:23.173495 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.173904 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m11:26:23.174639 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:26:23.190890 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:26:23.191281 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.191582 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:26:23.243083 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:26:23.256214 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m11:26:23.267044 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:26:23.268056 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m11:26:23.270764 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:26:23.275413 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:26:23.277938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '943fc1bb-ef01-44d3-9684-83a27217eb88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ea62e210>]}
[0m11:26:23.279013 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.17s]
[0m11:26:23.280048 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:26:23.281955 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.282618 [debug] [MainThread]: On master: BEGIN
[0m11:26:23.283216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:26:23.287947 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:26:23.288560 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.289053 [debug] [MainThread]: Using postgres connection "master"
[0m11:26:23.289489 [debug] [MainThread]: On master: COMMIT
[0m11:26:23.290166 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:26:23.290620 [debug] [MainThread]: On master: Close
[0m11:26:23.291152 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:26:23.291503 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:26:23.291875 [info ] [MainThread]: 
[0m11:26:23.292296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:26:23.293291 [debug] [MainThread]: Command end result
[0m11:26:23.324326 [info ] [MainThread]: 
[0m11:26:23.324801 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:26:23.325114 [info ] [MainThread]: 
[0m11:26:23.325452 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:26:23.326195 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8973367, "process_user_time": 1.977134, "process_kernel_time": 0.12463, "process_mem_max_rss": "113564", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:26:23.326712 [debug] [MainThread]: Command `dbt run` succeeded at 11:26:23.326601 after 0.90 seconds
[0m11:26:23.327045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58eea5df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58ec27aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d58f033d890>]}
[0m11:26:23.327392 [debug] [MainThread]: Flushing usage events
[0m11:27:38.066570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db5f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db151d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133ed3cd10>]}


============================== 11:27:38.070028 | c8866c99-42f0-4d5e-8a38-9c3872488e78 ==============================
[0m11:27:38.070028 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:27:38.070576 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_billing', 'send_anonymous_usage_stats': 'True'}
[0m11:27:38.204898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c1ef710>]}
[0m11:27:38.251370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db1e550>]}
[0m11:27:38.252107 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:27:38.261120 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:27:38.354027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:27:38.354603 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m11:27:38.548262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c21d7d0>]}
[0m11:27:38.614921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c060e10>]}
[0m11:27:38.615436 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:27:38.615740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133bf9f550>]}
[0m11:27:38.617152 [info ] [MainThread]: 
[0m11:27:38.617666 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:27:38.618542 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:27:38.656211 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:27:38.656637 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:27:38.656892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:38.661953 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:27:38.663288 [debug] [ThreadPool]: On list_my_db: Close
[0m11:27:38.668077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:27:38.673912 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:27:38.674267 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:27:38.674544 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:27:38.677710 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.678082 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:27:38.678397 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:27:38.680876 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:27:38.682299 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:27:38.682767 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:27:38.689661 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.690070 [debug] [MainThread]: On master: BEGIN
[0m11:27:38.690445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:27:38.693479 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.693850 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.694211 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:27:38.707161 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m11:27:38.709528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133aff85d0>]}
[0m11:27:38.709968 [debug] [MainThread]: On master: ROLLBACK
[0m11:27:38.710401 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.710666 [debug] [MainThread]: On master: BEGIN
[0m11:27:38.711250 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.711575 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.711838 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.712093 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.712506 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:27:38.712819 [debug] [MainThread]: On master: Close
[0m11:27:38.713518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:27:38.713918 [info ] [MainThread]: 
[0m11:27:38.716104 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m11:27:38.716617 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m11:27:38.717095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m11:27:38.717583 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m11:27:38.726156 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m11:27:38.726741 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m11:27:38.763662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m11:27:38.764250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.764587 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m11:27:38.764893 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:27:38.768289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.768844 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.769182 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        'PatientID'  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select distinct
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc
  );
[0m11:27:38.771248 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:27:38.778171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.778569 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m11:27:38.779276 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:27:38.782464 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.782842 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m11:27:38.783547 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:27:38.799639 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:27:38.800059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.800349 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m11:27:38.822437 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:27:38.829044 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m11:27:38.834293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m11:27:38.834761 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m11:27:38.836408 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:27:38.838628 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m11:27:38.840108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8866c99-42f0-4d5e-8a38-9c3872488e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133c28a490>]}
[0m11:27:38.840864 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m11:27:38.841526 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m11:27:38.842603 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.842929 [debug] [MainThread]: On master: BEGIN
[0m11:27:38.843203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:27:38.846359 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:27:38.846797 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.847139 [debug] [MainThread]: Using postgres connection "master"
[0m11:27:38.847475 [debug] [MainThread]: On master: COMMIT
[0m11:27:38.847985 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:27:38.848482 [debug] [MainThread]: On master: Close
[0m11:27:38.849036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:38.849455 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m11:27:38.849918 [info ] [MainThread]: 
[0m11:27:38.850601 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m11:27:38.851512 [debug] [MainThread]: Command end result
[0m11:27:38.883600 [info ] [MainThread]: 
[0m11:27:38.884081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:27:38.884400 [info ] [MainThread]: 
[0m11:27:38.884725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:27:38.885470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86453736, "process_user_time": 1.914386, "process_kernel_time": 0.138955, "process_mem_max_rss": "113700", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:27:38.885929 [debug] [MainThread]: Command `dbt run` succeeded at 11:27:38.885826 after 0.87 seconds
[0m11:27:38.886253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133db6ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72133dcec110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7213419007d0>]}
[0m11:27:38.886578 [debug] [MainThread]: Flushing usage events
[0m11:38:54.023890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcaaffb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcac97690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcac97890>]}


============================== 11:38:54.026456 | 44fc3166-84c7-4efe-a438-4c47ce2c1309 ==============================
[0m11:38:54.026456 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:38:54.026965 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run -m dim_doctor', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:38:54.156675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffca9c7d10>]}
[0m11:38:54.203108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc9234510>]}
[0m11:38:54.203829 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:38:54.213081 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:38:54.310764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:38:54.311352 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m11:38:54.506186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc9076710>]}
[0m11:38:54.573537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc8b0c890>]}
[0m11:38:54.573985 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:38:54.574317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc8f83410>]}
[0m11:38:54.575772 [info ] [MainThread]: 
[0m11:38:54.576361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:38:54.577214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:38:54.615512 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:38:54.615896 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:38:54.616155 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:38:54.621002 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:38:54.622430 [debug] [ThreadPool]: On list_my_db: Close
[0m11:38:54.627235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:38:54.632982 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:38:54.633316 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:38:54.633587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:38:54.636935 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.637310 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:38:54.637629 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:38:54.640075 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
[0m11:38:54.641513 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:38:54.641946 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:38:54.648757 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.649092 [debug] [MainThread]: On master: BEGIN
[0m11:38:54.649354 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:38:54.652596 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.652963 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.653319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:38:54.666384 [debug] [MainThread]: SQL status: SELECT 6 in 0.0 seconds
[0m11:38:54.668770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc8f06750>]}
[0m11:38:54.669158 [debug] [MainThread]: On master: ROLLBACK
[0m11:38:54.669604 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.669878 [debug] [MainThread]: On master: BEGIN
[0m11:38:54.670427 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.670727 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.670983 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.671242 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.671630 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:38:54.671921 [debug] [MainThread]: On master: Close
[0m11:38:54.672456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:38:54.672917 [info ] [MainThread]: 
[0m11:38:54.674975 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_doctor
[0m11:38:54.675502 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_doctor .................................. [RUN]
[0m11:38:54.676089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_doctor)
[0m11:38:54.676466 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_doctor
[0m11:38:54.684654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_doctor"
[0m11:38:54.685177 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_doctor
[0m11:38:54.721844 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_doctor"
[0m11:38:54.722413 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.722759 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: BEGIN
[0m11:38:54.723058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:38:54.726359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.726814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.727152 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */

  create view "my_db"."public"."dim_doctor__dbt_tmp"
    
    
  as (
    with doctor as (
    select * from "my_db"."public"."stg_doctor"
)

select * from doctor
  );
[0m11:38:54.728725 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:38:54.735077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.735534 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor__dbt_tmp" rename to "dim_doctor"
[0m11:38:54.736244 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:38:54.750111 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:38:54.750516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.750815 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:38:54.802935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:38:54.820140 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_doctor__dbt_backup"
[0m11:38:54.832127 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:38:54.832908 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
drop view if exists "my_db"."public"."dim_doctor__dbt_backup" cascade
[0m11:38:54.833823 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:38:54.837543 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: Close
[0m11:38:54.840167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44fc3166-84c7-4efe-a438-4c47ce2c1309', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffc82b2350>]}
[0m11:38:54.841151 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_doctor ............................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:38:54.842071 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_doctor
[0m11:38:54.843487 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.843866 [debug] [MainThread]: On master: BEGIN
[0m11:38:54.844174 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:38:54.847553 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:38:54.847997 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.848295 [debug] [MainThread]: Using postgres connection "master"
[0m11:38:54.848595 [debug] [MainThread]: On master: COMMIT
[0m11:38:54.849091 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:38:54.849602 [debug] [MainThread]: On master: Close
[0m11:38:54.850170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:38:54.850604 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_doctor' was properly closed.
[0m11:38:54.851082 [info ] [MainThread]: 
[0m11:38:54.851497 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:38:54.852420 [debug] [MainThread]: Command end result
[0m11:38:54.880434 [info ] [MainThread]: 
[0m11:38:54.880925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:38:54.881283 [info ] [MainThread]: 
[0m11:38:54.881622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:38:54.882413 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9002047, "process_user_time": 1.856005, "process_kernel_time": 0.140924, "process_mem_max_rss": "113736", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m11:38:54.882901 [debug] [MainThread]: Command `dbt run` succeeded at 11:38:54.882793 after 0.90 seconds
[0m11:38:54.883236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcaca4210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffce904710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffcea60d90>]}
[0m11:38:54.883585 [debug] [MainThread]: Flushing usage events
[0m11:42:53.066637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53144d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc532c7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53147110>]}


============================== 11:42:53.069258 | 503734ea-e002-4163-9bd7-12488159565c ==============================
[0m11:42:53.069258 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:42:53.069788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_medical_procedure', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:42:53.201302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53144f90>]}
[0m11:42:53.247661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc56e3d0d0>]}
[0m11:42:53.248401 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:42:53.257628 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:42:53.352643 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:42:53.353171 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:42:53.545340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc5171f4d0>]}
[0m11:42:53.611141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc51513410>]}
[0m11:42:53.611639 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:42:53.611922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc516e8690>]}
[0m11:42:53.613359 [info ] [MainThread]: 
[0m11:42:53.614042 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:42:53.614977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:42:53.652723 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:42:53.653060 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:42:53.653311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:42:53.658003 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:42:53.659472 [debug] [ThreadPool]: On list_my_db: Close
[0m11:42:53.664507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:42:53.670256 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:42:53.670601 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:42:53.670854 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:42:53.674122 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.674532 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:42:53.674824 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:42:53.677238 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m11:42:53.678687 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:42:53.679268 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:42:53.686364 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.686703 [debug] [MainThread]: On master: BEGIN
[0m11:42:53.686956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:42:53.690035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.690433 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.690792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:42:53.704680 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m11:42:53.707302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc509dabd0>]}
[0m11:42:53.707743 [debug] [MainThread]: On master: ROLLBACK
[0m11:42:53.708213 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.708495 [debug] [MainThread]: On master: BEGIN
[0m11:42:53.709093 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.709396 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.709676 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.709916 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.710375 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:42:53.710670 [debug] [MainThread]: On master: Close
[0m11:42:53.711122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:42:53.711495 [info ] [MainThread]: 
[0m11:42:53.713752 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.714301 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:42:53.714795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:42:53.715168 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.723358 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.723893 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.760310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.761037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.761401 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:42:53.761708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:42:53.764901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.765387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:42:53.765824 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select 
    Procedure_id,
    Procedure_name over (partition by Procedure_name),
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:42:53.766471 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "over"
LINE 16:     Procedure_name over (partition by Procedure_name),
                            ^

[0m11:42:53.766880 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: ROLLBACK
[0m11:42:53.767388 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:42:53.771371 [debug] [Thread-1 (]: Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "over"
  LINE 16:     Procedure_name over (partition by Procedure_name),
                              ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m11:42:53.772827 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '503734ea-e002-4163-9bd7-12488159565c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc5055b290>]}
[0m11:42:53.773440 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.dim_medical_procedure .............. [[31mERROR[0m in 0.06s]
[0m11:42:53.774088 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:42:53.775846 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.776253 [debug] [MainThread]: On master: BEGIN
[0m11:42:53.776630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:42:53.779548 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:42:53.779992 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.780284 [debug] [MainThread]: Using postgres connection "master"
[0m11:42:53.780561 [debug] [MainThread]: On master: COMMIT
[0m11:42:53.780942 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:42:53.781220 [debug] [MainThread]: On master: Close
[0m11:42:53.781773 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:42:53.782076 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:42:53.782408 [info ] [MainThread]: 
[0m11:42:53.782837 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:42:53.783955 [debug] [MainThread]: Command end result
[0m11:42:53.812664 [info ] [MainThread]: 
[0m11:42:53.813292 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:42:53.813670 [info ] [MainThread]: 
[0m11:42:53.814093 [error] [MainThread]:   Database Error in model dim_medical_procedure (models/marts/description/dim_medical_procedure.sql)
  syntax error at or near "over"
  LINE 16:     Procedure_name over (partition by Procedure_name),
                              ^
  compiled Code at target/run/dbt_modeling/models/marts/description/dim_medical_procedure.sql
[0m11:42:53.814427 [info ] [MainThread]: 
[0m11:42:53.814793 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:42:53.815548 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79069024, "process_user_time": 1.790024, "process_kernel_time": 0.135623, "process_mem_max_rss": "114248", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m11:42:53.816017 [debug] [MainThread]: Command `dbt run` failed at 11:42:53.815914 after 0.79 seconds
[0m11:42:53.816363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc53153310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc532c7f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbc515216d0>]}
[0m11:42:53.816696 [debug] [MainThread]: Flushing usage events
[0m11:45:05.434688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d5630dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d5631f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d5633dd0>]}


============================== 11:45:05.437215 | ffd151f8-4258-493a-b92e-4dab4df6dcf6 ==============================
[0m11:45:05.437215 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:45:05.437755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:05.565877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d55e8c50>]}
[0m11:45:05.612301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d92e4650>]}
[0m11:45:05.612999 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:45:05.622197 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:45:05.718464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:05.719034 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:45:05.913069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d3cf5510>]}
[0m11:45:05.979749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d39e0810>]}
[0m11:45:05.980237 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:45:05.980542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d3a77450>]}
[0m11:45:05.982169 [info ] [MainThread]: 
[0m11:45:05.982802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:05.983748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:45:06.022358 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:45:06.022763 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:45:06.023013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:06.028233 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:45:06.029631 [debug] [ThreadPool]: On list_my_db: Close
[0m11:45:06.034621 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:45:06.040674 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:06.041165 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:45:06.041435 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:06.045093 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.045501 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:06.045799 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:45:06.048508 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
[0m11:45:06.049979 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:45:06.050408 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:45:06.057350 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.057706 [debug] [MainThread]: On master: BEGIN
[0m11:45:06.057960 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:06.061153 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.061520 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.061891 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:06.075766 [debug] [MainThread]: SQL status: SELECT 7 in 0.0 seconds
[0m11:45:06.078368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d39e3750>]}
[0m11:45:06.078793 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:06.079283 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.079581 [debug] [MainThread]: On master: BEGIN
[0m11:45:06.080162 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.080490 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.080771 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.081037 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.081514 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:06.081808 [debug] [MainThread]: On master: Close
[0m11:45:06.082330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:06.082683 [info ] [MainThread]: 
[0m11:45:06.084831 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.085412 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:45:06.085876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:45:06.086321 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.095065 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.095896 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.131494 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.132100 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.132446 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:45:06.132753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:06.136011 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.136419 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.136787 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select 
    Procedure_id,
    count(*) over (partition by Procedure_name) as procedure_count,
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:45:06.138701 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:45:06.145187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.145666 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m11:45:06.146408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:06.159885 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:06.160295 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.160594 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:06.212007 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:06.222278 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m11:45:06.230521 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:06.231249 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m11:45:06.232399 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:45:06.235930 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:45:06.238104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd151f8-4258-493a-b92e-4dab4df6dcf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d3c9f010>]}
[0m11:45:06.239093 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.15s]
[0m11:45:06.239924 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:45:06.241321 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.241739 [debug] [MainThread]: On master: BEGIN
[0m11:45:06.242076 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:06.245331 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:06.245867 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.246173 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:06.246452 [debug] [MainThread]: On master: COMMIT
[0m11:45:06.246898 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:06.247365 [debug] [MainThread]: On master: Close
[0m11:45:06.247977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:06.248479 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:45:06.249042 [info ] [MainThread]: 
[0m11:45:06.249611 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m11:45:06.250458 [debug] [MainThread]: Command end result
[0m11:45:06.280183 [info ] [MainThread]: 
[0m11:45:06.280659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:06.280988 [info ] [MainThread]: 
[0m11:45:06.281316 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:06.282063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.88987124, "process_user_time": 1.8803, "process_kernel_time": 0.132021, "process_mem_max_rss": "113264", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:45:06.282536 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:06.282432 after 0.89 seconds
[0m11:45:06.282853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d563fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d563f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7266d93d4550>]}
[0m11:45:06.283179 [debug] [MainThread]: Flushing usage events
[0m11:45:55.649480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14a897d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14ad0c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14a8a550>]}


============================== 11:45:55.652411 | 590cec82-7865-4a61-a6c4-d447cd18193f ==============================
[0m11:45:55.652411 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:45:55.652915 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m dim_medical_procedure', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:45:55.788280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c131805d0>]}
[0m11:45:55.834401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c18794650>]}
[0m11:45:55.835129 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:45:55.843941 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:45:55.936169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:45:55.936767 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:45:56.154181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c149a2250>]}
[0m11:45:56.233799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c131a9d90>]}
[0m11:45:56.234457 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:45:56.234939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c149a1d50>]}
[0m11:45:56.236722 [info ] [MainThread]: 
[0m11:45:56.237380 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:56.238327 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:45:56.277828 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:45:56.278212 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:45:56.278622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:56.286317 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:45:56.288831 [debug] [ThreadPool]: On list_my_db: Close
[0m11:45:56.295640 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:45:56.302197 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:56.302617 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:45:56.302891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:56.306398 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.306968 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:45:56.307369 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:45:56.310467 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:45:56.312115 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:45:56.312746 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:45:56.323325 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.323703 [debug] [MainThread]: On master: BEGIN
[0m11:45:56.323961 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:56.327082 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.327545 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.327932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:56.345817 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m11:45:56.349156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c131b64d0>]}
[0m11:45:56.349716 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:56.350216 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.350582 [debug] [MainThread]: On master: BEGIN
[0m11:45:56.351096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.351465 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.351740 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.351992 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.352390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:56.352703 [debug] [MainThread]: On master: Close
[0m11:45:56.353184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:45:56.353553 [info ] [MainThread]: 
[0m11:45:56.355608 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.356211 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:45:56.357804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:45:56.358245 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.367662 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.368432 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.408656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.409310 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.409705 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:45:56.410051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:45:56.414086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.414891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.415325 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select 
    Procedure_id,
    count(*) over (partition by Procedure_name) as procedure_count,
    Procedure_name,
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:45:56.417390 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:45:56.423951 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.424403 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m11:45:56.425083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:56.428139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.428602 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m11:45:56.429666 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:56.448542 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:56.448986 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.449368 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:45:56.500560 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:45:56.507113 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m11:45:56.512102 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:45:56.512835 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m11:45:56.515007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:45:56.517594 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:45:56.519606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '590cec82-7865-4a61-a6c4-d447cd18193f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c12b0bdd0>]}
[0m11:45:56.520470 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.16s]
[0m11:45:56.521115 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:45:56.522244 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.522595 [debug] [MainThread]: On master: BEGIN
[0m11:45:56.522848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:56.525838 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:56.526264 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.526674 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:56.526945 [debug] [MainThread]: On master: COMMIT
[0m11:45:56.527377 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:56.527730 [debug] [MainThread]: On master: Close
[0m11:45:56.528180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:56.528491 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:45:56.529027 [info ] [MainThread]: 
[0m11:45:56.529770 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m11:45:56.531876 [debug] [MainThread]: Command end result
[0m11:45:56.566940 [info ] [MainThread]: 
[0m11:45:56.567699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:56.568076 [info ] [MainThread]: 
[0m11:45:56.568468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:45:56.569317 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9626546, "process_user_time": 1.90781, "process_kernel_time": 0.136842, "process_mem_max_rss": "113312", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:45:56.569820 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:56.569713 after 0.96 seconds
[0m11:45:56.570187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c14d60310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c188845d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x706c18a08d90>]}
[0m11:45:56.570560 [debug] [MainThread]: Flushing usage events
[0m11:46:42.843165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b85ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316d07550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b86b10>]}


============================== 11:46:42.847541 | ac319a10-0144-4108-b519-c586b4bb3574 ==============================
[0m11:46:42.847541 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:46:42.849472 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_medical_procedure', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:46:43.014881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b3cc50>]}
[0m11:46:43.084396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b55550>]}
[0m11:46:43.085183 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:46:43.095223 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:46:43.219212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:46:43.219803 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_medical_procedure.sql
[0m11:46:43.442720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7383150f9910>]}
[0m11:46:43.517982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738314f8c910>]}
[0m11:46:43.518446 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:46:43.518791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738314ff3450>]}
[0m11:46:43.520223 [info ] [MainThread]: 
[0m11:46:43.520775 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:43.521587 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:46:43.560227 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:46:43.560773 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:46:43.561093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:43.567850 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:46:43.569125 [debug] [ThreadPool]: On list_my_db: Close
[0m11:46:43.574377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:46:43.580495 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:46:43.580889 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:46:43.581184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:43.585045 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.585519 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:46:43.585932 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:46:43.588871 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:46:43.590554 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:46:43.591134 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:46:43.600636 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.601109 [debug] [MainThread]: On master: BEGIN
[0m11:46:43.601479 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:43.604748 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.605110 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.605546 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:46:43.623364 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m11:46:43.626520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7383143d6150>]}
[0m11:46:43.626922 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:43.627386 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.627662 [debug] [MainThread]: On master: BEGIN
[0m11:46:43.628280 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.628618 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.628893 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.629157 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.630099 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:46:43.631183 [debug] [MainThread]: On master: Close
[0m11:46:43.632183 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:46:43.632799 [info ] [MainThread]: 
[0m11:46:43.635775 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.636536 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_medical_procedure ....................... [RUN]
[0m11:46:43.638136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_medical_procedure)
[0m11:46:43.638714 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.647014 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.648025 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.694911 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.695714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.696258 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: BEGIN
[0m11:46:43.697011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:43.701702 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.702160 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.702628 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */

  create view "my_db"."public"."dim_medical_procedure__dbt_tmp"
    
    
  as (
    with medical_procedure as (
    select 
        "ProcedureID" as Procedure_id,
        "ProcedureName" as Procedure_name,
        "AppointmentID" as Appointment_id
        from "my_db"."public"."Medical_Procedure"
)
select distinct
    Procedure_id,
    Procedure_name,
    count(*) over (partition by Procedure_name) as procedure_count,
    Appointment_id
from medical_procedure
order by Procedure_name
  );
[0m11:46:43.705415 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:46:43.712889 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.714553 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure" rename to "dim_medical_procedure__dbt_backup"
[0m11:46:43.715830 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:46:43.719803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.720253 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
alter table "my_db"."public"."dim_medical_procedure__dbt_tmp" rename to "dim_medical_procedure"
[0m11:46:43.721024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:46:43.740342 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:46:43.740783 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.741103 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: COMMIT
[0m11:46:43.749510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:46:43.756667 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_medical_procedure__dbt_backup"
[0m11:46:43.761821 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_medical_procedure"
[0m11:46:43.762254 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_medical_procedure"} */
drop view if exists "my_db"."public"."dim_medical_procedure__dbt_backup" cascade
[0m11:46:43.764491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:46:43.767033 [debug] [Thread-1 (]: On model.dbt_modeling.dim_medical_procedure: Close
[0m11:46:43.768824 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac319a10-0144-4108-b519-c586b4bb3574', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73831429dc10>]}
[0m11:46:43.769689 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_medical_procedure .................. [[32mCREATE VIEW[0m in 0.13s]
[0m11:46:43.770508 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_medical_procedure
[0m11:46:43.771878 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.772357 [debug] [MainThread]: On master: BEGIN
[0m11:46:43.772704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:43.775937 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:46:43.776424 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.777002 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:43.777587 [debug] [MainThread]: On master: COMMIT
[0m11:46:43.778400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:46:43.779086 [debug] [MainThread]: On master: Close
[0m11:46:43.780265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:43.780985 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_medical_procedure' was properly closed.
[0m11:46:43.781667 [info ] [MainThread]: 
[0m11:46:43.782439 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m11:46:43.784568 [debug] [MainThread]: Command end result
[0m11:46:43.839472 [info ] [MainThread]: 
[0m11:46:43.840106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:43.840497 [info ] [MainThread]: 
[0m11:46:43.840852 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:46:43.842114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0584965, "process_user_time": 2.240232, "process_kernel_time": 0.133894, "process_mem_max_rss": "113524", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m11:46:43.842962 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:43.842780 after 1.06 seconds
[0m11:46:43.843415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738316b85410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73831a970690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73831aacc350>]}
[0m11:46:43.843889 [debug] [MainThread]: Flushing usage events
[0m11:51:40.514523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47a0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47838d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f4759850>]}


============================== 11:51:40.517126 | b284c6ed-b76c-4d57-bd5a-c294a8ad358f ==============================
[0m11:51:40.517126 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:51:40.517615 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_patient', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:51:40.643003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47cfd10>]}
[0m11:51:40.688875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f8470ed0>]}
[0m11:51:40.689599 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:51:40.698638 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:51:40.789743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:51:40.790280 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m11:51:40.981785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f2d34310>]}
[0m11:51:41.047130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f2b5aa10>]}
[0m11:51:41.047589 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:51:41.047926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f61e6310>]}
[0m11:51:41.049383 [info ] [MainThread]: 
[0m11:51:41.050046 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:51:41.050871 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:51:41.087677 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:51:41.088044 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:51:41.088299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:41.092637 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:51:41.093942 [debug] [ThreadPool]: On list_my_db: Close
[0m11:51:41.098999 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:51:41.104817 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:51:41.105146 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:51:41.105428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:51:41.108445 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.108820 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:51:41.109107 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:51:41.111554 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
[0m11:51:41.113137 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:51:41.113625 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:51:41.121035 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.121378 [debug] [MainThread]: On master: BEGIN
[0m11:51:41.121628 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:51:41.124874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.125218 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.125599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:51:41.140300 [debug] [MainThread]: SQL status: SELECT 8 in 0.0 seconds
[0m11:51:41.143123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f2d17450>]}
[0m11:51:41.143533 [debug] [MainThread]: On master: ROLLBACK
[0m11:51:41.144011 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.144303 [debug] [MainThread]: On master: BEGIN
[0m11:51:41.144987 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.145297 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.145630 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.145904 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.146309 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:51:41.146617 [debug] [MainThread]: On master: Close
[0m11:51:41.147069 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:41.147409 [info ] [MainThread]: 
[0m11:51:41.149804 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m11:51:41.150474 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m11:51:41.151974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m11:51:41.152382 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m11:51:41.159916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m11:51:41.160463 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m11:51:41.197954 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m11:51:41.198546 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.198866 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m11:51:41.199152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:51:41.202414 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.202859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.203205 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
)
select * from patient
  );
[0m11:51:41.204911 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:51:41.210859 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.211287 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m11:51:41.212061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:51:41.225926 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:51:41.226418 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.226757 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:51:41.278265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:51:41.292635 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_patient__dbt_backup"
[0m11:51:41.304759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:51:41.305729 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
drop view if exists "my_db"."public"."dim_patient__dbt_backup" cascade
[0m11:51:41.307074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:51:41.311475 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m11:51:41.314020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b284c6ed-b76c-4d57-bd5a-c294a8ad358f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f1fccf10>]}
[0m11:51:41.315060 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_patient ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m11:51:41.316105 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m11:51:41.318028 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.318502 [debug] [MainThread]: On master: BEGIN
[0m11:51:41.318843 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:51:41.322800 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:51:41.323397 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.323845 [debug] [MainThread]: Using postgres connection "master"
[0m11:51:41.324206 [debug] [MainThread]: On master: COMMIT
[0m11:51:41.324741 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:51:41.325081 [debug] [MainThread]: On master: Close
[0m11:51:41.325768 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:41.326149 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m11:51:41.326561 [info ] [MainThread]: 
[0m11:51:41.326918 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m11:51:41.328024 [debug] [MainThread]: Command end result
[0m11:51:41.359501 [info ] [MainThread]: 
[0m11:51:41.360011 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:41.360360 [info ] [MainThread]: 
[0m11:51:41.360723 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:41.361520 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.88750935, "process_user_time": 1.82379, "process_kernel_time": 0.134689, "process_mem_max_rss": "113676", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m11:51:41.362088 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:41.361927 after 0.89 seconds
[0m11:51:41.362562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f47ad710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f8859890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7866f8560710>]}
[0m11:51:41.362954 [debug] [MainThread]: Flushing usage events
[0m11:52:38.046749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750902946d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750902981a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750902980250>]}


============================== 11:52:38.049385 | ae2932f6-324b-4ab4-af4c-f2f93781e73c ==============================
[0m11:52:38.049385 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:52:38.049880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_patient', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:52:38.194064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75090284cc10>]}
[0m11:52:38.242923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750906641010>]}
[0m11:52:38.243640 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:52:38.253129 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:52:38.345493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:52:38.346067 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_patient.sql
[0m11:52:38.543692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509010ba150>]}
[0m11:52:38.609265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750900d48790>]}
[0m11:52:38.609729 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:52:38.610043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509035de090>]}
[0m11:52:38.611439 [info ] [MainThread]: 
[0m11:52:38.611965 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:52:38.612882 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:52:38.651312 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:52:38.651685 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:52:38.651945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:52:38.665022 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:52:38.666357 [debug] [ThreadPool]: On list_my_db: Close
[0m11:52:38.671189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:52:38.676860 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:52:38.677166 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:52:38.677425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:52:38.680956 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.681386 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:52:38.681727 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:52:38.684307 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m11:52:38.685823 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:52:38.686298 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:52:38.694332 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.694720 [debug] [MainThread]: On master: BEGIN
[0m11:52:38.695002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:52:38.698247 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.698609 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.698980 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:52:38.714205 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m11:52:38.717119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750900d7cb50>]}
[0m11:52:38.717503 [debug] [MainThread]: On master: ROLLBACK
[0m11:52:38.717967 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.718239 [debug] [MainThread]: On master: BEGIN
[0m11:52:38.718821 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.719103 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.719384 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.719644 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.720039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:52:38.720321 [debug] [MainThread]: On master: Close
[0m11:52:38.720789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:52:38.721166 [info ] [MainThread]: 
[0m11:52:38.723223 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_patient
[0m11:52:38.723809 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_patient ................................. [RUN]
[0m11:52:38.725325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_patient)
[0m11:52:38.725814 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_patient
[0m11:52:38.733760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_patient"
[0m11:52:38.734392 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_patient
[0m11:52:38.770461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_patient"
[0m11:52:38.771131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.771536 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: BEGIN
[0m11:52:38.771846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:52:38.775608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.776041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.776432 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */

  create view "my_db"."public"."dim_patient__dbt_tmp"
    
    
  as (
    with patient as (
    select * from "my_db"."public"."stg_patient"
)
select * from patient
order by patient_id
  );
[0m11:52:38.778125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:52:38.784816 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.785242 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient" rename to "dim_patient__dbt_backup"
[0m11:52:38.785963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:52:38.788964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.789314 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
alter table "my_db"."public"."dim_patient__dbt_tmp" rename to "dim_patient"
[0m11:52:38.790066 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:52:38.805768 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:52:38.806167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.806505 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: COMMIT
[0m11:52:38.814472 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:52:38.820887 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_patient__dbt_backup"
[0m11:52:38.825792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_patient"
[0m11:52:38.826168 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_patient"} */
drop view if exists "my_db"."public"."dim_patient__dbt_backup" cascade
[0m11:52:38.827896 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:52:38.830200 [debug] [Thread-1 (]: On model.dbt_modeling.dim_patient: Close
[0m11:52:38.831623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae2932f6-324b-4ab4-af4c-f2f93781e73c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7508ffd83a50>]}
[0m11:52:38.832526 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_patient ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m11:52:38.833218 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_patient
[0m11:52:38.834530 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.834821 [debug] [MainThread]: On master: BEGIN
[0m11:52:38.835072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:52:38.838248 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:52:38.838664 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.838973 [debug] [MainThread]: Using postgres connection "master"
[0m11:52:38.839353 [debug] [MainThread]: On master: COMMIT
[0m11:52:38.839912 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:52:38.840387 [debug] [MainThread]: On master: Close
[0m11:52:38.841005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:52:38.841354 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_patient' was properly closed.
[0m11:52:38.841719 [info ] [MainThread]: 
[0m11:52:38.842543 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m11:52:38.843509 [debug] [MainThread]: Command end result
[0m11:52:38.872281 [info ] [MainThread]: 
[0m11:52:38.872829 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:52:38.873196 [info ] [MainThread]: 
[0m11:52:38.873545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:52:38.874302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86895895, "process_user_time": 1.969374, "process_kernel_time": 0.124896, "process_mem_max_rss": "113484", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m11:52:38.874806 [debug] [MainThread]: Command `dbt run` succeeded at 11:52:38.874695 after 0.87 seconds
[0m11:52:38.875137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509067307d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509068b44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7509068b4e10>]}
[0m11:52:38.875498 [debug] [MainThread]: Flushing usage events
[0m11:53:13.933516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299df7c7010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299df7f1d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299df7ebe90>]}


============================== 11:53:13.936202 | 9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b ==============================
[0m11:53:13.936202 [info ] [MainThread]: Running with dbt=1.8.3
[0m11:53:13.936737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m dim_doctor', 'send_anonymous_usage_stats': 'True'}
[0m11:53:14.073425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299ddb13b50>]}
[0m11:53:14.122971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299e17ecc10>]}
[0m11:53:14.123754 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m11:53:14.132836 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m11:53:14.226651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:53:14.227230 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_doctor.sql
[0m11:53:14.420755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dc263ad0>]}
[0m11:53:14.489989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dbf58d10>]}
[0m11:53:14.490490 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m11:53:14.490786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dc021610>]}
[0m11:53:14.492262 [info ] [MainThread]: 
[0m11:53:14.492790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:53:14.493694 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m11:53:14.531210 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m11:53:14.532652 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m11:53:14.532961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:53:14.537369 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m11:53:14.538650 [debug] [ThreadPool]: On list_my_db: Close
[0m11:53:14.543623 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m11:53:14.549439 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:53:14.549801 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m11:53:14.550053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:53:14.553181 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.553604 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m11:53:14.553898 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m11:53:14.556372 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m11:53:14.557808 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m11:53:14.558215 [debug] [ThreadPool]: On list_my_db_public: Close
[0m11:53:14.565700 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.566048 [debug] [MainThread]: On master: BEGIN
[0m11:53:14.566301 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:53:14.569494 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.569851 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.570221 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:53:14.585651 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m11:53:14.588677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299ddabe910>]}
[0m11:53:14.589063 [debug] [MainThread]: On master: ROLLBACK
[0m11:53:14.589565 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.589835 [debug] [MainThread]: On master: BEGIN
[0m11:53:14.590362 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.590681 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.590959 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.591223 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.591602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:14.591922 [debug] [MainThread]: On master: Close
[0m11:53:14.592374 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:53:14.592697 [info ] [MainThread]: 
[0m11:53:14.594809 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_doctor
[0m11:53:14.595379 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_doctor .................................. [RUN]
[0m11:53:14.596966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_doctor)
[0m11:53:14.597421 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_doctor
[0m11:53:14.604854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_doctor"
[0m11:53:14.605501 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_doctor
[0m11:53:14.640658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_doctor"
[0m11:53:14.641272 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.641623 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: BEGIN
[0m11:53:14.641974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:53:14.645555 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.646021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.646413 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */

  create view "my_db"."public"."dim_doctor__dbt_tmp"
    
    
  as (
    with doctor as (
    select * from "my_db"."public"."stg_doctor"
)

select * from doctor 
order by doctor_id
  );
[0m11:53:14.648554 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:53:14.654965 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.655379 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor" rename to "dim_doctor__dbt_backup"
[0m11:53:14.656076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:14.659105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.659474 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
alter table "my_db"."public"."dim_doctor__dbt_tmp" rename to "dim_doctor"
[0m11:53:14.660145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:53:14.676186 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:53:14.676644 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.676961 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: COMMIT
[0m11:53:14.685010 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m11:53:14.691173 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_doctor__dbt_backup"
[0m11:53:14.695843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_doctor"
[0m11:53:14.696201 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_doctor"} */
drop view if exists "my_db"."public"."dim_doctor__dbt_backup" cascade
[0m11:53:14.697877 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m11:53:14.700149 [debug] [Thread-1 (]: On model.dbt_modeling.dim_doctor: Close
[0m11:53:14.701797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dc74ce6-5222-4d4b-ad37-4c5fbacc5d2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299daf38f10>]}
[0m11:53:14.702756 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_doctor ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m11:53:14.703486 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_doctor
[0m11:53:14.704722 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.705025 [debug] [MainThread]: On master: BEGIN
[0m11:53:14.705277 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:53:14.708429 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:53:14.708807 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.709146 [debug] [MainThread]: Using postgres connection "master"
[0m11:53:14.709436 [debug] [MainThread]: On master: COMMIT
[0m11:53:14.709838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:53:14.710211 [debug] [MainThread]: On master: Close
[0m11:53:14.710804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:53:14.711267 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_doctor' was properly closed.
[0m11:53:14.711891 [info ] [MainThread]: 
[0m11:53:14.712823 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m11:53:14.713755 [debug] [MainThread]: Command end result
[0m11:53:14.741645 [info ] [MainThread]: 
[0m11:53:14.742119 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:53:14.742451 [info ] [MainThread]: 
[0m11:53:14.742783 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:53:14.743514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8571896, "process_user_time": 1.90009, "process_kernel_time": 0.114703, "process_mem_max_rss": "113948", "process_out_blocks": "2576", "process_in_blocks": "0"}
[0m11:53:14.743979 [debug] [MainThread]: Command `dbt run` succeeded at 11:53:14.743876 after 0.86 seconds
[0m11:53:14.744295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299dddfca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299ddc900d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7299e18dc790>]}
[0m11:53:14.744636 [debug] [MainThread]: Flushing usage events
[0m12:18:50.236117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab915a410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab915a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab92f7990>]}


============================== 12:18:50.238643 | 0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4 ==============================
[0m12:18:50.238643 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:18:50.239170 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:18:50.365889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab904ad90>]}
[0m12:18:50.411799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cabce54950>]}
[0m12:18:50.412538 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:18:50.421576 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:18:50.514686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:50.515241 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:18:50.708345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab903c790>]}
[0m12:18:50.775906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab75ee450>]}
[0m12:18:50.776388 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:18:50.776684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab771d590>]}
[0m12:18:50.778124 [info ] [MainThread]: 
[0m12:18:50.778645 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:50.779497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:18:50.817454 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:18:50.817830 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:18:50.818138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:50.822977 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:18:50.824422 [debug] [ThreadPool]: On list_my_db: Close
[0m12:18:50.830112 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:18:50.836517 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:18:50.836863 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:18:50.837129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:50.840366 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.840721 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:18:50.841041 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:18:50.843507 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:18:50.844950 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:18:50.845363 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:18:50.853399 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.853747 [debug] [MainThread]: On master: BEGIN
[0m12:18:50.854011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:50.857190 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.857573 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.857925 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:50.873212 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:18:50.876103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab76e3d10>]}
[0m12:18:50.876494 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:50.876980 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.877252 [debug] [MainThread]: On master: BEGIN
[0m12:18:50.877853 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.878144 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.878417 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.878664 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.879067 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:18:50.879375 [debug] [MainThread]: On master: Close
[0m12:18:50.879796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:18:50.880111 [info ] [MainThread]: 
[0m12:18:50.881853 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:18:50.882363 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:18:50.884048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:18:50.884533 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:18:50.893712 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:18:50.894377 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:18:50.930501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:18:50.931371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:18:50.931727 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:18:50.932013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:50.935448 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.935879 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:18:50.936253 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select Patient_id
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
    "AppointmentID" as Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select Invoice_id
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    p.Patient_id,
    d.Doctor_id,
    p.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a
join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Procedure_id = pr.Procedure_id
join billing_data b on a.Invoice_id = b.Invoice_id
  );
[0m12:18:50.937297 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "AppointmentID" does not exist
LINE 25:     "AppointmentID" as Appointment_id
             ^

[0m12:18:50.937769 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:18:50.938270 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:18:50.942189 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column "AppointmentID" does not exist
  LINE 25:     "AppointmentID" as Appointment_id
               ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:18:50.943651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cbbd5fb-3fd6-42f6-9960-b9a85b093ca4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cab6557dd0>]}
[0m12:18:50.944240 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:18:50.944859 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:18:50.946505 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.946898 [debug] [MainThread]: On master: BEGIN
[0m12:18:50.947240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:50.950074 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:18:50.950545 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.950843 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:50.951147 [debug] [MainThread]: On master: COMMIT
[0m12:18:50.951798 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:18:50.952245 [debug] [MainThread]: On master: Close
[0m12:18:50.952802 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:50.953159 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:18:50.953646 [info ] [MainThread]: 
[0m12:18:50.954086 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:18:50.955008 [debug] [MainThread]: Command end result
[0m12:18:50.982432 [info ] [MainThread]: 
[0m12:18:50.982998 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:18:50.983432 [info ] [MainThread]: 
[0m12:18:50.983996 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column "AppointmentID" does not exist
  LINE 25:     "AppointmentID" as Appointment_id
               ^
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:18:50.984369 [info ] [MainThread]: 
[0m12:18:50.984726 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:18:50.985566 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79080784, "process_user_time": 1.802767, "process_kernel_time": 0.13446, "process_mem_max_rss": "113968", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m12:18:50.986082 [debug] [MainThread]: Command `dbt run` failed at 12:18:50.985971 after 0.79 seconds
[0m12:18:50.986450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78caba59b250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cabd0bcd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78cabd0bcc90>]}
[0m12:18:50.986776 [debug] [MainThread]: Flushing usage events
[0m12:19:40.526033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d6d3310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d71a4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d71a750>]}


============================== 12:19:40.528674 | 954252fe-dd6b-4c30-99ec-374673cef6bf ==============================
[0m12:19:40.528674 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:19:40.529259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m fct_appointment', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:19:40.668867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bdffd50>]}
[0m12:19:40.716236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb613dcfd0>]}
[0m12:19:40.716920 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:19:40.726071 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:19:40.821803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:40.822387 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:19:41.015350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bd012d0>]}
[0m12:19:41.081750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bb59a10>]}
[0m12:19:41.082232 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:19:41.082557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5b7895d0>]}
[0m12:19:41.084007 [info ] [MainThread]: 
[0m12:19:41.084534 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:41.085388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:19:41.123561 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:19:41.123910 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:19:41.124171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:41.128632 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:19:41.129919 [debug] [ThreadPool]: On list_my_db: Close
[0m12:19:41.134749 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:19:41.140488 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:19:41.140841 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:19:41.141088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:19:41.144409 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.144865 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:19:41.145158 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:19:41.147947 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:19:41.149471 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:19:41.149929 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:19:41.157314 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.157714 [debug] [MainThread]: On master: BEGIN
[0m12:19:41.157996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:41.161240 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.161678 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.162056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:41.178032 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:19:41.181095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bab7810>]}
[0m12:19:41.181490 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:41.182005 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.182276 [debug] [MainThread]: On master: BEGIN
[0m12:19:41.182906 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.183236 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.183525 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.183778 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.184198 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:19:41.184495 [debug] [MainThread]: On master: Close
[0m12:19:41.184955 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:19:41.185288 [info ] [MainThread]: 
[0m12:19:41.187579 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:19:41.188232 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:19:41.189763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:19:41.190172 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:19:41.199503 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:19:41.200263 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:19:41.236056 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:19:41.236647 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:19:41.236966 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:19:41.237242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:19:41.240440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.240875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:19:41.241217 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select Patient_id
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select Invoice_id
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    p.Patient_id,
    d.Doctor_id,
    p.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a
join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Procedure_id = pr.Procedure_id
join billing_data b on a.Invoice_id = b.Invoice_id
  );
[0m12:19:41.242438 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column a.procedure_id does not exist
LINE 43: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                   ^
HINT:  Perhaps you meant to reference the column "pr.procedure_id".

[0m12:19:41.242877 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:19:41.243396 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:19:41.247698 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column a.procedure_id does not exist
  LINE 43: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                     ^
  HINT:  Perhaps you meant to reference the column "pr.procedure_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:19:41.249525 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '954252fe-dd6b-4c30-99ec-374673cef6bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5bdbbf10>]}
[0m12:19:41.250162 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:19:41.250779 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:19:41.252368 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.252661 [debug] [MainThread]: On master: BEGIN
[0m12:19:41.252914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:41.255880 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:19:41.256314 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.256641 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:41.256892 [debug] [MainThread]: On master: COMMIT
[0m12:19:41.257269 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:19:41.257586 [debug] [MainThread]: On master: Close
[0m12:19:41.258049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:41.258418 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:19:41.258801 [info ] [MainThread]: 
[0m12:19:41.259191 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:19:41.260359 [debug] [MainThread]: Command end result
[0m12:19:41.287079 [info ] [MainThread]: 
[0m12:19:41.287531 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:19:41.287815 [info ] [MainThread]: 
[0m12:19:41.288182 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  column a.procedure_id does not exist
  LINE 43: join procedure_data pr on a.Procedure_id = pr.Procedure_id
                                     ^
  HINT:  Perhaps you meant to reference the column "pr.procedure_id".
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:19:41.288500 [info ] [MainThread]: 
[0m12:19:41.288805 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:19:41.289527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8069918, "process_user_time": 2.004504, "process_kernel_time": 0.130706, "process_mem_max_rss": "113992", "process_out_blocks": "2584", "command_success": false, "process_in_blocks": "0"}
[0m12:19:41.289990 [debug] [MainThread]: Command `dbt run` failed at 12:19:41.289876 after 0.81 seconds
[0m12:19:41.290321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d6d14d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5d8a0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76eb5a346750>]}
[0m12:19:41.290641 [debug] [MainThread]: Flushing usage events
[0m12:47:20.141865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a7549eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a7579cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a754837d0>]}


============================== 12:47:20.144375 | 12f43597-5425-4b42-9328-d57687a5ddaf ==============================
[0m12:47:20.144375 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:47:20.144884 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -m fct_appointment', 'send_anonymous_usage_stats': 'True'}
[0m12:47:20.273774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a75372d90>]}
[0m12:47:20.319879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a79190710>]}
[0m12:47:20.320611 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:47:20.329946 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:47:20.421656 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:20.422186 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:47:20.616182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a73c0ca50>]}
[0m12:47:20.682295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a73820990>]}
[0m12:47:20.682800 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:47:20.683077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a738b1d50>]}
[0m12:47:20.684556 [info ] [MainThread]: 
[0m12:47:20.685060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:20.685997 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:47:20.723890 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:47:20.724239 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:47:20.724511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:20.728949 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:47:20.730249 [debug] [ThreadPool]: On list_my_db: Close
[0m12:47:20.735242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:47:20.741280 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:20.741644 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:47:20.741890 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:20.745170 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.745574 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:20.745869 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:20.748313 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:47:20.749787 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:47:20.750217 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:47:20.757522 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.757871 [debug] [MainThread]: On master: BEGIN
[0m12:47:20.758113 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:20.761384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.761786 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.762138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:20.777362 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:47:20.780220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a72ddb850>]}
[0m12:47:20.780608 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:20.781005 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.781292 [debug] [MainThread]: On master: BEGIN
[0m12:47:20.781872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.782219 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.782500 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.782746 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.783125 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:20.783415 [debug] [MainThread]: On master: Close
[0m12:47:20.783837 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:20.784131 [info ] [MainThread]: 
[0m12:47:20.786224 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:47:20.786819 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:47:20.788379 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:47:20.788786 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:47:20.796972 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:47:20.797573 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:47:20.832823 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:47:20.833440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:20.833782 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:47:20.834050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:20.838854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.839256 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:20.839632 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select Patient_id
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:47:20.841128 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 46: join billing_data b on a.Patient_id = b.Patient_id
                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:47:20.841590 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:47:20.842085 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:47:20.845809 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 46: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:20.847254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12f43597-5425-4b42-9328-d57687a5ddaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a73822a90>]}
[0m12:47:20.847862 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:47:20.848478 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:47:20.849980 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.850290 [debug] [MainThread]: On master: BEGIN
[0m12:47:20.850561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:20.853770 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:20.854159 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.854516 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:20.854848 [debug] [MainThread]: On master: COMMIT
[0m12:47:20.855291 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:20.855703 [debug] [MainThread]: On master: Close
[0m12:47:20.856461 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:20.856847 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:47:20.857183 [info ] [MainThread]: 
[0m12:47:20.857581 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:47:20.858503 [debug] [MainThread]: Command end result
[0m12:47:20.885562 [info ] [MainThread]: 
[0m12:47:20.886419 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:20.886776 [info ] [MainThread]: 
[0m12:47:20.887223 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 46: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:20.887546 [info ] [MainThread]: 
[0m12:47:20.887871 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:47:20.888804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7883628, "process_user_time": 1.823306, "process_kernel_time": 0.118759, "process_mem_max_rss": "113684", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m12:47:20.889376 [debug] [MainThread]: Command `dbt run` failed at 12:47:20.889247 after 0.79 seconds
[0m12:47:20.889778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a754a9510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a793e4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726a793e4d90>]}
[0m12:47:20.890214 [debug] [MainThread]: Flushing usage events
[0m12:47:58.736706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89417ada10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8941764c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89417ae950>]}


============================== 12:47:58.739871 | 74799194-b38e-4bf8-a4bb-5f32a27a50c9 ==============================
[0m12:47:58.739871 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:47:58.740568 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:47:58.894344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893fe73710>]}
[0m12:47:58.950247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8945461010>]}
[0m12:47:58.951410 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:47:58.961015 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:47:59.064115 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:47:59.064750 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/appointment/fct_appointment.sql
[0m12:47:59.269691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893fd34c50>]}
[0m12:47:59.336886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893fb6c590>]}
[0m12:47:59.337428 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:47:59.337856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a894301a550>]}
[0m12:47:59.339511 [info ] [MainThread]: 
[0m12:47:59.340041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:47:59.340993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:47:59.378454 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:47:59.378870 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:47:59.379132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:47:59.384230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:47:59.385561 [debug] [ThreadPool]: On list_my_db: Close
[0m12:47:59.390278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:47:59.396039 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:59.396403 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:47:59.396659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:47:59.400513 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.401074 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:47:59.401585 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:47:59.404192 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:47:59.405726 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:47:59.406196 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:47:59.413289 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.413629 [debug] [MainThread]: On master: BEGIN
[0m12:47:59.413897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:47:59.417220 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.417726 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.418208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:47:59.434420 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:47:59.437770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8942429410>]}
[0m12:47:59.438247 [debug] [MainThread]: On master: ROLLBACK
[0m12:47:59.438771 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.439044 [debug] [MainThread]: On master: BEGIN
[0m12:47:59.439500 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.439812 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.440068 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.440311 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.440747 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:59.441031 [debug] [MainThread]: On master: Close
[0m12:47:59.441503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:47:59.441852 [info ] [MainThread]: 
[0m12:47:59.444173 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:47:59.444692 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:47:59.446472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:47:59.446971 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:47:59.455822 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:47:59.456518 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:47:59.492049 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:47:59.492664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:59.493006 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:47:59.493300 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:47:59.496548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.496988 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:47:59.497464 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:47:59.498993 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:47:59.499434 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:47:59.500024 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:47:59.504215 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:59.505619 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74799194-b38e-4bf8-a4bb-5f32a27a50c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a893eb21090>]}
[0m12:47:59.506209 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:47:59.506890 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:47:59.508547 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.508878 [debug] [MainThread]: On master: BEGIN
[0m12:47:59.509130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:47:59.512205 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:47:59.512631 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.512924 [debug] [MainThread]: Using postgres connection "master"
[0m12:47:59.513197 [debug] [MainThread]: On master: COMMIT
[0m12:47:59.513644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:47:59.513959 [debug] [MainThread]: On master: Close
[0m12:47:59.514378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:47:59.514648 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:47:59.514958 [info ] [MainThread]: 
[0m12:47:59.515297 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:47:59.516011 [debug] [MainThread]: Command end result
[0m12:47:59.545028 [info ] [MainThread]: 
[0m12:47:59.545468 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:47:59.545763 [info ] [MainThread]: 
[0m12:47:59.546121 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:47:59.546433 [info ] [MainThread]: 
[0m12:47:59.546742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:47:59.547535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8684435, "process_user_time": 2.046037, "process_kernel_time": 0.139002, "process_mem_max_rss": "114028", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m12:47:59.548046 [debug] [MainThread]: Command `dbt run` failed at 12:47:59.547934 after 0.87 seconds
[0m12:47:59.548413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a89458498d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a894192fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a8941764210>]}
[0m12:47:59.548761 [debug] [MainThread]: Flushing usage events
[0m12:48:29.266373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be02ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7c144d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be49950>]}


============================== 12:48:29.268953 | a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9 ==============================
[0m12:48:29.268953 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:48:29.269454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -m fct_appointment', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:48:29.410512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be4b510>]}
[0m12:48:29.458113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a5598d0>]}
[0m12:48:29.458800 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:48:29.468547 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:48:29.572647 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:29.573067 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:29.609440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a4fc610>]}
[0m12:48:29.681489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a569c10>]}
[0m12:48:29.681954 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:48:29.682246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a347fd0>]}
[0m12:48:29.683730 [info ] [MainThread]: 
[0m12:48:29.684259 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:48:29.685095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:48:29.724782 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:48:29.725182 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:48:29.725465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:29.730563 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:48:29.731865 [debug] [ThreadPool]: On list_my_db: Close
[0m12:48:29.737266 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:48:29.743171 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:48:29.743681 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:48:29.744164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:29.747494 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.747856 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:48:29.748184 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:48:29.750674 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:48:29.752181 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:48:29.752613 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:48:29.759808 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.760163 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.760436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:29.764171 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.764562 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.764945 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:48:29.780951 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:48:29.783947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a387590>]}
[0m12:48:29.784341 [debug] [MainThread]: On master: ROLLBACK
[0m12:48:29.784776 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.785033 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.785493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.785833 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.786098 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.786348 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.786733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:48:29.787018 [debug] [MainThread]: On master: Close
[0m12:48:29.787447 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:29.787809 [info ] [MainThread]: 
[0m12:48:29.789847 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:48:29.790385 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:48:29.791088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:48:29.791535 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:48:29.800810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:48:29.801412 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:48:29.837115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:48:29.837694 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:48:29.838021 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:48:29.838296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:29.841660 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.842230 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:48:29.842659 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:48:29.844540 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: integer = text
LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                             ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m12:48:29.845156 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: ROLLBACK
[0m12:48:29.845804 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:48:29.849784 [debug] [Thread-1 (]: Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:48:29.851171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5c250a6-e05f-4ad9-b5f7-1c8c11aabec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7a38cc50>]}
[0m12:48:29.851755 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.fct_appointment .................... [[31mERROR[0m in 0.06s]
[0m12:48:29.852368 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:48:29.854110 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.854449 [debug] [MainThread]: On master: BEGIN
[0m12:48:29.854708 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:29.857938 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:48:29.858300 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.858577 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:29.858838 [debug] [MainThread]: On master: COMMIT
[0m12:48:29.859192 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:48:29.859467 [debug] [MainThread]: On master: Close
[0m12:48:29.859856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:29.860106 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:48:29.860403 [info ] [MainThread]: 
[0m12:48:29.860738 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:48:29.861444 [debug] [MainThread]: Command end result
[0m12:48:29.891523 [info ] [MainThread]: 
[0m12:48:29.891964 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:48:29.892272 [info ] [MainThread]: 
[0m12:48:29.892661 [error] [MainThread]:   Database Error in model fct_appointment (models/marts/appointment/fct_appointment.sql)
  operator does not exist: integer = text
  LINE 49: join billing_data b on a.Patient_id = b.Patient_id
                                               ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_modeling/models/marts/appointment/fct_appointment.sql
[0m12:48:29.892967 [info ] [MainThread]: 
[0m12:48:29.893287 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:48:29.894194 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6742713, "process_user_time": 1.755404, "process_kernel_time": 0.124957, "process_mem_max_rss": "111076", "process_out_blocks": "1752", "command_success": false, "process_in_blocks": "0"}
[0m12:48:29.894913 [debug] [MainThread]: Command `dbt run` failed at 12:48:29.894785 after 0.68 seconds
[0m12:48:29.895354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7be56790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd7ff01890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77cd796b4250>]}
[0m12:48:29.895808 [debug] [MainThread]: Flushing usage events
[0m12:52:42.848181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e657fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e6870dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e6567790>]}


============================== 12:52:42.850789 | 154b0ec2-d6e9-4fda-965e-9e5c73aee690 ==============================
[0m12:52:42.850789 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:52:42.851339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -m stg_billing', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:52:42.979998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e657e790>]}
[0m12:52:43.026532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03ea24ce10>]}
[0m12:52:43.027240 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:52:43.037160 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:52:43.130756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:52:43.131370 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m12:52:43.324021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e64bbb50>]}
[0m12:52:43.393269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e4c9bc90>]}
[0m12:52:43.393778 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:52:43.394079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e7a8d7d0>]}
[0m12:52:43.395526 [info ] [MainThread]: 
[0m12:52:43.396191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:52:43.397216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:52:43.434610 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:52:43.434958 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:52:43.435216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:52:43.439602 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:52:43.440861 [debug] [ThreadPool]: On list_my_db: Close
[0m12:52:43.445803 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:52:43.451496 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:52:43.451839 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:52:43.452102 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:52:43.455569 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.456078 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:52:43.456425 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:52:43.459128 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:52:43.460700 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:52:43.461171 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:52:43.469587 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.469922 [debug] [MainThread]: On master: BEGIN
[0m12:52:43.470169 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:43.473239 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.473604 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.473958 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:52:43.489467 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:52:43.492461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e4af7810>]}
[0m12:52:43.492851 [debug] [MainThread]: On master: ROLLBACK
[0m12:52:43.493342 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.493673 [debug] [MainThread]: On master: BEGIN
[0m12:52:43.494231 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.494541 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.494842 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.495093 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.495512 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:52:43.495820 [debug] [MainThread]: On master: Close
[0m12:52:43.496342 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:52:43.496731 [info ] [MainThread]: 
[0m12:52:43.498735 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m12:52:43.499232 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m12:52:43.500864 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m12:52:43.501305 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m12:52:43.508654 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m12:52:43.509275 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m12:52:43.545420 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m12:52:43.546040 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:52:43.546369 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m12:52:43.546664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:52:43.549927 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.550315 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:52:43.550677 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  InvoiceID as Invoice_id,
        PatientID  as Patient_id,
        Items as Procedure,
        Amount
    from "my_db"."public"."Billing"
  );
[0m12:52:43.551407 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "invoiceid" does not exist
LINE 7:     select  InvoiceID as Invoice_id,
                    ^
HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".

[0m12:52:43.551770 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m12:52:43.552258 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m12:52:43.555936 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:52:43.557368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '154b0ec2-d6e9-4fda-965e-9e5c73aee690', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e394e510>]}
[0m12:52:43.557952 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m12:52:43.558592 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m12:52:43.560327 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.560674 [debug] [MainThread]: On master: BEGIN
[0m12:52:43.560960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:52:43.564052 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:52:43.564449 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.564720 [debug] [MainThread]: Using postgres connection "master"
[0m12:52:43.564999 [debug] [MainThread]: On master: COMMIT
[0m12:52:43.565411 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:52:43.565697 [debug] [MainThread]: On master: Close
[0m12:52:43.566254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:52:43.566720 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m12:52:43.567189 [info ] [MainThread]: 
[0m12:52:43.567827 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:52:43.568737 [debug] [MainThread]: Command end result
[0m12:52:43.596128 [info ] [MainThread]: 
[0m12:52:43.596668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:52:43.596998 [info ] [MainThread]: 
[0m12:52:43.597453 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "invoiceid" does not exist
  LINE 7:     select  InvoiceID as Invoice_id,
                      ^
  HINT:  Perhaps you meant to reference the column "Billing.InvoiceID".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:52:43.597750 [info ] [MainThread]: 
[0m12:52:43.598059 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:52:43.598797 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.79226536, "process_user_time": 1.815849, "process_kernel_time": 0.128705, "process_mem_max_rss": "114096", "process_out_blocks": "2576", "command_success": false, "process_in_blocks": "0"}
[0m12:52:43.599248 [debug] [MainThread]: Command `dbt run` failed at 12:52:43.599147 after 0.79 seconds
[0m12:52:43.599619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03e657fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03ea4c0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c03ea4c0dd0>]}
[0m12:52:43.599929 [debug] [MainThread]: Flushing usage events
[0m12:53:15.533872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716d4ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716d4e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716d4c590>]}


============================== 12:53:15.536384 | 61aaf0fc-5069-4333-ad7c-2b2222338c10 ==============================
[0m12:53:15.536384 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:53:15.536883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/dbt/logs', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -m stg_billing', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:53:15.665912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716c5c110>]}
[0m12:53:15.711859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a71aa49010>]}
[0m12:53:15.712568 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:53:15.721487 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:53:15.812573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:15.813151 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m12:53:16.005424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a715499590>]}
[0m12:53:16.073112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a7154c1750>]}
[0m12:53:16.073581 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:53:16.073876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a714d03f90>]}
[0m12:53:16.075524 [info ] [MainThread]: 
[0m12:53:16.076160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:16.077104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:53:16.114127 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:53:16.114500 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:53:16.114781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:16.119878 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:53:16.121482 [debug] [ThreadPool]: On list_my_db: Close
[0m12:53:16.126284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:53:16.131946 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:16.132330 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:53:16.132621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:16.135754 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.136124 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:16.136470 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:53:16.138942 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:53:16.140423 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:53:16.140888 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:53:16.148786 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.149119 [debug] [MainThread]: On master: BEGIN
[0m12:53:16.149372 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:16.152489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.152862 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.153219 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:53:16.168638 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:53:16.171675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a71401d4d0>]}
[0m12:53:16.172106 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:16.172503 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.172768 [debug] [MainThread]: On master: BEGIN
[0m12:53:16.173185 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.173480 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.173739 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.173991 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.174322 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:16.174615 [debug] [MainThread]: On master: Close
[0m12:53:16.175227 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:16.175733 [info ] [MainThread]: 
[0m12:53:16.178078 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m12:53:16.178590 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m12:53:16.180208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m12:53:16.180676 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m12:53:16.187848 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m12:53:16.188604 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m12:53:16.223649 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m12:53:16.224258 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:16.224582 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m12:53:16.224861 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:16.228030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.228424 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:16.228739 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        Amount
    from "my_db"."public"."Billing"
  );
[0m12:53:16.229366 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "amount" does not exist
LINE 10:         Amount
                 ^
HINT:  Perhaps you meant to reference the column "Billing.Amount".

[0m12:53:16.229727 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: ROLLBACK
[0m12:53:16.230285 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m12:53:16.233967 [debug] [Thread-1 (]: Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "amount" does not exist
  LINE 10:         Amount
                   ^
  HINT:  Perhaps you meant to reference the column "Billing.Amount".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:53:16.235362 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61aaf0fc-5069-4333-ad7c-2b2222338c10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716c87ed0>]}
[0m12:53:16.235947 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_billing ........................ [[31mERROR[0m in 0.06s]
[0m12:53:16.236651 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m12:53:16.238417 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.238758 [debug] [MainThread]: On master: BEGIN
[0m12:53:16.239021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:16.242035 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:16.242402 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.242682 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:16.242928 [debug] [MainThread]: On master: COMMIT
[0m12:53:16.243277 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:16.243556 [debug] [MainThread]: On master: Close
[0m12:53:16.243960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:16.244222 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m12:53:16.244539 [info ] [MainThread]: 
[0m12:53:16.244875 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:53:16.245866 [debug] [MainThread]: Command end result
[0m12:53:16.275904 [info ] [MainThread]: 
[0m12:53:16.276402 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m12:53:16.276725 [info ] [MainThread]: 
[0m12:53:16.277160 [error] [MainThread]:   Database Error in model stg_billing (models/staging/healthcare/stg_billing.sql)
  column "amount" does not exist
  LINE 10:         Amount
                   ^
  HINT:  Perhaps you meant to reference the column "Billing.Amount".
  compiled Code at target/run/dbt_modeling/models/staging/healthcare/stg_billing.sql
[0m12:53:16.277502 [info ] [MainThread]: 
[0m12:53:16.277855 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m12:53:16.278661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7864996, "process_user_time": 1.870357, "process_kernel_time": 0.128749, "process_mem_max_rss": "113936", "process_out_blocks": "2568", "command_success": false, "process_in_blocks": "0"}
[0m12:53:16.279162 [debug] [MainThread]: Command `dbt run` failed at 12:53:16.279054 after 0.79 seconds
[0m12:53:16.279531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716f17a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716f17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a716f17d10>]}
[0m12:53:16.279874 [debug] [MainThread]: Flushing usage events
[0m12:53:26.936109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3ad9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3ada90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3acc50>]}


============================== 12:53:26.938686 | a6e2e9c3-4397-4ef9-8c56-9d787b9468fa ==============================
[0m12:53:26.938686 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:53:26.939201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m stg_billing', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:53:27.070234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f28ad90>]}
[0m12:53:27.117088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7275730a0f50>]}
[0m12:53:27.117772 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:53:27.126738 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:53:27.218252 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:53:27.218796 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/staging/healthcare/stg_billing.sql
[0m12:53:27.412375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f392ad0>]}
[0m12:53:27.479855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756d657d10>]}
[0m12:53:27.480559 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:53:27.480963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756d62cbd0>]}
[0m12:53:27.482538 [info ] [MainThread]: 
[0m12:53:27.483106 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:53:27.483971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:53:27.521661 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:53:27.522041 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:53:27.522299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:53:27.527480 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:53:27.528746 [debug] [ThreadPool]: On list_my_db: Close
[0m12:53:27.534099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:53:27.540163 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:27.540519 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:53:27.540769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:53:27.544230 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.544603 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:53:27.544906 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:53:27.547430 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:53:27.549026 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:53:27.549627 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:53:27.556653 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.556979 [debug] [MainThread]: On master: BEGIN
[0m12:53:27.557221 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:53:27.560358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.560704 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.561049 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:53:27.576241 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:53:27.579254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756db12910>]}
[0m12:53:27.579772 [debug] [MainThread]: On master: ROLLBACK
[0m12:53:27.580247 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.580541 [debug] [MainThread]: On master: BEGIN
[0m12:53:27.581127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.581480 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.581769 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.582020 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.582409 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:27.582728 [debug] [MainThread]: On master: Close
[0m12:53:27.583197 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:53:27.583538 [info ] [MainThread]: 
[0m12:53:27.585471 [debug] [Thread-1 (]: Began running node model.dbt_modeling.stg_billing
[0m12:53:27.585989 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_billing ................................. [RUN]
[0m12:53:27.587617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.stg_billing)
[0m12:53:27.588040 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.stg_billing
[0m12:53:27.595619 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.stg_billing"
[0m12:53:27.596590 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.stg_billing
[0m12:53:27.632377 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.stg_billing"
[0m12:53:27.632983 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.633293 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: BEGIN
[0m12:53:27.633579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:53:27.636561 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.636998 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.637409 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */

  create view "my_db"."public"."stg_billing__dbt_tmp"
    
    
  as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"
  );
[0m12:53:27.638977 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:53:27.645635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.646035 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
alter table "my_db"."public"."stg_billing" rename to "stg_billing__dbt_backup"
[0m12:53:27.646771 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:53:27.650156 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.650614 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
alter table "my_db"."public"."stg_billing__dbt_tmp" rename to "stg_billing"
[0m12:53:27.651350 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:53:27.667535 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m12:53:27.667942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.668261 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: COMMIT
[0m12:53:27.676395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:53:27.682862 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."stg_billing__dbt_backup"
[0m12:53:27.687702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.stg_billing"
[0m12:53:27.688096 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.stg_billing"} */
drop view if exists "my_db"."public"."stg_billing__dbt_backup" cascade
[0m12:53:27.689759 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:53:27.692107 [debug] [Thread-1 (]: On model.dbt_modeling.stg_billing: Close
[0m12:53:27.693795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6e2e9c3-4397-4ef9-8c56-9d787b9468fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756cbea750>]}
[0m12:53:27.694544 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_billing ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m12:53:27.695275 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.stg_billing
[0m12:53:27.696557 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.696870 [debug] [MainThread]: On master: BEGIN
[0m12:53:27.697130 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:53:27.700256 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:53:27.700675 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.701003 [debug] [MainThread]: Using postgres connection "master"
[0m12:53:27.701271 [debug] [MainThread]: On master: COMMIT
[0m12:53:27.701777 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:53:27.702223 [debug] [MainThread]: On master: Close
[0m12:53:27.702808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:53:27.703139 [debug] [MainThread]: Connection 'model.dbt_modeling.stg_billing' was properly closed.
[0m12:53:27.703550 [info ] [MainThread]: 
[0m12:53:27.704095 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:53:27.704914 [debug] [MainThread]: Command end result
[0m12:53:27.734134 [info ] [MainThread]: 
[0m12:53:27.734634 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:53:27.734983 [info ] [MainThread]: 
[0m12:53:27.735322 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:53:27.736076 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.84218264, "process_user_time": 1.943378, "process_kernel_time": 0.135677, "process_mem_max_rss": "113340", "process_out_blocks": "2560", "process_in_blocks": "0"}
[0m12:53:27.736553 [debug] [MainThread]: Command `dbt run` succeeded at 12:53:27.736438 after 0.84 seconds
[0m12:53:27.736871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3adad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72756f3adfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727573198710>]}
[0m12:53:27.737178 [debug] [MainThread]: Flushing usage events
[0m12:54:52.647329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d177fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d177510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d177790>]}


============================== 12:54:52.650600 | 52f5402a-c0ce-4cce-8614-640f3950c4e3 ==============================
[0m12:54:52.650600 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:54:52.651313 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -m dim_billing', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:54:52.814183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d07bf10>]}
[0m12:54:52.877166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b8b9b50>]}
[0m12:54:52.878169 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:54:52.897246 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:54:53.044455 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:54:53.045258 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m12:54:53.280151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b8cfed0>]}
[0m12:54:53.349496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b568390>]}
[0m12:54:53.349977 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:54:53.350275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b779950>]}
[0m12:54:53.351828 [info ] [MainThread]: 
[0m12:54:53.352375 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:54:53.353292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:54:53.390991 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:54:53.391420 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:54:53.391718 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:54:53.397648 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:54:53.398908 [debug] [ThreadPool]: On list_my_db: Close
[0m12:54:53.403677 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:54:53.409556 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:54:53.409900 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:54:53.410150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:54:53.413225 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.413634 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:54:53.413931 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:54:53.416485 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:54:53.418116 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:54:53.418633 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:54:53.426200 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.426553 [debug] [MainThread]: On master: BEGIN
[0m12:54:53.426798 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:54:53.429960 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.430330 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.430736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:54:53.446112 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:54:53.449078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b7b98d0>]}
[0m12:54:53.449498 [debug] [MainThread]: On master: ROLLBACK
[0m12:54:53.449973 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.450267 [debug] [MainThread]: On master: BEGIN
[0m12:54:53.450863 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.451162 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.451459 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.451734 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.452151 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:53.452460 [debug] [MainThread]: On master: Close
[0m12:54:53.452909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:54:53.453220 [info ] [MainThread]: 
[0m12:54:53.455088 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m12:54:53.455596 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m12:54:53.457168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m12:54:53.457598 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m12:54:53.465523 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m12:54:53.466178 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m12:54:53.502122 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m12:54:53.502725 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.503097 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m12:54:53.503388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:54:53.507450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.507919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.508351 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select distinct
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc
  );
[0m12:54:53.510627 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:54:53.517185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.517600 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m12:54:53.518356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:53.521397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.521740 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m12:54:53.522428 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:54:53.538402 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:54:53.538847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.539139 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:54:53.561980 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:54:53.576281 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m12:54:53.586651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:54:53.587365 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m12:54:53.589867 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:54:53.593288 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m12:54:53.595187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '52f5402a-c0ce-4cce-8614-640f3950c4e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1b59dd90>]}
[0m12:54:53.596123 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.14s]
[0m12:54:53.596968 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m12:54:53.598298 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.598631 [debug] [MainThread]: On master: BEGIN
[0m12:54:53.598903 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:54:53.602005 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:54:53.602468 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.602786 [debug] [MainThread]: Using postgres connection "master"
[0m12:54:53.603035 [debug] [MainThread]: On master: COMMIT
[0m12:54:53.603427 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:54:53.603733 [debug] [MainThread]: On master: Close
[0m12:54:53.604205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:54:53.604518 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m12:54:53.604887 [info ] [MainThread]: 
[0m12:54:53.605502 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m12:54:53.606430 [debug] [MainThread]: Command end result
[0m12:54:53.635093 [info ] [MainThread]: 
[0m12:54:53.635583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:54:53.635921 [info ] [MainThread]: 
[0m12:54:53.636248 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:54:53.637022 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0566818, "process_user_time": 2.141088, "process_kernel_time": 0.146937, "process_mem_max_rss": "113656", "process_out_blocks": "2568", "process_in_blocks": "0"}
[0m12:54:53.637482 [debug] [MainThread]: Command `dbt run` succeeded at 12:54:53.637379 after 1.06 seconds
[0m12:54:53.637798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a1d30fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a210e8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d7a210e9150>]}
[0m12:54:53.638106 [debug] [MainThread]: Flushing usage events
[0m12:55:38.169005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bcbe8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bcbeb7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bcba2690>]}


============================== 12:55:38.171962 | 97e2168a-1042-4075-8676-a41a5b08ed82 ==============================
[0m12:55:38.171962 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:55:38.172649 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/usr/app/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -m dim_billing', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:38.358215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bca24210>]}
[0m12:55:38.423801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c08ac710>]}
[0m12:55:38.424532 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:55:38.437349 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:55:38.551435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:55:38.552004 [debug] [MainThread]: Partial parsing: updated file: dbt_modeling://models/marts/description/dim_billing.sql
[0m12:55:38.810981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bb15d4d0>]}
[0m12:55:38.893596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bb334f90>]}
[0m12:55:38.894090 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:55:38.894482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871bb15e690>]}
[0m12:55:38.896487 [info ] [MainThread]: 
[0m12:55:38.897520 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:55:38.898584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:55:38.938297 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:55:38.938699 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:55:38.938974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:38.946509 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:55:38.948042 [debug] [ThreadPool]: On list_my_db: Close
[0m12:55:38.953242 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:55:38.959139 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:55:38.959489 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:55:38.959762 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:38.963559 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:55:38.964019 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:55:38.964361 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:55:38.967235 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:55:38.968817 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:55:38.969294 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:55:38.976639 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:38.977013 [debug] [MainThread]: On master: BEGIN
[0m12:55:38.977273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:38.980978 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:55:38.981406 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:38.981768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:55:38.998122 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:55:39.001312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871ba3c1fd0>]}
[0m12:55:39.001733 [debug] [MainThread]: On master: ROLLBACK
[0m12:55:39.002145 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.002443 [debug] [MainThread]: On master: BEGIN
[0m12:55:39.002873 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:55:39.003186 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.003473 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.003720 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.004056 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:55:39.004325 [debug] [MainThread]: On master: Close
[0m12:55:39.004836 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:55:39.005270 [info ] [MainThread]: 
[0m12:55:39.007581 [debug] [Thread-1 (]: Began running node model.dbt_modeling.dim_billing
[0m12:55:39.008085 [info ] [Thread-1 (]: 1 of 1 START sql view model public.dim_billing ................................. [RUN]
[0m12:55:39.009675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.dim_billing)
[0m12:55:39.010084 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.dim_billing
[0m12:55:39.019440 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.dim_billing"
[0m12:55:39.020061 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.dim_billing
[0m12:55:39.056253 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.dim_billing"
[0m12:55:39.056874 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.057206 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: BEGIN
[0m12:55:39.057514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:39.060683 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:55:39.061101 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.061450 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */

  create view "my_db"."public"."dim_billing__dbt_tmp"
    
    
  as (
    with billing as (
    select  "InvoiceID" as Invoice_id,
        "PatientID"  as Patient_id,
        "Items" as Procedure,
        "Amount"
    from "my_db"."public"."Billing"   
)

select distinct
    Invoice_id,
    Patient_id,
    Procedure,
    sum("Amount") over (partition by Procedure) as total_amount
from billing
order by total_amount desc ,Patient_id
  );
[0m12:55:39.064113 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:55:39.070523 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.070942 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing" rename to "dim_billing__dbt_backup"
[0m12:55:39.071674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:55:39.074723 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.075061 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
alter table "my_db"."public"."dim_billing__dbt_tmp" rename to "dim_billing"
[0m12:55:39.075684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:55:39.091962 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:55:39.092375 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.092720 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: COMMIT
[0m12:55:39.143911 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:55:39.152090 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."dim_billing__dbt_backup"
[0m12:55:39.157728 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.dim_billing"
[0m12:55:39.158202 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.dim_billing"} */
drop view if exists "my_db"."public"."dim_billing__dbt_backup" cascade
[0m12:55:39.160151 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:55:39.163219 [debug] [Thread-1 (]: On model.dbt_modeling.dim_billing: Close
[0m12:55:39.165666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97e2168a-1042-4075-8676-a41a5b08ed82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871b9f203d0>]}
[0m12:55:39.167168 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.dim_billing ............................ [[32mCREATE VIEW[0m in 0.16s]
[0m12:55:39.168845 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.dim_billing
[0m12:55:39.171039 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.171459 [debug] [MainThread]: On master: BEGIN
[0m12:55:39.171773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:39.175448 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:55:39.175890 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.176200 [debug] [MainThread]: Using postgres connection "master"
[0m12:55:39.176511 [debug] [MainThread]: On master: COMMIT
[0m12:55:39.177013 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:55:39.177385 [debug] [MainThread]: On master: Close
[0m12:55:39.177994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:39.178545 [debug] [MainThread]: Connection 'model.dbt_modeling.dim_billing' was properly closed.
[0m12:55:39.179133 [info ] [MainThread]: 
[0m12:55:39.179829 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m12:55:39.181319 [debug] [MainThread]: Command end result
[0m12:55:39.229057 [info ] [MainThread]: 
[0m12:55:39.229936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:39.230573 [info ] [MainThread]: 
[0m12:55:39.231259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:55:39.232842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.122446, "process_user_time": 2.208911, "process_kernel_time": 0.143929, "process_mem_max_rss": "113496", "process_out_blocks": "2584", "process_in_blocks": "0"}
[0m12:55:39.234379 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:39.233911 after 1.12 seconds
[0m12:55:39.235558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c09a4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c0b00c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7871c0b00d90>]}
[0m12:55:39.237141 [debug] [MainThread]: Flushing usage events
[0m12:56:09.676631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c4201dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c4200fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41e7b90>]}


============================== 12:56:09.679233 | c32211fe-6ca4-4138-88ad-e371e30c7514 ==============================
[0m12:56:09.679233 [info ] [MainThread]: Running with dbt=1.8.3
[0m12:56:09.679716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/usr/app/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -m fct_appointment', 'send_anonymous_usage_stats': 'True'}
[0m12:56:09.813867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c2895c10>]}
[0m12:56:09.862267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c7efc790>]}
[0m12:56:09.862912 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m12:56:09.872186 [debug] [MainThread]: checksum: 871d77df38a0661255d31f261d53a40de07e4ab2030d521ff4a1932357e45ee6, vars: {}, profile: , target: dev, version: 1.8.3
[0m12:56:09.974211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:56:09.974652 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:56:10.010172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c2822050>]}
[0m12:56:10.081070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c294d690>]}
[0m12:56:10.081511 [info ] [MainThread]: Found 5 seeds, 10 models, 415 macros
[0m12:56:10.081805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41fced0>]}
[0m12:56:10.083238 [info ] [MainThread]: 
[0m12:56:10.083810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:56:10.084668 [debug] [ThreadPool]: Acquiring new postgres connection 'list_my_db'
[0m12:56:10.124888 [debug] [ThreadPool]: Using postgres connection "list_my_db"
[0m12:56:10.125247 [debug] [ThreadPool]: On list_my_db: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db"} */

    select distinct nspname from pg_namespace
  
[0m12:56:10.125525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:10.129955 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m12:56:10.131219 [debug] [ThreadPool]: On list_my_db: Close
[0m12:56:10.136189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_my_db, now list_my_db_public)
[0m12:56:10.142250 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:56:10.142627 [debug] [ThreadPool]: On list_my_db_public: BEGIN
[0m12:56:10.142875 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:56:10.146097 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.146465 [debug] [ThreadPool]: Using postgres connection "list_my_db_public"
[0m12:56:10.146771 [debug] [ThreadPool]: On list_my_db_public: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "list_my_db_public"} */
select
      'my_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'my_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:56:10.149226 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
[0m12:56:10.150683 [debug] [ThreadPool]: On list_my_db_public: ROLLBACK
[0m12:56:10.151156 [debug] [ThreadPool]: On list_my_db_public: Close
[0m12:56:10.159306 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.159663 [debug] [MainThread]: On master: BEGIN
[0m12:56:10.159922 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:56:10.163151 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.163544 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.163919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:56:10.179367 [debug] [MainThread]: SQL status: SELECT 9 in 0.0 seconds
[0m12:56:10.182120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41ce890>]}
[0m12:56:10.182490 [debug] [MainThread]: On master: ROLLBACK
[0m12:56:10.182937 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.183198 [debug] [MainThread]: On master: BEGIN
[0m12:56:10.183732 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.184026 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.184278 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.184551 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.184919 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:56:10.185188 [debug] [MainThread]: On master: Close
[0m12:56:10.185622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:10.185928 [info ] [MainThread]: 
[0m12:56:10.187793 [debug] [Thread-1 (]: Began running node model.dbt_modeling.fct_appointment
[0m12:56:10.188316 [info ] [Thread-1 (]: 1 of 1 START sql view model public.fct_appointment ............................. [RUN]
[0m12:56:10.189040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_my_db_public, now model.dbt_modeling.fct_appointment)
[0m12:56:10.189506 [debug] [Thread-1 (]: Began compiling node model.dbt_modeling.fct_appointment
[0m12:56:10.198661 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_modeling.fct_appointment"
[0m12:56:10.199382 [debug] [Thread-1 (]: Began executing node model.dbt_modeling.fct_appointment
[0m12:56:10.236109 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_modeling.fct_appointment"
[0m12:56:10.236886 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.237332 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: BEGIN
[0m12:56:10.237666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:56:10.241046 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.241549 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.241964 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */

  create view "my_db"."public"."fct_appointment__dbt_tmp"
    
    
  as (
    with appointment_data as(
    select  Appointment_id,
            Patient_id,
            Doctor_id,
            Appointment_date
    from "my_db"."public"."stg_appointment"              
),
patient_data as (
    select 
        Patient_id,
        First_name,
        Last_name
    from "my_db"."public"."dim_patient"
),
doctor_data as (
    select Doctor_id
    from "my_db"."public"."dim_doctor"
),

procedure_data as (
    select  Procedure_id,
            Appointment_id
    from "my_db"."public"."dim_medical_procedure"
),
billing_data as (
    select  Invoice_id,
            Patient_id 
    from "my_db"."public"."dim_billing"
)

select
    a.Appointment_id,
    a.Patient_id,
    a.Doctor_id,
    pr.Procedure_id,
    b.Invoice_id,
    a.Appointment_date
from appointment_data a

join patient_data p on a.Patient_id = p.Patient_id
join doctor_data d on a.Doctor_id = d.Doctor_id
join procedure_data pr on a.Appointment_id = pr.Appointment_id
join billing_data b on a.Patient_id = b.Patient_id

order by a.Appointment_id
  );
[0m12:56:10.244565 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:56:10.250735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.251111 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
alter table "my_db"."public"."fct_appointment__dbt_tmp" rename to "fct_appointment"
[0m12:56:10.251864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:56:10.266936 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m12:56:10.267314 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.267615 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: COMMIT
[0m12:56:10.275243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m12:56:10.281262 [debug] [Thread-1 (]: Applying DROP to: "my_db"."public"."fct_appointment__dbt_backup"
[0m12:56:10.285904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_modeling.fct_appointment"
[0m12:56:10.286285 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: /* {"app": "dbt", "dbt_version": "1.8.3", "profile_name": "dbt_modeling", "target_name": "dev", "node_id": "model.dbt_modeling.fct_appointment"} */
drop view if exists "my_db"."public"."fct_appointment__dbt_backup" cascade
[0m12:56:10.286933 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m12:56:10.289042 [debug] [Thread-1 (]: On model.dbt_modeling.fct_appointment: Close
[0m12:56:10.290450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c32211fe-6ca4-4138-88ad-e371e30c7514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c41c0990>]}
[0m12:56:10.291231 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.fct_appointment ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m12:56:10.292481 [debug] [Thread-1 (]: Finished running node model.dbt_modeling.fct_appointment
[0m12:56:10.293596 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.293918 [debug] [MainThread]: On master: BEGIN
[0m12:56:10.294199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:56:10.297366 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:56:10.297897 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.298221 [debug] [MainThread]: Using postgres connection "master"
[0m12:56:10.298553 [debug] [MainThread]: On master: COMMIT
[0m12:56:10.299057 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:56:10.299498 [debug] [MainThread]: On master: Close
[0m12:56:10.300002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:10.300356 [debug] [MainThread]: Connection 'model.dbt_modeling.fct_appointment' was properly closed.
[0m12:56:10.300819 [info ] [MainThread]: 
[0m12:56:10.301355 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:56:10.302206 [debug] [MainThread]: Command end result
[0m12:56:10.331624 [info ] [MainThread]: 
[0m12:56:10.332116 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:10.332447 [info ] [MainThread]: 
[0m12:56:10.332784 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:56:10.333532 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7016038, "process_user_time": 1.736623, "process_kernel_time": 0.115974, "process_mem_max_rss": "111080", "process_out_blocks": "1760", "process_in_blocks": "0"}
[0m12:56:10.334005 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:10.333902 after 0.70 seconds
[0m12:56:10.334315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c420f450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c420d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d88c1a17bd0>]}
[0m12:56:10.334643 [debug] [MainThread]: Flushing usage events
